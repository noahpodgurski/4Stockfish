"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdatemeleelight"]("main",{

/***/ "./src/input/gamepad/gamepadCalibration.ts":
/*!*************************************************!*\
  !*** ./src/input/gamepad/gamepadCalibration.ts ***!
  \*************************************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

eval("\n// @flow\n/*eslint indent:0*/\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.customGamepadInfoIsUsable = void 0;\nexports.setClickObject = setClickObject;\nexports.setClickObjectNumber = setClickObjectNumber;\nexports.setCustomGamepadInfoIsUsable = setCustomGamepadInfoIsUsable;\nexports.runCalibration = runCalibration;\nconst Vec2D_js_1 = __webpack_require__(Object(function webpackMissingModule() { var e = new Error(\"Cannot find module '../../main/util/Vec2D.js'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }()));\nconst deepCopy_js_1 = __webpack_require__(Object(function webpackMissingModule() { var e = new Error(\"Cannot find module '../../main/util/deepCopy.js'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }()));\nconst main_js_1 = __webpack_require__(Object(function webpackMissingModule() { var e = new Error(\"Cannot find module '../../main/main.js'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }()));\nconst controllermenu_js_1 = __webpack_require__(Object(function webpackMissingModule() { var e = new Error(\"Cannot find module '../../menus/controllermenu.js'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }()));\nconst gamepadInfo_js_1 = __webpack_require__(Object(function webpackMissingModule() { var e = new Error(\"Cannot find module './gamepadInfo.js'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }()));\nconst gamepad_js_1 = __webpack_require__(Object(function webpackMissingModule() { var e = new Error(\"Cannot find module './gamepad.js'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }()));\nconst custom_js_1 = __webpack_require__(/*! ./gamepads/custom.js */ \"./src/input/gamepad/gamepads/custom.js\");\nconst findGamepadInfo_js_1 = __webpack_require__(Object(function webpackMissingModule() { var e = new Error(\"Cannot find module './findGamepadInfo.js'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }()));\nconst sfx_js_1 = __webpack_require__(Object(function webpackMissingModule() { var e = new Error(\"Cannot find module '../../main/sfx.js'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }()));\nconst calibrationInProgress = [false, false, false, false];\nfunction setCalibrationInProgress(i, boolean) {\n    calibrationInProgress[i] = boolean;\n}\nconst nullSnapshots = {\n    b0: [], bL: [], bR: [], bU: [],\n    a0: [], aL: [], aR: [], aU: []\n};\nlet clickObject = null;\nfunction setClickObject(click) {\n    if (clickObject === null) {\n        clickObject = click;\n    }\n}\nlet clickObjectNumber = 0;\nfunction setClickObjectNumber(k) {\n    clickObjectNumber = k;\n}\nexports.customGamepadInfoIsUsable = [true, null, null, null, null, null, null, null];\nlet listening = false;\nconst ids = [\"a\", \"b\", \"x\", \"y\", \"s\", \"r\", \"l\", \"z\", \"dpad\", \"icon\", \"ls\", \"cs\"];\n// add listeners for click\n// these turn off when the SVG is not displayed, so shouldn't impact performance\nfunction listen() {\n    var _a, _b;\n    // $FlowFixMe ignore the following type error\n    const svgDoc = (_a = document.getElementById(\"gamepadSVGCalibration\")) === null || _a === void 0 ? void 0 : _a.ownerDocument;\n    for (let i = 0; i < ids.length; i++) {\n        const id = ids[i];\n        if (id === null) {\n            throw \"id is null\";\n        }\n        // eslint-disable-next-line no-loop-func\n        (_b = svgDoc === null || svgDoc === void 0 ? void 0 : svgDoc.getElementById(id)) === null || _b === void 0 ? void 0 : _b.addEventListener('click', () => {\n            clickObject = id;\n        });\n    }\n    listening = true;\n}\nconst defaultTexts = [\"Click button, trigger or analog stick to rebind.\"];\nconst errorText = [\"Error: no controller detected\"];\n// figure out which custom gamepad infos are usable by the current controller\n// sets the value for customGamepadInfoIsUsable\nfunction setCustomGamepadInfoIsUsable(j) {\n    const currentGamepad = (0, gamepad_js_1.getGamepad)(j);\n    if (currentGamepad) {\n        const currentGamepadId = currentGamepad.id;\n        if ((0, findGamepadInfo_js_1.getGamepadNameAndInfo)(currentGamepadId) === null) {\n            exports.customGamepadInfoIsUsable[0] = null;\n        }\n        else {\n            exports.customGamepadInfoIsUsable[0] = true;\n        }\n        for (let k = 1; k < 8; k++) {\n            const maybeCustomGamepadInfo = (0, custom_js_1.getCustomGamepadInfo)(k);\n            if (maybeCustomGamepadInfo === null) {\n                exports.customGamepadInfoIsUsable[k] = null;\n            }\n            else {\n                if (currentGamepadId === maybeCustomGamepadInfo.fullID) {\n                    exports.customGamepadInfoIsUsable[k] = true;\n                }\n                else {\n                    exports.customGamepadInfoIsUsable[k] = false;\n                }\n            }\n        }\n    }\n    else {\n        exports.customGamepadInfoIsUsable[0] = null;\n    }\n}\nfunction runCalibration(i) {\n    if (!calibrationInProgress[i]) {\n        setCalibrationInProgress(i, true);\n        const interval = 2000;\n        const j = main_js_1.currentPlayers[i];\n        const prevGamepadInfo = main_js_1.mType[i] === null || main_js_1.mType[i] === \"keyboard\" ? gamepadInfo_js_1.nullGamepadInfo : main_js_1.mType[i];\n        const gamepadInfo = (0, deepCopy_js_1.deepCopyObject)(true, prevGamepadInfo);\n        setCustomGamepadInfoIsUsable(j);\n        clickObject = null;\n        if (listening === false) {\n            listen();\n        }\n        (0, controllermenu_js_1.updateControllerMenu)(false, [\"Mouse-click the start button to begin calibration.\"], 0);\n        preCalibrationLoop(i, j, gamepadInfo, interval);\n    }\n}\nfunction resetGamepadInfo(j) {\n    const gamepad = (0, gamepad_js_1.getGamepad)(j);\n    let baseGamepadInfo = gamepadInfo_js_1.nullGamepadInfo;\n    if (gamepad !== undefined && gamepad !== null && gamepad.id !== undefined && gamepad.id !== null) {\n        const maybeNameAndInfo = (0, findGamepadInfo_js_1.getGamepadNameAndInfo)(gamepad.id);\n        if (maybeNameAndInfo !== null) {\n            baseGamepadInfo = (0, deepCopy_js_1.deepCopyObject)(true, maybeNameAndInfo[1]);\n        }\n    }\n    return baseGamepadInfo;\n}\nfunction saveSound() {\n    sfx_js_1.sounds.star.play();\n}\nfunction preCalibrationLoop(i, j, gamepadInfo, interval) {\n    if (clickObject === \"s\") {\n        sfx_js_1.sounds.blunthit.play();\n        (0, custom_js_1.setCustomGamepadInfo)(j, gamepadInfo);\n        (0, main_js_1.setUsingCustomControls)(i, true);\n        (0, controllermenu_js_1.updateControllerMenu)(false, [\"Finding controller neutral point.\", \"Do not press anything.\"], interval);\n        // take null snapshot\n        setTimeout(() => {\n            (0, main_js_1.setControllerReset)(i);\n            saveSound();\n            const gamepad = (0, gamepad_js_1.getGamepad)(j);\n            if (gamepad !== undefined && gamepad !== null) {\n                const snapshots = nullSnapshots;\n                snapshots.b0 = (0, deepCopy_js_1.deepCopyArray)(true, gamepad.buttons);\n                snapshots.a0 = (0, deepCopy_js_1.deepCopyArray)(true, gamepad.axes);\n                calibrationLoop(i, j, gamepadInfo, snapshots, interval);\n                (0, controllermenu_js_1.updateControllerMenu)(false, defaultTexts, 0);\n            }\n            else {\n                (0, controllermenu_js_1.updateControllerMenu)(false, errorText, 0);\n            }\n        }, interval);\n    }\n    else if (clickObject === \"exit\") {\n        sfx_js_1.sounds.menuBack.play();\n        (0, controllermenu_js_1.updateControllerMenu)(true, [\"Quitting calibration menu.\"], interval);\n        setCalibrationInProgress(i, false);\n    }\n    else if (clickObject === \"reset\") {\n        sfx_js_1.sounds.loudelectricfizz.play();\n        (0, controllermenu_js_1.setCustomInUse)(0);\n        const baseGamepadInfo = resetGamepadInfo(j);\n        (0, main_js_1.setUsingCustomControls)(i, false, baseGamepadInfo);\n        (0, controllermenu_js_1.updateControllerMenu)(false, [\"Controller bindings have been reset.\", \"Click the start button to begin calibration.\"], 0);\n        setTimeout(() => preCalibrationLoop(i, j, baseGamepadInfo, interval), 16);\n    }\n    else if (clickObject === \"center\") {\n        saveSound();\n        (0, main_js_1.setControllerReset)(i);\n        (0, controllermenu_js_1.updateControllerMenu)(false, [\"Controller has been re-centered.\", \"Click the start button to begin calibration.\"], 0);\n        setTimeout(() => preCalibrationLoop(i, j, gamepadInfo, interval), 16);\n    }\n    else if (clickObject === \"loadCustom\") {\n        if (clickObjectNumber === 0) {\n            (0, controllermenu_js_1.setCustomInUse)(0);\n            const baseGamepadInfo = resetGamepadInfo(j);\n            (0, main_js_1.setUsingCustomControls)(i, false, baseGamepadInfo);\n            (0, controllermenu_js_1.updateControllerMenu)(false, [\"Now using default controller bindings.\", \"Click the start button to begin calibration.\"], 0);\n            setTimeout(() => preCalibrationLoop(i, j, baseGamepadInfo, interval), 16);\n        }\n        else {\n            const newCustomGamepadInfo = (0, custom_js_1.getCustomGamepadInfo)(clickObjectNumber);\n            if (newCustomGamepadInfo === null || exports.customGamepadInfoIsUsable[clickObjectNumber] !== true) {\n                sfx_js_1.sounds.deny.play();\n                setTimeout(() => preCalibrationLoop(i, j, gamepadInfo, interval), 16);\n            }\n            else {\n                const newGamepadInfo = newCustomGamepadInfo.gamepadInfo;\n                (0, controllermenu_js_1.setCustomInUse)(clickObjectNumber);\n                (0, custom_js_1.setCustomGamepadInfo)(j, newGamepadInfo);\n                (0, main_js_1.setUsingCustomControls)(i, true);\n                (0, controllermenu_js_1.updateControllerMenu)(false, [\"Now using custom bindings #\" + clickObjectNumber + \".\", \"Click the start button to begin calibration.\"], 0);\n                setTimeout(() => preCalibrationLoop(i, j, newGamepadInfo, interval), 16);\n            }\n        }\n    }\n    else if (clickObject === \"saveCustom\") {\n        if (clickObjectNumber < 1) {\n            sfx_js_1.sounds.deny.play();\n        }\n        else {\n            exports.customGamepadInfoIsUsable[clickObjectNumber] = true;\n            (0, custom_js_1.storeCustomGamepadInfo)(gamepadInfo, (0, gamepad_js_1.getGamepad)(j).id, (\"custom\" + clickObjectNumber), clickObjectNumber);\n            (0, controllermenu_js_1.setCustomInUse)(clickObjectNumber);\n        }\n        setTimeout(() => preCalibrationLoop(i, j, gamepadInfo, interval), 16);\n    }\n    else {\n        if (clickObject === \"icon\") {\n            sfx_js_1.sounds.shout8.play();\n            sfx_js_1.sounds.sword3.play();\n        }\n        setTimeout(() => preCalibrationLoop(i, j, gamepadInfo, interval), 16);\n    }\n    clickObject = null;\n}\n;\nfunction calibrationLoop(i, j, gamepadInfo, snapshots, interval) {\n    if (clickObject === null) {\n        setTimeout(() => {\n            calibrationLoop(i, j, gamepadInfo, snapshots, interval);\n        }, 16);\n    }\n    else {\n        calibrateObject(i, j, gamepadInfo, snapshots, interval);\n    }\n}\n;\nfunction calibrateObject(i, j, gamepadInfo, snapshots, interval) {\n    let texts;\n    let gamepad;\n    let totalInterval = interval + 16;\n    if (clickObject === null) {\n        console.log(\"error in function 'calibrateObject': calibration called on null object\");\n    }\n    else if (clickObject === \"icon\") {\n        sfx_js_1.sounds.shout8.play();\n        sfx_js_1.sounds.sword3.play();\n    }\n    else if (clickObject === \"exit\") {\n        sfx_js_1.sounds.menuBack.play();\n        setCalibrationInProgress(i, false);\n        (0, controllermenu_js_1.updateControllerMenu)(true, [\"Quitting calibration menu.\"], interval);\n    }\n    else if (clickObject === \"reset\") {\n        sfx_js_1.sounds.loudelectricfizz.play();\n        (0, controllermenu_js_1.setCustomInUse)(0);\n        const baseGamepadInfo = resetGamepadInfo(j);\n        (0, custom_js_1.setCustomGamepadInfo)(j, baseGamepadInfo);\n        (0, main_js_1.setUsingCustomControls)(i, false, baseGamepadInfo);\n        (0, controllermenu_js_1.updateControllerMenu)(false, [\"Controller bindings have been reset.\", \"Click the start button to begin calibration.\"], 0);\n        setTimeout(() => preCalibrationLoop(i, j, baseGamepadInfo, interval), 16);\n    }\n    else if (clickObject === \"center\") {\n        saveSound();\n        (0, main_js_1.setControllerReset)(i);\n        (0, controllermenu_js_1.updateControllerMenu)(false, [\"Controller has been re-centered.\", \"Click the start button to continue calibration.\"], 0);\n        setTimeout(() => preCalibrationLoop(i, j, gamepadInfo, interval), 16);\n        totalInterval = 16;\n    }\n    else if (clickObject === \"loadCustom\") {\n        if (clickObjectNumber === 0) {\n            (0, controllermenu_js_1.setCustomInUse)(0);\n            const baseGamepadInfo = resetGamepadInfo(j);\n            (0, main_js_1.setUsingCustomControls)(i, false, baseGamepadInfo);\n            (0, controllermenu_js_1.updateControllerMenu)(false, [\"Now using default controller bindings.\", \"Click the start button to begin calibration.\"], 0);\n            setTimeout(() => preCalibrationLoop(i, j, baseGamepadInfo, interval), 16);\n        }\n        else {\n            const newCustomGamepadInfo = (0, custom_js_1.getCustomGamepadInfo)(clickObjectNumber);\n            if (newCustomGamepadInfo === null || exports.customGamepadInfoIsUsable[clickObjectNumber] !== true) {\n                sfx_js_1.sounds.deny.play();\n                setTimeout(() => preCalibrationLoop(i, j, gamepadInfo, interval), 16);\n            }\n            else {\n                const newGamepadInfo = newCustomGamepadInfo.gamepadInfo;\n                (0, controllermenu_js_1.setCustomInUse)(clickObjectNumber);\n                (0, custom_js_1.setCustomGamepadInfo)(j, newGamepadInfo);\n                (0, main_js_1.setUsingCustomControls)(i, true);\n                (0, controllermenu_js_1.updateControllerMenu)(false, [\"Now using custom bindings #\" + clickObjectNumber + \".\", \"Click the start button to begin calibration.\"], 0);\n                setTimeout(() => preCalibrationLoop(i, j, newGamepadInfo, interval), 16);\n            }\n        }\n    }\n    else if (clickObject === \"saveCustom\") {\n        if (clickObjectNumber < 1) {\n            sfx_js_1.sounds.deny.play();\n        }\n        else {\n            exports.customGamepadInfoIsUsable[clickObjectNumber] = true;\n            (0, custom_js_1.storeCustomGamepadInfo)(gamepadInfo, (0, gamepad_js_1.getGamepad)(j).id, (\"custom\" + clickObjectNumber), clickObjectNumber);\n            (0, controllermenu_js_1.setCustomInUse)(clickObjectNumber);\n        }\n    }\n    else if (clickObject === \"l\" || clickObject === \"r\") {\n        texts = [\"Fully depress \" + clickObject.toUpperCase() + \" trigger.\", \"Keep holding down the trigger.\"];\n        const t = clickObject; // passed as-is in the closure\n        const tA = clickObject + \"A\";\n        (0, controllermenu_js_1.updateControllerMenu)(false, texts, interval);\n        setTimeout(() => {\n            saveSound();\n            gamepad = (0, gamepad_js_1.getGamepad)(j);\n            gamepadInfo[t] = scanForButton(snapshots.b0, gamepad.buttons, snapshots.a0, gamepad.axes, true);\n            gamepadInfo[tA] = scanForTrigger(snapshots.b0, gamepad.buttons, snapshots.a0, gamepad.axes);\n            (0, controllermenu_js_1.updateControllerMenu)(false, defaultTexts, 0);\n            if (t === \"l\" && gamepadInfo.lA !== null && (gamepadInfo.lA.kind === \"value\" || gamepadInfo.lA.kind === \"axis\")) {\n                gamepadInfo.isGC = Math.abs(gamepadInfo.lA.min + 0.866) < 0.01 ? true : false; // hacky but hey\n            }\n        }, interval);\n    }\n    else if (clickObject === \"ls\" || clickObject === \"cs\" || clickObject === \"dpad\") {\n        let sep = \",\";\n        if (clickObject === \"ls\") {\n            texts = [\"Move left analog stick all the way \", \"and keep it there.\"];\n        }\n        else if (clickObject === \"cs\") {\n            texts = [\"Move c-stick all the way \", \"and keep it there.\"];\n        }\n        else {\n            sep = \".\";\n            texts = [\"Press and hold d-pad \"];\n        }\n        totalInterval += 5 * interval;\n        (0, controllermenu_js_1.updateControllerMenu)(false, [texts[0] + \"left\" + sep, texts[1]], 1.5 * interval);\n        setTimeout(() => {\n            saveSound();\n            gamepad = (0, gamepad_js_1.getGamepad)(j);\n            snapshots.bL = (0, deepCopy_js_1.deepCopyArray)(true, gamepad.buttons);\n            snapshots.aL = (0, deepCopy_js_1.deepCopyArray)(true, gamepad.axes);\n            (0, controllermenu_js_1.updateControllerMenu)(false, [texts[0] + \"right\" + sep, texts[1]], 1.5 * interval);\n        }, 1.5 * interval);\n        setTimeout(() => {\n            saveSound();\n            gamepad = (0, gamepad_js_1.getGamepad)(j);\n            snapshots.bR = (0, deepCopy_js_1.deepCopyArray)(true, gamepad.buttons);\n            snapshots.aR = (0, deepCopy_js_1.deepCopyArray)(true, gamepad.axes);\n            (0, controllermenu_js_1.updateControllerMenu)(false, [texts[0] + \"up\" + sep, texts[1]], 1.5 * interval);\n        }, 3 * interval);\n        setTimeout(() => {\n            saveSound();\n            gamepad = (0, gamepad_js_1.getGamepad)(j);\n            snapshots.bU = (0, deepCopy_js_1.deepCopyArray)(true, gamepad.buttons);\n            snapshots.aU = (0, deepCopy_js_1.deepCopyArray)(true, gamepad.axes);\n            (0, controllermenu_js_1.updateControllerMenu)(false, [texts[0] + \"down\" + sep, texts[1]], 1.5 * interval);\n        }, 4.5 * interval);\n        if (clickObject === \"dpad\") {\n            setTimeout(() => {\n                saveSound();\n                gamepad = (0, gamepad_js_1.getGamepad)(j);\n                gamepadInfo.dpad = scanForDPad(snapshots.b0, snapshots.bL, snapshots.bR, snapshots.bU, gamepad.buttons, snapshots.a0, snapshots.aL, snapshots.aR, snapshots.aU, gamepad.axes);\n                (0, controllermenu_js_1.updateControllerMenu)(false, defaultTexts, 0);\n            }, 6 * interval);\n        }\n        else {\n            const clickNow = clickObject; // passed as-is in the closure\n            setTimeout(() => {\n                saveSound();\n                gamepad = (0, gamepad_js_1.getGamepad)(j);\n                gamepadInfo[clickNow] = scanForStick(snapshots.b0, snapshots.bL, snapshots.bR, snapshots.bU, gamepad.buttons, snapshots.a0, snapshots.aL, snapshots.aR, snapshots.aU, gamepad.axes);\n                (0, controllermenu_js_1.updateControllerMenu)(false, defaultTexts, 0);\n            }, 6 * interval);\n        }\n    }\n    else { // only plain buttons left now\n        const buttonName = clickObject === \"s\" ? \"start\" : clickObject.toUpperCase();\n        texts = [\"Press and hold \" + buttonName + \".\"];\n        const clickNow = clickObject;\n        (0, controllermenu_js_1.updateControllerMenu)(false, texts, interval);\n        setTimeout(() => {\n            saveSound();\n            gamepad = (0, gamepad_js_1.getGamepad)(j);\n            gamepadInfo[clickNow] = scanForButton(snapshots.b0, gamepad.buttons, snapshots.a0, gamepad.axes);\n            (0, controllermenu_js_1.updateControllerMenu)(false, defaultTexts, 0);\n        }, interval);\n    }\n    if (clickObject !== \"exit\" && clickObject !== \"reset\" && clickObject !== \"center\" && clickObject !== \"loadCustom\") {\n        if (clickObject !== null) {\n            sfx_js_1.sounds.blunthit.play();\n            setTimeout(() => {\n                (0, custom_js_1.setCustomGamepadInfo)(j, gamepadInfo);\n                calibrationLoop(i, j, gamepadInfo, snapshots, interval);\n            }, totalInterval);\n        }\n        else {\n            setTimeout(() => {\n                calibrationLoop(i, j, gamepadInfo, snapshots, interval);\n            }, totalInterval);\n        }\n    }\n    if (clickObject !== null && clickObject !== \"saveCustom\" && clickObject !== \"loadCustom\"\n        && clickObject !== \"center\" && clickObject !== \"icon\" && clickObject !== \"exit\" && clickObject !== \"reset\") {\n        (0, controllermenu_js_1.setCustomInUse)(null);\n    }\n    if (clickObject !== null) {\n        clickObject = null;\n    }\n}\nfunction scanForButton(buttons0, buttons1, axes0, axes1, onlyPressed = false) {\n    let buttonInfo = null;\n    const bLg = buttons1.length;\n    for (let i = 0; i < bLg; i++) {\n        if (detectedButtonPressed(buttons0[i].pressed, buttons1[i].pressed)) {\n            buttonInfo = { kind: \"pressed\", index: i };\n            break;\n        }\n        else if (!onlyPressed && detectedButtonValue(buttons0[i].value, buttons1[i].value)) {\n            buttonInfo = { kind: \"value\", index: i, threshold: 0.75 };\n            break;\n        }\n    }\n    if (!onlyPressed && buttonInfo === null) {\n        const aLg = axes1.length;\n        for (let j = 0; j < aLg; j++) {\n            if (detectedButtonValue(axes0[j], axes1[j])) {\n                buttonInfo = { kind: \"axis\", index: j, threshold: 0.75 };\n                break;\n            }\n        }\n    }\n    return buttonInfo;\n}\n;\nfunction detectedButtonPressed(pressed0, pressed1) {\n    return pressed1 && !pressed0;\n}\n;\nfunction detectedButtonValue(value0, value1) {\n    return (value0 < 0.25 && value1 > 0.75);\n}\n;\nfunction scanForTrigger(buttons0, buttons1, axes0, axes1) {\n    let minMax;\n    let triggerInfo = null;\n    const aLg = axes1.length;\n    for (let i = 0; i < aLg && triggerInfo === null; i++) {\n        minMax = detectedTrigger(axes0[i], axes1[i]);\n        if (minMax !== null) {\n            triggerInfo = { kind: \"axis\", index: i, min: minMax[0], max: minMax[1] };\n            break;\n        }\n    }\n    if (triggerInfo === null) {\n        const bLg = buttons1.length;\n        for (let j = 0; j < bLg && triggerInfo === null; j++) {\n            minMax = detectedTrigger(buttons0[j].value, buttons1[j].value);\n            if (minMax !== null) {\n                triggerInfo = { kind: \"value\", index: j, min: minMax[0], max: minMax[1] };\n                break;\n            }\n        }\n    }\n    return triggerInfo;\n}\nfunction detectedTrigger(axis0, axis1) {\n    if (Math.abs(axis1 - axis0) < 0.5) {\n        return null;\n    }\n    else {\n        return getMinAndMax(axis0, axis1);\n    }\n}\nfunction getMinAndMax(axis0, axis1) {\n    const min = axis0 < -0.87 ? -1 : axis0 < -0.5 ? -0.866 : axis0 > 0.87 ? 1 : axis0 > 0.5 ? 0.8667 : 0;\n    const max = min === 0 ? Math.sign(axis1) : -min;\n    return [min, max];\n}\nfunction scanForStick(buttons0, buttonsL, buttonsR, buttonsU, buttonsD, axes0, axesL, axesR, axesU, axesD) {\n    let stickInfo = null;\n    let xDiff = 0;\n    let yDiff = 0;\n    let newXDiff = 0;\n    let newYDiff = 0;\n    let xIndex;\n    let yIndex;\n    let kind;\n    let cardinals = null;\n    const aLg = axes0.length;\n    kind = \"axes\";\n    for (let i = 0; i < aLg; i++) {\n        newXDiff = axesR[i] - axesL[i];\n        if (Math.abs(newXDiff) > Math.abs(xDiff)) {\n            xDiff = newXDiff;\n            xIndex = i;\n        }\n        newYDiff = axesU[i] - axesD[i];\n        if (Math.abs(newYDiff) > Math.abs(yDiff)) {\n            yDiff = newYDiff;\n            yIndex = i;\n        }\n    }\n    if (xIndex !== undefined && yIndex !== undefined && Math.abs(xDiff) > 0.5 && Math.abs(yDiff) > 0.5) {\n        cardinals = {\n            center: new Vec2D_js_1.Vec2D(axes0[xIndex], axes0[yIndex]),\n            left: axesL[xIndex],\n            right: axesR[xIndex],\n            up: axesU[yIndex],\n            down: axesD[yIndex]\n        };\n    }\n    if (Math.abs(xDiff) < 0.5 || Math.abs(yDiff) < 0.5) {\n        const bLg = buttons0.length;\n        kind = \"value\";\n        for (let j = 0; j < bLg; j++) {\n            newXDiff = buttonsR[j].value - buttonsL[j].value;\n            if (Math.abs(newXDiff) > Math.abs(xDiff)) {\n                xDiff = newXDiff;\n                xIndex = j;\n            }\n            newYDiff = buttonsU[j].value - buttonsD[j].value;\n            if (Math.abs(newYDiff) > Math.abs(yDiff)) {\n                yDiff = newYDiff;\n                yIndex = j;\n            }\n        }\n        if (xIndex !== undefined && yIndex !== undefined && Math.abs(xDiff) > 0.5 && Math.abs(yDiff) > 0.5) {\n            cardinals = {\n                center: new Vec2D_js_1.Vec2D(buttons0[xIndex].value, buttons0[yIndex].value),\n                left: buttonsL[xIndex].value,\n                right: buttonsR[xIndex].value,\n                up: buttonsU[yIndex].value,\n                down: buttonsD[yIndex].value\n            };\n        }\n    }\n    if (xIndex !== undefined && yIndex !== undefined) {\n        if (kind === \"axes\") {\n            stickInfo = { kind: \"axes\", xIndex: xIndex, yIndex: yIndex, cardinals: cardinals };\n        }\n        else {\n            stickInfo = { kind: \"value\", xIndex: xIndex, yIndex: yIndex, cardinals: cardinals };\n        }\n    }\n    return stickInfo;\n}\nfunction scanForDPad(buttons0, buttonsL, buttonsR, buttonsU, buttonsD, axes0, axesL, axesR, axesU, axesD) {\n    let dPadInfo = null;\n    const bLg = buttons0.length;\n    let lIndex;\n    let rIndex;\n    let uIndex;\n    let dIndex;\n    for (let i = 0; i < bLg; i++) {\n        if (lIndex === undefined && detectedButtonPressed(buttons0[i].pressed, buttonsL[i].pressed)) {\n            lIndex = i;\n        }\n        if (rIndex === undefined && detectedButtonPressed(buttons0[i].pressed, buttonsR[i].pressed)) {\n            rIndex = i;\n        }\n        if (uIndex === undefined && detectedButtonPressed(buttons0[i].pressed, buttonsU[i].pressed)) {\n            uIndex = i;\n        }\n        if (dIndex === undefined && detectedButtonPressed(buttons0[i].pressed, buttonsD[i].pressed)) {\n            dIndex = i;\n        }\n    }\n    if (lIndex !== undefined && rIndex !== undefined && uIndex !== undefined && dIndex !== undefined) {\n        dPadInfo = {\n            kind: \"buttons\",\n            upIndex: uIndex, downIndex: dIndex,\n            leftIndex: lIndex, rightIndex: rIndex\n        };\n    }\n    else {\n        let xDiff = 0;\n        let yDiff = 0;\n        let newXDiff = 0;\n        let newYDiff = 0;\n        let xIndex;\n        let yIndex;\n        const aLg = axes0.length;\n        for (let i = 0; i < aLg; i++) {\n            newXDiff = axesR[i] - axesL[i];\n            if (Math.abs(newXDiff) > Math.abs(xDiff)) {\n                xDiff = newXDiff;\n                xIndex = i;\n            }\n            newYDiff = axesU[i] - axesD[i];\n            if (Math.abs(newYDiff) > Math.abs(yDiff)) {\n                yDiff = newYDiff;\n                yIndex = i;\n            }\n        }\n        if (xIndex !== undefined && yIndex !== undefined) {\n            if (Math.abs(xDiff) > 0.5 && Math.abs(yDiff) > 0.5 && xIndex !== yIndex) {\n                dPadInfo = {\n                    kind: \"2axes\",\n                    xIndex: xIndex, yIndex: yIndex,\n                    xFlip: (xDiff < 0), yFlip: (yDiff < 0)\n                };\n            }\n            else { // lol\n                dPadInfo = { kind: \"axis\", index: xIndex };\n            }\n        }\n    }\n    return dPadInfo;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvaW5wdXQvZ2FtZXBhZC9nYW1lcGFkQ2FsaWJyYXRpb24udHMiLCJtYXBwaW5ncyI6IkFBQWE7QUFDYjtBQUNBO0FBQ0EsOENBQTZDLEVBQUUsYUFBYSxFQUFDO0FBQzdELGlDQUFpQztBQUNqQyxzQkFBc0I7QUFDdEIsNEJBQTRCO0FBQzVCLG9DQUFvQztBQUNwQyxzQkFBc0I7QUFDdEIsbUJBQW1CLG1CQUFPLENBQUMsdUpBQTBCO0FBQ3JELHNCQUFzQixtQkFBTyxDQUFDLDBKQUE2QjtBQUMzRCxrQkFBa0IsbUJBQU8sQ0FBQyxpSkFBb0I7QUFDOUMsNEJBQTRCLG1CQUFPLENBQUMsNEpBQStCO0FBQ25FLHlCQUF5QixtQkFBTyxDQUFDLCtJQUFrQjtBQUNuRCxxQkFBcUIsbUJBQU8sQ0FBQywySUFBYztBQUMzQyxvQkFBb0IsbUJBQU8sQ0FBQyxvRUFBc0I7QUFDbEQsNkJBQTZCLG1CQUFPLENBQUMsbUpBQXNCO0FBQzNELGlCQUFpQixtQkFBTyxDQUFDLGdKQUFtQjtBQUM1QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQ0FBaUM7QUFDakM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixnQkFBZ0I7QUFDcEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSxvQ0FBb0M7QUFDaEQ7QUFDQTtBQUNBLFlBQVksb0NBQW9DO0FBQ2hEO0FBQ0Esd0JBQXdCLE9BQU87QUFDL0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUSxvQ0FBb0M7QUFDNUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQjtBQUMvQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrRkFBK0Y7QUFDL0Y7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQSwwQ0FBMEM7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixTQUFTO0FBQzdCO0FBQ0EsMkJBQTJCO0FBQzNCO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQjtBQUMzQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLFNBQVM7QUFDakM7QUFDQSwrQkFBK0I7QUFDL0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IsaUNBQWlDO0FBQ3JEO0FBQ0E7QUFDQSw0QkFBNEI7QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixpQ0FBaUM7QUFDekQ7QUFDQTtBQUNBLGdDQUFnQztBQUNoQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixTQUFTO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsU0FBUztBQUNqQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCO0FBQzFCO0FBQ0E7QUFDQSwwQkFBMEI7QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixTQUFTO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLFNBQVM7QUFDakM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUI7QUFDbkIsNkJBQTZCO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9tZWxlZWxpZ2h0Ly4vc3JjL2lucHV0L2dhbWVwYWQvZ2FtZXBhZENhbGlicmF0aW9uLnRzP2VlYTIiXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG4vLyBAZmxvd1xuLyplc2xpbnQgaW5kZW50OjAqL1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuZXhwb3J0cy5jdXN0b21HYW1lcGFkSW5mb0lzVXNhYmxlID0gdm9pZCAwO1xuZXhwb3J0cy5zZXRDbGlja09iamVjdCA9IHNldENsaWNrT2JqZWN0O1xuZXhwb3J0cy5zZXRDbGlja09iamVjdE51bWJlciA9IHNldENsaWNrT2JqZWN0TnVtYmVyO1xuZXhwb3J0cy5zZXRDdXN0b21HYW1lcGFkSW5mb0lzVXNhYmxlID0gc2V0Q3VzdG9tR2FtZXBhZEluZm9Jc1VzYWJsZTtcbmV4cG9ydHMucnVuQ2FsaWJyYXRpb24gPSBydW5DYWxpYnJhdGlvbjtcbmNvbnN0IFZlYzJEX2pzXzEgPSByZXF1aXJlKFwiLi4vLi4vbWFpbi91dGlsL1ZlYzJELmpzXCIpO1xuY29uc3QgZGVlcENvcHlfanNfMSA9IHJlcXVpcmUoXCIuLi8uLi9tYWluL3V0aWwvZGVlcENvcHkuanNcIik7XG5jb25zdCBtYWluX2pzXzEgPSByZXF1aXJlKFwiLi4vLi4vbWFpbi9tYWluLmpzXCIpO1xuY29uc3QgY29udHJvbGxlcm1lbnVfanNfMSA9IHJlcXVpcmUoXCIuLi8uLi9tZW51cy9jb250cm9sbGVybWVudS5qc1wiKTtcbmNvbnN0IGdhbWVwYWRJbmZvX2pzXzEgPSByZXF1aXJlKFwiLi9nYW1lcGFkSW5mby5qc1wiKTtcbmNvbnN0IGdhbWVwYWRfanNfMSA9IHJlcXVpcmUoXCIuL2dhbWVwYWQuanNcIik7XG5jb25zdCBjdXN0b21fanNfMSA9IHJlcXVpcmUoXCIuL2dhbWVwYWRzL2N1c3RvbS5qc1wiKTtcbmNvbnN0IGZpbmRHYW1lcGFkSW5mb19qc18xID0gcmVxdWlyZShcIi4vZmluZEdhbWVwYWRJbmZvLmpzXCIpO1xuY29uc3Qgc2Z4X2pzXzEgPSByZXF1aXJlKFwiLi4vLi4vbWFpbi9zZnguanNcIik7XG5jb25zdCBjYWxpYnJhdGlvbkluUHJvZ3Jlc3MgPSBbZmFsc2UsIGZhbHNlLCBmYWxzZSwgZmFsc2VdO1xuZnVuY3Rpb24gc2V0Q2FsaWJyYXRpb25JblByb2dyZXNzKGksIGJvb2xlYW4pIHtcbiAgICBjYWxpYnJhdGlvbkluUHJvZ3Jlc3NbaV0gPSBib29sZWFuO1xufVxuY29uc3QgbnVsbFNuYXBzaG90cyA9IHtcbiAgICBiMDogW10sIGJMOiBbXSwgYlI6IFtdLCBiVTogW10sXG4gICAgYTA6IFtdLCBhTDogW10sIGFSOiBbXSwgYVU6IFtdXG59O1xubGV0IGNsaWNrT2JqZWN0ID0gbnVsbDtcbmZ1bmN0aW9uIHNldENsaWNrT2JqZWN0KGNsaWNrKSB7XG4gICAgaWYgKGNsaWNrT2JqZWN0ID09PSBudWxsKSB7XG4gICAgICAgIGNsaWNrT2JqZWN0ID0gY2xpY2s7XG4gICAgfVxufVxubGV0IGNsaWNrT2JqZWN0TnVtYmVyID0gMDtcbmZ1bmN0aW9uIHNldENsaWNrT2JqZWN0TnVtYmVyKGspIHtcbiAgICBjbGlja09iamVjdE51bWJlciA9IGs7XG59XG5leHBvcnRzLmN1c3RvbUdhbWVwYWRJbmZvSXNVc2FibGUgPSBbdHJ1ZSwgbnVsbCwgbnVsbCwgbnVsbCwgbnVsbCwgbnVsbCwgbnVsbCwgbnVsbF07XG5sZXQgbGlzdGVuaW5nID0gZmFsc2U7XG5jb25zdCBpZHMgPSBbXCJhXCIsIFwiYlwiLCBcInhcIiwgXCJ5XCIsIFwic1wiLCBcInJcIiwgXCJsXCIsIFwielwiLCBcImRwYWRcIiwgXCJpY29uXCIsIFwibHNcIiwgXCJjc1wiXTtcbi8vIGFkZCBsaXN0ZW5lcnMgZm9yIGNsaWNrXG4vLyB0aGVzZSB0dXJuIG9mZiB3aGVuIHRoZSBTVkcgaXMgbm90IGRpc3BsYXllZCwgc28gc2hvdWxkbid0IGltcGFjdCBwZXJmb3JtYW5jZVxuZnVuY3Rpb24gbGlzdGVuKCkge1xuICAgIHZhciBfYSwgX2I7XG4gICAgLy8gJEZsb3dGaXhNZSBpZ25vcmUgdGhlIGZvbGxvd2luZyB0eXBlIGVycm9yXG4gICAgY29uc3Qgc3ZnRG9jID0gKF9hID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJnYW1lcGFkU1ZHQ2FsaWJyYXRpb25cIikpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5vd25lckRvY3VtZW50O1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgaWRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGNvbnN0IGlkID0gaWRzW2ldO1xuICAgICAgICBpZiAoaWQgPT09IG51bGwpIHtcbiAgICAgICAgICAgIHRocm93IFwiaWQgaXMgbnVsbFwiO1xuICAgICAgICB9XG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1sb29wLWZ1bmNcbiAgICAgICAgKF9iID0gc3ZnRG9jID09PSBudWxsIHx8IHN2Z0RvYyA9PT0gdm9pZCAwID8gdm9pZCAwIDogc3ZnRG9jLmdldEVsZW1lbnRCeUlkKGlkKSkgPT09IG51bGwgfHwgX2IgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9iLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICAgICAgY2xpY2tPYmplY3QgPSBpZDtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGxpc3RlbmluZyA9IHRydWU7XG59XG5jb25zdCBkZWZhdWx0VGV4dHMgPSBbXCJDbGljayBidXR0b24sIHRyaWdnZXIgb3IgYW5hbG9nIHN0aWNrIHRvIHJlYmluZC5cIl07XG5jb25zdCBlcnJvclRleHQgPSBbXCJFcnJvcjogbm8gY29udHJvbGxlciBkZXRlY3RlZFwiXTtcbi8vIGZpZ3VyZSBvdXQgd2hpY2ggY3VzdG9tIGdhbWVwYWQgaW5mb3MgYXJlIHVzYWJsZSBieSB0aGUgY3VycmVudCBjb250cm9sbGVyXG4vLyBzZXRzIHRoZSB2YWx1ZSBmb3IgY3VzdG9tR2FtZXBhZEluZm9Jc1VzYWJsZVxuZnVuY3Rpb24gc2V0Q3VzdG9tR2FtZXBhZEluZm9Jc1VzYWJsZShqKSB7XG4gICAgY29uc3QgY3VycmVudEdhbWVwYWQgPSAoMCwgZ2FtZXBhZF9qc18xLmdldEdhbWVwYWQpKGopO1xuICAgIGlmIChjdXJyZW50R2FtZXBhZCkge1xuICAgICAgICBjb25zdCBjdXJyZW50R2FtZXBhZElkID0gY3VycmVudEdhbWVwYWQuaWQ7XG4gICAgICAgIGlmICgoMCwgZmluZEdhbWVwYWRJbmZvX2pzXzEuZ2V0R2FtZXBhZE5hbWVBbmRJbmZvKShjdXJyZW50R2FtZXBhZElkKSA9PT0gbnVsbCkge1xuICAgICAgICAgICAgZXhwb3J0cy5jdXN0b21HYW1lcGFkSW5mb0lzVXNhYmxlWzBdID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGV4cG9ydHMuY3VzdG9tR2FtZXBhZEluZm9Jc1VzYWJsZVswXSA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgZm9yIChsZXQgayA9IDE7IGsgPCA4OyBrKyspIHtcbiAgICAgICAgICAgIGNvbnN0IG1heWJlQ3VzdG9tR2FtZXBhZEluZm8gPSAoMCwgY3VzdG9tX2pzXzEuZ2V0Q3VzdG9tR2FtZXBhZEluZm8pKGspO1xuICAgICAgICAgICAgaWYgKG1heWJlQ3VzdG9tR2FtZXBhZEluZm8gPT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICBleHBvcnRzLmN1c3RvbUdhbWVwYWRJbmZvSXNVc2FibGVba10gPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRHYW1lcGFkSWQgPT09IG1heWJlQ3VzdG9tR2FtZXBhZEluZm8uZnVsbElEKSB7XG4gICAgICAgICAgICAgICAgICAgIGV4cG9ydHMuY3VzdG9tR2FtZXBhZEluZm9Jc1VzYWJsZVtrXSA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBleHBvcnRzLmN1c3RvbUdhbWVwYWRJbmZvSXNVc2FibGVba10gPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGV4cG9ydHMuY3VzdG9tR2FtZXBhZEluZm9Jc1VzYWJsZVswXSA9IG51bGw7XG4gICAgfVxufVxuZnVuY3Rpb24gcnVuQ2FsaWJyYXRpb24oaSkge1xuICAgIGlmICghY2FsaWJyYXRpb25JblByb2dyZXNzW2ldKSB7XG4gICAgICAgIHNldENhbGlicmF0aW9uSW5Qcm9ncmVzcyhpLCB0cnVlKTtcbiAgICAgICAgY29uc3QgaW50ZXJ2YWwgPSAyMDAwO1xuICAgICAgICBjb25zdCBqID0gbWFpbl9qc18xLmN1cnJlbnRQbGF5ZXJzW2ldO1xuICAgICAgICBjb25zdCBwcmV2R2FtZXBhZEluZm8gPSBtYWluX2pzXzEubVR5cGVbaV0gPT09IG51bGwgfHwgbWFpbl9qc18xLm1UeXBlW2ldID09PSBcImtleWJvYXJkXCIgPyBnYW1lcGFkSW5mb19qc18xLm51bGxHYW1lcGFkSW5mbyA6IG1haW5fanNfMS5tVHlwZVtpXTtcbiAgICAgICAgY29uc3QgZ2FtZXBhZEluZm8gPSAoMCwgZGVlcENvcHlfanNfMS5kZWVwQ29weU9iamVjdCkodHJ1ZSwgcHJldkdhbWVwYWRJbmZvKTtcbiAgICAgICAgc2V0Q3VzdG9tR2FtZXBhZEluZm9Jc1VzYWJsZShqKTtcbiAgICAgICAgY2xpY2tPYmplY3QgPSBudWxsO1xuICAgICAgICBpZiAobGlzdGVuaW5nID09PSBmYWxzZSkge1xuICAgICAgICAgICAgbGlzdGVuKCk7XG4gICAgICAgIH1cbiAgICAgICAgKDAsIGNvbnRyb2xsZXJtZW51X2pzXzEudXBkYXRlQ29udHJvbGxlck1lbnUpKGZhbHNlLCBbXCJNb3VzZS1jbGljayB0aGUgc3RhcnQgYnV0dG9uIHRvIGJlZ2luIGNhbGlicmF0aW9uLlwiXSwgMCk7XG4gICAgICAgIHByZUNhbGlicmF0aW9uTG9vcChpLCBqLCBnYW1lcGFkSW5mbywgaW50ZXJ2YWwpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIHJlc2V0R2FtZXBhZEluZm8oaikge1xuICAgIGNvbnN0IGdhbWVwYWQgPSAoMCwgZ2FtZXBhZF9qc18xLmdldEdhbWVwYWQpKGopO1xuICAgIGxldCBiYXNlR2FtZXBhZEluZm8gPSBnYW1lcGFkSW5mb19qc18xLm51bGxHYW1lcGFkSW5mbztcbiAgICBpZiAoZ2FtZXBhZCAhPT0gdW5kZWZpbmVkICYmIGdhbWVwYWQgIT09IG51bGwgJiYgZ2FtZXBhZC5pZCAhPT0gdW5kZWZpbmVkICYmIGdhbWVwYWQuaWQgIT09IG51bGwpIHtcbiAgICAgICAgY29uc3QgbWF5YmVOYW1lQW5kSW5mbyA9ICgwLCBmaW5kR2FtZXBhZEluZm9fanNfMS5nZXRHYW1lcGFkTmFtZUFuZEluZm8pKGdhbWVwYWQuaWQpO1xuICAgICAgICBpZiAobWF5YmVOYW1lQW5kSW5mbyAhPT0gbnVsbCkge1xuICAgICAgICAgICAgYmFzZUdhbWVwYWRJbmZvID0gKDAsIGRlZXBDb3B5X2pzXzEuZGVlcENvcHlPYmplY3QpKHRydWUsIG1heWJlTmFtZUFuZEluZm9bMV0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBiYXNlR2FtZXBhZEluZm87XG59XG5mdW5jdGlvbiBzYXZlU291bmQoKSB7XG4gICAgc2Z4X2pzXzEuc291bmRzLnN0YXIucGxheSgpO1xufVxuZnVuY3Rpb24gcHJlQ2FsaWJyYXRpb25Mb29wKGksIGosIGdhbWVwYWRJbmZvLCBpbnRlcnZhbCkge1xuICAgIGlmIChjbGlja09iamVjdCA9PT0gXCJzXCIpIHtcbiAgICAgICAgc2Z4X2pzXzEuc291bmRzLmJsdW50aGl0LnBsYXkoKTtcbiAgICAgICAgKDAsIGN1c3RvbV9qc18xLnNldEN1c3RvbUdhbWVwYWRJbmZvKShqLCBnYW1lcGFkSW5mbyk7XG4gICAgICAgICgwLCBtYWluX2pzXzEuc2V0VXNpbmdDdXN0b21Db250cm9scykoaSwgdHJ1ZSk7XG4gICAgICAgICgwLCBjb250cm9sbGVybWVudV9qc18xLnVwZGF0ZUNvbnRyb2xsZXJNZW51KShmYWxzZSwgW1wiRmluZGluZyBjb250cm9sbGVyIG5ldXRyYWwgcG9pbnQuXCIsIFwiRG8gbm90IHByZXNzIGFueXRoaW5nLlwiXSwgaW50ZXJ2YWwpO1xuICAgICAgICAvLyB0YWtlIG51bGwgc25hcHNob3RcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICAoMCwgbWFpbl9qc18xLnNldENvbnRyb2xsZXJSZXNldCkoaSk7XG4gICAgICAgICAgICBzYXZlU291bmQoKTtcbiAgICAgICAgICAgIGNvbnN0IGdhbWVwYWQgPSAoMCwgZ2FtZXBhZF9qc18xLmdldEdhbWVwYWQpKGopO1xuICAgICAgICAgICAgaWYgKGdhbWVwYWQgIT09IHVuZGVmaW5lZCAmJiBnYW1lcGFkICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgY29uc3Qgc25hcHNob3RzID0gbnVsbFNuYXBzaG90cztcbiAgICAgICAgICAgICAgICBzbmFwc2hvdHMuYjAgPSAoMCwgZGVlcENvcHlfanNfMS5kZWVwQ29weUFycmF5KSh0cnVlLCBnYW1lcGFkLmJ1dHRvbnMpO1xuICAgICAgICAgICAgICAgIHNuYXBzaG90cy5hMCA9ICgwLCBkZWVwQ29weV9qc18xLmRlZXBDb3B5QXJyYXkpKHRydWUsIGdhbWVwYWQuYXhlcyk7XG4gICAgICAgICAgICAgICAgY2FsaWJyYXRpb25Mb29wKGksIGosIGdhbWVwYWRJbmZvLCBzbmFwc2hvdHMsIGludGVydmFsKTtcbiAgICAgICAgICAgICAgICAoMCwgY29udHJvbGxlcm1lbnVfanNfMS51cGRhdGVDb250cm9sbGVyTWVudSkoZmFsc2UsIGRlZmF1bHRUZXh0cywgMCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAoMCwgY29udHJvbGxlcm1lbnVfanNfMS51cGRhdGVDb250cm9sbGVyTWVudSkoZmFsc2UsIGVycm9yVGV4dCwgMCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sIGludGVydmFsKTtcbiAgICB9XG4gICAgZWxzZSBpZiAoY2xpY2tPYmplY3QgPT09IFwiZXhpdFwiKSB7XG4gICAgICAgIHNmeF9qc18xLnNvdW5kcy5tZW51QmFjay5wbGF5KCk7XG4gICAgICAgICgwLCBjb250cm9sbGVybWVudV9qc18xLnVwZGF0ZUNvbnRyb2xsZXJNZW51KSh0cnVlLCBbXCJRdWl0dGluZyBjYWxpYnJhdGlvbiBtZW51LlwiXSwgaW50ZXJ2YWwpO1xuICAgICAgICBzZXRDYWxpYnJhdGlvbkluUHJvZ3Jlc3MoaSwgZmFsc2UpO1xuICAgIH1cbiAgICBlbHNlIGlmIChjbGlja09iamVjdCA9PT0gXCJyZXNldFwiKSB7XG4gICAgICAgIHNmeF9qc18xLnNvdW5kcy5sb3VkZWxlY3RyaWNmaXp6LnBsYXkoKTtcbiAgICAgICAgKDAsIGNvbnRyb2xsZXJtZW51X2pzXzEuc2V0Q3VzdG9tSW5Vc2UpKDApO1xuICAgICAgICBjb25zdCBiYXNlR2FtZXBhZEluZm8gPSByZXNldEdhbWVwYWRJbmZvKGopO1xuICAgICAgICAoMCwgbWFpbl9qc18xLnNldFVzaW5nQ3VzdG9tQ29udHJvbHMpKGksIGZhbHNlLCBiYXNlR2FtZXBhZEluZm8pO1xuICAgICAgICAoMCwgY29udHJvbGxlcm1lbnVfanNfMS51cGRhdGVDb250cm9sbGVyTWVudSkoZmFsc2UsIFtcIkNvbnRyb2xsZXIgYmluZGluZ3MgaGF2ZSBiZWVuIHJlc2V0LlwiLCBcIkNsaWNrIHRoZSBzdGFydCBidXR0b24gdG8gYmVnaW4gY2FsaWJyYXRpb24uXCJdLCAwKTtcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiBwcmVDYWxpYnJhdGlvbkxvb3AoaSwgaiwgYmFzZUdhbWVwYWRJbmZvLCBpbnRlcnZhbCksIDE2KTtcbiAgICB9XG4gICAgZWxzZSBpZiAoY2xpY2tPYmplY3QgPT09IFwiY2VudGVyXCIpIHtcbiAgICAgICAgc2F2ZVNvdW5kKCk7XG4gICAgICAgICgwLCBtYWluX2pzXzEuc2V0Q29udHJvbGxlclJlc2V0KShpKTtcbiAgICAgICAgKDAsIGNvbnRyb2xsZXJtZW51X2pzXzEudXBkYXRlQ29udHJvbGxlck1lbnUpKGZhbHNlLCBbXCJDb250cm9sbGVyIGhhcyBiZWVuIHJlLWNlbnRlcmVkLlwiLCBcIkNsaWNrIHRoZSBzdGFydCBidXR0b24gdG8gYmVnaW4gY2FsaWJyYXRpb24uXCJdLCAwKTtcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiBwcmVDYWxpYnJhdGlvbkxvb3AoaSwgaiwgZ2FtZXBhZEluZm8sIGludGVydmFsKSwgMTYpO1xuICAgIH1cbiAgICBlbHNlIGlmIChjbGlja09iamVjdCA9PT0gXCJsb2FkQ3VzdG9tXCIpIHtcbiAgICAgICAgaWYgKGNsaWNrT2JqZWN0TnVtYmVyID09PSAwKSB7XG4gICAgICAgICAgICAoMCwgY29udHJvbGxlcm1lbnVfanNfMS5zZXRDdXN0b21JblVzZSkoMCk7XG4gICAgICAgICAgICBjb25zdCBiYXNlR2FtZXBhZEluZm8gPSByZXNldEdhbWVwYWRJbmZvKGopO1xuICAgICAgICAgICAgKDAsIG1haW5fanNfMS5zZXRVc2luZ0N1c3RvbUNvbnRyb2xzKShpLCBmYWxzZSwgYmFzZUdhbWVwYWRJbmZvKTtcbiAgICAgICAgICAgICgwLCBjb250cm9sbGVybWVudV9qc18xLnVwZGF0ZUNvbnRyb2xsZXJNZW51KShmYWxzZSwgW1wiTm93IHVzaW5nIGRlZmF1bHQgY29udHJvbGxlciBiaW5kaW5ncy5cIiwgXCJDbGljayB0aGUgc3RhcnQgYnV0dG9uIHRvIGJlZ2luIGNhbGlicmF0aW9uLlwiXSwgMCk7XG4gICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHByZUNhbGlicmF0aW9uTG9vcChpLCBqLCBiYXNlR2FtZXBhZEluZm8sIGludGVydmFsKSwgMTYpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgbmV3Q3VzdG9tR2FtZXBhZEluZm8gPSAoMCwgY3VzdG9tX2pzXzEuZ2V0Q3VzdG9tR2FtZXBhZEluZm8pKGNsaWNrT2JqZWN0TnVtYmVyKTtcbiAgICAgICAgICAgIGlmIChuZXdDdXN0b21HYW1lcGFkSW5mbyA9PT0gbnVsbCB8fCBleHBvcnRzLmN1c3RvbUdhbWVwYWRJbmZvSXNVc2FibGVbY2xpY2tPYmplY3ROdW1iZXJdICE9PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgc2Z4X2pzXzEuc291bmRzLmRlbnkucGxheSgpO1xuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gcHJlQ2FsaWJyYXRpb25Mb29wKGksIGosIGdhbWVwYWRJbmZvLCBpbnRlcnZhbCksIDE2KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnN0IG5ld0dhbWVwYWRJbmZvID0gbmV3Q3VzdG9tR2FtZXBhZEluZm8uZ2FtZXBhZEluZm87XG4gICAgICAgICAgICAgICAgKDAsIGNvbnRyb2xsZXJtZW51X2pzXzEuc2V0Q3VzdG9tSW5Vc2UpKGNsaWNrT2JqZWN0TnVtYmVyKTtcbiAgICAgICAgICAgICAgICAoMCwgY3VzdG9tX2pzXzEuc2V0Q3VzdG9tR2FtZXBhZEluZm8pKGosIG5ld0dhbWVwYWRJbmZvKTtcbiAgICAgICAgICAgICAgICAoMCwgbWFpbl9qc18xLnNldFVzaW5nQ3VzdG9tQ29udHJvbHMpKGksIHRydWUpO1xuICAgICAgICAgICAgICAgICgwLCBjb250cm9sbGVybWVudV9qc18xLnVwZGF0ZUNvbnRyb2xsZXJNZW51KShmYWxzZSwgW1wiTm93IHVzaW5nIGN1c3RvbSBiaW5kaW5ncyAjXCIgKyBjbGlja09iamVjdE51bWJlciArIFwiLlwiLCBcIkNsaWNrIHRoZSBzdGFydCBidXR0b24gdG8gYmVnaW4gY2FsaWJyYXRpb24uXCJdLCAwKTtcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHByZUNhbGlicmF0aW9uTG9vcChpLCBqLCBuZXdHYW1lcGFkSW5mbywgaW50ZXJ2YWwpLCAxNik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSBpZiAoY2xpY2tPYmplY3QgPT09IFwic2F2ZUN1c3RvbVwiKSB7XG4gICAgICAgIGlmIChjbGlja09iamVjdE51bWJlciA8IDEpIHtcbiAgICAgICAgICAgIHNmeF9qc18xLnNvdW5kcy5kZW55LnBsYXkoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGV4cG9ydHMuY3VzdG9tR2FtZXBhZEluZm9Jc1VzYWJsZVtjbGlja09iamVjdE51bWJlcl0gPSB0cnVlO1xuICAgICAgICAgICAgKDAsIGN1c3RvbV9qc18xLnN0b3JlQ3VzdG9tR2FtZXBhZEluZm8pKGdhbWVwYWRJbmZvLCAoMCwgZ2FtZXBhZF9qc18xLmdldEdhbWVwYWQpKGopLmlkLCAoXCJjdXN0b21cIiArIGNsaWNrT2JqZWN0TnVtYmVyKSwgY2xpY2tPYmplY3ROdW1iZXIpO1xuICAgICAgICAgICAgKDAsIGNvbnRyb2xsZXJtZW51X2pzXzEuc2V0Q3VzdG9tSW5Vc2UpKGNsaWNrT2JqZWN0TnVtYmVyKTtcbiAgICAgICAgfVxuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHByZUNhbGlicmF0aW9uTG9vcChpLCBqLCBnYW1lcGFkSW5mbywgaW50ZXJ2YWwpLCAxNik7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBpZiAoY2xpY2tPYmplY3QgPT09IFwiaWNvblwiKSB7XG4gICAgICAgICAgICBzZnhfanNfMS5zb3VuZHMuc2hvdXQ4LnBsYXkoKTtcbiAgICAgICAgICAgIHNmeF9qc18xLnNvdW5kcy5zd29yZDMucGxheSgpO1xuICAgICAgICB9XG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4gcHJlQ2FsaWJyYXRpb25Mb29wKGksIGosIGdhbWVwYWRJbmZvLCBpbnRlcnZhbCksIDE2KTtcbiAgICB9XG4gICAgY2xpY2tPYmplY3QgPSBudWxsO1xufVxuO1xuZnVuY3Rpb24gY2FsaWJyYXRpb25Mb29wKGksIGosIGdhbWVwYWRJbmZvLCBzbmFwc2hvdHMsIGludGVydmFsKSB7XG4gICAgaWYgKGNsaWNrT2JqZWN0ID09PSBudWxsKSB7XG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgY2FsaWJyYXRpb25Mb29wKGksIGosIGdhbWVwYWRJbmZvLCBzbmFwc2hvdHMsIGludGVydmFsKTtcbiAgICAgICAgfSwgMTYpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgY2FsaWJyYXRlT2JqZWN0KGksIGosIGdhbWVwYWRJbmZvLCBzbmFwc2hvdHMsIGludGVydmFsKTtcbiAgICB9XG59XG47XG5mdW5jdGlvbiBjYWxpYnJhdGVPYmplY3QoaSwgaiwgZ2FtZXBhZEluZm8sIHNuYXBzaG90cywgaW50ZXJ2YWwpIHtcbiAgICBsZXQgdGV4dHM7XG4gICAgbGV0IGdhbWVwYWQ7XG4gICAgbGV0IHRvdGFsSW50ZXJ2YWwgPSBpbnRlcnZhbCArIDE2O1xuICAgIGlmIChjbGlja09iamVjdCA9PT0gbnVsbCkge1xuICAgICAgICBjb25zb2xlLmxvZyhcImVycm9yIGluIGZ1bmN0aW9uICdjYWxpYnJhdGVPYmplY3QnOiBjYWxpYnJhdGlvbiBjYWxsZWQgb24gbnVsbCBvYmplY3RcIik7XG4gICAgfVxuICAgIGVsc2UgaWYgKGNsaWNrT2JqZWN0ID09PSBcImljb25cIikge1xuICAgICAgICBzZnhfanNfMS5zb3VuZHMuc2hvdXQ4LnBsYXkoKTtcbiAgICAgICAgc2Z4X2pzXzEuc291bmRzLnN3b3JkMy5wbGF5KCk7XG4gICAgfVxuICAgIGVsc2UgaWYgKGNsaWNrT2JqZWN0ID09PSBcImV4aXRcIikge1xuICAgICAgICBzZnhfanNfMS5zb3VuZHMubWVudUJhY2sucGxheSgpO1xuICAgICAgICBzZXRDYWxpYnJhdGlvbkluUHJvZ3Jlc3MoaSwgZmFsc2UpO1xuICAgICAgICAoMCwgY29udHJvbGxlcm1lbnVfanNfMS51cGRhdGVDb250cm9sbGVyTWVudSkodHJ1ZSwgW1wiUXVpdHRpbmcgY2FsaWJyYXRpb24gbWVudS5cIl0sIGludGVydmFsKTtcbiAgICB9XG4gICAgZWxzZSBpZiAoY2xpY2tPYmplY3QgPT09IFwicmVzZXRcIikge1xuICAgICAgICBzZnhfanNfMS5zb3VuZHMubG91ZGVsZWN0cmljZml6ei5wbGF5KCk7XG4gICAgICAgICgwLCBjb250cm9sbGVybWVudV9qc18xLnNldEN1c3RvbUluVXNlKSgwKTtcbiAgICAgICAgY29uc3QgYmFzZUdhbWVwYWRJbmZvID0gcmVzZXRHYW1lcGFkSW5mbyhqKTtcbiAgICAgICAgKDAsIGN1c3RvbV9qc18xLnNldEN1c3RvbUdhbWVwYWRJbmZvKShqLCBiYXNlR2FtZXBhZEluZm8pO1xuICAgICAgICAoMCwgbWFpbl9qc18xLnNldFVzaW5nQ3VzdG9tQ29udHJvbHMpKGksIGZhbHNlLCBiYXNlR2FtZXBhZEluZm8pO1xuICAgICAgICAoMCwgY29udHJvbGxlcm1lbnVfanNfMS51cGRhdGVDb250cm9sbGVyTWVudSkoZmFsc2UsIFtcIkNvbnRyb2xsZXIgYmluZGluZ3MgaGF2ZSBiZWVuIHJlc2V0LlwiLCBcIkNsaWNrIHRoZSBzdGFydCBidXR0b24gdG8gYmVnaW4gY2FsaWJyYXRpb24uXCJdLCAwKTtcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiBwcmVDYWxpYnJhdGlvbkxvb3AoaSwgaiwgYmFzZUdhbWVwYWRJbmZvLCBpbnRlcnZhbCksIDE2KTtcbiAgICB9XG4gICAgZWxzZSBpZiAoY2xpY2tPYmplY3QgPT09IFwiY2VudGVyXCIpIHtcbiAgICAgICAgc2F2ZVNvdW5kKCk7XG4gICAgICAgICgwLCBtYWluX2pzXzEuc2V0Q29udHJvbGxlclJlc2V0KShpKTtcbiAgICAgICAgKDAsIGNvbnRyb2xsZXJtZW51X2pzXzEudXBkYXRlQ29udHJvbGxlck1lbnUpKGZhbHNlLCBbXCJDb250cm9sbGVyIGhhcyBiZWVuIHJlLWNlbnRlcmVkLlwiLCBcIkNsaWNrIHRoZSBzdGFydCBidXR0b24gdG8gY29udGludWUgY2FsaWJyYXRpb24uXCJdLCAwKTtcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiBwcmVDYWxpYnJhdGlvbkxvb3AoaSwgaiwgZ2FtZXBhZEluZm8sIGludGVydmFsKSwgMTYpO1xuICAgICAgICB0b3RhbEludGVydmFsID0gMTY7XG4gICAgfVxuICAgIGVsc2UgaWYgKGNsaWNrT2JqZWN0ID09PSBcImxvYWRDdXN0b21cIikge1xuICAgICAgICBpZiAoY2xpY2tPYmplY3ROdW1iZXIgPT09IDApIHtcbiAgICAgICAgICAgICgwLCBjb250cm9sbGVybWVudV9qc18xLnNldEN1c3RvbUluVXNlKSgwKTtcbiAgICAgICAgICAgIGNvbnN0IGJhc2VHYW1lcGFkSW5mbyA9IHJlc2V0R2FtZXBhZEluZm8oaik7XG4gICAgICAgICAgICAoMCwgbWFpbl9qc18xLnNldFVzaW5nQ3VzdG9tQ29udHJvbHMpKGksIGZhbHNlLCBiYXNlR2FtZXBhZEluZm8pO1xuICAgICAgICAgICAgKDAsIGNvbnRyb2xsZXJtZW51X2pzXzEudXBkYXRlQ29udHJvbGxlck1lbnUpKGZhbHNlLCBbXCJOb3cgdXNpbmcgZGVmYXVsdCBjb250cm9sbGVyIGJpbmRpbmdzLlwiLCBcIkNsaWNrIHRoZSBzdGFydCBidXR0b24gdG8gYmVnaW4gY2FsaWJyYXRpb24uXCJdLCAwKTtcbiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gcHJlQ2FsaWJyYXRpb25Mb29wKGksIGosIGJhc2VHYW1lcGFkSW5mbywgaW50ZXJ2YWwpLCAxNik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBjb25zdCBuZXdDdXN0b21HYW1lcGFkSW5mbyA9ICgwLCBjdXN0b21fanNfMS5nZXRDdXN0b21HYW1lcGFkSW5mbykoY2xpY2tPYmplY3ROdW1iZXIpO1xuICAgICAgICAgICAgaWYgKG5ld0N1c3RvbUdhbWVwYWRJbmZvID09PSBudWxsIHx8IGV4cG9ydHMuY3VzdG9tR2FtZXBhZEluZm9Jc1VzYWJsZVtjbGlja09iamVjdE51bWJlcl0gIT09IHRydWUpIHtcbiAgICAgICAgICAgICAgICBzZnhfanNfMS5zb3VuZHMuZGVueS5wbGF5KCk7XG4gICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiBwcmVDYWxpYnJhdGlvbkxvb3AoaSwgaiwgZ2FtZXBhZEluZm8sIGludGVydmFsKSwgMTYpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbmV3R2FtZXBhZEluZm8gPSBuZXdDdXN0b21HYW1lcGFkSW5mby5nYW1lcGFkSW5mbztcbiAgICAgICAgICAgICAgICAoMCwgY29udHJvbGxlcm1lbnVfanNfMS5zZXRDdXN0b21JblVzZSkoY2xpY2tPYmplY3ROdW1iZXIpO1xuICAgICAgICAgICAgICAgICgwLCBjdXN0b21fanNfMS5zZXRDdXN0b21HYW1lcGFkSW5mbykoaiwgbmV3R2FtZXBhZEluZm8pO1xuICAgICAgICAgICAgICAgICgwLCBtYWluX2pzXzEuc2V0VXNpbmdDdXN0b21Db250cm9scykoaSwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgKDAsIGNvbnRyb2xsZXJtZW51X2pzXzEudXBkYXRlQ29udHJvbGxlck1lbnUpKGZhbHNlLCBbXCJOb3cgdXNpbmcgY3VzdG9tIGJpbmRpbmdzICNcIiArIGNsaWNrT2JqZWN0TnVtYmVyICsgXCIuXCIsIFwiQ2xpY2sgdGhlIHN0YXJ0IGJ1dHRvbiB0byBiZWdpbiBjYWxpYnJhdGlvbi5cIl0sIDApO1xuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gcHJlQ2FsaWJyYXRpb25Mb29wKGksIGosIG5ld0dhbWVwYWRJbmZvLCBpbnRlcnZhbCksIDE2KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBlbHNlIGlmIChjbGlja09iamVjdCA9PT0gXCJzYXZlQ3VzdG9tXCIpIHtcbiAgICAgICAgaWYgKGNsaWNrT2JqZWN0TnVtYmVyIDwgMSkge1xuICAgICAgICAgICAgc2Z4X2pzXzEuc291bmRzLmRlbnkucGxheSgpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgZXhwb3J0cy5jdXN0b21HYW1lcGFkSW5mb0lzVXNhYmxlW2NsaWNrT2JqZWN0TnVtYmVyXSA9IHRydWU7XG4gICAgICAgICAgICAoMCwgY3VzdG9tX2pzXzEuc3RvcmVDdXN0b21HYW1lcGFkSW5mbykoZ2FtZXBhZEluZm8sICgwLCBnYW1lcGFkX2pzXzEuZ2V0R2FtZXBhZCkoaikuaWQsIChcImN1c3RvbVwiICsgY2xpY2tPYmplY3ROdW1iZXIpLCBjbGlja09iamVjdE51bWJlcik7XG4gICAgICAgICAgICAoMCwgY29udHJvbGxlcm1lbnVfanNfMS5zZXRDdXN0b21JblVzZSkoY2xpY2tPYmplY3ROdW1iZXIpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2UgaWYgKGNsaWNrT2JqZWN0ID09PSBcImxcIiB8fCBjbGlja09iamVjdCA9PT0gXCJyXCIpIHtcbiAgICAgICAgdGV4dHMgPSBbXCJGdWxseSBkZXByZXNzIFwiICsgY2xpY2tPYmplY3QudG9VcHBlckNhc2UoKSArIFwiIHRyaWdnZXIuXCIsIFwiS2VlcCBob2xkaW5nIGRvd24gdGhlIHRyaWdnZXIuXCJdO1xuICAgICAgICBjb25zdCB0ID0gY2xpY2tPYmplY3Q7IC8vIHBhc3NlZCBhcy1pcyBpbiB0aGUgY2xvc3VyZVxuICAgICAgICBjb25zdCB0QSA9IGNsaWNrT2JqZWN0ICsgXCJBXCI7XG4gICAgICAgICgwLCBjb250cm9sbGVybWVudV9qc18xLnVwZGF0ZUNvbnRyb2xsZXJNZW51KShmYWxzZSwgdGV4dHMsIGludGVydmFsKTtcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICBzYXZlU291bmQoKTtcbiAgICAgICAgICAgIGdhbWVwYWQgPSAoMCwgZ2FtZXBhZF9qc18xLmdldEdhbWVwYWQpKGopO1xuICAgICAgICAgICAgZ2FtZXBhZEluZm9bdF0gPSBzY2FuRm9yQnV0dG9uKHNuYXBzaG90cy5iMCwgZ2FtZXBhZC5idXR0b25zLCBzbmFwc2hvdHMuYTAsIGdhbWVwYWQuYXhlcywgdHJ1ZSk7XG4gICAgICAgICAgICBnYW1lcGFkSW5mb1t0QV0gPSBzY2FuRm9yVHJpZ2dlcihzbmFwc2hvdHMuYjAsIGdhbWVwYWQuYnV0dG9ucywgc25hcHNob3RzLmEwLCBnYW1lcGFkLmF4ZXMpO1xuICAgICAgICAgICAgKDAsIGNvbnRyb2xsZXJtZW51X2pzXzEudXBkYXRlQ29udHJvbGxlck1lbnUpKGZhbHNlLCBkZWZhdWx0VGV4dHMsIDApO1xuICAgICAgICAgICAgaWYgKHQgPT09IFwibFwiICYmIGdhbWVwYWRJbmZvLmxBICE9PSBudWxsICYmIChnYW1lcGFkSW5mby5sQS5raW5kID09PSBcInZhbHVlXCIgfHwgZ2FtZXBhZEluZm8ubEEua2luZCA9PT0gXCJheGlzXCIpKSB7XG4gICAgICAgICAgICAgICAgZ2FtZXBhZEluZm8uaXNHQyA9IE1hdGguYWJzKGdhbWVwYWRJbmZvLmxBLm1pbiArIDAuODY2KSA8IDAuMDEgPyB0cnVlIDogZmFsc2U7IC8vIGhhY2t5IGJ1dCBoZXlcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSwgaW50ZXJ2YWwpO1xuICAgIH1cbiAgICBlbHNlIGlmIChjbGlja09iamVjdCA9PT0gXCJsc1wiIHx8IGNsaWNrT2JqZWN0ID09PSBcImNzXCIgfHwgY2xpY2tPYmplY3QgPT09IFwiZHBhZFwiKSB7XG4gICAgICAgIGxldCBzZXAgPSBcIixcIjtcbiAgICAgICAgaWYgKGNsaWNrT2JqZWN0ID09PSBcImxzXCIpIHtcbiAgICAgICAgICAgIHRleHRzID0gW1wiTW92ZSBsZWZ0IGFuYWxvZyBzdGljayBhbGwgdGhlIHdheSBcIiwgXCJhbmQga2VlcCBpdCB0aGVyZS5cIl07XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoY2xpY2tPYmplY3QgPT09IFwiY3NcIikge1xuICAgICAgICAgICAgdGV4dHMgPSBbXCJNb3ZlIGMtc3RpY2sgYWxsIHRoZSB3YXkgXCIsIFwiYW5kIGtlZXAgaXQgdGhlcmUuXCJdO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgc2VwID0gXCIuXCI7XG4gICAgICAgICAgICB0ZXh0cyA9IFtcIlByZXNzIGFuZCBob2xkIGQtcGFkIFwiXTtcbiAgICAgICAgfVxuICAgICAgICB0b3RhbEludGVydmFsICs9IDUgKiBpbnRlcnZhbDtcbiAgICAgICAgKDAsIGNvbnRyb2xsZXJtZW51X2pzXzEudXBkYXRlQ29udHJvbGxlck1lbnUpKGZhbHNlLCBbdGV4dHNbMF0gKyBcImxlZnRcIiArIHNlcCwgdGV4dHNbMV1dLCAxLjUgKiBpbnRlcnZhbCk7XG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgc2F2ZVNvdW5kKCk7XG4gICAgICAgICAgICBnYW1lcGFkID0gKDAsIGdhbWVwYWRfanNfMS5nZXRHYW1lcGFkKShqKTtcbiAgICAgICAgICAgIHNuYXBzaG90cy5iTCA9ICgwLCBkZWVwQ29weV9qc18xLmRlZXBDb3B5QXJyYXkpKHRydWUsIGdhbWVwYWQuYnV0dG9ucyk7XG4gICAgICAgICAgICBzbmFwc2hvdHMuYUwgPSAoMCwgZGVlcENvcHlfanNfMS5kZWVwQ29weUFycmF5KSh0cnVlLCBnYW1lcGFkLmF4ZXMpO1xuICAgICAgICAgICAgKDAsIGNvbnRyb2xsZXJtZW51X2pzXzEudXBkYXRlQ29udHJvbGxlck1lbnUpKGZhbHNlLCBbdGV4dHNbMF0gKyBcInJpZ2h0XCIgKyBzZXAsIHRleHRzWzFdXSwgMS41ICogaW50ZXJ2YWwpO1xuICAgICAgICB9LCAxLjUgKiBpbnRlcnZhbCk7XG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgc2F2ZVNvdW5kKCk7XG4gICAgICAgICAgICBnYW1lcGFkID0gKDAsIGdhbWVwYWRfanNfMS5nZXRHYW1lcGFkKShqKTtcbiAgICAgICAgICAgIHNuYXBzaG90cy5iUiA9ICgwLCBkZWVwQ29weV9qc18xLmRlZXBDb3B5QXJyYXkpKHRydWUsIGdhbWVwYWQuYnV0dG9ucyk7XG4gICAgICAgICAgICBzbmFwc2hvdHMuYVIgPSAoMCwgZGVlcENvcHlfanNfMS5kZWVwQ29weUFycmF5KSh0cnVlLCBnYW1lcGFkLmF4ZXMpO1xuICAgICAgICAgICAgKDAsIGNvbnRyb2xsZXJtZW51X2pzXzEudXBkYXRlQ29udHJvbGxlck1lbnUpKGZhbHNlLCBbdGV4dHNbMF0gKyBcInVwXCIgKyBzZXAsIHRleHRzWzFdXSwgMS41ICogaW50ZXJ2YWwpO1xuICAgICAgICB9LCAzICogaW50ZXJ2YWwpO1xuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgIHNhdmVTb3VuZCgpO1xuICAgICAgICAgICAgZ2FtZXBhZCA9ICgwLCBnYW1lcGFkX2pzXzEuZ2V0R2FtZXBhZCkoaik7XG4gICAgICAgICAgICBzbmFwc2hvdHMuYlUgPSAoMCwgZGVlcENvcHlfanNfMS5kZWVwQ29weUFycmF5KSh0cnVlLCBnYW1lcGFkLmJ1dHRvbnMpO1xuICAgICAgICAgICAgc25hcHNob3RzLmFVID0gKDAsIGRlZXBDb3B5X2pzXzEuZGVlcENvcHlBcnJheSkodHJ1ZSwgZ2FtZXBhZC5heGVzKTtcbiAgICAgICAgICAgICgwLCBjb250cm9sbGVybWVudV9qc18xLnVwZGF0ZUNvbnRyb2xsZXJNZW51KShmYWxzZSwgW3RleHRzWzBdICsgXCJkb3duXCIgKyBzZXAsIHRleHRzWzFdXSwgMS41ICogaW50ZXJ2YWwpO1xuICAgICAgICB9LCA0LjUgKiBpbnRlcnZhbCk7XG4gICAgICAgIGlmIChjbGlja09iamVjdCA9PT0gXCJkcGFkXCIpIHtcbiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICAgIHNhdmVTb3VuZCgpO1xuICAgICAgICAgICAgICAgIGdhbWVwYWQgPSAoMCwgZ2FtZXBhZF9qc18xLmdldEdhbWVwYWQpKGopO1xuICAgICAgICAgICAgICAgIGdhbWVwYWRJbmZvLmRwYWQgPSBzY2FuRm9yRFBhZChzbmFwc2hvdHMuYjAsIHNuYXBzaG90cy5iTCwgc25hcHNob3RzLmJSLCBzbmFwc2hvdHMuYlUsIGdhbWVwYWQuYnV0dG9ucywgc25hcHNob3RzLmEwLCBzbmFwc2hvdHMuYUwsIHNuYXBzaG90cy5hUiwgc25hcHNob3RzLmFVLCBnYW1lcGFkLmF4ZXMpO1xuICAgICAgICAgICAgICAgICgwLCBjb250cm9sbGVybWVudV9qc18xLnVwZGF0ZUNvbnRyb2xsZXJNZW51KShmYWxzZSwgZGVmYXVsdFRleHRzLCAwKTtcbiAgICAgICAgICAgIH0sIDYgKiBpbnRlcnZhbCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBjb25zdCBjbGlja05vdyA9IGNsaWNrT2JqZWN0OyAvLyBwYXNzZWQgYXMtaXMgaW4gdGhlIGNsb3N1cmVcbiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICAgIHNhdmVTb3VuZCgpO1xuICAgICAgICAgICAgICAgIGdhbWVwYWQgPSAoMCwgZ2FtZXBhZF9qc18xLmdldEdhbWVwYWQpKGopO1xuICAgICAgICAgICAgICAgIGdhbWVwYWRJbmZvW2NsaWNrTm93XSA9IHNjYW5Gb3JTdGljayhzbmFwc2hvdHMuYjAsIHNuYXBzaG90cy5iTCwgc25hcHNob3RzLmJSLCBzbmFwc2hvdHMuYlUsIGdhbWVwYWQuYnV0dG9ucywgc25hcHNob3RzLmEwLCBzbmFwc2hvdHMuYUwsIHNuYXBzaG90cy5hUiwgc25hcHNob3RzLmFVLCBnYW1lcGFkLmF4ZXMpO1xuICAgICAgICAgICAgICAgICgwLCBjb250cm9sbGVybWVudV9qc18xLnVwZGF0ZUNvbnRyb2xsZXJNZW51KShmYWxzZSwgZGVmYXVsdFRleHRzLCAwKTtcbiAgICAgICAgICAgIH0sIDYgKiBpbnRlcnZhbCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSB7IC8vIG9ubHkgcGxhaW4gYnV0dG9ucyBsZWZ0IG5vd1xuICAgICAgICBjb25zdCBidXR0b25OYW1lID0gY2xpY2tPYmplY3QgPT09IFwic1wiID8gXCJzdGFydFwiIDogY2xpY2tPYmplY3QudG9VcHBlckNhc2UoKTtcbiAgICAgICAgdGV4dHMgPSBbXCJQcmVzcyBhbmQgaG9sZCBcIiArIGJ1dHRvbk5hbWUgKyBcIi5cIl07XG4gICAgICAgIGNvbnN0IGNsaWNrTm93ID0gY2xpY2tPYmplY3Q7XG4gICAgICAgICgwLCBjb250cm9sbGVybWVudV9qc18xLnVwZGF0ZUNvbnRyb2xsZXJNZW51KShmYWxzZSwgdGV4dHMsIGludGVydmFsKTtcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICBzYXZlU291bmQoKTtcbiAgICAgICAgICAgIGdhbWVwYWQgPSAoMCwgZ2FtZXBhZF9qc18xLmdldEdhbWVwYWQpKGopO1xuICAgICAgICAgICAgZ2FtZXBhZEluZm9bY2xpY2tOb3ddID0gc2NhbkZvckJ1dHRvbihzbmFwc2hvdHMuYjAsIGdhbWVwYWQuYnV0dG9ucywgc25hcHNob3RzLmEwLCBnYW1lcGFkLmF4ZXMpO1xuICAgICAgICAgICAgKDAsIGNvbnRyb2xsZXJtZW51X2pzXzEudXBkYXRlQ29udHJvbGxlck1lbnUpKGZhbHNlLCBkZWZhdWx0VGV4dHMsIDApO1xuICAgICAgICB9LCBpbnRlcnZhbCk7XG4gICAgfVxuICAgIGlmIChjbGlja09iamVjdCAhPT0gXCJleGl0XCIgJiYgY2xpY2tPYmplY3QgIT09IFwicmVzZXRcIiAmJiBjbGlja09iamVjdCAhPT0gXCJjZW50ZXJcIiAmJiBjbGlja09iamVjdCAhPT0gXCJsb2FkQ3VzdG9tXCIpIHtcbiAgICAgICAgaWYgKGNsaWNrT2JqZWN0ICE9PSBudWxsKSB7XG4gICAgICAgICAgICBzZnhfanNfMS5zb3VuZHMuYmx1bnRoaXQucGxheSgpO1xuICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgKDAsIGN1c3RvbV9qc18xLnNldEN1c3RvbUdhbWVwYWRJbmZvKShqLCBnYW1lcGFkSW5mbyk7XG4gICAgICAgICAgICAgICAgY2FsaWJyYXRpb25Mb29wKGksIGosIGdhbWVwYWRJbmZvLCBzbmFwc2hvdHMsIGludGVydmFsKTtcbiAgICAgICAgICAgIH0sIHRvdGFsSW50ZXJ2YWwpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgY2FsaWJyYXRpb25Mb29wKGksIGosIGdhbWVwYWRJbmZvLCBzbmFwc2hvdHMsIGludGVydmFsKTtcbiAgICAgICAgICAgIH0sIHRvdGFsSW50ZXJ2YWwpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGlmIChjbGlja09iamVjdCAhPT0gbnVsbCAmJiBjbGlja09iamVjdCAhPT0gXCJzYXZlQ3VzdG9tXCIgJiYgY2xpY2tPYmplY3QgIT09IFwibG9hZEN1c3RvbVwiXG4gICAgICAgICYmIGNsaWNrT2JqZWN0ICE9PSBcImNlbnRlclwiICYmIGNsaWNrT2JqZWN0ICE9PSBcImljb25cIiAmJiBjbGlja09iamVjdCAhPT0gXCJleGl0XCIgJiYgY2xpY2tPYmplY3QgIT09IFwicmVzZXRcIikge1xuICAgICAgICAoMCwgY29udHJvbGxlcm1lbnVfanNfMS5zZXRDdXN0b21JblVzZSkobnVsbCk7XG4gICAgfVxuICAgIGlmIChjbGlja09iamVjdCAhPT0gbnVsbCkge1xuICAgICAgICBjbGlja09iamVjdCA9IG51bGw7XG4gICAgfVxufVxuZnVuY3Rpb24gc2NhbkZvckJ1dHRvbihidXR0b25zMCwgYnV0dG9uczEsIGF4ZXMwLCBheGVzMSwgb25seVByZXNzZWQgPSBmYWxzZSkge1xuICAgIGxldCBidXR0b25JbmZvID0gbnVsbDtcbiAgICBjb25zdCBiTGcgPSBidXR0b25zMS5sZW5ndGg7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBiTGc7IGkrKykge1xuICAgICAgICBpZiAoZGV0ZWN0ZWRCdXR0b25QcmVzc2VkKGJ1dHRvbnMwW2ldLnByZXNzZWQsIGJ1dHRvbnMxW2ldLnByZXNzZWQpKSB7XG4gICAgICAgICAgICBidXR0b25JbmZvID0geyBraW5kOiBcInByZXNzZWRcIiwgaW5kZXg6IGkgfTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKCFvbmx5UHJlc3NlZCAmJiBkZXRlY3RlZEJ1dHRvblZhbHVlKGJ1dHRvbnMwW2ldLnZhbHVlLCBidXR0b25zMVtpXS52YWx1ZSkpIHtcbiAgICAgICAgICAgIGJ1dHRvbkluZm8gPSB7IGtpbmQ6IFwidmFsdWVcIiwgaW5kZXg6IGksIHRocmVzaG9sZDogMC43NSB9O1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaWYgKCFvbmx5UHJlc3NlZCAmJiBidXR0b25JbmZvID09PSBudWxsKSB7XG4gICAgICAgIGNvbnN0IGFMZyA9IGF4ZXMxLmxlbmd0aDtcbiAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBhTGc7IGorKykge1xuICAgICAgICAgICAgaWYgKGRldGVjdGVkQnV0dG9uVmFsdWUoYXhlczBbal0sIGF4ZXMxW2pdKSkge1xuICAgICAgICAgICAgICAgIGJ1dHRvbkluZm8gPSB7IGtpbmQ6IFwiYXhpc1wiLCBpbmRleDogaiwgdGhyZXNob2xkOiAwLjc1IH07XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGJ1dHRvbkluZm87XG59XG47XG5mdW5jdGlvbiBkZXRlY3RlZEJ1dHRvblByZXNzZWQocHJlc3NlZDAsIHByZXNzZWQxKSB7XG4gICAgcmV0dXJuIHByZXNzZWQxICYmICFwcmVzc2VkMDtcbn1cbjtcbmZ1bmN0aW9uIGRldGVjdGVkQnV0dG9uVmFsdWUodmFsdWUwLCB2YWx1ZTEpIHtcbiAgICByZXR1cm4gKHZhbHVlMCA8IDAuMjUgJiYgdmFsdWUxID4gMC43NSk7XG59XG47XG5mdW5jdGlvbiBzY2FuRm9yVHJpZ2dlcihidXR0b25zMCwgYnV0dG9uczEsIGF4ZXMwLCBheGVzMSkge1xuICAgIGxldCBtaW5NYXg7XG4gICAgbGV0IHRyaWdnZXJJbmZvID0gbnVsbDtcbiAgICBjb25zdCBhTGcgPSBheGVzMS5sZW5ndGg7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBhTGcgJiYgdHJpZ2dlckluZm8gPT09IG51bGw7IGkrKykge1xuICAgICAgICBtaW5NYXggPSBkZXRlY3RlZFRyaWdnZXIoYXhlczBbaV0sIGF4ZXMxW2ldKTtcbiAgICAgICAgaWYgKG1pbk1heCAhPT0gbnVsbCkge1xuICAgICAgICAgICAgdHJpZ2dlckluZm8gPSB7IGtpbmQ6IFwiYXhpc1wiLCBpbmRleDogaSwgbWluOiBtaW5NYXhbMF0sIG1heDogbWluTWF4WzFdIH07XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH1cbiAgICBpZiAodHJpZ2dlckluZm8gPT09IG51bGwpIHtcbiAgICAgICAgY29uc3QgYkxnID0gYnV0dG9uczEubGVuZ3RoO1xuICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IGJMZyAmJiB0cmlnZ2VySW5mbyA9PT0gbnVsbDsgaisrKSB7XG4gICAgICAgICAgICBtaW5NYXggPSBkZXRlY3RlZFRyaWdnZXIoYnV0dG9uczBbal0udmFsdWUsIGJ1dHRvbnMxW2pdLnZhbHVlKTtcbiAgICAgICAgICAgIGlmIChtaW5NYXggIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICB0cmlnZ2VySW5mbyA9IHsga2luZDogXCJ2YWx1ZVwiLCBpbmRleDogaiwgbWluOiBtaW5NYXhbMF0sIG1heDogbWluTWF4WzFdIH07XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRyaWdnZXJJbmZvO1xufVxuZnVuY3Rpb24gZGV0ZWN0ZWRUcmlnZ2VyKGF4aXMwLCBheGlzMSkge1xuICAgIGlmIChNYXRoLmFicyhheGlzMSAtIGF4aXMwKSA8IDAuNSkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHJldHVybiBnZXRNaW5BbmRNYXgoYXhpczAsIGF4aXMxKTtcbiAgICB9XG59XG5mdW5jdGlvbiBnZXRNaW5BbmRNYXgoYXhpczAsIGF4aXMxKSB7XG4gICAgY29uc3QgbWluID0gYXhpczAgPCAtMC44NyA/IC0xIDogYXhpczAgPCAtMC41ID8gLTAuODY2IDogYXhpczAgPiAwLjg3ID8gMSA6IGF4aXMwID4gMC41ID8gMC44NjY3IDogMDtcbiAgICBjb25zdCBtYXggPSBtaW4gPT09IDAgPyBNYXRoLnNpZ24oYXhpczEpIDogLW1pbjtcbiAgICByZXR1cm4gW21pbiwgbWF4XTtcbn1cbmZ1bmN0aW9uIHNjYW5Gb3JTdGljayhidXR0b25zMCwgYnV0dG9uc0wsIGJ1dHRvbnNSLCBidXR0b25zVSwgYnV0dG9uc0QsIGF4ZXMwLCBheGVzTCwgYXhlc1IsIGF4ZXNVLCBheGVzRCkge1xuICAgIGxldCBzdGlja0luZm8gPSBudWxsO1xuICAgIGxldCB4RGlmZiA9IDA7XG4gICAgbGV0IHlEaWZmID0gMDtcbiAgICBsZXQgbmV3WERpZmYgPSAwO1xuICAgIGxldCBuZXdZRGlmZiA9IDA7XG4gICAgbGV0IHhJbmRleDtcbiAgICBsZXQgeUluZGV4O1xuICAgIGxldCBraW5kO1xuICAgIGxldCBjYXJkaW5hbHMgPSBudWxsO1xuICAgIGNvbnN0IGFMZyA9IGF4ZXMwLmxlbmd0aDtcbiAgICBraW5kID0gXCJheGVzXCI7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBhTGc7IGkrKykge1xuICAgICAgICBuZXdYRGlmZiA9IGF4ZXNSW2ldIC0gYXhlc0xbaV07XG4gICAgICAgIGlmIChNYXRoLmFicyhuZXdYRGlmZikgPiBNYXRoLmFicyh4RGlmZikpIHtcbiAgICAgICAgICAgIHhEaWZmID0gbmV3WERpZmY7XG4gICAgICAgICAgICB4SW5kZXggPSBpO1xuICAgICAgICB9XG4gICAgICAgIG5ld1lEaWZmID0gYXhlc1VbaV0gLSBheGVzRFtpXTtcbiAgICAgICAgaWYgKE1hdGguYWJzKG5ld1lEaWZmKSA+IE1hdGguYWJzKHlEaWZmKSkge1xuICAgICAgICAgICAgeURpZmYgPSBuZXdZRGlmZjtcbiAgICAgICAgICAgIHlJbmRleCA9IGk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaWYgKHhJbmRleCAhPT0gdW5kZWZpbmVkICYmIHlJbmRleCAhPT0gdW5kZWZpbmVkICYmIE1hdGguYWJzKHhEaWZmKSA+IDAuNSAmJiBNYXRoLmFicyh5RGlmZikgPiAwLjUpIHtcbiAgICAgICAgY2FyZGluYWxzID0ge1xuICAgICAgICAgICAgY2VudGVyOiBuZXcgVmVjMkRfanNfMS5WZWMyRChheGVzMFt4SW5kZXhdLCBheGVzMFt5SW5kZXhdKSxcbiAgICAgICAgICAgIGxlZnQ6IGF4ZXNMW3hJbmRleF0sXG4gICAgICAgICAgICByaWdodDogYXhlc1JbeEluZGV4XSxcbiAgICAgICAgICAgIHVwOiBheGVzVVt5SW5kZXhdLFxuICAgICAgICAgICAgZG93bjogYXhlc0RbeUluZGV4XVxuICAgICAgICB9O1xuICAgIH1cbiAgICBpZiAoTWF0aC5hYnMoeERpZmYpIDwgMC41IHx8IE1hdGguYWJzKHlEaWZmKSA8IDAuNSkge1xuICAgICAgICBjb25zdCBiTGcgPSBidXR0b25zMC5sZW5ndGg7XG4gICAgICAgIGtpbmQgPSBcInZhbHVlXCI7XG4gICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgYkxnOyBqKyspIHtcbiAgICAgICAgICAgIG5ld1hEaWZmID0gYnV0dG9uc1Jbal0udmFsdWUgLSBidXR0b25zTFtqXS52YWx1ZTtcbiAgICAgICAgICAgIGlmIChNYXRoLmFicyhuZXdYRGlmZikgPiBNYXRoLmFicyh4RGlmZikpIHtcbiAgICAgICAgICAgICAgICB4RGlmZiA9IG5ld1hEaWZmO1xuICAgICAgICAgICAgICAgIHhJbmRleCA9IGo7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBuZXdZRGlmZiA9IGJ1dHRvbnNVW2pdLnZhbHVlIC0gYnV0dG9uc0Rbal0udmFsdWU7XG4gICAgICAgICAgICBpZiAoTWF0aC5hYnMobmV3WURpZmYpID4gTWF0aC5hYnMoeURpZmYpKSB7XG4gICAgICAgICAgICAgICAgeURpZmYgPSBuZXdZRGlmZjtcbiAgICAgICAgICAgICAgICB5SW5kZXggPSBqO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmICh4SW5kZXggIT09IHVuZGVmaW5lZCAmJiB5SW5kZXggIT09IHVuZGVmaW5lZCAmJiBNYXRoLmFicyh4RGlmZikgPiAwLjUgJiYgTWF0aC5hYnMoeURpZmYpID4gMC41KSB7XG4gICAgICAgICAgICBjYXJkaW5hbHMgPSB7XG4gICAgICAgICAgICAgICAgY2VudGVyOiBuZXcgVmVjMkRfanNfMS5WZWMyRChidXR0b25zMFt4SW5kZXhdLnZhbHVlLCBidXR0b25zMFt5SW5kZXhdLnZhbHVlKSxcbiAgICAgICAgICAgICAgICBsZWZ0OiBidXR0b25zTFt4SW5kZXhdLnZhbHVlLFxuICAgICAgICAgICAgICAgIHJpZ2h0OiBidXR0b25zUlt4SW5kZXhdLnZhbHVlLFxuICAgICAgICAgICAgICAgIHVwOiBidXR0b25zVVt5SW5kZXhdLnZhbHVlLFxuICAgICAgICAgICAgICAgIGRvd246IGJ1dHRvbnNEW3lJbmRleF0udmFsdWVcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG4gICAgaWYgKHhJbmRleCAhPT0gdW5kZWZpbmVkICYmIHlJbmRleCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIGlmIChraW5kID09PSBcImF4ZXNcIikge1xuICAgICAgICAgICAgc3RpY2tJbmZvID0geyBraW5kOiBcImF4ZXNcIiwgeEluZGV4OiB4SW5kZXgsIHlJbmRleDogeUluZGV4LCBjYXJkaW5hbHM6IGNhcmRpbmFscyB9O1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgc3RpY2tJbmZvID0geyBraW5kOiBcInZhbHVlXCIsIHhJbmRleDogeEluZGV4LCB5SW5kZXg6IHlJbmRleCwgY2FyZGluYWxzOiBjYXJkaW5hbHMgfTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gc3RpY2tJbmZvO1xufVxuZnVuY3Rpb24gc2NhbkZvckRQYWQoYnV0dG9uczAsIGJ1dHRvbnNMLCBidXR0b25zUiwgYnV0dG9uc1UsIGJ1dHRvbnNELCBheGVzMCwgYXhlc0wsIGF4ZXNSLCBheGVzVSwgYXhlc0QpIHtcbiAgICBsZXQgZFBhZEluZm8gPSBudWxsO1xuICAgIGNvbnN0IGJMZyA9IGJ1dHRvbnMwLmxlbmd0aDtcbiAgICBsZXQgbEluZGV4O1xuICAgIGxldCBySW5kZXg7XG4gICAgbGV0IHVJbmRleDtcbiAgICBsZXQgZEluZGV4O1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYkxnOyBpKyspIHtcbiAgICAgICAgaWYgKGxJbmRleCA9PT0gdW5kZWZpbmVkICYmIGRldGVjdGVkQnV0dG9uUHJlc3NlZChidXR0b25zMFtpXS5wcmVzc2VkLCBidXR0b25zTFtpXS5wcmVzc2VkKSkge1xuICAgICAgICAgICAgbEluZGV4ID0gaTtcbiAgICAgICAgfVxuICAgICAgICBpZiAockluZGV4ID09PSB1bmRlZmluZWQgJiYgZGV0ZWN0ZWRCdXR0b25QcmVzc2VkKGJ1dHRvbnMwW2ldLnByZXNzZWQsIGJ1dHRvbnNSW2ldLnByZXNzZWQpKSB7XG4gICAgICAgICAgICBySW5kZXggPSBpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh1SW5kZXggPT09IHVuZGVmaW5lZCAmJiBkZXRlY3RlZEJ1dHRvblByZXNzZWQoYnV0dG9uczBbaV0ucHJlc3NlZCwgYnV0dG9uc1VbaV0ucHJlc3NlZCkpIHtcbiAgICAgICAgICAgIHVJbmRleCA9IGk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGRJbmRleCA9PT0gdW5kZWZpbmVkICYmIGRldGVjdGVkQnV0dG9uUHJlc3NlZChidXR0b25zMFtpXS5wcmVzc2VkLCBidXR0b25zRFtpXS5wcmVzc2VkKSkge1xuICAgICAgICAgICAgZEluZGV4ID0gaTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBpZiAobEluZGV4ICE9PSB1bmRlZmluZWQgJiYgckluZGV4ICE9PSB1bmRlZmluZWQgJiYgdUluZGV4ICE9PSB1bmRlZmluZWQgJiYgZEluZGV4ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgZFBhZEluZm8gPSB7XG4gICAgICAgICAgICBraW5kOiBcImJ1dHRvbnNcIixcbiAgICAgICAgICAgIHVwSW5kZXg6IHVJbmRleCwgZG93bkluZGV4OiBkSW5kZXgsXG4gICAgICAgICAgICBsZWZ0SW5kZXg6IGxJbmRleCwgcmlnaHRJbmRleDogckluZGV4XG4gICAgICAgIH07XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBsZXQgeERpZmYgPSAwO1xuICAgICAgICBsZXQgeURpZmYgPSAwO1xuICAgICAgICBsZXQgbmV3WERpZmYgPSAwO1xuICAgICAgICBsZXQgbmV3WURpZmYgPSAwO1xuICAgICAgICBsZXQgeEluZGV4O1xuICAgICAgICBsZXQgeUluZGV4O1xuICAgICAgICBjb25zdCBhTGcgPSBheGVzMC5sZW5ndGg7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYUxnOyBpKyspIHtcbiAgICAgICAgICAgIG5ld1hEaWZmID0gYXhlc1JbaV0gLSBheGVzTFtpXTtcbiAgICAgICAgICAgIGlmIChNYXRoLmFicyhuZXdYRGlmZikgPiBNYXRoLmFicyh4RGlmZikpIHtcbiAgICAgICAgICAgICAgICB4RGlmZiA9IG5ld1hEaWZmO1xuICAgICAgICAgICAgICAgIHhJbmRleCA9IGk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBuZXdZRGlmZiA9IGF4ZXNVW2ldIC0gYXhlc0RbaV07XG4gICAgICAgICAgICBpZiAoTWF0aC5hYnMobmV3WURpZmYpID4gTWF0aC5hYnMoeURpZmYpKSB7XG4gICAgICAgICAgICAgICAgeURpZmYgPSBuZXdZRGlmZjtcbiAgICAgICAgICAgICAgICB5SW5kZXggPSBpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmICh4SW5kZXggIT09IHVuZGVmaW5lZCAmJiB5SW5kZXggIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgaWYgKE1hdGguYWJzKHhEaWZmKSA+IDAuNSAmJiBNYXRoLmFicyh5RGlmZikgPiAwLjUgJiYgeEluZGV4ICE9PSB5SW5kZXgpIHtcbiAgICAgICAgICAgICAgICBkUGFkSW5mbyA9IHtcbiAgICAgICAgICAgICAgICAgICAga2luZDogXCIyYXhlc1wiLFxuICAgICAgICAgICAgICAgICAgICB4SW5kZXg6IHhJbmRleCwgeUluZGV4OiB5SW5kZXgsXG4gICAgICAgICAgICAgICAgICAgIHhGbGlwOiAoeERpZmYgPCAwKSwgeUZsaXA6ICh5RGlmZiA8IDApXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgeyAvLyBsb2xcbiAgICAgICAgICAgICAgICBkUGFkSW5mbyA9IHsga2luZDogXCJheGlzXCIsIGluZGV4OiB4SW5kZXggfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gZFBhZEluZm87XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/input/gamepad/gamepadCalibration.ts\n");

/***/ }),

/***/ "./src/input/input.ts":
/*!****************************!*\
  !*** ./src/input/input.ts ***!
  \****************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

eval("\n/*eslint indent:0*/\n// @flow\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.keyboardMap = exports.aiInputBank = exports.aiPlayer4 = exports.aiPlayer3 = exports.aiPlayer2 = exports.aiPlayer1 = exports.nullInputs = exports.nullInput = void 0;\nexports.inputData = inputData;\nexports.pollInputs = pollInputs;\nexports.showButton = showButton;\nexports.setCustomCenters = setCustomCenters;\nconst Vec2D_1 = __webpack_require__(/*! ../main/util/Vec2D */ \"./src/main/util/Vec2D.ts\");\nconst settings_1 = __webpack_require__(/*! ../settings */ \"./src/settings.ts\");\nconst main_1 = __webpack_require__(/*! ../main/main */ \"./src/main/main.ts\");\nconst retrieveGamepadInputs_1 = __webpack_require__(/*! ./gamepad/retrieveGamepadInputs */ \"./src/input/gamepad/retrieveGamepadInputs.ts\");\nconst meleeInputs_1 = __webpack_require__(/*! ./meleeInputs */ \"./src/input/meleeInputs.ts\");\nconst jquery_1 = __importDefault(__webpack_require__(/*! jquery */ \"./node_modules/jquery/dist/jquery.js\"));\nconst replay_1 = __webpack_require__(/*! ../main/replay */ \"./src/main/replay.ts\");\nconst streamclient_1 = __webpack_require__(/*! ../main/multiplayer/streamclient */ \"./src/main/multiplayer/streamclient.js\");\nfunction inputData(list = [false, false, false, false, false, false, false, false, false, false, false, false, 0, 0, 0, 0, 0, 0]) {\n    return {\n        a: list[0],\n        b: list[1],\n        x: list[2],\n        y: list[3],\n        z: list[4],\n        r: list[5],\n        l: list[6],\n        s: list[7],\n        du: list[8],\n        dr: list[9],\n        dd: list[10],\n        dl: list[11],\n        lsX: (0, meleeInputs_1.deaden)(list[12]),\n        lsY: (0, meleeInputs_1.deaden)(list[13]),\n        csX: (0, meleeInputs_1.deaden)(list[14]),\n        csY: (0, meleeInputs_1.deaden)(list[15]),\n        lA: list[16],\n        rA: list[17],\n        rawX: list[12],\n        rawY: list[13],\n        rawcsX: list[14],\n        rawcsY: list[15]\n    };\n}\n;\nconst nullInput = () => inputData();\nexports.nullInput = nullInput;\nconst nullInputs = () => [inputData(),\n    inputData(),\n    inputData(),\n    inputData(),\n    inputData(),\n    inputData(),\n    inputData(),\n    inputData()\n];\nexports.nullInputs = nullInputs;\nexports.aiPlayer1 = [inputData(),\n    inputData(),\n    inputData(),\n    inputData(),\n    inputData(),\n    inputData(),\n    inputData(),\n    inputData()\n];\nexports.aiPlayer2 = [inputData(),\n    inputData(),\n    inputData(),\n    inputData(),\n    inputData(),\n    inputData(),\n    inputData(),\n    inputData()\n];\nexports.aiPlayer3 = [inputData(),\n    inputData(),\n    inputData(),\n    inputData(),\n    inputData(),\n    inputData(),\n    inputData(),\n    inputData()\n];\nexports.aiPlayer4 = [inputData(),\n    inputData(),\n    inputData(),\n    inputData(),\n    inputData(),\n    inputData(),\n    inputData(),\n    inputData()\n];\nexports.aiInputBank = [exports.aiPlayer1, exports.aiPlayer2, exports.aiPlayer3, exports.aiPlayer4];\n// should be able to move out the \"frameByFrame\" aspect of the following function\n// it is only used to make z button mean \"left trigger value = 0.35\" + \"A = true\".\nfunction pollInputs(gameMode, frameByFrame, controllerInfo, playerSlot, controllerIndex, keys, playertype) {\n    // input is the input for player i in the current frame\n    let input = (0, exports.nullInput)(); // initialise with default values\n    if (replay_1.replayActive) {\n        input = pollReplayInputs(gameMode, controllerInfo, playerSlot, controllerIndex, frameByFrame);\n    }\n    else if (playertype === 1 && gameMode === 3) {\n        return exports.aiInputBank[playerSlot][0];\n    }\n    else if (controllerInfo === \"keyboard\") { // keyboard controls\n        input = pollKeyboardInputs(gameMode, frameByFrame, keys);\n        // } else if (playertype === 2 || controllerInfo === 99) { // np: online play?\n        //   input = pollNetworkInputs(gameMode, controllerInfo, playerSlot, controllerIndex, frameByFrame);\n    }\n    else if (playertype === 0) {\n        input = pollGamepadInputs(gameMode, controllerInfo, playerSlot, controllerIndex, frameByFrame);\n    }\n    return input;\n}\nfunction pollNetworkInputs(gameMode, controllerType, playerSlot, controllerIndex, frameByFrame) {\n    return (0, streamclient_1.retrieveNetworkInputs)(playerSlot, controllerIndex);\n}\nfunction pollReplayInputs(gameMode, controllerType, playerSlot, controllerIndex, frameByFrame) {\n    return (0, replay_1.retrieveReplayInputs)(playerSlot, controllerIndex);\n}\nfunction pollKeyboardInputs(gameMode, frameByFrame, keys) {\n    const input = (0, exports.nullInput)(); // initialise with default values\n    let stickR = 1;\n    let stickL = 1;\n    let stickU = 1;\n    let stickD = 1;\n    if (gameMode === 3 || gameMode === 5) {\n        stickR = settings_1.keyMap.lstick.ranges[1];\n        stickL = settings_1.keyMap.lstick.ranges[2];\n        stickU = settings_1.keyMap.lstick.ranges[0];\n        stickD = settings_1.keyMap.lstick.ranges[3];\n    }\n    let lstickX = (keys[settings_1.keyMap.lstick.right[0]] || keys[settings_1.keyMap.lstick.right[1]]) ? ((keys[settings_1.keyMap.lstick.left[0]] ||\n        keys[settings_1.keyMap.lstick.left[1]]) ? 0 : stickR) : ((keys[settings_1.keyMap.lstick.left[0]] || keys[settings_1.keyMap.lstick.left[1]]) ?\n        -stickL : 0);\n    let lstickY = (keys[settings_1.keyMap.lstick.up[0]] || keys[settings_1.keyMap.lstick.up[1]]) ? ((keys[settings_1.keyMap.lstick.down[0]] || keys[settings_1.keyMap.lstick.down[1]]) ? 0 : stickU) : ((keys[settings_1.keyMap.lstick.down[0]] || keys[settings_1.keyMap.lstick.down[1]]) ? -stickD : 0);\n    let lAnalog = (keys[settings_1.keyMap.shoulders.lAnalog[0]] || keys[settings_1.keyMap.shoulders.lAnalog[1]]) ? settings_1.keyMap.shoulders.ranges[0] : 0;\n    let rAnalog = (keys[settings_1.keyMap.shoulders.rAnalog[0]] || keys[settings_1.keyMap.shoulders.rAnalog[1]]) ? settings_1.keyMap.shoulders.ranges[1] : 0;\n    if (gameMode === 3 || gameMode === 5) {\n        for (let j = 0; j < 5; j++) {\n            if (keys[settings_1.keyMap.lstick.modifiers[j][0]]) {\n                lstickX *= settings_1.keyMap.lstick.modifiers[j][1];\n                lstickY *= settings_1.keyMap.lstick.modifiers[j][2];\n            }\n            if (keys[settings_1.keyMap.shoulders.modifiers[j][0]]) {\n                lAnalog *= settings_1.keyMap.shoulders.modifiers[j][1];\n                rAnalog *= settings_1.keyMap.shoulders.modifiers[j][2];\n            }\n        }\n    }\n    lstickX = Math.sign(lstickX) * Math.min(1, Math.abs(lstickX));\n    lstickY = Math.sign(lstickY) * Math.min(1, Math.abs(lstickY));\n    lAnalog = Math.min(1, Math.abs(lAnalog));\n    rAnalog = Math.min(1, Math.abs(rAnalog));\n    const cstickX = (keys[settings_1.keyMap.cstick.right[0]] || keys[settings_1.keyMap.cstick.right[1]]) ? ((keys[settings_1.keyMap.cstick.left[0]] ||\n        keys[settings_1.keyMap.cstick.left[1]]) ? 0 : 1) : ((keys[settings_1.keyMap.cstick.left[0]] || keys[settings_1.keyMap.cstick.left[1]]) ? -1 :\n        0);\n    const cstickY = (keys[settings_1.keyMap.cstick.up[0]] || keys[settings_1.keyMap.cstick.up[1]]) ? ((keys[settings_1.keyMap.cstick.down[0]] || keys[settings_1.keyMap.cstick.down[1]]) ? 0 : 1) : ((keys[settings_1.keyMap.cstick.down[0]] || keys[settings_1.keyMap.cstick.down[1]]) ? -1 : 0);\n    const rescaledLStick = (0, meleeInputs_1.tasRescale)(lstickX, lstickY, true);\n    input.lsX = (0, meleeInputs_1.deaden)(rescaledLStick[0]);\n    input.lsY = (0, meleeInputs_1.deaden)(rescaledLStick[1]);\n    input.rawX = rescaledLStick[0];\n    input.rawY = rescaledLStick[1];\n    const rescaledCStick = (0, meleeInputs_1.tasRescale)(cstickX, cstickY, true);\n    input.csX = (0, meleeInputs_1.deaden)(rescaledCStick[0]);\n    input.csY = (0, meleeInputs_1.deaden)(rescaledCStick[1]);\n    input.rawcsX = rescaledCStick[0];\n    input.rawcsY = rescaledCStick[1];\n    input.lA = lAnalog;\n    input.rA = rAnalog;\n    input.s = keys[settings_1.keyMap.s[0]] || keys[settings_1.keyMap.s[1]];\n    input.x = keys[settings_1.keyMap.x[0]] || keys[settings_1.keyMap.x[1]];\n    input.a = keys[settings_1.keyMap.a[0]] || keys[settings_1.keyMap.a[1]];\n    input.b = keys[settings_1.keyMap.b[0]] || keys[settings_1.keyMap.b[1]];\n    input.y = keys[settings_1.keyMap.y[0]] || keys[settings_1.keyMap.y[1]];\n    input.r = keys[settings_1.keyMap.r[0]] || keys[settings_1.keyMap.r[1]];\n    input.l = keys[settings_1.keyMap.l[0]] || keys[settings_1.keyMap.l[1]];\n    input.z = keys[settings_1.keyMap.z[0]] || keys[settings_1.keyMap.z[1]];\n    input.dl = keys[settings_1.keyMap.dl[0]];\n    input.dd = keys[settings_1.keyMap.dd[0]];\n    input.dr = keys[settings_1.keyMap.dr[0]];\n    input.du = keys[settings_1.keyMap.du[0]];\n    if (!frameByFrame && gameMode !== 4 && gameMode !== 14) { // not in target builder, calibration screen, or frame by frame mode\n        if (input.z) {\n            if (input.lA < 0.35) {\n                input.lA = 0.35;\n            }\n            input.a = true;\n        }\n    }\n    if (input.l) {\n        input.lA = 1;\n    }\n    if (input.r) {\n        input.rA = 1;\n    }\n    return input;\n}\nfunction pollGamepadInputs(gameMode, gamepadInfo, playerSlot, controllerIndex, frameByFrame) {\n    const input = (0, exports.nullInput)();\n    if (navigator.getGamepads === undefined) {\n        return input;\n    }\n    const gamepads = navigator.getGamepads();\n    const gamepad = gamepads[controllerIndex];\n    if (gamepad === null || gamepad === undefined) {\n        return input;\n    }\n    // -------------------------------------------------------\n    // analog sticks\n    const fixedGamepad = gamepad;\n    // {\n    //   buttons: gamepad.buttons as GamepadButton[],\n    //   axes: gamepad.axes as number[],\n    //   id: gamepad.id\n    // };\n    const lsVec = (0, retrieveGamepadInputs_1.stickValue)(fixedGamepad, gamepadInfo, \"ls\");\n    const csVec = (0, retrieveGamepadInputs_1.stickValue)(fixedGamepad, gamepadInfo, \"cs\");\n    const isGC = gamepadInfo.isGC;\n    let lsCardinals = null;\n    if (gamepadInfo.ls !== null) {\n        lsCardinals = gamepadInfo.ls.cardinals;\n    }\n    let csCardinals = null;\n    if (gamepadInfo.cs !== null) {\n        csCardinals = gamepadInfo.cs.cardinals;\n    }\n    const lsticks = (0, meleeInputs_1.scaleToMeleeAxes)(lsVec.x // x-axis data\n    , lsVec.y // y-axis data\n    , isGC, lsCardinals, custcent[playerSlot].ls.x // x-axis \"custom center\" offset\n    , custcent[playerSlot].ls.y // y-axis \"custom center\" offset\n    );\n    const csticks = (0, meleeInputs_1.scaleToMeleeAxes)(csVec.x, csVec.y, isGC, csCardinals, custcent[playerSlot].cs.x, custcent[playerSlot].cs.y);\n    input.lsX = (0, meleeInputs_1.deaden)(lsticks[0]);\n    input.lsY = (0, meleeInputs_1.deaden)(lsticks[1]);\n    input.csX = (0, meleeInputs_1.deaden)(csticks[0]);\n    input.csY = (0, meleeInputs_1.deaden)(csticks[1]);\n    input.rawX = lsticks[0];\n    input.rawY = lsticks[1];\n    input.rawcsX = csticks[0];\n    input.rawcsY = csticks[1];\n    // -------------------------------------------------------\n    // buttons\n    input.s = (0, retrieveGamepadInputs_1.buttonState)(fixedGamepad, gamepadInfo, \"s\");\n    input.x = (0, retrieveGamepadInputs_1.buttonState)(fixedGamepad, gamepadInfo, \"x\");\n    input.a = (0, retrieveGamepadInputs_1.buttonState)(fixedGamepad, gamepadInfo, \"a\");\n    input.b = (0, retrieveGamepadInputs_1.buttonState)(fixedGamepad, gamepadInfo, \"b\");\n    input.y = (0, retrieveGamepadInputs_1.buttonState)(fixedGamepad, gamepadInfo, \"y\");\n    input.z = (0, retrieveGamepadInputs_1.buttonState)(fixedGamepad, gamepadInfo, \"z\");\n    // -------------------------------------------------------\n    // triggers\n    input.l = (0, retrieveGamepadInputs_1.buttonState)(fixedGamepad, gamepadInfo, \"l\");\n    input.r = (0, retrieveGamepadInputs_1.buttonState)(fixedGamepad, gamepadInfo, \"r\");\n    if (gamepadInfo.lA !== null) {\n        const lA = gamepadInfo.lA;\n        if (lA.kind === \"light\") {\n            input.lA = (0, retrieveGamepadInputs_1.triggerValue)(fixedGamepad, gamepadInfo, \"lA\");\n        }\n        else {\n            input.lA = (0, meleeInputs_1.scaleToGCTrigger)((0, retrieveGamepadInputs_1.triggerValue)(fixedGamepad, gamepadInfo, \"lA\") // raw trigger value\n            , -lA.min - custcent[playerSlot].l // offset\n            , lA.max - lA.min // scaling\n            );\n        }\n    }\n    if (gamepadInfo.rA !== null) {\n        const rA = gamepadInfo.rA;\n        if (rA.kind === \"light\") {\n            input.rA = (0, retrieveGamepadInputs_1.triggerValue)(fixedGamepad, gamepadInfo, \"rA\");\n        }\n        else {\n            input.rA = (0, meleeInputs_1.scaleToGCTrigger)((0, retrieveGamepadInputs_1.triggerValue)(fixedGamepad, gamepadInfo, \"rA\") // raw trigger value\n            , -rA.min - custcent[playerSlot].r // offset\n            , rA.max - rA.min // scaling\n            );\n        }\n    }\n    if (main_1.controllerResetCountdowns[playerSlot] === 0) {\n        setCustomCenters(playerSlot, lsVec, csVec, input.lA, input.rA);\n    }\n    if (!frameByFrame && gameMode !== 4 && gameMode !== 14) { // not in target builder or calibration screen\n        if (input.z) {\n            if (input.lA < 0.35) {\n                input.lA = 0.35;\n            }\n            input.a = true;\n        }\n    }\n    if (gameMode !== 14) {\n        if (input.l) {\n            input.lA = 1;\n        }\n        if (input.r) {\n            input.rA = 1;\n        }\n        if (input.lA > 0.95) {\n            input.l = true;\n        }\n        if (input.rA > 0.95) {\n            input.r = true;\n        }\n    }\n    // -------------------------------------------------------\n    // d-pad\n    const dPadData = (0, retrieveGamepadInputs_1.dPadState)(fixedGamepad, gamepadInfo);\n    input.dl = dPadData.left;\n    input.dd = dPadData.down;\n    input.dr = dPadData.right;\n    input.du = dPadData.up;\n    return input;\n}\n;\nfunction showButton(i, but, boolean) {\n    if (boolean) {\n        (0, jquery_1.default)(\"#\" + i + \"button\" + but).show();\n    }\n    else {\n        (0, jquery_1.default)(\"#\" + i + \"button\" + but).hide();\n    }\n}\n;\nexports.keyboardMap = [\n    [102, 186],\n    [101, 76],\n    [100, 75],\n    [104, 79],\n    [103, 73],\n    [105, 80],\n    [107, 192, 222],\n    [109, 219], 71, 78, 66, 86\n];\nconst customCenters = function () {\n    this.ls = new Vec2D_1.Vec2D(0, 0);\n    this.cs = new Vec2D_1.Vec2D(0, 0);\n    this.l = 0;\n    this.r = 0;\n};\nconst custcent = [new customCenters, new customCenters, new customCenters, new customCenters];\nfunction setCustomCenters(i, ls0, cs0, l0, r0) {\n    custcent[i].ls = ls0;\n    custcent[i].cs = cs0;\n    custcent[i].l = l0;\n    custcent[i].r = r0;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvaW5wdXQvaW5wdXQudHMiLCJtYXBwaW5ncyI6IkFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQSw2Q0FBNkM7QUFDN0M7QUFDQSw4Q0FBNkMsRUFBRSxhQUFhLEVBQUM7QUFDN0QsbUJBQW1CLEdBQUcsbUJBQW1CLEdBQUcsaUJBQWlCLEdBQUcsaUJBQWlCLEdBQUcsaUJBQWlCLEdBQUcsaUJBQWlCLEdBQUcsa0JBQWtCLEdBQUcsaUJBQWlCO0FBQ2xLLGlCQUFpQjtBQUNqQixrQkFBa0I7QUFDbEIsa0JBQWtCO0FBQ2xCLHdCQUF3QjtBQUN4QixnQkFBZ0IsbUJBQU8sQ0FBQyxvREFBb0I7QUFDNUMsbUJBQW1CLG1CQUFPLENBQUMsc0NBQWE7QUFDeEMsZUFBZSxtQkFBTyxDQUFDLHdDQUFjO0FBQ3JDLGdDQUFnQyxtQkFBTyxDQUFDLHFGQUFpQztBQUN6RSxzQkFBc0IsbUJBQU8sQ0FBQyxpREFBZTtBQUM3QyxpQ0FBaUMsbUJBQU8sQ0FBQyxvREFBUTtBQUNqRCxpQkFBaUIsbUJBQU8sQ0FBQyw0Q0FBZ0I7QUFDekMsdUJBQXVCLG1CQUFPLENBQUMsZ0ZBQWtDO0FBQ2pFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQjtBQUNsQixpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQjtBQUNuQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBDQUEwQztBQUMxQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4Q0FBOEM7QUFDOUM7QUFDQSxhQUFhLHNEQUFzRDtBQUNuRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNENBQTRDO0FBQzVDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsT0FBTztBQUMvQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4REFBOEQ7QUFDOUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4REFBOEQ7QUFDOUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUI7QUFDbkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9tZWxlZWxpZ2h0Ly4vc3JjL2lucHV0L2lucHV0LnRzPzhhOWUiXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG4vKmVzbGludCBpbmRlbnQ6MCovXG4vLyBAZmxvd1xudmFyIF9faW1wb3J0RGVmYXVsdCA9ICh0aGlzICYmIHRoaXMuX19pbXBvcnREZWZhdWx0KSB8fCBmdW5jdGlvbiAobW9kKSB7XG4gICAgcmV0dXJuIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpID8gbW9kIDogeyBcImRlZmF1bHRcIjogbW9kIH07XG59O1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuZXhwb3J0cy5rZXlib2FyZE1hcCA9IGV4cG9ydHMuYWlJbnB1dEJhbmsgPSBleHBvcnRzLmFpUGxheWVyNCA9IGV4cG9ydHMuYWlQbGF5ZXIzID0gZXhwb3J0cy5haVBsYXllcjIgPSBleHBvcnRzLmFpUGxheWVyMSA9IGV4cG9ydHMubnVsbElucHV0cyA9IGV4cG9ydHMubnVsbElucHV0ID0gdm9pZCAwO1xuZXhwb3J0cy5pbnB1dERhdGEgPSBpbnB1dERhdGE7XG5leHBvcnRzLnBvbGxJbnB1dHMgPSBwb2xsSW5wdXRzO1xuZXhwb3J0cy5zaG93QnV0dG9uID0gc2hvd0J1dHRvbjtcbmV4cG9ydHMuc2V0Q3VzdG9tQ2VudGVycyA9IHNldEN1c3RvbUNlbnRlcnM7XG5jb25zdCBWZWMyRF8xID0gcmVxdWlyZShcIi4uL21haW4vdXRpbC9WZWMyRFwiKTtcbmNvbnN0IHNldHRpbmdzXzEgPSByZXF1aXJlKFwiLi4vc2V0dGluZ3NcIik7XG5jb25zdCBtYWluXzEgPSByZXF1aXJlKFwiLi4vbWFpbi9tYWluXCIpO1xuY29uc3QgcmV0cmlldmVHYW1lcGFkSW5wdXRzXzEgPSByZXF1aXJlKFwiLi9nYW1lcGFkL3JldHJpZXZlR2FtZXBhZElucHV0c1wiKTtcbmNvbnN0IG1lbGVlSW5wdXRzXzEgPSByZXF1aXJlKFwiLi9tZWxlZUlucHV0c1wiKTtcbmNvbnN0IGpxdWVyeV8xID0gX19pbXBvcnREZWZhdWx0KHJlcXVpcmUoXCJqcXVlcnlcIikpO1xuY29uc3QgcmVwbGF5XzEgPSByZXF1aXJlKFwiLi4vbWFpbi9yZXBsYXlcIik7XG5jb25zdCBzdHJlYW1jbGllbnRfMSA9IHJlcXVpcmUoXCIuLi9tYWluL211bHRpcGxheWVyL3N0cmVhbWNsaWVudFwiKTtcbmZ1bmN0aW9uIGlucHV0RGF0YShsaXN0ID0gW2ZhbHNlLCBmYWxzZSwgZmFsc2UsIGZhbHNlLCBmYWxzZSwgZmFsc2UsIGZhbHNlLCBmYWxzZSwgZmFsc2UsIGZhbHNlLCBmYWxzZSwgZmFsc2UsIDAsIDAsIDAsIDAsIDAsIDBdKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgYTogbGlzdFswXSxcbiAgICAgICAgYjogbGlzdFsxXSxcbiAgICAgICAgeDogbGlzdFsyXSxcbiAgICAgICAgeTogbGlzdFszXSxcbiAgICAgICAgejogbGlzdFs0XSxcbiAgICAgICAgcjogbGlzdFs1XSxcbiAgICAgICAgbDogbGlzdFs2XSxcbiAgICAgICAgczogbGlzdFs3XSxcbiAgICAgICAgZHU6IGxpc3RbOF0sXG4gICAgICAgIGRyOiBsaXN0WzldLFxuICAgICAgICBkZDogbGlzdFsxMF0sXG4gICAgICAgIGRsOiBsaXN0WzExXSxcbiAgICAgICAgbHNYOiAoMCwgbWVsZWVJbnB1dHNfMS5kZWFkZW4pKGxpc3RbMTJdKSxcbiAgICAgICAgbHNZOiAoMCwgbWVsZWVJbnB1dHNfMS5kZWFkZW4pKGxpc3RbMTNdKSxcbiAgICAgICAgY3NYOiAoMCwgbWVsZWVJbnB1dHNfMS5kZWFkZW4pKGxpc3RbMTRdKSxcbiAgICAgICAgY3NZOiAoMCwgbWVsZWVJbnB1dHNfMS5kZWFkZW4pKGxpc3RbMTVdKSxcbiAgICAgICAgbEE6IGxpc3RbMTZdLFxuICAgICAgICByQTogbGlzdFsxN10sXG4gICAgICAgIHJhd1g6IGxpc3RbMTJdLFxuICAgICAgICByYXdZOiBsaXN0WzEzXSxcbiAgICAgICAgcmF3Y3NYOiBsaXN0WzE0XSxcbiAgICAgICAgcmF3Y3NZOiBsaXN0WzE1XVxuICAgIH07XG59XG47XG5jb25zdCBudWxsSW5wdXQgPSAoKSA9PiBpbnB1dERhdGEoKTtcbmV4cG9ydHMubnVsbElucHV0ID0gbnVsbElucHV0O1xuY29uc3QgbnVsbElucHV0cyA9ICgpID0+IFtpbnB1dERhdGEoKSxcbiAgICBpbnB1dERhdGEoKSxcbiAgICBpbnB1dERhdGEoKSxcbiAgICBpbnB1dERhdGEoKSxcbiAgICBpbnB1dERhdGEoKSxcbiAgICBpbnB1dERhdGEoKSxcbiAgICBpbnB1dERhdGEoKSxcbiAgICBpbnB1dERhdGEoKVxuXTtcbmV4cG9ydHMubnVsbElucHV0cyA9IG51bGxJbnB1dHM7XG5leHBvcnRzLmFpUGxheWVyMSA9IFtpbnB1dERhdGEoKSxcbiAgICBpbnB1dERhdGEoKSxcbiAgICBpbnB1dERhdGEoKSxcbiAgICBpbnB1dERhdGEoKSxcbiAgICBpbnB1dERhdGEoKSxcbiAgICBpbnB1dERhdGEoKSxcbiAgICBpbnB1dERhdGEoKSxcbiAgICBpbnB1dERhdGEoKVxuXTtcbmV4cG9ydHMuYWlQbGF5ZXIyID0gW2lucHV0RGF0YSgpLFxuICAgIGlucHV0RGF0YSgpLFxuICAgIGlucHV0RGF0YSgpLFxuICAgIGlucHV0RGF0YSgpLFxuICAgIGlucHV0RGF0YSgpLFxuICAgIGlucHV0RGF0YSgpLFxuICAgIGlucHV0RGF0YSgpLFxuICAgIGlucHV0RGF0YSgpXG5dO1xuZXhwb3J0cy5haVBsYXllcjMgPSBbaW5wdXREYXRhKCksXG4gICAgaW5wdXREYXRhKCksXG4gICAgaW5wdXREYXRhKCksXG4gICAgaW5wdXREYXRhKCksXG4gICAgaW5wdXREYXRhKCksXG4gICAgaW5wdXREYXRhKCksXG4gICAgaW5wdXREYXRhKCksXG4gICAgaW5wdXREYXRhKClcbl07XG5leHBvcnRzLmFpUGxheWVyNCA9IFtpbnB1dERhdGEoKSxcbiAgICBpbnB1dERhdGEoKSxcbiAgICBpbnB1dERhdGEoKSxcbiAgICBpbnB1dERhdGEoKSxcbiAgICBpbnB1dERhdGEoKSxcbiAgICBpbnB1dERhdGEoKSxcbiAgICBpbnB1dERhdGEoKSxcbiAgICBpbnB1dERhdGEoKVxuXTtcbmV4cG9ydHMuYWlJbnB1dEJhbmsgPSBbZXhwb3J0cy5haVBsYXllcjEsIGV4cG9ydHMuYWlQbGF5ZXIyLCBleHBvcnRzLmFpUGxheWVyMywgZXhwb3J0cy5haVBsYXllcjRdO1xuLy8gc2hvdWxkIGJlIGFibGUgdG8gbW92ZSBvdXQgdGhlIFwiZnJhbWVCeUZyYW1lXCIgYXNwZWN0IG9mIHRoZSBmb2xsb3dpbmcgZnVuY3Rpb25cbi8vIGl0IGlzIG9ubHkgdXNlZCB0byBtYWtlIHogYnV0dG9uIG1lYW4gXCJsZWZ0IHRyaWdnZXIgdmFsdWUgPSAwLjM1XCIgKyBcIkEgPSB0cnVlXCIuXG5mdW5jdGlvbiBwb2xsSW5wdXRzKGdhbWVNb2RlLCBmcmFtZUJ5RnJhbWUsIGNvbnRyb2xsZXJJbmZvLCBwbGF5ZXJTbG90LCBjb250cm9sbGVySW5kZXgsIGtleXMsIHBsYXllcnR5cGUpIHtcbiAgICAvLyBpbnB1dCBpcyB0aGUgaW5wdXQgZm9yIHBsYXllciBpIGluIHRoZSBjdXJyZW50IGZyYW1lXG4gICAgbGV0IGlucHV0ID0gKDAsIGV4cG9ydHMubnVsbElucHV0KSgpOyAvLyBpbml0aWFsaXNlIHdpdGggZGVmYXVsdCB2YWx1ZXNcbiAgICBpZiAocmVwbGF5XzEucmVwbGF5QWN0aXZlKSB7XG4gICAgICAgIGlucHV0ID0gcG9sbFJlcGxheUlucHV0cyhnYW1lTW9kZSwgY29udHJvbGxlckluZm8sIHBsYXllclNsb3QsIGNvbnRyb2xsZXJJbmRleCwgZnJhbWVCeUZyYW1lKTtcbiAgICB9XG4gICAgZWxzZSBpZiAocGxheWVydHlwZSA9PT0gMSAmJiBnYW1lTW9kZSA9PT0gMykge1xuICAgICAgICByZXR1cm4gZXhwb3J0cy5haUlucHV0QmFua1twbGF5ZXJTbG90XVswXTtcbiAgICB9XG4gICAgZWxzZSBpZiAoY29udHJvbGxlckluZm8gPT09IFwia2V5Ym9hcmRcIikgeyAvLyBrZXlib2FyZCBjb250cm9sc1xuICAgICAgICBpbnB1dCA9IHBvbGxLZXlib2FyZElucHV0cyhnYW1lTW9kZSwgZnJhbWVCeUZyYW1lLCBrZXlzKTtcbiAgICAgICAgLy8gfSBlbHNlIGlmIChwbGF5ZXJ0eXBlID09PSAyIHx8IGNvbnRyb2xsZXJJbmZvID09PSA5OSkgeyAvLyBucDogb25saW5lIHBsYXk/XG4gICAgICAgIC8vICAgaW5wdXQgPSBwb2xsTmV0d29ya0lucHV0cyhnYW1lTW9kZSwgY29udHJvbGxlckluZm8sIHBsYXllclNsb3QsIGNvbnRyb2xsZXJJbmRleCwgZnJhbWVCeUZyYW1lKTtcbiAgICB9XG4gICAgZWxzZSBpZiAocGxheWVydHlwZSA9PT0gMCkge1xuICAgICAgICBpbnB1dCA9IHBvbGxHYW1lcGFkSW5wdXRzKGdhbWVNb2RlLCBjb250cm9sbGVySW5mbywgcGxheWVyU2xvdCwgY29udHJvbGxlckluZGV4LCBmcmFtZUJ5RnJhbWUpO1xuICAgIH1cbiAgICByZXR1cm4gaW5wdXQ7XG59XG5mdW5jdGlvbiBwb2xsTmV0d29ya0lucHV0cyhnYW1lTW9kZSwgY29udHJvbGxlclR5cGUsIHBsYXllclNsb3QsIGNvbnRyb2xsZXJJbmRleCwgZnJhbWVCeUZyYW1lKSB7XG4gICAgcmV0dXJuICgwLCBzdHJlYW1jbGllbnRfMS5yZXRyaWV2ZU5ldHdvcmtJbnB1dHMpKHBsYXllclNsb3QsIGNvbnRyb2xsZXJJbmRleCk7XG59XG5mdW5jdGlvbiBwb2xsUmVwbGF5SW5wdXRzKGdhbWVNb2RlLCBjb250cm9sbGVyVHlwZSwgcGxheWVyU2xvdCwgY29udHJvbGxlckluZGV4LCBmcmFtZUJ5RnJhbWUpIHtcbiAgICByZXR1cm4gKDAsIHJlcGxheV8xLnJldHJpZXZlUmVwbGF5SW5wdXRzKShwbGF5ZXJTbG90LCBjb250cm9sbGVySW5kZXgpO1xufVxuZnVuY3Rpb24gcG9sbEtleWJvYXJkSW5wdXRzKGdhbWVNb2RlLCBmcmFtZUJ5RnJhbWUsIGtleXMpIHtcbiAgICBjb25zdCBpbnB1dCA9ICgwLCBleHBvcnRzLm51bGxJbnB1dCkoKTsgLy8gaW5pdGlhbGlzZSB3aXRoIGRlZmF1bHQgdmFsdWVzXG4gICAgbGV0IHN0aWNrUiA9IDE7XG4gICAgbGV0IHN0aWNrTCA9IDE7XG4gICAgbGV0IHN0aWNrVSA9IDE7XG4gICAgbGV0IHN0aWNrRCA9IDE7XG4gICAgaWYgKGdhbWVNb2RlID09PSAzIHx8IGdhbWVNb2RlID09PSA1KSB7XG4gICAgICAgIHN0aWNrUiA9IHNldHRpbmdzXzEua2V5TWFwLmxzdGljay5yYW5nZXNbMV07XG4gICAgICAgIHN0aWNrTCA9IHNldHRpbmdzXzEua2V5TWFwLmxzdGljay5yYW5nZXNbMl07XG4gICAgICAgIHN0aWNrVSA9IHNldHRpbmdzXzEua2V5TWFwLmxzdGljay5yYW5nZXNbMF07XG4gICAgICAgIHN0aWNrRCA9IHNldHRpbmdzXzEua2V5TWFwLmxzdGljay5yYW5nZXNbM107XG4gICAgfVxuICAgIGxldCBsc3RpY2tYID0gKGtleXNbc2V0dGluZ3NfMS5rZXlNYXAubHN0aWNrLnJpZ2h0WzBdXSB8fCBrZXlzW3NldHRpbmdzXzEua2V5TWFwLmxzdGljay5yaWdodFsxXV0pID8gKChrZXlzW3NldHRpbmdzXzEua2V5TWFwLmxzdGljay5sZWZ0WzBdXSB8fFxuICAgICAgICBrZXlzW3NldHRpbmdzXzEua2V5TWFwLmxzdGljay5sZWZ0WzFdXSkgPyAwIDogc3RpY2tSKSA6ICgoa2V5c1tzZXR0aW5nc18xLmtleU1hcC5sc3RpY2subGVmdFswXV0gfHwga2V5c1tzZXR0aW5nc18xLmtleU1hcC5sc3RpY2subGVmdFsxXV0pID9cbiAgICAgICAgLXN0aWNrTCA6IDApO1xuICAgIGxldCBsc3RpY2tZID0gKGtleXNbc2V0dGluZ3NfMS5rZXlNYXAubHN0aWNrLnVwWzBdXSB8fCBrZXlzW3NldHRpbmdzXzEua2V5TWFwLmxzdGljay51cFsxXV0pID8gKChrZXlzW3NldHRpbmdzXzEua2V5TWFwLmxzdGljay5kb3duWzBdXSB8fCBrZXlzW3NldHRpbmdzXzEua2V5TWFwLmxzdGljay5kb3duWzFdXSkgPyAwIDogc3RpY2tVKSA6ICgoa2V5c1tzZXR0aW5nc18xLmtleU1hcC5sc3RpY2suZG93blswXV0gfHwga2V5c1tzZXR0aW5nc18xLmtleU1hcC5sc3RpY2suZG93blsxXV0pID8gLXN0aWNrRCA6IDApO1xuICAgIGxldCBsQW5hbG9nID0gKGtleXNbc2V0dGluZ3NfMS5rZXlNYXAuc2hvdWxkZXJzLmxBbmFsb2dbMF1dIHx8IGtleXNbc2V0dGluZ3NfMS5rZXlNYXAuc2hvdWxkZXJzLmxBbmFsb2dbMV1dKSA/IHNldHRpbmdzXzEua2V5TWFwLnNob3VsZGVycy5yYW5nZXNbMF0gOiAwO1xuICAgIGxldCByQW5hbG9nID0gKGtleXNbc2V0dGluZ3NfMS5rZXlNYXAuc2hvdWxkZXJzLnJBbmFsb2dbMF1dIHx8IGtleXNbc2V0dGluZ3NfMS5rZXlNYXAuc2hvdWxkZXJzLnJBbmFsb2dbMV1dKSA/IHNldHRpbmdzXzEua2V5TWFwLnNob3VsZGVycy5yYW5nZXNbMV0gOiAwO1xuICAgIGlmIChnYW1lTW9kZSA9PT0gMyB8fCBnYW1lTW9kZSA9PT0gNSkge1xuICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IDU7IGorKykge1xuICAgICAgICAgICAgaWYgKGtleXNbc2V0dGluZ3NfMS5rZXlNYXAubHN0aWNrLm1vZGlmaWVyc1tqXVswXV0pIHtcbiAgICAgICAgICAgICAgICBsc3RpY2tYICo9IHNldHRpbmdzXzEua2V5TWFwLmxzdGljay5tb2RpZmllcnNbal1bMV07XG4gICAgICAgICAgICAgICAgbHN0aWNrWSAqPSBzZXR0aW5nc18xLmtleU1hcC5sc3RpY2subW9kaWZpZXJzW2pdWzJdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGtleXNbc2V0dGluZ3NfMS5rZXlNYXAuc2hvdWxkZXJzLm1vZGlmaWVyc1tqXVswXV0pIHtcbiAgICAgICAgICAgICAgICBsQW5hbG9nICo9IHNldHRpbmdzXzEua2V5TWFwLnNob3VsZGVycy5tb2RpZmllcnNbal1bMV07XG4gICAgICAgICAgICAgICAgckFuYWxvZyAqPSBzZXR0aW5nc18xLmtleU1hcC5zaG91bGRlcnMubW9kaWZpZXJzW2pdWzJdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGxzdGlja1ggPSBNYXRoLnNpZ24obHN0aWNrWCkgKiBNYXRoLm1pbigxLCBNYXRoLmFicyhsc3RpY2tYKSk7XG4gICAgbHN0aWNrWSA9IE1hdGguc2lnbihsc3RpY2tZKSAqIE1hdGgubWluKDEsIE1hdGguYWJzKGxzdGlja1kpKTtcbiAgICBsQW5hbG9nID0gTWF0aC5taW4oMSwgTWF0aC5hYnMobEFuYWxvZykpO1xuICAgIHJBbmFsb2cgPSBNYXRoLm1pbigxLCBNYXRoLmFicyhyQW5hbG9nKSk7XG4gICAgY29uc3QgY3N0aWNrWCA9IChrZXlzW3NldHRpbmdzXzEua2V5TWFwLmNzdGljay5yaWdodFswXV0gfHwga2V5c1tzZXR0aW5nc18xLmtleU1hcC5jc3RpY2sucmlnaHRbMV1dKSA/ICgoa2V5c1tzZXR0aW5nc18xLmtleU1hcC5jc3RpY2subGVmdFswXV0gfHxcbiAgICAgICAga2V5c1tzZXR0aW5nc18xLmtleU1hcC5jc3RpY2subGVmdFsxXV0pID8gMCA6IDEpIDogKChrZXlzW3NldHRpbmdzXzEua2V5TWFwLmNzdGljay5sZWZ0WzBdXSB8fCBrZXlzW3NldHRpbmdzXzEua2V5TWFwLmNzdGljay5sZWZ0WzFdXSkgPyAtMSA6XG4gICAgICAgIDApO1xuICAgIGNvbnN0IGNzdGlja1kgPSAoa2V5c1tzZXR0aW5nc18xLmtleU1hcC5jc3RpY2sudXBbMF1dIHx8IGtleXNbc2V0dGluZ3NfMS5rZXlNYXAuY3N0aWNrLnVwWzFdXSkgPyAoKGtleXNbc2V0dGluZ3NfMS5rZXlNYXAuY3N0aWNrLmRvd25bMF1dIHx8IGtleXNbc2V0dGluZ3NfMS5rZXlNYXAuY3N0aWNrLmRvd25bMV1dKSA/IDAgOiAxKSA6ICgoa2V5c1tzZXR0aW5nc18xLmtleU1hcC5jc3RpY2suZG93blswXV0gfHwga2V5c1tzZXR0aW5nc18xLmtleU1hcC5jc3RpY2suZG93blsxXV0pID8gLTEgOiAwKTtcbiAgICBjb25zdCByZXNjYWxlZExTdGljayA9ICgwLCBtZWxlZUlucHV0c18xLnRhc1Jlc2NhbGUpKGxzdGlja1gsIGxzdGlja1ksIHRydWUpO1xuICAgIGlucHV0LmxzWCA9ICgwLCBtZWxlZUlucHV0c18xLmRlYWRlbikocmVzY2FsZWRMU3RpY2tbMF0pO1xuICAgIGlucHV0LmxzWSA9ICgwLCBtZWxlZUlucHV0c18xLmRlYWRlbikocmVzY2FsZWRMU3RpY2tbMV0pO1xuICAgIGlucHV0LnJhd1ggPSByZXNjYWxlZExTdGlja1swXTtcbiAgICBpbnB1dC5yYXdZID0gcmVzY2FsZWRMU3RpY2tbMV07XG4gICAgY29uc3QgcmVzY2FsZWRDU3RpY2sgPSAoMCwgbWVsZWVJbnB1dHNfMS50YXNSZXNjYWxlKShjc3RpY2tYLCBjc3RpY2tZLCB0cnVlKTtcbiAgICBpbnB1dC5jc1ggPSAoMCwgbWVsZWVJbnB1dHNfMS5kZWFkZW4pKHJlc2NhbGVkQ1N0aWNrWzBdKTtcbiAgICBpbnB1dC5jc1kgPSAoMCwgbWVsZWVJbnB1dHNfMS5kZWFkZW4pKHJlc2NhbGVkQ1N0aWNrWzFdKTtcbiAgICBpbnB1dC5yYXdjc1ggPSByZXNjYWxlZENTdGlja1swXTtcbiAgICBpbnB1dC5yYXdjc1kgPSByZXNjYWxlZENTdGlja1sxXTtcbiAgICBpbnB1dC5sQSA9IGxBbmFsb2c7XG4gICAgaW5wdXQuckEgPSByQW5hbG9nO1xuICAgIGlucHV0LnMgPSBrZXlzW3NldHRpbmdzXzEua2V5TWFwLnNbMF1dIHx8IGtleXNbc2V0dGluZ3NfMS5rZXlNYXAuc1sxXV07XG4gICAgaW5wdXQueCA9IGtleXNbc2V0dGluZ3NfMS5rZXlNYXAueFswXV0gfHwga2V5c1tzZXR0aW5nc18xLmtleU1hcC54WzFdXTtcbiAgICBpbnB1dC5hID0ga2V5c1tzZXR0aW5nc18xLmtleU1hcC5hWzBdXSB8fCBrZXlzW3NldHRpbmdzXzEua2V5TWFwLmFbMV1dO1xuICAgIGlucHV0LmIgPSBrZXlzW3NldHRpbmdzXzEua2V5TWFwLmJbMF1dIHx8IGtleXNbc2V0dGluZ3NfMS5rZXlNYXAuYlsxXV07XG4gICAgaW5wdXQueSA9IGtleXNbc2V0dGluZ3NfMS5rZXlNYXAueVswXV0gfHwga2V5c1tzZXR0aW5nc18xLmtleU1hcC55WzFdXTtcbiAgICBpbnB1dC5yID0ga2V5c1tzZXR0aW5nc18xLmtleU1hcC5yWzBdXSB8fCBrZXlzW3NldHRpbmdzXzEua2V5TWFwLnJbMV1dO1xuICAgIGlucHV0LmwgPSBrZXlzW3NldHRpbmdzXzEua2V5TWFwLmxbMF1dIHx8IGtleXNbc2V0dGluZ3NfMS5rZXlNYXAubFsxXV07XG4gICAgaW5wdXQueiA9IGtleXNbc2V0dGluZ3NfMS5rZXlNYXAuelswXV0gfHwga2V5c1tzZXR0aW5nc18xLmtleU1hcC56WzFdXTtcbiAgICBpbnB1dC5kbCA9IGtleXNbc2V0dGluZ3NfMS5rZXlNYXAuZGxbMF1dO1xuICAgIGlucHV0LmRkID0ga2V5c1tzZXR0aW5nc18xLmtleU1hcC5kZFswXV07XG4gICAgaW5wdXQuZHIgPSBrZXlzW3NldHRpbmdzXzEua2V5TWFwLmRyWzBdXTtcbiAgICBpbnB1dC5kdSA9IGtleXNbc2V0dGluZ3NfMS5rZXlNYXAuZHVbMF1dO1xuICAgIGlmICghZnJhbWVCeUZyYW1lICYmIGdhbWVNb2RlICE9PSA0ICYmIGdhbWVNb2RlICE9PSAxNCkgeyAvLyBub3QgaW4gdGFyZ2V0IGJ1aWxkZXIsIGNhbGlicmF0aW9uIHNjcmVlbiwgb3IgZnJhbWUgYnkgZnJhbWUgbW9kZVxuICAgICAgICBpZiAoaW5wdXQueikge1xuICAgICAgICAgICAgaWYgKGlucHV0LmxBIDwgMC4zNSkge1xuICAgICAgICAgICAgICAgIGlucHV0LmxBID0gMC4zNTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlucHV0LmEgPSB0cnVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIGlmIChpbnB1dC5sKSB7XG4gICAgICAgIGlucHV0LmxBID0gMTtcbiAgICB9XG4gICAgaWYgKGlucHV0LnIpIHtcbiAgICAgICAgaW5wdXQuckEgPSAxO1xuICAgIH1cbiAgICByZXR1cm4gaW5wdXQ7XG59XG5mdW5jdGlvbiBwb2xsR2FtZXBhZElucHV0cyhnYW1lTW9kZSwgZ2FtZXBhZEluZm8sIHBsYXllclNsb3QsIGNvbnRyb2xsZXJJbmRleCwgZnJhbWVCeUZyYW1lKSB7XG4gICAgY29uc3QgaW5wdXQgPSAoMCwgZXhwb3J0cy5udWxsSW5wdXQpKCk7XG4gICAgaWYgKG5hdmlnYXRvci5nZXRHYW1lcGFkcyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHJldHVybiBpbnB1dDtcbiAgICB9XG4gICAgY29uc3QgZ2FtZXBhZHMgPSBuYXZpZ2F0b3IuZ2V0R2FtZXBhZHMoKTtcbiAgICBjb25zdCBnYW1lcGFkID0gZ2FtZXBhZHNbY29udHJvbGxlckluZGV4XTtcbiAgICBpZiAoZ2FtZXBhZCA9PT0gbnVsbCB8fCBnYW1lcGFkID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgcmV0dXJuIGlucHV0O1xuICAgIH1cbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gYW5hbG9nIHN0aWNrc1xuICAgIGNvbnN0IGZpeGVkR2FtZXBhZCA9IGdhbWVwYWQ7XG4gICAgLy8ge1xuICAgIC8vICAgYnV0dG9uczogZ2FtZXBhZC5idXR0b25zIGFzIEdhbWVwYWRCdXR0b25bXSxcbiAgICAvLyAgIGF4ZXM6IGdhbWVwYWQuYXhlcyBhcyBudW1iZXJbXSxcbiAgICAvLyAgIGlkOiBnYW1lcGFkLmlkXG4gICAgLy8gfTtcbiAgICBjb25zdCBsc1ZlYyA9ICgwLCByZXRyaWV2ZUdhbWVwYWRJbnB1dHNfMS5zdGlja1ZhbHVlKShmaXhlZEdhbWVwYWQsIGdhbWVwYWRJbmZvLCBcImxzXCIpO1xuICAgIGNvbnN0IGNzVmVjID0gKDAsIHJldHJpZXZlR2FtZXBhZElucHV0c18xLnN0aWNrVmFsdWUpKGZpeGVkR2FtZXBhZCwgZ2FtZXBhZEluZm8sIFwiY3NcIik7XG4gICAgY29uc3QgaXNHQyA9IGdhbWVwYWRJbmZvLmlzR0M7XG4gICAgbGV0IGxzQ2FyZGluYWxzID0gbnVsbDtcbiAgICBpZiAoZ2FtZXBhZEluZm8ubHMgIT09IG51bGwpIHtcbiAgICAgICAgbHNDYXJkaW5hbHMgPSBnYW1lcGFkSW5mby5scy5jYXJkaW5hbHM7XG4gICAgfVxuICAgIGxldCBjc0NhcmRpbmFscyA9IG51bGw7XG4gICAgaWYgKGdhbWVwYWRJbmZvLmNzICE9PSBudWxsKSB7XG4gICAgICAgIGNzQ2FyZGluYWxzID0gZ2FtZXBhZEluZm8uY3MuY2FyZGluYWxzO1xuICAgIH1cbiAgICBjb25zdCBsc3RpY2tzID0gKDAsIG1lbGVlSW5wdXRzXzEuc2NhbGVUb01lbGVlQXhlcykobHNWZWMueCAvLyB4LWF4aXMgZGF0YVxuICAgICwgbHNWZWMueSAvLyB5LWF4aXMgZGF0YVxuICAgICwgaXNHQywgbHNDYXJkaW5hbHMsIGN1c3RjZW50W3BsYXllclNsb3RdLmxzLnggLy8geC1heGlzIFwiY3VzdG9tIGNlbnRlclwiIG9mZnNldFxuICAgICwgY3VzdGNlbnRbcGxheWVyU2xvdF0ubHMueSAvLyB5LWF4aXMgXCJjdXN0b20gY2VudGVyXCIgb2Zmc2V0XG4gICAgKTtcbiAgICBjb25zdCBjc3RpY2tzID0gKDAsIG1lbGVlSW5wdXRzXzEuc2NhbGVUb01lbGVlQXhlcykoY3NWZWMueCwgY3NWZWMueSwgaXNHQywgY3NDYXJkaW5hbHMsIGN1c3RjZW50W3BsYXllclNsb3RdLmNzLngsIGN1c3RjZW50W3BsYXllclNsb3RdLmNzLnkpO1xuICAgIGlucHV0LmxzWCA9ICgwLCBtZWxlZUlucHV0c18xLmRlYWRlbikobHN0aWNrc1swXSk7XG4gICAgaW5wdXQubHNZID0gKDAsIG1lbGVlSW5wdXRzXzEuZGVhZGVuKShsc3RpY2tzWzFdKTtcbiAgICBpbnB1dC5jc1ggPSAoMCwgbWVsZWVJbnB1dHNfMS5kZWFkZW4pKGNzdGlja3NbMF0pO1xuICAgIGlucHV0LmNzWSA9ICgwLCBtZWxlZUlucHV0c18xLmRlYWRlbikoY3N0aWNrc1sxXSk7XG4gICAgaW5wdXQucmF3WCA9IGxzdGlja3NbMF07XG4gICAgaW5wdXQucmF3WSA9IGxzdGlja3NbMV07XG4gICAgaW5wdXQucmF3Y3NYID0gY3N0aWNrc1swXTtcbiAgICBpbnB1dC5yYXdjc1kgPSBjc3RpY2tzWzFdO1xuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBidXR0b25zXG4gICAgaW5wdXQucyA9ICgwLCByZXRyaWV2ZUdhbWVwYWRJbnB1dHNfMS5idXR0b25TdGF0ZSkoZml4ZWRHYW1lcGFkLCBnYW1lcGFkSW5mbywgXCJzXCIpO1xuICAgIGlucHV0LnggPSAoMCwgcmV0cmlldmVHYW1lcGFkSW5wdXRzXzEuYnV0dG9uU3RhdGUpKGZpeGVkR2FtZXBhZCwgZ2FtZXBhZEluZm8sIFwieFwiKTtcbiAgICBpbnB1dC5hID0gKDAsIHJldHJpZXZlR2FtZXBhZElucHV0c18xLmJ1dHRvblN0YXRlKShmaXhlZEdhbWVwYWQsIGdhbWVwYWRJbmZvLCBcImFcIik7XG4gICAgaW5wdXQuYiA9ICgwLCByZXRyaWV2ZUdhbWVwYWRJbnB1dHNfMS5idXR0b25TdGF0ZSkoZml4ZWRHYW1lcGFkLCBnYW1lcGFkSW5mbywgXCJiXCIpO1xuICAgIGlucHV0LnkgPSAoMCwgcmV0cmlldmVHYW1lcGFkSW5wdXRzXzEuYnV0dG9uU3RhdGUpKGZpeGVkR2FtZXBhZCwgZ2FtZXBhZEluZm8sIFwieVwiKTtcbiAgICBpbnB1dC56ID0gKDAsIHJldHJpZXZlR2FtZXBhZElucHV0c18xLmJ1dHRvblN0YXRlKShmaXhlZEdhbWVwYWQsIGdhbWVwYWRJbmZvLCBcInpcIik7XG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vIHRyaWdnZXJzXG4gICAgaW5wdXQubCA9ICgwLCByZXRyaWV2ZUdhbWVwYWRJbnB1dHNfMS5idXR0b25TdGF0ZSkoZml4ZWRHYW1lcGFkLCBnYW1lcGFkSW5mbywgXCJsXCIpO1xuICAgIGlucHV0LnIgPSAoMCwgcmV0cmlldmVHYW1lcGFkSW5wdXRzXzEuYnV0dG9uU3RhdGUpKGZpeGVkR2FtZXBhZCwgZ2FtZXBhZEluZm8sIFwiclwiKTtcbiAgICBpZiAoZ2FtZXBhZEluZm8ubEEgIT09IG51bGwpIHtcbiAgICAgICAgY29uc3QgbEEgPSBnYW1lcGFkSW5mby5sQTtcbiAgICAgICAgaWYgKGxBLmtpbmQgPT09IFwibGlnaHRcIikge1xuICAgICAgICAgICAgaW5wdXQubEEgPSAoMCwgcmV0cmlldmVHYW1lcGFkSW5wdXRzXzEudHJpZ2dlclZhbHVlKShmaXhlZEdhbWVwYWQsIGdhbWVwYWRJbmZvLCBcImxBXCIpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgaW5wdXQubEEgPSAoMCwgbWVsZWVJbnB1dHNfMS5zY2FsZVRvR0NUcmlnZ2VyKSgoMCwgcmV0cmlldmVHYW1lcGFkSW5wdXRzXzEudHJpZ2dlclZhbHVlKShmaXhlZEdhbWVwYWQsIGdhbWVwYWRJbmZvLCBcImxBXCIpIC8vIHJhdyB0cmlnZ2VyIHZhbHVlXG4gICAgICAgICAgICAsIC1sQS5taW4gLSBjdXN0Y2VudFtwbGF5ZXJTbG90XS5sIC8vIG9mZnNldFxuICAgICAgICAgICAgLCBsQS5tYXggLSBsQS5taW4gLy8gc2NhbGluZ1xuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBpZiAoZ2FtZXBhZEluZm8uckEgIT09IG51bGwpIHtcbiAgICAgICAgY29uc3QgckEgPSBnYW1lcGFkSW5mby5yQTtcbiAgICAgICAgaWYgKHJBLmtpbmQgPT09IFwibGlnaHRcIikge1xuICAgICAgICAgICAgaW5wdXQuckEgPSAoMCwgcmV0cmlldmVHYW1lcGFkSW5wdXRzXzEudHJpZ2dlclZhbHVlKShmaXhlZEdhbWVwYWQsIGdhbWVwYWRJbmZvLCBcInJBXCIpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgaW5wdXQuckEgPSAoMCwgbWVsZWVJbnB1dHNfMS5zY2FsZVRvR0NUcmlnZ2VyKSgoMCwgcmV0cmlldmVHYW1lcGFkSW5wdXRzXzEudHJpZ2dlclZhbHVlKShmaXhlZEdhbWVwYWQsIGdhbWVwYWRJbmZvLCBcInJBXCIpIC8vIHJhdyB0cmlnZ2VyIHZhbHVlXG4gICAgICAgICAgICAsIC1yQS5taW4gLSBjdXN0Y2VudFtwbGF5ZXJTbG90XS5yIC8vIG9mZnNldFxuICAgICAgICAgICAgLCByQS5tYXggLSByQS5taW4gLy8gc2NhbGluZ1xuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBpZiAobWFpbl8xLmNvbnRyb2xsZXJSZXNldENvdW50ZG93bnNbcGxheWVyU2xvdF0gPT09IDApIHtcbiAgICAgICAgc2V0Q3VzdG9tQ2VudGVycyhwbGF5ZXJTbG90LCBsc1ZlYywgY3NWZWMsIGlucHV0LmxBLCBpbnB1dC5yQSk7XG4gICAgfVxuICAgIGlmICghZnJhbWVCeUZyYW1lICYmIGdhbWVNb2RlICE9PSA0ICYmIGdhbWVNb2RlICE9PSAxNCkgeyAvLyBub3QgaW4gdGFyZ2V0IGJ1aWxkZXIgb3IgY2FsaWJyYXRpb24gc2NyZWVuXG4gICAgICAgIGlmIChpbnB1dC56KSB7XG4gICAgICAgICAgICBpZiAoaW5wdXQubEEgPCAwLjM1KSB7XG4gICAgICAgICAgICAgICAgaW5wdXQubEEgPSAwLjM1O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaW5wdXQuYSA9IHRydWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaWYgKGdhbWVNb2RlICE9PSAxNCkge1xuICAgICAgICBpZiAoaW5wdXQubCkge1xuICAgICAgICAgICAgaW5wdXQubEEgPSAxO1xuICAgICAgICB9XG4gICAgICAgIGlmIChpbnB1dC5yKSB7XG4gICAgICAgICAgICBpbnB1dC5yQSA9IDE7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGlucHV0LmxBID4gMC45NSkge1xuICAgICAgICAgICAgaW5wdXQubCA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGlucHV0LnJBID4gMC45NSkge1xuICAgICAgICAgICAgaW5wdXQuciA9IHRydWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vIGQtcGFkXG4gICAgY29uc3QgZFBhZERhdGEgPSAoMCwgcmV0cmlldmVHYW1lcGFkSW5wdXRzXzEuZFBhZFN0YXRlKShmaXhlZEdhbWVwYWQsIGdhbWVwYWRJbmZvKTtcbiAgICBpbnB1dC5kbCA9IGRQYWREYXRhLmxlZnQ7XG4gICAgaW5wdXQuZGQgPSBkUGFkRGF0YS5kb3duO1xuICAgIGlucHV0LmRyID0gZFBhZERhdGEucmlnaHQ7XG4gICAgaW5wdXQuZHUgPSBkUGFkRGF0YS51cDtcbiAgICByZXR1cm4gaW5wdXQ7XG59XG47XG5mdW5jdGlvbiBzaG93QnV0dG9uKGksIGJ1dCwgYm9vbGVhbikge1xuICAgIGlmIChib29sZWFuKSB7XG4gICAgICAgICgwLCBqcXVlcnlfMS5kZWZhdWx0KShcIiNcIiArIGkgKyBcImJ1dHRvblwiICsgYnV0KS5zaG93KCk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICAoMCwganF1ZXJ5XzEuZGVmYXVsdCkoXCIjXCIgKyBpICsgXCJidXR0b25cIiArIGJ1dCkuaGlkZSgpO1xuICAgIH1cbn1cbjtcbmV4cG9ydHMua2V5Ym9hcmRNYXAgPSBbXG4gICAgWzEwMiwgMTg2XSxcbiAgICBbMTAxLCA3Nl0sXG4gICAgWzEwMCwgNzVdLFxuICAgIFsxMDQsIDc5XSxcbiAgICBbMTAzLCA3M10sXG4gICAgWzEwNSwgODBdLFxuICAgIFsxMDcsIDE5MiwgMjIyXSxcbiAgICBbMTA5LCAyMTldLCA3MSwgNzgsIDY2LCA4NlxuXTtcbmNvbnN0IGN1c3RvbUNlbnRlcnMgPSBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5scyA9IG5ldyBWZWMyRF8xLlZlYzJEKDAsIDApO1xuICAgIHRoaXMuY3MgPSBuZXcgVmVjMkRfMS5WZWMyRCgwLCAwKTtcbiAgICB0aGlzLmwgPSAwO1xuICAgIHRoaXMuciA9IDA7XG59O1xuY29uc3QgY3VzdGNlbnQgPSBbbmV3IGN1c3RvbUNlbnRlcnMsIG5ldyBjdXN0b21DZW50ZXJzLCBuZXcgY3VzdG9tQ2VudGVycywgbmV3IGN1c3RvbUNlbnRlcnNdO1xuZnVuY3Rpb24gc2V0Q3VzdG9tQ2VudGVycyhpLCBsczAsIGNzMCwgbDAsIHIwKSB7XG4gICAgY3VzdGNlbnRbaV0ubHMgPSBsczA7XG4gICAgY3VzdGNlbnRbaV0uY3MgPSBjczA7XG4gICAgY3VzdGNlbnRbaV0ubCA9IGwwO1xuICAgIGN1c3RjZW50W2ldLnIgPSByMDtcbn1cbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/input/input.ts\n");

/***/ })

},
/******/ function(__webpack_require__) { // webpackRuntimeModules
/******/ /* webpack/runtime/getFullHash */
/******/ (() => {
/******/ 	__webpack_require__.h = () => ("4ec2aa276fc329f382d9")
/******/ })();
/******/ 
/******/ }
);