"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdatemeleelight"]("main",{

/***/ "./src/main/main.ts":
/*!**************************!*\
  !*** ./src/main/main.ts ***!
  \**************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

eval("\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.starting = exports.blastzone = exports.stageSelect = exports.respawnPoints = exports.edgeOrientation = exports.edgeOffset = exports.edges = exports.wallsR = exports.wallsL = exports.platforms = exports.ground = exports.startingFace = exports.startingPoint = exports.frameAdvance = exports.pause = exports.colours = exports.costumeTimeout = exports.pPal = exports.tagText = exports.hasTag = exports.palettes = exports.randomTags = exports.versusMode = exports.gameMode = exports.showDebug = exports.findingPlayers = exports.frameByFrameRender = exports.wasFrameByFrame = exports.frameByFrame = exports.playing = exports.activePorts = exports.ports = exports.cpuDifficulty = exports.playerType = exports.playerAmount = exports.currentPlayers = exports.mType = exports.firstTimeDetected = exports.usingCustomControls = exports.controllerResetCountdowns = exports.gameEnd = exports.calibrationPlayer = exports.shine = exports.characterSelections = exports.framerate = exports.gamelogicTime = exports.renderTime = exports.player = exports.snowCount = exports.holiday = void 0;\nexports.layerSwitches = exports.layers = exports.canvasMain = exports.c = exports.ui = exports.fg2 = exports.fg1 = exports.bg2 = exports.bg1 = exports.keyBinding = exports.keyBind = exports.keys = exports.usingLocalStorage = exports.matchTimer = exports.startTimer = void 0;\nexports.setControllerReset = setControllerReset;\nexports.setUsingCustomControls = setUsingCustomControls;\nexports.setMtype = setMtype;\nexports.setCurrentPlayer = setCurrentPlayer;\nexports.setTagText = setTagText;\nexports.setStageSelect = setStageSelect;\nexports.setStarting = setStarting;\nexports.setStartTimer = setStartTimer;\nexports.getStartTimer = getStartTimer;\nexports.addMatchTimer = addMatchTimer;\nexports.setMatchTimer = setMatchTimer;\nexports.getMatchTimer = getMatchTimer;\nexports.setCookie = setCookie;\nexports.setVersusMode = setVersusMode;\nexports.getCookie = getCookie;\nexports.setKeyBinding = setKeyBinding;\nexports.overrideKeyboardEvent = overrideKeyboardEvent;\nexports.disabledEventPropagation = disabledEventPropagation;\nexports.SVG = SVG;\nexports.matchTimerTick = matchTimerTick;\nexports.screenShake = screenShake;\nexports.percentShake = percentShake;\nexports.findPlayers = findPlayers;\nexports.setPlayerType = setPlayerType;\nexports.addPlayer = addPlayer;\nexports.togglePort = togglePort;\nexports.positionPlayersInCSS = positionPlayersInCSS;\nexports.changeGamemode = changeGamemode;\nexports.interpretInputs = interpretInputs;\nexports.renderToMain = renderToMain;\nexports.update = update;\nexports.gameTick = gameTick;\nexports.clearScreen = clearScreen;\nexports.renderTick = renderTick;\nexports.buildPlayerObject = buildPlayerObject;\nexports.initializePlayers = initializePlayers;\nexports.startGame = startGame;\nexports.endGame = endGame;\nexports.finishGame = finishGame;\nexports.start = start;\nexports.customDeadzone = customDeadzone;\nexports.addShine = addShine;\nexports.setShine = setShine;\nexports.setFindingPlayers = setFindingPlayers;\nexports.setPlaying = setPlaying;\nexports.setCreditsPlayer = setCreditsPlayer;\nexports.setCalibrationPlayer = setCalibrationPlayer;\nexports.cacheDom = cacheDom;\nexports.setCS = setCS;\n/* eslint-disable */\nconst css_1 = __webpack_require__(/*! ../menus/css */ \"./src/menus/css.ts\");\nconst player_1 = __webpack_require__(/*! ../main/player */ \"./src/main/player.ts\");\nconst settings_1 = __webpack_require__(/*! ../settings */ \"./src/settings.ts\");\nconst startup_1 = __webpack_require__(/*! ../menus/startup */ \"./src/menus/startup.ts\");\nconst menu_1 = __webpack_require__(/*! ../menus/menu */ \"./src/menus/menu.ts\");\nconst sfx_1 = __webpack_require__(/*! ../main/sfx */ \"./src/main/sfx.ts\");\nconst startscreen_1 = __webpack_require__(/*! ../menus/startscreen */ \"./src/menus/startscreen.ts\");\nconst stagerender_1 = __webpack_require__(/*! ../stages/stagerender */ \"./src/stages/stagerender.ts\");\nconst stageselect_1 = __webpack_require__(/*! ../menus/stageselect */ \"./src/menus/stageselect.ts\");\nconst audiomenu_1 = __webpack_require__(/*! ../menus/audiomenu */ \"./src/menus/audiomenu.ts\");\nconst gameplaymenu_1 = __webpack_require__(/*! ../menus/gameplaymenu */ \"./src/menus/gameplaymenu.ts\");\nconst keyboardmenu_1 = __webpack_require__(/*! ../menus/keyboardmenu */ \"./src/menus/keyboardmenu.ts\");\nconst controllermenu_1 = __webpack_require__(/*! ../menus/controllermenu */ \"./src/menus/controllermenu.ts\");\nconst render_1 = __webpack_require__(/*! ../main/render */ \"./src/main/render.ts\");\nconst actionStateShortcuts_1 = __webpack_require__(/*! ../physics/actionStateShortcuts */ \"./src/physics/actionStateShortcuts.ts\");\nconst hitDetection_1 = __webpack_require__(/*! ../physics/hitDetection */ \"./src/physics/hitDetection.ts\");\nconst article_1 = __webpack_require__(/*! ../physics/article */ \"./src/physics/article.ts\");\nconst ai_1 = __webpack_require__(/*! ../main/ai */ \"./src/main/ai.ts\");\nconst physics_1 = __webpack_require__(/*! ../physics/physics */ \"./src/physics/physics.ts\");\nconst jquery_1 = __importDefault(__webpack_require__(/*! jquery */ \"./node_modules/jquery/dist/jquery.js\"));\nconst transparency_1 = __webpack_require__(/*! ../main/vfx/transparency */ \"./src/main/vfx/transparency.js\");\nconst drawVfx_1 = __webpack_require__(/*! ../main/vfx/drawVfx */ \"./src/main/vfx/drawVfx.js\");\nconst vfxQueue_1 = __webpack_require__(/*! ../main/vfx/vfxQueue */ \"./src/main/vfx/vfxQueue.js\");\nconst activeStage_1 = __webpack_require__(/*! ../stages/activeStage */ \"./src/stages/activeStage.ts\");\nconst music_1 = __webpack_require__(/*! ./music */ \"./src/main/music.ts\");\nconst vfx_1 = __webpack_require__(/*! ../main/vfx */ \"./src/main/vfx.ts\");\nconst renderVfx_1 = __webpack_require__(/*! ./vfx/renderVfx */ \"./src/main/vfx/renderVfx.js\");\nconst Box2D_1 = __webpack_require__(/*! ./util/Box2D */ \"./src/main/util/Box2D.ts\");\nconst Vec2D_1 = __webpack_require__(/*! ./util/Vec2D */ \"./src/main/util/Vec2D.ts\");\nconst streamclient_1 = __webpack_require__(/*! ./multiplayer/streamclient */ \"./src/main/multiplayer/streamclient.js\");\nconst replay_1 = __webpack_require__(/*! ./replay */ \"./src/main/replay.ts\");\nconst input_1 = __webpack_require__(/*! ../input/input */ \"./src/input/input.ts\");\nconst meleeInputs_1 = __webpack_require__(/*! ../input/meleeInputs */ \"./src/input/meleeInputs.ts\");\nconst findGamepadInfo_1 = __webpack_require__(/*! ../input/gamepad/findGamepadInfo */ \"./src/input/gamepad/findGamepadInfo.ts\");\nconst custom_1 = __webpack_require__(/*! ../input/gamepad/gamepads/custom */ \"./src/input/gamepad/gamepads/custom.js\");\nconst retrieveGamepadInputs_1 = __webpack_require__(/*! ../input/gamepad/retrieveGamepadInputs */ \"./src/input/gamepad/retrieveGamepadInputs.ts\");\nconst drawGamepad_1 = __webpack_require__(/*! ../input/gamepad/drawGamepad */ \"./src/input/gamepad/drawGamepad.ts\");\nconst deepCopyObject_1 = __webpack_require__(/*! ./util/deepCopyObject */ \"./src/main/util/deepCopyObject.ts\");\nconst css_2 = __webpack_require__(/*! ../menus/css */ \"./src/menus/css.ts\");\n/*globals performance*/\nexports.holiday = 0;\nexports.snowCount = 150;\n//todo find 'Player' object\nexports.player = [0, 0, 0, 0];\nexports.renderTime = [10, 0, 100, 0];\nexports.gamelogicTime = [5, 0, 100, 0];\nexports.framerate = [0, 0, 0];\nexports.characterSelections = [0, 0, 0, 0];\nexports.shine = 0.5;\nexports.calibrationPlayer = 0;\nexports.gameEnd = false;\nexports.controllerResetCountdowns = [0, 0, 0, 0];\nfunction setControllerReset(i) {\n    exports.controllerResetCountdowns[i] = 0;\n}\nlet keyboardOccupied = false;\nexports.usingCustomControls = [false, false, false, false];\nfunction setUsingCustomControls(i, boolean, info) {\n    exports.usingCustomControls[i] = boolean;\n    if (bool) {\n        exports.mType[i] = custom_1.customGamepadInfo[exports.currentPlayers[i]];\n    }\n    else {\n        exports.mType[i] = info;\n    }\n}\nexports.firstTimeDetected = [true, true, true, true];\nwindow.mType = [null, null, null, null];\nexports.mType = [null, null, null, null];\nfunction setMtype(index, val) {\n    exports.mType[index] = val;\n}\nexports.currentPlayers = [];\nfunction setCurrentPlayer(index, val) {\n    exports.currentPlayers[index] = val;\n}\nexports.playerAmount = 0;\nexports.playerType = [-1, -1, -1, -1];\nexports.cpuDifficulty = [3, 3, 3, 3];\nexports.ports = 0;\nexports.activePorts = [];\nexports.playing = false;\nexports.frameByFrame = false;\nexports.wasFrameByFrame = false;\nexports.frameByFrameRender = false;\nexports.findingPlayers = true;\nexports.showDebug = false;\nexports.gameMode = 20;\n// 20:Startup\n// 13:Data Menu\n// 12:Keyboard Controls\n// 11:Gameplay Menu\n// 10:Sound Menu\n// 9: -\n// 8: -\n// 7:Target Select\n// 6:Stage Select (VS)\n// 5:Target Playing\n// 4:Target Builder\n// 3:Playing (VS)\n// 2:CSS\n// 1:Main Menu\n// 0:Title Screen\nexports.versusMode = 0;\nexports.randomTags = [\"NEO!\", \"SELF\", \"NOVA\", \"PNDA\", \"Panda\", \"LFFN\", \"Scorp\", \"AZ\", \"AXE\", \"Tempo\", \"TMPO\", \"[A]rmada\", \"WBALLZ\", \"Westballz\", \"PPMD\", \"Kreygasm\", \"M2K\", \"Mang0\", \"USA\", \"SCAR\", \"TOPH\", \"(.Y.)\", \"HBOX\", \"HungryBox\", \"PLUP\", \"Shroomed\", \"SFAT\", \"Wizz\", \"Lucky\", \"S2J\", \"SilentWolf\", \"aMSa\", \"S2J\", \"Hax$\"];\nexports.palettes = [[\"rgb(250, 89, 89)\", \"rgb(255, 170, 170)\", \"rgba(255, 206, 111, \", \"rgb(244, 68, 68)\", \"rgba(255, 225, 167, \"],\n    [\"rgb(95, 216, 84)\", \"rgb(184, 253, 154)\", \"rgba(252, 95, 95, \", \"rgb(255, 182, 96)\", \"rgba(254, 141, 141, \"],\n    [\"rgb(5, 195, 255)\", \"rgb(121, 223, 255)\", \"rgba(218, 96, 254, \", \"rgb(231, 134, 255)\", \"rgba(230, 144, 255, \"],\n    [\"rgb(255, 187, 70)\", \"rgb(248, 255, 122)\", \"rgba(80, 182, 255, \", \"rgb(255, 142, 70)\", \"rgba(139, 203, 249, \"],\n    [\"rgb(177, 89, 255)\", \"rgb(203, 144, 255)\", \"rgba(144, 255, 110, \", \"rgb(247, 126, 250)\", \"rgba(190, 255, 170, \"],\n    [\"rgb(182, 131, 70)\", \"rgb(252, 194, 126)\", \"rgba(47, 186, 123, \", \"rgb(255, 112, 66)\", \"rgba(111, 214, 168, \"],\n    [\"rgb(232, 232, 208)\", \"rgb(255, 255, 255)\", \"rgba(244, 255, 112, \", \"rgb(191, 119, 119)\", \"rgba(255, 255, 200, \"]];\nexports.hasTag = [false, false, false, false];\nexports.tagText = [\"\", \"\", \"\", \"\"];\nfunction setTagText(index, value) {\n    exports.tagText[index] = value;\n    exports.hasTag[index] = true;\n}\nexports.pPal = [0, 1, 2, 3];\nexports.costumeTimeout = [];\nexports.colours = [\"rgba(4, 255, 82, 0.62)\", \"rgba(117, 20, 255, 0.63)\", \"rgba(255, 20, 20, 0.63)\", \"rgba(255, 232, 20, 0.63)\"];\nexports.pause = [[true, true], [true, true], [true, true], [true, true]];\nexports.frameAdvance = [[true, true], [true, true], [true, true], [true, true]];\nexports.startingPoint = [[-50, 50], [50, 50], [-25, 5], [25, 5]];\nexports.startingFace = [1, -1, 1, -1];\nexports.ground = [[-68.4, 0], [68.4, 0]];\nexports.platforms = [[[-57.6, 27.2], [-20, 27.2]], [[20, 27.2], [57.6, 27.2]], [[-18.8, 54.4], [18.8, 54.4]]];\nexports.wallsL = [[[-68.4, 0], [-68.4, -108.8]]];\nexports.wallsR = [[[68.4, 0], [68.4, -108.8]]];\nexports.edges = [[[-68.4, 0], [-63.4, 0]], [[68.4, 0], [63.4, 0]]];\n//edgeOffset = [[-71.3,-23.7],[71.3,-23.7]];\nexports.edgeOffset = [[-2.9, -23.7], [2.9, -23.7]];\nexports.edgeOrientation = [1, -1];\nexports.respawnPoints = [[-50, 50, 1], [50, 50, -1], [25, 35, 1], [-25, 35, -1]];\nexports.stageSelect = 0;\nfunction setStageSelect(val) {\n    exports.stageSelect = val;\n}\nexports.blastzone = new Box2D_1.Box2D([-224, 200], [224, -108.8]);\nexports.starting = true;\nfunction setStarting(val) {\n    exports.starting = val;\n}\nexports.startTimer = 1.5;\nfunction setStartTimer(val) {\n    exports.startTimer = val;\n}\nfunction getStartTimer() {\n    return exports.startTimer;\n}\n//matchTimer = 5999.99;\nexports.matchTimer = 480;\nfunction addMatchTimer(val) {\n    exports.matchTimer += val;\n}\nfunction setMatchTimer(val) {\n    exports.matchTimer = val;\n}\nfunction getMatchTimer() {\n    return exports.matchTimer;\n}\nexports.usingLocalStorage = false;\nif (typeof (Storage) !== \"undefined\") {\n    // Code for localStorage/sessionStorage.\n    exports.usingLocalStorage = true;\n    console.log(\"local storage works\");\n}\nelse {\n    // Sorry! No Web Storage support..\n    console.log(\"local storage does not work\");\n}\nfunction setCookie(cname, cvalue, exdays) {\n    var d = new Date();\n    d.setTime(d.getTime() + (exdays * 24 * 60 * 60 * 1000));\n    var exp = \"expires=\" + d.toUTCString();\n    document.cookie = cname + \"=\" + cvalue + \"; \" + exp;\n    localStorage.setItem(cname, cvalue);\n}\nfunction setVersusMode(val) {\n    exports.versusMode = val;\n}\nfunction getCookie(cname) {\n    if (exports.usingLocalStorage) {\n        return localStorage.getItem(cname);\n    }\n    else {\n        var name = cname + \"=\";\n        var ca = document.cookie.split(';');\n        for (var i = 0; i < ca.length; i++) {\n            var c = ca[i];\n            while (c.charAt(0) == ' ')\n                c = c.substring(1);\n            if (c.indexOf(name) == 0)\n                return c.substring(name.length, c.length);\n        }\n        return \"\";\n    }\n}\nexports.keys = {};\nexports.keyBind = 0;\nexports.keyBinding = false;\nfunction setKeyBinding(val) {\n    exports.keyBinding = val;\n}\nfunction overrideKeyboardEvent(e) {\n    if (!showingCode && css_1.choosingTag == -1 && e.keyCode != 122 && e.keyCode != 116) {\n        switch (e.type) {\n            case \"keydown\":\n                if (!exports.keys[e.keyCode]) {\n                    exports.keys[e.keyCode] = true;\n                    exports.keyBind = e.keyCode;\n                    exports.keyBinding = true;\n                    // do key down stuff here\n                }\n                break;\n            case \"keyup\":\n                delete (exports.keys[e.keyCode]);\n                // do key up stuff here\n                break;\n        }\n        disabledEventPropagation(e);\n        e.preventDefault();\n        return false;\n    }\n    else {\n        if (css_1.choosingTag > -1) {\n            if (e.keyCode == 13) {\n                switch (e.type) {\n                    case \"keydown\":\n                        exports.keys[13] = true;\n                        break;\n                    case \"keyup\":\n                        delete (exports.keys[13]);\n                        break;\n                    default:\n                        break;\n                }\n            }\n        }\n        return true;\n    }\n}\n;\nfunction disabledEventPropagation(e) {\n    if (e) {\n        if (e.stopPropagation) {\n            e.stopPropagation();\n        }\n        else if (event) {\n            event.cancelBubble = true;\n        }\n    }\n}\n;\ndocument.onkeydown = overrideKeyboardEvent;\ndocument.onkeyup = overrideKeyboardEvent;\n/*var keys = [];\nexport const onkeyup (e) {\n  keys[e.keyCode]=false;\n}\nexport const onkeydown (e) {\n  keys[e.keyCode]=true;\n}*/\nfunction SVG(tag) {\n    return document.createElementNS('http://www.w3.org/2000/svg', tag);\n}\n/*if (Gamepad.supported) {\n    console.log(\"gamepad supported\");\n} else {\n    console.log(\"gamepad not supported\");\n}*/\nwindow.addEventListener(\"gamepadconnected\", function (e) {\n    console.log(\"Gamepad connected at index %d: %s. %d buttons, %d axes.\", e.gamepad.index, e.gamepad.id, e.gamepad.buttons.length, e.gamepad.axes.length);\n});\nif (navigator.getGamepads)\n    console.log(navigator.getGamepads());\nfunction matchTimerTick(input) {\n    exports.matchTimer -= 0.016667;\n    if (dom.matchMinutes && dom.matchSeconds) {\n        var sec = (exports.matchTimer % 60).toFixed(2);\n        dom.matchMinutes.innerHTML = Math.floor(exports.matchTimer / 60);\n        dom.matchSeconds.innerHTML = sec.length < 5 ? `0${sec}` : sec;\n    }\n    if (exports.matchTimer <= 0) {\n        finishGame(input);\n    }\n}\nfunction screenShake(kb) {\n    var seed = [Math.random(), Math.random(), Math.random(), Math.random()];\n    exports.fg1.translate(kb * 0.1 * seed[0], kb * 0.1 * seed[1]);\n    setTimeout(function () { exports.fg1.translate(-kb * 0.05 * seed[0], -kb * 0.05 * seed[1]); }, 20);\n    setTimeout(function () { exports.fg1.translate(-kb * 0.05 * seed[0], -kb * 0.05 * seed[1]); exports.fg1.translate(-kb * 0.1 * seed[2], -kb * 0.1 * seed[3]); }, 40);\n    setTimeout(function () { exports.fg1.translate(kb * 0.05 * seed[2], kb * 0.05 * seed[3]); }, 60);\n    setTimeout(function () { exports.fg1.translate(kb * 0.05 * seed[2], kb * 0.05 * seed[3]); }, 80);\n}\nfunction percentShake(kb, i) {\n    exports.player[i].percentShake = new Vec2D_1.Vec2D(kb * 0.1 * Math.random(), kb * 0.1 * Math.random());\n    setTimeout(function () { exports.player[i].percentShake = new Vec2D_1.Vec2D(kb * 0.05 * Math.random(), kb * 0.05 * Math.random()); }, 20);\n    setTimeout(function () { exports.player[i].percentShake = new Vec2D_1.Vec2D(-kb * 0.1 * Math.random(), -kb * 0.1 * Math.random()); }, 40);\n    setTimeout(function () { exports.player[i].percentShake = new Vec2D_1.Vec2D(-kb * 0.05 * Math.random(), -kb * 0.05 * Math.random()); }, 60);\n    setTimeout(function () { exports.player[i].percentShake = new Vec2D_1.Vec2D(0, 0); }, 80);\n}\nfunction findPlayers() {\n    var gps = navigator.getGamepads ? navigator.getGamepads() : (navigator.webkitGetGamepads ? navigator.webkitGetGamepads() : []);\n    /*if (typeof gps != \"undefined\"){\n      console.log(gps);\n    }*/\n    if (!keyboardOccupied) {\n        if (exports.gameMode < 2 || exports.gameMode == 20) {\n            if (exports.keys[13] || exports.keys[settings_1.keyMap.s[0]] || exports.keys[settings_1.keyMap.s[1]]) {\n                if (exports.ports < 4) {\n                    changeGamemode(1);\n                    (0, jquery_1.default)(\"#keyboardPrompt\").hide();\n                    keyboardOccupied = true;\n                    sfx_1.sounds.menuForward.play();\n                    if (exports.ports == 0) {\n                        music_1.MusicManager.playMenuLoop();\n                    }\n                    addPlayer(exports.ports, \"keyboard\");\n                }\n            }\n        }\n        else {\n            if (exports.keys[settings_1.keyMap.a[0]] || exports.keys[settings_1.keyMap.a[1]]) {\n                if (exports.ports < 4) {\n                    keyboardOccupied = true;\n                    addPlayer(exports.ports, \"keyboard\");\n                }\n            }\n        }\n    }\n    for (var i = 0; i < gps.length; i++) {\n        var gamepad = navigator.getGamepads ? navigator.getGamepads()[i] : (navigator.webkitGetGamepads ? navigator.webkitGetGamepads()[i] : null);\n        if (exports.playerType[i] === 2) {\n            var alreadyIn = false;\n            for (var k = 0; k < exports.ports; k++) {\n                if (exports.currentPlayers[k] === i) {\n                    alreadyIn = true;\n                }\n            }\n            if (!alreadyIn) {\n                if (exports.ports < 4) {\n                    addPlayer(i, 99);\n                }\n            }\n            continue;\n        }\n        var gamepad = navigator.getGamepads ? navigator.getGamepads()[i] : (navigator.webkitGetGamepads ? navigator.webkitGetGamepads()[i] : null);\n        if (typeof gamepad != \"undefined\" && gamepad != null) {\n            var detected = false;\n            var gpdName;\n            var gpdInfo;\n            if (exports.usingCustomControls[i] && custom_1.customGamepadInfo[i] !== null) {\n                gpdName = \"custom controls\";\n                gpdInfo = custom_1.customGamepadInfo[i];\n                detected = true;\n            }\n            else {\n                const maybeNameAndInfo = (0, findGamepadInfo_1.getGamepadNameAndInfo)(gamepad.id);\n                if (maybeNameAndInfo === null) {\n                    console.log(\"Error in 'findPlayers': controller \" + (i + 1) + \" detected but not supported.\");\n                    console.log(\"Try manual calibration of your controller.\");\n                }\n                else {\n                    detected = true;\n                    [gpdName, gpdInfo] = maybeNameAndInfo;\n                }\n            }\n            if (detected) {\n                if (exports.firstTimeDetected[i]) {\n                    console.log(\"Controller \" + (i + 1) + \" is: \" + gpdName + \".\");\n                    exports.firstTimeDetected[i] = false;\n                }\n                if (exports.gameMode < 2 || exports.gameMode == 20) {\n                    if ((0, retrieveGamepadInputs_1.buttonState)(gamepad, gpdInfo, \"s\")) {\n                        var alreadyIn = false;\n                        for (var k = 0; k < exports.ports; k++) {\n                            if (exports.currentPlayers[k] == i) {\n                                alreadyIn = true;\n                            }\n                        }\n                        if (!alreadyIn) {\n                            if (exports.ports < 4) {\n                                changeGamemode(1);\n                                (0, jquery_1.default)(\"#keyboardPrompt\").hide();\n                                sfx_1.sounds.menuForward.play();\n                                if (exports.ports === 0) {\n                                    music_1.MusicManager.playMenuLoop();\n                                }\n                                addPlayer(i, gpdInfo);\n                            }\n                        }\n                    }\n                }\n                else {\n                    if ((0, retrieveGamepadInputs_1.buttonState)(gamepad, gpdInfo, \"a\")) {\n                        var alreadyIn = false;\n                        for (var k = 0; k < exports.ports; k++) {\n                            if (exports.currentPlayers[k] == i) {\n                                alreadyIn = true;\n                            }\n                        }\n                        if (!alreadyIn) {\n                            if (exports.ports < 4) {\n                                addPlayer(i, gpdInfo);\n                            }\n                        }\n                    }\n                }\n            }\n            else {\n                console.log(\"No controller detected by browser\");\n            }\n        }\n    }\n}\nfunction setPlayerType(playerSlot, type) {\n    exports.playerType[playerSlot] = type;\n}\nfunction addPlayer(i, controllerInfo) {\n    if (controllerInfo === 99) {\n        exports.ports++;\n        exports.currentPlayers[exports.ports - 1] = i;\n        exports.playerType[exports.ports - 1] = 2;\n        exports.mType[exports.ports - 1] = controllerInfo;\n    }\n    else {\n        exports.ports++;\n        exports.currentPlayers[exports.ports - 1] = i;\n        exports.playerType[exports.ports - 1] = 0;\n        exports.mType[exports.ports - 1] = controllerInfo;\n        if (exports.showDebug) {\n            (0, drawGamepad_1.updateGamepadSVGColour)(i, \"gamepadSVG\" + i);\n            document.getElementById(\"gamepadSVG\" + i).style.display = \"\";\n        }\n    }\n}\nfunction togglePort(i) {\n    exports.playerType[i]++;\n    if (exports.playerType[i] == 3) {\n        exports.playerType[i] = -1;\n        if (exports.showDebug) {\n            document.getElementById(\"gamepadSVG\" + i).style.display = \"none\";\n        }\n    }\n    if (exports.playerType[i] == 0 && exports.ports <= i) {\n        exports.playerType[i] = 1;\n        (0, drawGamepad_1.setGamepadSVGColour)(i, \"black\");\n        if (exports.showDebug) {\n            (0, drawGamepad_1.updateGamepadSVGColour)(i, \"gamepadSVG\" + i);\n            document.getElementById(\"gamepadSVG\" + i).style.display = \"\";\n        }\n    }\n}\nfunction positionPlayersInCSS() {\n    for (var i = 0; i < 4; i++) {\n        var x = (-80 + i * 50) * 2 / 3;\n        var y = -30;\n        exports.player[i].phys.pos = new Vec2D_1.Vec2D(x, y);\n        exports.player[i].phys.hurtbox = new Box2D_1.Box2D([-4 + x, 18 + y], [4 + x, y]);\n    }\n}\n// 20:Startup\n// 14:Controller Menu\n// 13:Data Menu\n// 12:Keyboard Controls\n// 11:Gameplay Menu\n// 10:Sound Menu\n// 9: -\n// 8: -\n// 7:Target Select\n// 6:Stage Select (VS)\n// 5:Target Playing\n// 4:Target Builder\n// 3:Playing (VS)\n// 2:CSS\n// 1:Main Menu\n// 0:Title Screen\nfunction changeGamemode(newGamemode) {\n    exports.bg1.fillStyle = \"black\";\n    exports.bg1.fillRect(0, 0, exports.layers.BG1.width, exports.layers.BG1.height);\n    exports.fg1.clearRect(0, 0, exports.layers.FG1.width, exports.layers.FG1.height);\n    exports.gameMode = newGamemode;\n    switch (newGamemode) {\n        // TITLESCREEN\n        case 0:\n            (0, startscreen_1.drawStartScreenInit)();\n            break;\n        // MAIN MENU\n        case 1:\n            (0, jquery_1.default)(\"#logoVid\").remove();\n            (0, menu_1.drawMainMenuInit)();\n            break;\n        // CSS\n        case 2:\n            (0, css_1.drawCSSInit)();\n            break;\n        // Playing (VS)\n        case 3:\n            (0, stagerender_1.drawBackgroundInit)();\n            (0, stagerender_1.drawStageInit)();\n            break;\n        // Target Builder\n        case 4:\n            break;\n        // Target Playing\n        case 5:\n            (0, stagerender_1.drawBackgroundInit)();\n            (0, stagerender_1.drawStageInit)();\n            break;\n        // Stage select (vs)\n        case 6:\n            (0, stageselect_1.drawSSSInit)();\n            break;\n        // Target Select\n        case 7:\n            // drawTSSInit();\n            break;\n        // sound menu\n        case 10:\n            (0, audiomenu_1.drawAudioMenuInit)();\n            break;\n        // gameplay menu\n        case 11:\n            (0, gameplaymenu_1.drawGameplayMenuInit)();\n            break;\n        // keyboard menu\n        case 12:\n            (0, keyboardmenu_1.drawKeyboardMenuInit)();\n            break;\n        // credits\n        case 13:\n            // drawCreditsInit();\n            break;\n        // Multiplayer Modes\n        case 14:\n            (0, controllermenu_1.drawControllerMenuInit)();\n            break;\n        case 15:\n            (0, css_1.drawCSSInit)();\n            (0, streamclient_1.connectToMPServer)();\n            break;\n        // startup\n        case 20:\n            break;\n        default:\n            break;\n    }\n}\n/*export const addPlayer (i,gType,pType){\n  console.log(i,gType,pType);\n\n  currentPlayers.push(i);\n  if (pType == 0){\n    ports++;\n    mType[ports-1] = gType;\n    playerType[ports-1] = pType;\n\n    costumeTimeout.push(false);\n    pPal.push(ports-1);\n    buildPlayerObject(ports-1);\n    player[playerAmount-1].phys.pos = new Vec2D(-100+25*(playerAmount=1),-40);\n    player[ports-1].phys.face = 1;\n    player[ports-1].actionState = 0;\n    $(\"#currentPlayers\").append('<div class=\"pBoxBox\"><div class=\"playerBox\" id=\"pBox'+(ports-1)+'\" style=\"background-color:'+palettes[pPal[ports-1]][0]+';border:5px solid '+palettes[pPal[ports-1]][2]+'0.8)\"><p>P'+ports+'<br><span class=\"cont\">(Cont. '+i+')</span></p></div><div id=\"pTag'+(ports-1)+'\" class=\"pTag\"><textarea id=\"pTagEdit'+(ports-1)+'\" class=\"pTagEdit\" maxlength=\"10\"></textarea></div></div>');\n  }\n  else {\n    mType[i] = gType;\n\n    costumeTimeout.push(false);\n    pPal.push(i);\n    buildPlayerObject(i);\n    player[playerAmount-1].phys.pos = new Vec2D(-100+25*(playerAmount=1),-40);\n    player[i].phys.face = 1;\n    player[i].actionState = 0;\n    $(\"#currentPlayers\").append('<div class=\"pBoxBox\"><div class=\"playerBox\" id=\"pBox'+i+'\" style=\"background-color:'+palettes[pPal[i]][0]+';border:5px solid '+palettes[pPal[i]][2]+'0.8)\"><p>P'+(i+1)+'<br><span class=\"cont\">(Cont. '+i+')</span></p></div><div id=\"pTag'+i+'\" class=\"pTag\"><textarea id=\"pTagEdit'+i+'\" class=\"pTagEdit\" maxlength=\"10\"></textarea></div></div>');\n  }\n  playerAmount++;\n}\n\nexport const removePlayer (i){\n  playerType[i] = -1;\n  playerAmount--;\n}*/\nfunction interpretInputs(i, active, playertype, inputBuffer) {\n    let tempBuffer = (0, input_1.nullInputs)();\n    // keep updating Z and Start all the time, even when paused\n    for (var k = 0; k < 7; k++) {\n        tempBuffer[7 - k].z = inputBuffer[6 - k].z;\n        tempBuffer[7 - k].s = inputBuffer[6 - k].s;\n    }\n    tempBuffer[0] = (0, input_1.pollInputs)(exports.gameMode, exports.frameByFrame, exports.mType[i], i, exports.currentPlayers[i], exports.keys, playertype);\n    let pastOffset = 0;\n    if ((exports.gameMode !== 3 && exports.gameMode !== 5) || (exports.playing && (exports.pause[i][1] || !exports.pause[i][0]))\n        || exports.wasFrameByFrame\n        || (!exports.playing && exports.pause[i][0] && !exports.pause[i][1])) {\n        pastOffset = 1;\n    }\n    exports.pause[i][1] = exports.pause[i][0];\n    exports.wasFrameByFrame = false;\n    exports.frameAdvance[i][1] = exports.frameAdvance[i][0];\n    for (var k = 0; k < 7; k++) {\n        tempBuffer[7 - k].lsX = inputBuffer[7 - k - pastOffset].lsX;\n        tempBuffer[7 - k].lsY = inputBuffer[7 - k - pastOffset].lsY;\n        tempBuffer[7 - k].rawX = inputBuffer[7 - k - pastOffset].rawX;\n        tempBuffer[7 - k].rawY = inputBuffer[7 - k - pastOffset].rawY;\n        tempBuffer[7 - k].csX = inputBuffer[7 - k - pastOffset].csX;\n        tempBuffer[7 - k].csY = inputBuffer[7 - k - pastOffset].csY;\n        tempBuffer[7 - k].rawcsX = inputBuffer[7 - k - pastOffset].rawcsX;\n        tempBuffer[7 - k].rawcsY = inputBuffer[7 - k - pastOffset].rawcsY;\n        tempBuffer[7 - k].lA = inputBuffer[7 - k - pastOffset].lA;\n        tempBuffer[7 - k].rA = inputBuffer[7 - k - pastOffset].rA;\n        tempBuffer[7 - k].a = inputBuffer[7 - k - pastOffset].a;\n        tempBuffer[7 - k].b = inputBuffer[7 - k - pastOffset].b;\n        tempBuffer[7 - k].x = inputBuffer[7 - k - pastOffset].x;\n        tempBuffer[7 - k].y = inputBuffer[7 - k - pastOffset].y;\n        tempBuffer[7 - k].r = inputBuffer[7 - k - pastOffset].r;\n        tempBuffer[7 - k].l = inputBuffer[7 - k - pastOffset].l;\n        tempBuffer[7 - k].dl = inputBuffer[7 - k - pastOffset].dl;\n        tempBuffer[7 - k].dd = inputBuffer[7 - k - pastOffset].dd;\n        tempBuffer[7 - k].dr = inputBuffer[7 - k - pastOffset].dr;\n        tempBuffer[7 - k].du = inputBuffer[7 - k - pastOffset].du;\n    }\n    if (exports.mType !== null) {\n        if ((exports.mType[i] === \"keyboard\" && (tempBuffer[0].z || tempBuffer[1].z))\n            || (exports.mType[i] !== \"keyboard\" && (tempBuffer[0].z && !tempBuffer[1].z))) {\n            exports.frameAdvance[i][0] = true;\n        }\n        else {\n            exports.frameAdvance[i][0] = false;\n        }\n    }\n    if (exports.frameAdvance[i][0] && !exports.frameAdvance[i][1] && !exports.playing && exports.gameMode !== 4) {\n        exports.frameByFrame = true;\n    }\n    if (exports.mType[i] === \"keyboard\") { // keyboard controls\n        if (tempBuffer[0].s || tempBuffer[1].s || (exports.gameMode === 5 && (tempBuffer[0].du || tempBuffer[1].du))) {\n            exports.pause[i][0] = true;\n        }\n        else {\n            exports.pause[i][0] = false;\n        }\n        if (!exports.playing && (exports.gameMode == 3 || exports.gameMode == 5)\n            && (tempBuffer[0].a || tempBuffer[1].a) && (tempBuffer[0].l || tempBuffer[1].l)\n            && (tempBuffer[0].r || tempBuffer[1].r) && (tempBuffer[0].s || tempBuffer[1].s)) {\n            if (tempBuffer[0].b || tempBuffer[1].b) {\n                startGame();\n            }\n            else {\n                endGame(inputBuffer);\n            }\n        }\n        interpretPause(exports.pause[i][0], exports.pause[i][1]);\n    }\n    else if (exports.mType[i] !== null) { // gamepad controls\n        if (!exports.playing && (exports.gameMode == 3 || exports.gameMode == 5) &&\n            (tempBuffer[0].a && tempBuffer[0].l && tempBuffer[0].r && tempBuffer[0].s)\n            && (!(tempBuffer[1].a && tempBuffer[1].l && tempBuffer[1].r && tempBuffer[1].s))) {\n            if (tempBuffer[0].b) {\n                startGame();\n            }\n            else {\n                endGame(inputBuffer);\n            }\n        }\n        if (tempBuffer[0].s || tempBuffer[0].du && exports.gameMode == 5) {\n            exports.pause[i][0] = true;\n        }\n        else {\n            exports.pause[i][0] = false;\n        }\n        // Controller reset functionality\n        if ((tempBuffer[0].z || tempBuffer[0].du) && tempBuffer[0].x && tempBuffer[0].y) {\n            exports.controllerResetCountdowns[i] -= 1;\n            if (exports.controllerResetCountdowns[i] === 0) {\n                // triggers code in input.js\n                console.log(\"Controller #\" + (i + 1) + \" was reset!\");\n                (0, jquery_1.default)(\"#resetIndicator\" + i).fadeIn(100);\n                (0, jquery_1.default)(\"#resetIndicator\" + i).fadeOut(500);\n            }\n        }\n        else {\n            exports.controllerResetCountdowns[i] = 125;\n        }\n        interpretPause(exports.pause[i][0], exports.pause[i][1]);\n    }\n    else { // AI\n        tempBuffer[0].rawX = tempBuffer[0].lsX;\n        tempBuffer[0].rawY = tempBuffer[0].lsY;\n        tempBuffer[0].rawcsX = tempBuffer[0].csX;\n        tempBuffer[0].rawcsY = tempBuffer[0].csY;\n        tempBuffer[0].lsX = (0, meleeInputs_1.deaden)(tempBuffer[0].rawX);\n        tempBuffer[0].lsY = (0, meleeInputs_1.deaden)(tempBuffer[0].rawY);\n        tempBuffer[0].csX = (0, meleeInputs_1.deaden)(tempBuffer[0].rawcsX);\n        tempBuffer[0].csY = (0, meleeInputs_1.deaden)(tempBuffer[0].rawcsY);\n    }\n    if (exports.showDebug) {\n        (0, jquery_1.default)(\"#lsAxisX\" + i).empty().append(tempBuffer[0].lsX.toFixed(3));\n        (0, jquery_1.default)(\"#lsAxisY\" + i).empty().append(tempBuffer[0].lsY.toFixed(3));\n        (0, jquery_1.default)(\"#csAxisX\" + i).empty().append(tempBuffer[0].csX.toFixed(3));\n        (0, jquery_1.default)(\"#csAxisY\" + i).empty().append(tempBuffer[0].csY.toFixed(3));\n        (0, jquery_1.default)(\"#lAnalog\" + i).empty().append(tempBuffer[0].lA.toFixed(3));\n        (0, jquery_1.default)(\"#rAnalog\" + i).empty().append(tempBuffer[0].rA.toFixed(3));\n        (0, drawGamepad_1.updateGamepadSVGState)(i, \"gamepadSVG\" + i, tempBuffer[0]);\n    }\n    if (exports.gameMode === 14) { // controller calibration screen\n        (0, drawGamepad_1.updateGamepadSVGState)(i, \"gamepadSVGCalibration\", tempBuffer[0]);\n    }\n    if (exports.showDebug || exports.gameMode === 14) {\n        const which = (exports.showDebug && exports.gameMode === 14) ? \"both\" : exports.showDebug ? \"debug\" : \"calibration\";\n        if (tempBuffer[0].x && !tempBuffer[1].x && tempBuffer[0].du) {\n            (0, drawGamepad_1.cycleGamepadColour)(i, which, true);\n        }\n        if (tempBuffer[0].y && !tempBuffer[1].y && tempBuffer[0].du) {\n            (0, drawGamepad_1.cycleGamepadColour)(i, which, false);\n        }\n    }\n    if (streamclient_1.giveInputs[i] === true) {\n        //turns out keyboards leave gaps in the input buffer\n        (0, deepCopyObject_1.deepObjectMerge)(true, (0, input_1.nullInput)(), tempBuffer[0]);\n        (0, streamclient_1.updateNetworkInputs)(tempBuffer[0], i);\n    }\n    if (active) {\n        if (tempBuffer[0].dl && !tempBuffer[1].dl) {\n            exports.player[i].showLedgeGrabBox ^= true;\n        }\n        if (tempBuffer[0].dd && !tempBuffer[1].dd) {\n            exports.player[i].showECB ^= true;\n        }\n        if (tempBuffer[0].dr && !tempBuffer[1].dr) {\n            exports.player[i].showHitbox ^= true;\n        }\n    }\n    if (exports.frameByFrame) {\n        tempBuffer[0].z = false;\n    }\n    return tempBuffer;\n}\nfunction interpretPause(pause0, pause1) {\n    if (pause0 && !pause1) {\n        if (exports.gameMode == 3 || exports.gameMode == 5) {\n            exports.playing ^= true;\n            if (!exports.playing) {\n                sfx_1.sounds.pause.play();\n                changeVolume(music_1.MusicManager, audiomenu_1.masterVolume[1] * 0.3, 1);\n                (0, render_1.renderForeground)();\n            }\n            else {\n                changeVolume(music_1.MusicManager, audiomenu_1.masterVolume[1], 1);\n            }\n        }\n    }\n}\nexports.bg1 = 0;\nexports.bg2 = 0;\nexports.fg1 = 0;\nexports.fg2 = 0;\nexports.ui = 0;\nexports.c = 0;\nexports.canvasMain = 0;\nexports.layers = {\n    BG1: null,\n    BG2: null,\n    FG1: null,\n    FG2: null,\n    UI: null\n};\nexports.layerSwitches = {\n    BG1: true,\n    BG2: true,\n    FG1: true,\n    FG2: true,\n    UI: true\n};\nfunction renderToMain() {\n    var keys = Object.keys(exports.layers);\n    for (var i = 0; i < keys.length; i++) {\n        if (exports.layerSwitches[keys[i]]) {\n            exports.c.drawImage(exports.layers[keys[i]], 0, 0);\n        }\n    }\n}\nfunction update(i, inputBuffers) {\n    if (!exports.starting) {\n        if (exports.currentPlayers[i] != -1) {\n            if (exports.playerType[i] == 0) {\n                // do nothing, use the provided player i inputs\n            }\n            else if (exports.playerType[i] === 1) {\n                if (exports.player[i].actionState != \"SLEEP\") {\n                    (0, ai_1.runAI)(i); // no need to return input since polling returns ai input if they are active\n                }\n            }\n        }\n    }\n    (0, physics_1.physics)(i, inputBuffers);\n}\nlet delta = 0;\nlet lastFrameTimeMs = 0;\nlet lastUpdate = performance.now();\nfunction gameTick(oldInputBuffers) {\n    var start = performance.now();\n    var diff = 0;\n    let input = [(0, input_1.nullInputs)(), (0, input_1.nullInputs)(), (0, input_1.nullInputs)(), (0, input_1.nullInputs)()];\n    if (exports.gameMode == 0 || exports.gameMode == 20) {\n        findPlayers();\n    }\n    else if (exports.gameMode == 1) {\n        //console.log(playerType);\n        for (var i = 0; i < exports.ports; i++) {\n            input[i] = interpretInputs(i, true, exports.playerType[i], oldInputBuffers[i]);\n            (0, menu_1.menuMove)(i, input);\n        }\n    }\n    else if (exports.gameMode == 10) {\n        for (var i = 0; i < exports.ports; i++) {\n            input[i] = interpretInputs(i, true, exports.playerType[i], oldInputBuffers[i]);\n            (0, audiomenu_1.audioMenuControls)(i, input);\n        }\n    }\n    else if (exports.gameMode == 11) {\n        for (var i = 0; i < exports.ports; i++) {\n            input[i] = interpretInputs(i, true, exports.playerType[i], oldInputBuffers[i]);\n            (0, gameplaymenu_1.gameplayMenuControls)(i, input);\n        }\n    }\n    else if (exports.gameMode == 12) {\n        for (var i = 0; i < exports.ports; i++) {\n            input[i] = interpretInputs(i, true, exports.playerType[i], oldInputBuffers[i]);\n            (0, keyboardmenu_1.keyboardMenuControls)(i, input);\n        }\n    }\n    else if (exports.gameMode == 13) {\n        //target\n    }\n    else if (exports.gameMode == 14) {\n        // controller calibration\n        input[exports.calibrationPlayer] = interpretInputs(exports.calibrationPlayer, true, exports.playerType[exports.calibrationPlayer], oldInputBuffers[exports.calibrationPlayer]);\n    }\n    else if (exports.gameMode == 15) {\n        for (var i = 0; i < exports.ports; i++) {\n            input[i] = interpretInputs(i, true, exports.playerType[i], oldInputBuffers[i]);\n            (0, menu_1.menuMove)(i, input);\n        }\n    }\n    else if (exports.gameMode == 2) {\n        for (var i = 0; i < 4; i++) {\n            if (i < exports.ports) {\n                input[i] = interpretInputs(i, true, exports.playerType[i], oldInputBuffers[i]);\n                (0, css_1.cssControls)(i, input);\n            }\n            actionStateShortcuts_1.actionStates[exports.characterSelections[i]][exports.player[i].actionState].main(i, input);\n        }\n        for (var i = 0; i < 4; i++) {\n            if (exports.playerType[i] > -1) {\n                (0, hitDetection_1.hitDetect)(i, input);\n            }\n        }\n        (0, hitDetection_1.executeHits)(input);\n        (0, hitDetection_1.resetHitQueue)();\n        findPlayers();\n    }\n    else if (exports.gameMode == 6) {\n        // stage select\n        for (var i = 0; i < 4; i++) {\n            if (i < exports.ports) {\n                input[i] = interpretInputs(i, true, exports.playerType[i], oldInputBuffers[i]);\n                (0, stageselect_1.sssControls)(i, input);\n            }\n        }\n    }\n    else if (exports.playing || exports.frameByFrame) {\n        //console.log(\"test0\");\n        /*delta = timestamp - lastFrameTimeMs; // get the delta time since last frame\n        lastFrameTimeMs = timestamp;\n        console.log(delta);*/\n        var now = performance.now();\n        var dt = now - lastUpdate;\n        //console.log(now);\n        //console.log(dt);\n        lastUpdate = now;\n        (0, hitDetection_1.resetHitQueue)();\n        (0, activeStage_1.getActiveStage)().movingPlatforms();\n        (0, article_1.destroyArticles)();\n        (0, article_1.executeArticles)();\n        for (var i = 0; i < 4; i++) {\n            if (exports.playerType[i] > -1) {\n                if (!exports.starting) {\n                    input[i] = interpretInputs(i, true, exports.playerType[i], oldInputBuffers[i]);\n                }\n                update(i, input);\n            }\n        }\n        (0, hitDetection_1.checkPhantoms)();\n        for (var i = 0; i < 4; i++) {\n            if (exports.playerType[i] > -1) {\n                (0, hitDetection_1.hitDetect)(i, input);\n            }\n        }\n        (0, hitDetection_1.executeHits)(input);\n        (0, article_1.articlesHitDetection)();\n        (0, article_1.executeArticleHits)(input);\n        if (!exports.starting && !exports.versusMode) {\n            matchTimerTick(input);\n        }\n        else {\n            exports.startTimer -= 0.01666667;\n            if (exports.startTimer < 0) {\n                exports.starting = false;\n            }\n        }\n        if (exports.frameByFrame) {\n            exports.frameByFrameRender = true;\n            exports.wasFrameByFrame = true;\n        }\n        exports.frameByFrame = false;\n        if (exports.showDebug) {\n            diff = performance.now() - start;\n            exports.gamelogicTime[0] += diff;\n            exports.gamelogicTime[0] /= 2;\n            if (diff >= 10) {\n                exports.gamelogicTime[3]++;\n            }\n            if (diff < exports.gamelogicTime[2]) {\n                exports.gamelogicTime[2] = diff;\n            }\n            if (diff > exports.gamelogicTime[1]) {\n                exports.gamelogicTime[1] = diff;\n            }\n            dom.gamelogicAvg.innerHTML = Math.round(exports.gamelogicTime[0]);\n            dom.gamelogicHigh.innerHTML = Math.round(exports.gamelogicTime[1]);\n            dom.gamelogicLow.innerHTML = Math.round(exports.gamelogicTime[2]);\n            dom.gamelogicPeak.innerHTML = exports.gamelogicTime[3];\n        }\n    }\n    else if (exports.findingPlayers) {\n        findPlayers();\n    }\n    else {\n        if (!exports.gameEnd) {\n            for (var i = 0; i < 4; i++) {\n                if (exports.playerType[i] == 0 || exports.playerType[i] == 2) {\n                    if (exports.currentPlayers[i] != -1) {\n                        input[i] = interpretInputs(i, false, exports.playerType[i], oldInputBuffers[i]);\n                    }\n                }\n            }\n        }\n    }\n    /*\n  \n    var beforeWaster = performance.now();\n    // neeed to waste 0.666ms\n    var timeWasted = false;\n    var t = 0;\n    var o = performance.now();\n    while(!timeWasted){\n      var n = performance.now();\n      t += n - o;\n      //console.log(t);\n      if (t > 0.6666){\n        timeWasted = true;\n      }\n      o = n;\n      //console.log(\".\");\n    }\n    //console.log(performance.now() - beforeWaster);*/\n    (0, replay_1.saveGameState)(input, exports.ports);\n    setTimeout(gameTick, 16, input);\n}\nfunction clearScreen() {\n    //bg1.fillStyle = \"rgb(0, 0, 0)\";\n    //bg1.fillRect(0,0,layers.BG1.width,layers.BG1.height);\n    exports.bg2.clearRect(0, 0, exports.layers.BG2.width, exports.layers.BG2.height);\n    //fg1.clearRect(0,0,layers.FG1.width,layers.FG1.height);\n    exports.fg2.clearRect(0, 0, exports.layers.FG2.width, exports.layers.FG2.height);\n    exports.ui.clearRect(0, 0, exports.layers.UI.width, exports.layers.UI.height);\n}\nlet otherFrame = true;\nlet fps30 = false;\nfunction renderTick() {\n    window.requestAnimationFrame(renderTick);\n    otherFrame ^= true;\n    if ((fps30 && otherFrame) || !fps30) {\n        //console.log(\"------\");\n        if (exports.gameMode == 20) {\n            (0, startup_1.drawStartUp)();\n        }\n        else if (exports.gameMode == 10) {\n            (0, audiomenu_1.drawAudioMenu)();\n        }\n        else if (exports.gameMode == 11) {\n            (0, gameplaymenu_1.drawGameplayMenu)();\n        }\n        else if (exports.gameMode == 12) {\n            (0, keyboardmenu_1.drawKeyboardMenu)();\n        }\n        else if (exports.gameMode == 13) {\n            drawCredits();\n        }\n        else if (exports.gameMode == 14) {\n            (0, controllermenu_1.drawControllerMenu)();\n        }\n        else if (exports.gameMode == 0) {\n            (0, startscreen_1.drawStartScreen)();\n        }\n        else if (exports.gameMode == 1) {\n            (0, menu_1.drawMainMenu)();\n        }\n        else if (exports.gameMode == 2) {\n            (0, css_1.drawCSS)();\n            //renderVfx();\n        }\n        else if (exports.gameMode == 6) {\n            (0, stageselect_1.drawSSS)();\n        }\n        else if (exports.playing || exports.frameByFrameRender) {\n            /*delta = timestamp - lastFrameTimeMs; // get the delta time since last frame\n            lastFrameTimeMs = timestamp;\n            console.log(delta);*/\n            //console.log(\"test2\");\n            var rStart = performance.now();\n            clearScreen();\n            if ((0, vfx_1.isShowSFX)()) {\n                (0, stagerender_1.drawBackground)();\n            }\n            (0, stagerender_1.drawStage)();\n            for (var i = 0; i < 4; i++) {\n                if (exports.playerType[i] > -1) {\n                    (0, render_1.renderPlayer)(i);\n                }\n            }\n            (0, article_1.renderArticles)();\n            (0, renderVfx_1.renderVfx)();\n            (0, render_1.renderOverlay)(true);\n            if (exports.showDebug) {\n                var diff = performance.now() - rStart;\n                exports.renderTime[0] += diff;\n                exports.renderTime[0] /= 2;\n                if (diff >= 10) {\n                    exports.renderTime[3]++;\n                }\n                if (diff > exports.renderTime[1]) {\n                    exports.renderTime[1] = diff;\n                }\n                if (diff < exports.renderTime[2]) {\n                    exports.renderTime[2] = diff;\n                }\n                dom.renderAvg.innerHTML = Math.round(exports.renderTime[0]);\n                dom.renderHigh.innerHTML = Math.round(exports.renderTime[1]);\n                dom.renderLow.innerHTML = Math.round(exports.renderTime[2]);\n                dom.renderPeak.innerHTML = exports.renderTime[3];\n            }\n        }\n        if (exports.frameByFrameRender) {\n            (0, render_1.renderForeground)();\n        }\n        exports.frameByFrameRender = false;\n        //renderToMain();\n        //console.log(performance.now());\n    }\n    else {\n        if (exports.playing) {\n            (0, renderVfx_1.renderVfx)(true);\n        }\n    }\n}\nfunction buildPlayerObject(i) {\n    exports.player[i] = new player_1.playerObject(exports.characterSelections[i], exports.startingPoint[i], exports.startingFace[i]);\n    exports.player[i].phys.ECB1 = [new Vec2D_1.Vec2D(exports.startingPoint[i].x, exports.startingPoint[i].y), new Vec2D_1.Vec2D(exports.startingPoint[i].x, exports.startingPoint[i].y), new Vec2D_1.Vec2D(exports.startingPoint[i].x, exports.startingPoint[i].y), new Vec2D_1.Vec2D(exports.startingPoint[i].x, exports.startingPoint[i].y)];\n    exports.player[i].phys.ECBp = [new Vec2D_1.Vec2D(exports.startingPoint[i].x, exports.startingPoint[i].y), new Vec2D_1.Vec2D(exports.startingPoint[i].x, exports.startingPoint[i].y), new Vec2D_1.Vec2D(exports.startingPoint[i].x, exports.startingPoint[i].y), new Vec2D_1.Vec2D(exports.startingPoint[i].x, exports.startingPoint[i].y)];\n    exports.player[i].difficulty = exports.cpuDifficulty[i];\n}\nfunction initializePlayers(i, target) {\n    buildPlayerObject(i);\n    if (target) {\n        (0, drawVfx_1.drawVfx)({\n            name: \"entrance\",\n            pos: new Vec2D_1.Vec2D(activeStage_1.activeStage.startingPoint[0].x, activeStage_1.activeStage.startingPoint[0].y)\n        });\n    }\n    else {\n        (0, drawVfx_1.drawVfx)({\n            name: \"entrance\",\n            pos: new Vec2D_1.Vec2D(exports.startingPoint[i][0], exports.startingPoint[i][1])\n        });\n    }\n}\nfunction startGame() {\n    (0, activeStage_1.setVsStage)(exports.stageSelect);\n    (0, stagerender_1.setBackgroundType)(Math.round(Math.random()));\n    changeGamemode(3);\n    (0, vfxQueue_1.resetVfxQueue)();\n    for (var n = 0; n < 4; n++) {\n        if (exports.playerType[n] > -1) {\n            initializePlayers(n, false);\n            (0, render_1.renderPlayer)(n);\n            exports.player[n].inCSS = false;\n        }\n        if (exports.versusMode) {\n            exports.player[n].stocks = 1;\n        }\n    }\n    exports.matchTimer = 480;\n    exports.startTimer = 1.5;\n    exports.starting = true;\n    music_1.MusicManager.stopWhatisPlaying();\n    switch (exports.stageSelect) {\n        case 0:\n            music_1.MusicManager.playBattleFieldLoop();\n            break;\n        case 1:\n            music_1.MusicManager.playyStoryLoop();\n            break;\n        case 2:\n            music_1.MusicManager.playpStadiumLoop();\n            break;\n        case 3:\n            music_1.MusicManager.playDreamLandLoop();\n            break;\n        case 4:\n            music_1.MusicManager.playfinaldLoop();\n            break;\n        case 5:\n            music_1.MusicManager.playfodLoop();\n            break;\n        default:\n            break;\n    }\n    (0, drawVfx_1.drawVfx)({\n        name: \"start\",\n        pos: new Vec2D_1.Vec2D(0, 0)\n    });\n    exports.findingPlayers = false;\n    exports.playing = true;\n}\nfunction endGame(input) {\n    exports.gameEnd = false;\n    (0, render_1.resetLostStockQueue)();\n    (0, hitDetection_1.setPhantonQueue)([]);\n    (0, article_1.resetAArticles)();\n    music_1.MusicManager.stopWhatisPlaying();\n    changeVolume(music_1.MusicManager, audiomenu_1.masterVolume[1], 1);\n    exports.playing = false;\n    clearScreen();\n    (0, stagerender_1.drawStage)();\n    (0, css_2.setTokenPosSnapToChar)(0);\n    (0, css_2.setTokenPosSnapToChar)(1);\n    (0, css_2.setTokenPosSnapToChar)(2);\n    (0, css_2.setTokenPosSnapToChar)(3);\n    if (exports.gameMode == 3) {\n        changeGamemode(2);\n        music_1.MusicManager.playMenuLoop();\n        exports.pause = [[true, true], [true, true], [true, true], [true, true]];\n        exports.frameAdvance = [\n            [true, true],\n            [true, true],\n            [true, true],\n            [true, true]\n        ];\n        exports.findingPlayers = true;\n        positionPlayersInCSS();\n        for (var i = 0; i < 4; i++) {\n            if (exports.playerType[i] > -1) {\n                if (exports.player[i].actionState == \"FURAFURA\") {\n                    sfx_1.sounds.furaloop.stop(exports.player[i].furaLoopID);\n                }\n                //input[i][0].a = true; // do\n                //input[i][1].a = true; // not\n                exports.player[i].inCSS = true;\n                exports.player[i].phys.face = 1;\n                exports.player[i].actionState = \"WAIT\";\n                exports.player[i].timer = 0;\n            }\n        }\n    }\n}\nfunction finishGame(input) {\n    exports.gameEnd = true;\n    exports.playing = false;\n    exports.fg2.save();\n    exports.fg2.textAlign = \"center\";\n    var text = \"Game!\";\n    var size = 300;\n    var textScale = 1;\n    var textGrad = exports.fg2.createLinearGradient(0, 200, 0, 520);\n    if (exports.matchTimer <= 0) {\n        text = \"Time!\";\n        sfx_1.sounds.time.play();\n        textGrad.addColorStop(0, \"black\");\n        textGrad.addColorStop(0.5, \"black\");\n        textGrad.addColorStop(0.7, \"rgb(21, 51, 180)\");\n        textGrad.addColorStop(1, \"rgb(71, 94, 250)\");\n    }\n    else {\n        sfx_1.sounds.game.play();\n        textGrad.addColorStop(0, \"black\");\n        textGrad.addColorStop(0.4, \"black\");\n        textGrad.addColorStop(0.7, \"rgb(167, 27, 40)\");\n        textGrad.addColorStop(1, \"rgb(255, 31, 52)\");\n    }\n    exports.fg2.scale(1, textScale);\n    exports.fg2.fillStyle = textGrad;\n    exports.fg2.lineWidth = 40;\n    exports.fg2.strokeStyle = \"black\";\n    exports.fg2.font = \"900 \" + size + \"px Arial\";\n    exports.fg2.strokeText(text, 600, 470 / textScale);\n    exports.fg2.lineWidth = 20;\n    exports.fg2.strokeStyle = \"white\";\n    exports.fg2.font = \"900 \" + size + \"px Arial\";\n    exports.fg2.strokeText(text, 600, 470 / textScale);\n    exports.fg2.font = \"900 \" + size + \"px Arial\";\n    exports.fg2.fillText(text, 600, 470 / textScale);\n    exports.fg2.restore();\n    music_1.MusicManager.stopWhatisPlaying();\n    setTimeout(function () {\n        endGame(input);\n    }, 2500);\n}\nfunction onFullScreenChange() {\n    var fullscreenElement = document.fullscreenElement || document.mozFullScreenElement || document.webkitFullscreenElement;\n    // if in fullscreen mode fullscreenElement won't be null\n    var cont = document.getElementById(\"topButtonContainer\");\n    var icn = document.querySelectorAll(\".topButton\");\n    if (fullscreenElement != null) {\n        cont.style.transition = \"opacity 0.5s linear 0s\";\n        cont.style.opacity = 0;\n        ;\n        setTimeout(function () {\n            var i;\n            for (i = 0; i < icn.length; i++) {\n                icn[i].style.height = \"5px\";\n            }\n            cont.style.height = \"5px\";\n            resize();\n        }, 500);\n        (0, jquery_1.default)(\"#keyboardPrompt\").hide();\n        (0, jquery_1.default)(\"#keyboardControlsImg\").hide();\n        (0, jquery_1.default)(\"#controllerSupportContainer\").hide();\n        (0, jquery_1.default)(\"#debugButtonEdit\").empty().append(\"OFF\");\n        (0, jquery_1.default)(\"#debug\").hide();\n        (0, jquery_1.default)(\"#players\").hide();\n        (0, jquery_1.default)(\"body\").css(\"overflow\", \"hidden\");\n        showHeader = false;\n    }\n    else {\n        var i;\n        for (i = 0; i < icn.length; i++) {\n            icn[i].style.height = \"25px\";\n        }\n        cont.style.height = \"31px\";\n        cont.style.transition = \"opacity 0.5s linear 0s\";\n        cont.style.opacity = 1;\n    }\n}\nfunction start() {\n    if (exports.holiday === 1) {\n        (0, jquery_1.default)(\"#layerButton\").after('<div id=\"snowButton\" class=\"gameButton\" style=\"width:90px\"><img src=\"assets/christmas/snowflake.png\" height=17 width=17 style=\"display:inline-block\"/><p style=\"width:30px;display:inline-block\"><span id=\"snowButtonEdit\">150</span></p><div id=\"snowMinus\" class=\"snowControl\" style=\"display:inline-block;padding:3px\"><p style=\"padding:0;font-size:20px\">-</p></div><div id=\"snowPlus\" style=\"display:inline-block;padding:3px\"><p style=\"padding:0;font-size:17px\">+</p></div></div>');\n    }\n    for (var i = 0; i < 4; i++) {\n        buildPlayerObject(i);\n        exports.player[i].phys.face = 1;\n        exports.player[i].actionState = \"WAIT\";\n    }\n    cacheDom();\n    (0, keyboardmenu_1.getKeyboardCookie)();\n    giveMedals();\n    (0, audiomenu_1.getAudioCookies)();\n    (0, gameplaymenu_1.getGameplayCookies)();\n    (0, jquery_1.default)(\"#keyboardButton\").click(function () {\n        (0, jquery_1.default)(\"#keyboardControlsImg\").toggle();\n        (0, jquery_1.default)(\"#keyboardPrompt\").hide();\n    });\n    (0, jquery_1.default)(\"#controllerButton\").click(function () {\n        (0, jquery_1.default)(\"#controllerSupportContainer\").toggle();\n    });\n    exports.layers.BG1 = document.getElementById(\"background1Canvas\");\n    exports.bg1 = exports.layers.BG1.getContext(\"2d\");\n    exports.layers.BG2 = document.getElementById(\"background2Canvas\");\n    exports.bg2 = exports.layers.BG2.getContext(\"2d\");\n    exports.layers.FG1 = document.getElementById(\"foreground1Canvas\");\n    exports.fg1 = exports.layers.FG1.getContext(\"2d\");\n    exports.layers.FG2 = document.getElementById(\"foreground2Canvas\");\n    exports.fg2 = exports.layers.FG2.getContext(\"2d\");\n    exports.layers.UI = document.getElementById(\"uiCanvas\");\n    exports.ui = exports.layers.UI.getContext(\"2d\");\n    exports.bg1.fillStyle = \"rgb(0, 0, 0)\";\n    exports.bg1.fillRect(0, 0, exports.layers.BG1.width, exports.layers.BG1.height);\n    let nullInputBuffers = [(0, input_1.nullInputs)(), (0, input_1.nullInputs)(), (0, input_1.nullInputs)(), (0, input_1.nullInputs)()];\n    gameTick(nullInputBuffers);\n    renderTick();\n    (0, jquery_1.default)(\"#effectsButton\").click(function () {\n        if ((0, vfx_1.isShowSFX)()) {\n            (0, jquery_1.default)(\"#effectsButtonEdit\").empty().append(\"OFF\");\n        }\n        else {\n            (0, jquery_1.default)(\"#effectsButtonEdit\").empty().append(\"ON\");\n        }\n        (0, vfx_1.toggleShowSFX)();\n    });\n    (0, jquery_1.default)(\"#fpsButton\").click(function () {\n        if (fps30) {\n            (0, jquery_1.default)(\"#fpsButtonEdit\").empty().append(\"60\");\n        }\n        else {\n            (0, jquery_1.default)(\"#fpsButtonEdit\").empty().append(\"30\");\n        }\n        fps30 ^= true;\n    });\n    (0, jquery_1.default)(\"#alphaButton\").click(function () {\n        if ((0, transparency_1.getTransparency)()) {\n            (0, jquery_1.default)(\"#alphaButtonEdit\").empty().append(\"OFF\");\n        }\n        else {\n            (0, jquery_1.default)(\"#alphaButtonEdit\").empty().append(\"ON\");\n        }\n        (0, transparency_1.toggleTransparency)();\n    });\n    (0, jquery_1.default)(\"#layerButton\").hover(function () {\n        (0, jquery_1.default)(\"#layerDropdown\").toggle();\n    });\n    (0, jquery_1.default)(\".layer\").click(function () {\n        var id = (0, jquery_1.default)(this).attr(\"id\");\n        switch (id) {\n            case \"layer1\":\n                exports.layerSwitches.BG1 ^= true;\n                (0, jquery_1.default)(\"#background1Canvas\").toggle();\n                break;\n            case \"layer2\":\n                exports.layerSwitches.BG2 ^= true;\n                (0, jquery_1.default)(\"#background2Canvas\").toggle();\n                break;\n            case \"layer3\":\n                exports.layerSwitches.FG1 ^= true;\n                (0, jquery_1.default)(\"#foreground1Canvas\").toggle();\n                break;\n            case \"layer4\":\n                exports.layerSwitches.FG2 ^= true;\n                (0, jquery_1.default)(\"#foreground2Canvas\").toggle();\n                break;\n            case \"layer5\":\n                exports.layerSwitches.UI ^= true;\n                (0, jquery_1.default)(\"#uiCanvas\").toggle();\n                break;\n            default:\n                break;\n        }\n        (0, jquery_1.default)(this).toggleClass(\"layerOn\");\n    });\n    (0, jquery_1.default)(\"#debugButton\").click(function () {\n        if (exports.showDebug) {\n            for (let i = 0; i < 4; i++) {\n                document.getElementById(\"gamepadSVG\" + i).style.display = \"none\";\n            }\n            (0, jquery_1.default)(\"#debugButtonEdit\").empty().append(\"OFF\");\n            (0, jquery_1.default)(\"#debug\").hide();\n            (0, jquery_1.default)(\"#players\").hide();\n            (0, jquery_1.default)(\"body\").css(\"overflow\", \"hidden\");\n            //var mY = Math.max(($(window).height()-750)/2,0);\n            //$(\"#display\").css(\"margin\",mY+\"px 0px 0px \"+mX+\"px\");\n        }\n        else {\n            for (let i = 0; i < 4; i++) {\n                if (exports.playerType[i] !== -1) {\n                    (0, drawGamepad_1.updateGamepadSVGColour)(i, \"gamepadSVG\" + i);\n                    document.getElementById(\"gamepadSVG\" + i).style.display = \"\";\n                }\n            }\n            (0, jquery_1.default)(\"#debugButtonEdit\").empty().append(\"ON\");\n            (0, jquery_1.default)(\"#debug\").show();\n            (0, jquery_1.default)(\"#players\").show();\n            (0, jquery_1.default)(\"body\").css(\"overflow\", \"scroll\");\n            //var mY = Math.max(($(window).height()-900)/2,0);\n            //$(\"#display\").css(\"margin\",mY+\" 0px 0px px \"+mX+\"px\");\n        }\n        exports.showDebug ^= true;\n        resize();\n    });\n    (0, jquery_1.default)(\"#hideButton\").click(function () {\n        (0, jquery_1.default)(\"#header\").toggle();\n        showHeader ^= true;\n        resize();\n    });\n    (0, jquery_1.default)(\"#fullscreenButton\").click(function () {\n        if ((document.fullScreenElement && document.fullScreenElement !== null) || (!document.mozFullScreen && !document.webkitIsFullScreen)) {\n            if (document.documentElement.requestFullScreen) {\n                document.documentElement.requestFullScreen();\n            }\n            else if (document.documentElement.mozRequestFullScreen) {\n                document.documentElement.mozRequestFullScreen();\n            }\n            else if (document.documentElement.webkitRequestFullScreen) {\n                document.documentElement.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT);\n            }\n        }\n        else {\n            if (document.cancelFullScreen) {\n                document.cancelFullScreen();\n            }\n            else if (document.mozCancelFullScreen) {\n                document.mozCancelFullScreen();\n            }\n            else if (document.webkitCancelFullScreen) {\n                document.webkitCancelFullScreen();\n            }\n        }\n        // resize();\n    });\n    document.addEventListener(\"fullscreenchange\", onFullScreenChange, false);\n    document.addEventListener(\"webkitfullscreenchange\", onFullScreenChange, false);\n    document.addEventListener(\"mozfullscreenchange\", onFullScreenChange, false);\n    (0, jquery_1.default)(\".topButton\").hover(function () {\n        (0, jquery_1.default)(this).children(\".buttonDetails\").toggle();\n    });\n    if (mobile === false) {\n        (0, jquery_1.default)(\".button\").hover(function () {\n            (0, jquery_1.default)(this).toggleClass(\"buttonhighlighted\");\n        });\n        (0, jquery_1.default)(\".socialmedia\").hover(function () {\n            (0, jquery_1.default)(this).toggleClass(\"socialmediahighlight\");\n        });\n        (0, jquery_1.default)(\".sugbtn\").hover(function () {\n            (0, jquery_1.default)(this).toggleClass(\"sugbtnhighlight\");\n        });\n    }\n    (0, jquery_1.default)(\"#appsButton\").hover(function () {\n        (0, jquery_1.default)(\"#appsDropdown\").show();\n    }, function () {\n        (0, jquery_1.default)(\"#appsDropdown\").hide();\n    });\n    if (exports.holiday === 1) {\n        (0, jquery_1.default)(\"#snowMinus\").click(function () {\n            exports.snowCount -= 20;\n            if (exports.snowCount < 0) {\n                exports.snowCount = 0;\n            }\n            (0, jquery_1.default)(\"#snowButtonEdit\").text(exports.snowCount);\n        });\n        (0, jquery_1.default)(\"#snowPlus\").click(function () {\n            exports.snowCount += 20;\n            if (exports.snowCount > 1200) {\n                exports.snowCount = 1200;\n            }\n            (0, jquery_1.default)(\"#snowButtonEdit\").text(exports.snowCount);\n        });\n    }\n    (0, jquery_1.default)(\"#replay\").change(function () {\n        // grab the first image in the FileList object and pass it to the function\n        (0, replay_1.loadReplay)(this.files[0]);\n    });\n    resize();\n}\nwindow.start = start;\nfunction customDeadzone() {\n    this.ls = new Vec2D_1.Vec2D(0, 0);\n    this.cs = new Vec2D_1.Vec2D(0, 0);\n    this.l = 0;\n    this.r = 0;\n}\nfunction addShine(val) {\n    exports.shine += val;\n}\nfunction setShine(val) {\n    exports.shine = val;\n}\nfunction setFindingPlayers(val) {\n    exports.findingPlayers = val;\n}\nfunction setPlaying(val) {\n    exports.playing = val;\n}\nfunction setCreditsPlayer(val) {\n    creditsPlayer = val;\n}\nfunction setCalibrationPlayer(val) {\n    exports.calibrationPlayer = val;\n}\nconst dom = {};\nfunction cacheDom() {\n    const elementIds = [\n        \"matchMinutes\",\n        \"matchSeconds\",\n        \"gamelogicAvg\",\n        \"gamelogicHigh\",\n        \"gamelogicLow\",\n        \"gamelogicPeak\",\n        \"renderAvg\",\n        \"renderHigh\",\n        \"renderLow\",\n        \"renderPeak\",\n    ];\n    elementIds.forEach((id) => {\n        dom[id] = document.getElementById(id);\n    });\n}\n;\nfunction setCS(index, val) {\n    exports.characterSelections[index] = val;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSSx1QkFBdUI7QUFDM0I7QUFDQSxvQkFBb0IsT0FBTztBQUMzQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVEsb0JBQW9CO0FBQzVCO0FBQ0EsMkNBQTJDO0FBQzNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBDQUEwQztBQUMxQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQ0FBbUM7QUFDbkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVksZUFBZTtBQUMzQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYLFdBQVc7QUFDWCxXQUFXO0FB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Q1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLFlBQVksaUJBQWlCO0FBQzdCO0FBQ0EsZ0JBQWdCLGlCQUFpQjtBQUNqQztBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0EsWUFBWSxpQkFBaUI7QUFDN0I7QUFDQSxnQkFBZ0IsaUJBQWlCO0FBQ2pDO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJLGFBQWE7QUFDakI7QUFDQTtBQUNBLElBQUksYUFBYTtBQUNqQjtBQUNBO0FBQ0EsSUFBSSxzQkFBc0I7QUFDMUI7QUFDQTtBQUNBLElBQUksZUFBZTtBQUNuQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSSx5QkFBeUI7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbWVsZWVsaWdodC8uL3NyYy9tYWluL21haW4udHM/MTNlMyJdLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcbnZhciBfX2ltcG9ydERlZmF1bHQgPSAodGhpcyAmJiB0aGlzLl9faW1wb3J0RGVmYXVsdCkgfHwgZnVuY3Rpb24gKG1vZCkge1xuICAgIHJldHVybiAobW9kICYmIG1vZC5fX2VzTW9kdWxlKSA/IG1vZCA6IHsgXCJkZWZhdWx0XCI6IG1vZCB9O1xufTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbmV4cG9ydHMuc3RhcnRpbmcgPSBleHBvcnRzLmJsYXN0em9uZSA9IGV4cG9ydHMuc3RhZ2VTZWxlY3QgPSBleHBvcnRzLnJlc3Bhd25Qb2ludHMgPSBleHBvcnRzLmVkZ2VPcmllbnRhdGlvbiA9IGV4cG9ydHMuZWRnZU9mZnNldCA9IGV4cG9ydHMuZWRnZXMgPSBleHBvcnRzLndhbGxzUiA9IGV4cG9ydHMud2FsbHNMID0gZXhwb3J0cy5wbGF0Zm9ybXMgPSBleHBvcnRzLmdyb3VuZCA9IGV4cG9ydHMuc3RhcnRpbmdGYWNlID0gZXhwb3J0cy5zdGFydGluZ1BvaW50ID0gZXhwb3J0cy5mcmFtZUFkdmFuY2UgPSBleHBvcnRzLnBhdXNlID0gZXhwb3J0cy5jb2xvdXJzID0gZXhwb3J0cy5jb3N0dW1lVGltZW91dCA9IGV4cG9ydHMucFBhbCA9IGV4cG9ydHMudGFnVGV4dCA9IGV4cG9ydHMuaGFzVGFnID0gZXhwb3J0cy5wYWxldHRlcyA9IGV4cG9ydHMucmFuZG9tVGFncyA9IGV4cG9ydHMudmVyc3VzTW9kZSA9IGV4cG9ydHMuZ2FtZU1vZGUgPSBleHBvcnRzLnNob3dEZWJ1ZyA9IGV4cG9ydHMuZmluZGluZ1BsYXllcnMgPSBleHBvcnRzLmZyYW1lQnlGcmFtZVJlbmRlciA9IGV4cG9ydHMud2FzRnJhbWVCeUZyYW1lID0gZXhwb3J0cy5mcmFtZUJ5RnJhbWUgPSBleHBvcnRzLnBsYXlpbmcgPSBleHBvcnRzLmFjdGl2ZVBvcnRzID0gZXhwb3J0cy5wb3J0cyA9IGV4cG9ydHMuY3B1RGlmZmljdWx0eSA9IGV4cG9ydHMucGxheWVyVHlwZSA9IGV4cG9ydHMucGxheWVyQW1vdW50ID0gZXhwb3J0cy5jdXJyZW50UGxheWVycyA9IGV4cG9ydHMubVR5cGUgPSBleHBvcnRzLmZpcnN0VGltZURldGVjdGVkID0gZXhwb3J0cy51c2luZ0N1c3RvbUNvbnRyb2xzID0gZXhwb3J0cy5jb250cm9sbGVyUmVzZXRDb3VudGRvd25zID0gZXhwb3J0cy5nYW1lRW5kID0gZXhwb3J0cy5jYWxpYnJhdGlvblBsYXllciA9IGV4cG9ydHMuc2hpbmUgPSBleHBvcnRzLmNoYXJhY3RlclNlbGVjdGlvbnMgPSBleHBvcnRzLmZyYW1lcmF0ZSA9IGV4cG9ydHMuZ2FtZWxvZ2ljVGltZSA9IGV4cG9ydHMucmVuZGVyVGltZSA9IGV4cG9ydHMucGxheWVyID0gZXhwb3J0cy5zbm93Q291bnQgPSBleHBvcnRzLmhvbGlkYXkgPSB2b2lkIDA7XG5leHBvcnRzLmxheWVyU3dpdGNoZXMgPSBleHBvcnRzLmxheWVycyA9IGV4cG9ydHMuY2FudmFzTWFpbiA9IGV4cG9ydHMuYyA9IGV4cG9ydHMudWkgPSBleHBvcnRzLmZnMiA9IGV4cG9ydHMuZmcxID0gZXhwb3J0cy5iZzIgPSBleHBvcnRzLmJnMSA9IGV4cG9ydHMua2V5QmluZGluZyA9IGV4cG9ydHMua2V5QmluZCA9IGV4cG9ydHMua2V5cyA9IGV4cG9ydHMudXNpbmdMb2NhbFN0b3JhZ2UgPSBleHBvcnRzLm1hdGNoVGltZXIgPSBleHBvcnRzLnN0YXJ0VGltZXIgPSB2b2lkIDA7XG5leHBvcnRzLnNldENvbnRyb2xsZXJSZXNldCA9IHNldENvbnRyb2xsZXJSZXNldDtcbmV4cG9ydHMuc2V0VXNpbmdDdXN0b21Db250cm9scyA9IHNldFVzaW5nQ3VzdG9tQ29udHJvbHM7XG5leHBvcnRzLnNldE10eXBlID0gc2V0TXR5cGU7XG5leHBvcnRzLnNldEN1cnJlbnRQbGF5ZXIgPSBzZXRDdXJyZW50UGxheWVyO1xuZXhwb3J0cy5zZXRUYWdUZXh0ID0gc2V0VGFnVGV4dDtcbmV4cG9ydHMuc2V0U3RhZ2VTZWxlY3QgPSBzZXRTdGFnZVNlbGVjdDtcbmV4cG9ydHMuc2V0U3RhcnRpbmcgPSBzZXRTdGFydGluZztcbmV4cG9ydHMuc2V0U3RhcnRUaW1lciA9IHNldFN0YXJ0VGltZXI7XG5leHBvcnRzLmdldFN0YXJ0VGltZXIgPSBnZXRTdGFydFRpbWVyO1xuZXhwb3J0cy5hZGRNYXRjaFRpbWVyID0gYWRkTWF0Y2hUaW1lcjtcbmV4cG9ydHMuc2V0TWF0Y2hUaW1lciA9IHNldE1hdGNoVGltZXI7XG5leHBvcnRzLmdldE1hdGNoVGltZXIgPSBnZXRNYXRjaFRpbWVyO1xuZXhwb3J0cy5zZXRDb29raWUgPSBzZXRDb29raWU7XG5leHBvcnRzLnNldFZlcnN1c01vZGUgPSBzZXRWZXJzdXNNb2RlO1xuZXhwb3J0cy5nZXRDb29raWUgPSBnZXRDb29raWU7XG5leHBvcnRzLnNldEtleUJpbmRpbmcgPSBzZXRLZXlCaW5kaW5nO1xuZXhwb3J0cy5vdmVycmlkZUtleWJvYXJkRXZlbnQgPSBvdmVycmlkZUtleWJvYXJkRXZlbnQ7XG5leHBvcnRzLmRpc2FibGVkRXZlbnRQcm9wYWdhdGlvbiA9IGRpc2FibGVkRXZlbnRQcm9wYWdhdGlvbjtcbmV4cG9ydHMuU1ZHID0gU1ZHO1xuZXhwb3J0cy5tYXRjaFRpbWVyVGljayA9IG1hdGNoVGltZXJUaWNrO1xuZXhwb3J0cy5zY3JlZW5TaGFrZSA9IHNjcmVlblNoYWtlO1xuZXhwb3J0cy5wZXJjZW50U2hha2UgPSBwZXJjZW50U2hha2U7XG5leHBvcnRzLmZpbmRQbGF5ZXJzID0gZmluZFBsYXllcnM7XG5leHBvcnRzLnNldFBsYXllclR5cGUgPSBzZXRQbGF5ZXJUeXBlO1xuZXhwb3J0cy5hZGRQbGF5ZXIgPSBhZGRQbGF5ZXI7XG5leHBvcnRzLnRvZ2dsZVBvcnQgPSB0b2dnbGVQb3J0O1xuZXhwb3J0cy5wb3NpdGlvblBsYXllcnNJbkNTUyA9IHBvc2l0aW9uUGxheWVyc0luQ1NTO1xuZXhwb3J0cy5jaGFuZ2VHYW1lbW9kZSA9IGNoYW5nZUdhbWVtb2RlO1xuZXhwb3J0cy5pbnRlcnByZXRJbnB1dHMgPSBpbnRlcnByZXRJbnB1dHM7XG5leHBvcnRzLnJlbmRlclRvTWFpbiA9IHJlbmRlclRvTWFpbjtcbmV4cG9ydHMudXBkYXRlID0gdXBkYXRlO1xuZXhwb3J0cy5nYW1lVGljayA9IGdhbWVUaWNrO1xuZXhwb3J0cy5jbGVhclNjcmVlbiA9IGNsZWFyU2NyZWVuO1xuZXhwb3J0cy5yZW5kZXJUaWNrID0gcmVuZGVyVGljaztcbmV4cG9ydHMuYnVpbGRQbGF5ZXJPYmplY3QgPSBidWlsZFBsYXllck9iamVjdDtcbmV4cG9ydHMuaW5pdGlhbGl6ZVBsYXllcnMgPSBpbml0aWFsaXplUGxheWVycztcbmV4cG9ydHMuc3RhcnRHYW1lID0gc3RhcnRHYW1lO1xuZXhwb3J0cy5lbmRHYW1lID0gZW5kR2FtZTtcbmV4cG9ydHMuZmluaXNoR2FtZSA9IGZpbmlzaEdhbWU7XG5leHBvcnRzLnN0YXJ0ID0gc3RhcnQ7XG5leHBvcnRzLmN1c3RvbURlYWR6b25lID0gY3VzdG9tRGVhZHpvbmU7XG5leHBvcnRzLmFkZFNoaW5lID0gYWRkU2hpbmU7XG5leHBvcnRzLnNldFNoaW5lID0gc2V0U2hpbmU7XG5leHBvcnRzLnNldEZpbmRpbmdQbGF5ZXJzID0gc2V0RmluZGluZ1BsYXllcnM7XG5leHBvcnRzLnNldFBsYXlpbmcgPSBzZXRQbGF5aW5nO1xuZXhwb3J0cy5zZXRDcmVkaXRzUGxheWVyID0gc2V0Q3JlZGl0c1BsYXllcjtcbmV4cG9ydHMuc2V0Q2FsaWJyYXRpb25QbGF5ZXIgPSBzZXRDYWxpYnJhdGlvblBsYXllcjtcbmV4cG9ydHMuY2FjaGVEb20gPSBjYWNoZURvbTtcbmV4cG9ydHMuc2V0Q1MgPSBzZXRDUztcbi8qIGVzbGludC1kaXNhYmxlICovXG5jb25zdCBjc3NfMSA9IHJlcXVpcmUoXCIuLi9tZW51cy9jc3NcIik7XG5jb25zdCBwbGF5ZXJfMSA9IHJlcXVpcmUoXCIuLi9tYWluL3BsYXllclwiKTtcbmNvbnN0IHNldHRpbmdzXzEgPSByZXF1aXJlKFwiLi4vc2V0dGluZ3NcIik7XG5jb25zdCBzdGFydHVwXzEgPSByZXF1aXJlKFwiLi4vbWVudXMvc3RhcnR1cFwiKTtcbmNvbnN0IG1lbnVfMSA9IHJlcXVpcmUoXCIuLi9tZW51cy9tZW51XCIpO1xuY29uc3Qgc2Z4XzEgPSByZXF1aXJlKFwiLi4vbWFpbi9zZnhcIik7XG5jb25zdCBzdGFydHNjcmVlbl8xID0gcmVxdWlyZShcIi4uL21lbnVzL3N0YXJ0c2NyZWVuXCIpO1xuY29uc3Qgc3RhZ2VyZW5kZXJfMSA9IHJlcXVpcmUoXCIuLi9zdGFnZXMvc3RhZ2VyZW5kZXJcIik7XG5jb25zdCBzdGFnZXNlbGVjdF8xID0gcmVxdWlyZShcIi4uL21lbnVzL3N0YWdlc2VsZWN0XCIpO1xuY29uc3QgYXVkaW9tZW51XzEgPSByZXF1aXJlKFwiLi4vbWVudXMvYXVkaW9tZW51XCIpO1xuY29uc3QgZ2FtZXBsYXltZW51XzEgPSByZXF1aXJlKFwiLi4vbWVudXMvZ2FtZXBsYXltZW51XCIpO1xuY29uc3Qga2V5Ym9hcmRtZW51XzEgPSByZXF1aXJlKFwiLi4vbWVudXMva2V5Ym9hcmRtZW51XCIpO1xuY29uc3QgY29udHJvbGxlcm1lbnVfMSA9IHJlcXVpcmUoXCIuLi9tZW51cy9jb250cm9sbGVybWVudVwiKTtcbmNvbnN0IHJlbmRlcl8xID0gcmVxdWlyZShcIi4uL21haW4vcmVuZGVyXCIpO1xuY29uc3QgYWN0aW9uU3RhdGVTaG9ydGN1dHNfMSA9IHJlcXVpcmUoXCIuLi9waHlzaWNzL2FjdGlvblN0YXRlU2hvcnRjdXRzXCIpO1xuY29uc3QgaGl0RGV0ZWN0aW9uXzEgPSByZXF1aXJlKFwiLi4vcGh5c2ljcy9oaXREZXRlY3Rpb25cIik7XG5jb25zdCBhcnRpY2xlXzEgPSByZXF1aXJlKFwiLi4vcGh5c2ljcy9hcnRpY2xlXCIpO1xuY29uc3QgYWlfMSA9IHJlcXVpcmUoXCIuLi9tYWluL2FpXCIpO1xuY29uc3QgcGh5c2ljc18xID0gcmVxdWlyZShcIi4uL3BoeXNpY3MvcGh5c2ljc1wiKTtcbmNvbnN0IGpxdWVyeV8xID0gX19pbXBvcnREZWZhdWx0KHJlcXVpcmUoXCJqcXVlcnlcIikpO1xuY29uc3QgdHJhbnNwYXJlbmN5XzEgPSByZXF1aXJlKFwiLi4vbWFpbi92ZngvdHJhbnNwYXJlbmN5XCIpO1xuY29uc3QgZHJhd1ZmeF8xID0gcmVxdWlyZShcIi4uL21haW4vdmZ4L2RyYXdWZnhcIik7XG5jb25zdCB2ZnhRdWV1ZV8xID0gcmVxdWlyZShcIi4uL21haW4vdmZ4L3ZmeFF1ZXVlXCIpO1xuY29uc3QgYWN0aXZlU3RhZ2VfMSA9IHJlcXVpcmUoXCIuLi9zdGFnZXMvYWN0aXZlU3RhZ2VcIik7XG5jb25zdCBtdXNpY18xID0gcmVxdWlyZShcIi4vbXVzaWNcIik7XG5jb25zdCB2ZnhfMSA9IHJlcXVpcmUoXCIuLi9tYWluL3ZmeFwiKTtcbmNvbnN0IHJlbmRlclZmeF8xID0gcmVxdWlyZShcIi4vdmZ4L3JlbmRlclZmeFwiKTtcbmNvbnN0IEJveDJEXzEgPSByZXF1aXJlKFwiLi91dGlsL0JveDJEXCIpO1xuY29uc3QgVmVjMkRfMSA9IHJlcXVpcmUoXCIuL3V0aWwvVmVjMkRcIik7XG5jb25zdCBzdHJlYW1jbGllbnRfMSA9IHJlcXVpcmUoXCIuL211bHRpcGxheWVyL3N0cmVhbWNsaWVudFwiKTtcbmNvbnN0IHJlcGxheV8xID0gcmVxdWlyZShcIi4vcmVwbGF5XCIpO1xuY29uc3QgaW5wdXRfMSA9IHJlcXVpcmUoXCIuLi9pbnB1dC9pbnB1dFwiKTtcbmNvbnN0IG1lbGVlSW5wdXRzXzEgPSByZXF1aXJlKFwiLi4vaW5wdXQvbWVsZWVJbnB1dHNcIik7XG5jb25zdCBmaW5kR2FtZXBhZEluZm9fMSA9IHJlcXVpcmUoXCIuLi9pbnB1dC9nYW1lcGFkL2ZpbmRHYW1lcGFkSW5mb1wiKTtcbmNvbnN0IGN1c3RvbV8xID0gcmVxdWlyZShcIi4uL2lucHV0L2dhbWVwYWQvZ2FtZXBhZHMvY3VzdG9tXCIpO1xuY29uc3QgcmV0cmlldmVHYW1lcGFkSW5wdXRzXzEgPSByZXF1aXJlKFwiLi4vaW5wdXQvZ2FtZXBhZC9yZXRyaWV2ZUdhbWVwYWRJbnB1dHNcIik7XG5jb25zdCBkcmF3R2FtZXBhZF8xID0gcmVxdWlyZShcIi4uL2lucHV0L2dhbWVwYWQvZHJhd0dhbWVwYWRcIik7XG5jb25zdCBkZWVwQ29weU9iamVjdF8xID0gcmVxdWlyZShcIi4vdXRpbC9kZWVwQ29weU9iamVjdFwiKTtcbmNvbnN0IGNzc18yID0gcmVxdWlyZShcIi4uL21lbnVzL2Nzc1wiKTtcbi8qZ2xvYmFscyBwZXJmb3JtYW5jZSovXG5leHBvcnRzLmhvbGlkYXkgPSAwO1xuZXhwb3J0cy5zbm93Q291bnQgPSAxNTA7XG4vL3RvZG8gZmluZCAnUGxheWVyJyBvYmplY3RcbmV4cG9ydHMucGxheWVyID0gWzAsIDAsIDAsIDBdO1xuZXhwb3J0cy5yZW5kZXJUaW1lID0gWzEwLCAwLCAxMDAsIDBdO1xuZXhwb3J0cy5nYW1lbG9naWNUaW1lID0gWzUsIDAsIDEwMCwgMF07XG5leHBvcnRzLmZyYW1lcmF0ZSA9IFswLCAwLCAwXTtcbmV4cG9ydHMuY2hhcmFjdGVyU2VsZWN0aW9ucyA9IFswLCAwLCAwLCAwXTtcbmV4cG9ydHMuc2hpbmUgPSAwLjU7XG5leHBvcnRzLmNhbGlicmF0aW9uUGxheWVyID0gMDtcbmV4cG9ydHMuZ2FtZUVuZCA9IGZhbHNlO1xuZXhwb3J0cy5jb250cm9sbGVyUmVzZXRDb3VudGRvd25zID0gWzAsIDAsIDAsIDBdO1xuZnVuY3Rpb24gc2V0Q29udHJvbGxlclJlc2V0KGkpIHtcbiAgICBleHBvcnRzLmNvbnRyb2xsZXJSZXNldENvdW50ZG93bnNbaV0gPSAwO1xufVxubGV0IGtleWJvYXJkT2NjdXBpZWQgPSBmYWxzZTtcbmV4cG9ydHMudXNpbmdDdXN0b21Db250cm9scyA9IFtmYWxzZSwgZmFsc2UsIGZhbHNlLCBmYWxzZV07XG5mdW5jdGlvbiBzZXRVc2luZ0N1c3RvbUNvbnRyb2xzKGksIGJvb2xlYW4sIGluZm8pIHtcbiAgICBleHBvcnRzLnVzaW5nQ3VzdG9tQ29udHJvbHNbaV0gPSBib29sZWFuO1xuICAgIGlmIChib29sKSB7XG4gICAgICAgIGV4cG9ydHMubVR5cGVbaV0gPSBjdXN0b21fMS5jdXN0b21HYW1lcGFkSW5mb1tleHBvcnRzLmN1cnJlbnRQbGF5ZXJzW2ldXTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGV4cG9ydHMubVR5cGVbaV0gPSBpbmZvO1xuICAgIH1cbn1cbmV4cG9ydHMuZmlyc3RUaW1lRGV0ZWN0ZWQgPSBbdHJ1ZSwgdHJ1ZSwgdHJ1ZSwgdHJ1ZV07XG53aW5kb3cubVR5cGUgPSBbbnVsbCwgbnVsbCwgbnVsbCwgbnVsbF07XG5leHBvcnRzLm1UeXBlID0gW251bGwsIG51bGwsIG51bGwsIG51bGxdO1xuZnVuY3Rpb24gc2V0TXR5cGUoaW5kZXgsIHZhbCkge1xuICAgIGV4cG9ydHMubVR5cGVbaW5kZXhdID0gdmFsO1xufVxuZXhwb3J0cy5jdXJyZW50UGxheWVycyA9IFtdO1xuZnVuY3Rpb24gc2V0Q3VycmVudFBsYXllcihpbmRleCwgdmFsKSB7XG4gICAgZXhwb3J0cy5jdXJyZW50UGxheWVyc1tpbmRleF0gPSB2YWw7XG59XG5leHBvcnRzLnBsYXllckFtb3VudCA9IDA7XG5leHBvcnRzLnBsYXllclR5cGUgPSBbLTEsIC0xLCAtMSwgLTFdO1xuZXhwb3J0cy5jcHVEaWZmaWN1bHR5ID0gWzMsIDMsIDMsIDNdO1xuZXhwb3J0cy5wb3J0cyA9IDA7XG5leHBvcnRzLmFjdGl2ZVBvcnRzID0gW107XG5leHBvcnRzLnBsYXlpbmcgPSBmYWxzZTtcbmV4cG9ydHMuZnJhbWVCeUZyYW1lID0gZmFsc2U7XG5leHBvcnRzLndhc0ZyYW1lQnlGcmFtZSA9IGZhbHNlO1xuZXhwb3J0cy5mcmFtZUJ5RnJhbWVSZW5kZXIgPSBmYWxzZTtcbmV4cG9ydHMuZmluZGluZ1BsYXllcnMgPSB0cnVlO1xuZXhwb3J0cy5zaG93RGVidWcgPSBmYWxzZTtcbmV4cG9ydHMuZ2FtZU1vZGUgPSAyMDtcbi8vIDIwOlN0YXJ0dXBcbi8vIDEzOkRhdGEgTWVudVxuLy8gMTI6S2V5Ym9hcmQgQ29udHJvbHNcbi8vIDExOkdhbWVwbGF5IE1lbnVcbi8vIDEwOlNvdW5kIE1lbnVcbi8vIDk6IC1cbi8vIDg6IC1cbi8vIDc6VGFyZ2V0IFNlbGVjdFxuLy8gNjpTdGFnZSBTZWxlY3QgKFZTKVxuLy8gNTpUYXJnZXQgUGxheWluZ1xuLy8gNDpUYXJnZXQgQnVpbGRlclxuLy8gMzpQbGF5aW5nIChWUylcbi8vIDI6Q1NTXG4vLyAxOk1haW4gTWVudVxuLy8gMDpUaXRsZSBTY3JlZW5cbmV4cG9ydHMudmVyc3VzTW9kZSA9IDA7XG5leHBvcnRzLnJhbmRvbVRhZ3MgPSBbXCJORU8hXCIsIFwiU0VMRlwiLCBcIk5PVkFcIiwgXCJQTkRBXCIsIFwiUGFuZGFcIiwgXCJMRkZOXCIsIFwiU2NvcnBcIiwgXCJBWlwiLCBcIkFYRVwiLCBcIlRlbXBvXCIsIFwiVE1QT1wiLCBcIltBXXJtYWRhXCIsIFwiV0JBTExaXCIsIFwiV2VzdGJhbGx6XCIsIFwiUFBNRFwiLCBcIktyZXlnYXNtXCIsIFwiTTJLXCIsIFwiTWFuZzBcIiwgXCJVU0FcIiwgXCJTQ0FSXCIsIFwiVE9QSFwiLCBcIiguWS4pXCIsIFwiSEJPWFwiLCBcIkh1bmdyeUJveFwiLCBcIlBMVVBcIiwgXCJTaHJvb21lZFwiLCBcIlNGQVRcIiwgXCJXaXp6XCIsIFwiTHVja3lcIiwgXCJTMkpcIiwgXCJTaWxlbnRXb2xmXCIsIFwiYU1TYVwiLCBcIlMySlwiLCBcIkhheCRcIl07XG5leHBvcnRzLnBhbGV0dGVzID0gW1tcInJnYigyNTAsIDg5LCA4OSlcIiwgXCJyZ2IoMjU1LCAxNzAsIDE3MClcIiwgXCJyZ2JhKDI1NSwgMjA2LCAxMTEsIFwiLCBcInJnYigyNDQsIDY4LCA2OClcIiwgXCJyZ2JhKDI1NSwgMjI1LCAxNjcsIFwiXSxcbiAgICBbXCJyZ2IoOTUsIDIxNiwgODQpXCIsIFwicmdiKDE4NCwgMjUzLCAxNTQpXCIsIFwicmdiYSgyNTIsIDk1LCA5NSwgXCIsIFwicmdiKDI1NSwgMTgyLCA5NilcIiwgXCJyZ2JhKDI1NCwgMTQxLCAxNDEsIFwiXSxcbiAgICBbXCJyZ2IoNSwgMTk1LCAyNTUpXCIsIFwicmdiKDEyMSwgMjIzLCAyNTUpXCIsIFwicmdiYSgyMTgsIDk2LCAyNTQsIFwiLCBcInJnYigyMzEsIDEzNCwgMjU1KVwiLCBcInJnYmEoMjMwLCAxNDQsIDI1NSwgXCJdLFxuICAgIFtcInJnYigyNTUsIDE4NywgNzApXCIsIFwicmdiKDI0OCwgMjU1LCAxMjIpXCIsIFwicmdiYSg4MCwgMTgyLCAyNTUsIFwiLCBcInJnYigyNTUsIDE0MiwgNzApXCIsIFwicmdiYSgxMzksIDIwMywgMjQ5LCBcIl0sXG4gICAgW1wicmdiKDE3NywgODksIDI1NSlcIiwgXCJyZ2IoMjAzLCAxNDQsIDI1NSlcIiwgXCJyZ2JhKDE0NCwgMjU1LCAxMTAsIFwiLCBcInJnYigyNDcsIDEyNiwgMjUwKVwiLCBcInJnYmEoMTkwLCAyNTUsIDE3MCwgXCJdLFxuICAgIFtcInJnYigxODIsIDEzMSwgNzApXCIsIFwicmdiKDI1MiwgMTk0LCAxMjYpXCIsIFwicmdiYSg0NywgMTg2LCAxMjMsIFwiLCBcInJnYigyNTUsIDExMiwgNjYpXCIsIFwicmdiYSgxMTEsIDIxNCwgMTY4LCBcIl0sXG4gICAgW1wicmdiKDIzMiwgMjMyLCAyMDgpXCIsIFwicmdiKDI1NSwgMjU1LCAyNTUpXCIsIFwicmdiYSgyNDQsIDI1NSwgMTEyLCBcIiwgXCJyZ2IoMTkxLCAxMTksIDExOSlcIiwgXCJyZ2JhKDI1NSwgMjU1LCAyMDAsIFwiXV07XG5leHBvcnRzLmhhc1RhZyA9IFtmYWxzZSwgZmFsc2UsIGZhbHNlLCBmYWxzZV07XG5leHBvcnRzLnRhZ1RleHQgPSBbXCJcIiwgXCJcIiwgXCJcIiwgXCJcIl07XG5mdW5jdGlvbiBzZXRUYWdUZXh0KGluZGV4LCB2YWx1ZSkge1xuICAgIGV4cG9ydHMudGFnVGV4dFtpbmRleF0gPSB2YWx1ZTtcbiAgICBleHBvcnRzLmhhc1RhZ1tpbmRleF0gPSB0cnVlO1xufVxuZXhwb3J0cy5wUGFsID0gWzAsIDEsIDIsIDNdO1xuZXhwb3J0cy5jb3N0dW1lVGltZW91dCA9IFtdO1xuZXhwb3J0cy5jb2xvdXJzID0gW1wicmdiYSg0LCAyNTUsIDgyLCAwLjYyKVwiLCBcInJnYmEoMTE3LCAyMCwgMjU1LCAwLjYzKVwiLCBcInJnYmEoMjU1LCAyMCwgMjAsIDAuNjMpXCIsIFwicmdiYSgyNTUsIDIzMiwgMjAsIDAuNjMpXCJdO1xuZXhwb3J0cy5wYXVzZSA9IFtbdHJ1ZSwgdHJ1ZV0sIFt0cnVlLCB0cnVlXSwgW3RydWUsIHRydWVdLCBbdHJ1ZSwgdHJ1ZV1dO1xuZXhwb3J0cy5mcmFtZUFkdmFuY2UgPSBbW3RydWUsIHRydWVdLCBbdHJ1ZSwgdHJ1ZV0sIFt0cnVlLCB0cnVlXSwgW3RydWUsIHRydWVdXTtcbmV4cG9ydHMuc3RhcnRpbmdQb2ludCA9IFtbLTUwLCA1MF0sIFs1MCwgNTBdLCBbLTI1LCA1XSwgWzI1LCA1XV07XG5leHBvcnRzLnN0YXJ0aW5nRmFjZSA9IFsxLCAtMSwgMSwgLTFdO1xuZXhwb3J0cy5ncm91bmQgPSBbWy02OC40LCAwXSwgWzY4LjQsIDBdXTtcbmV4cG9ydHMucGxhdGZvcm1zID0gW1tbLTU3LjYsIDI3LjJdLCBbLTIwLCAyNy4yXV0sIFtbMjAsIDI3LjJdLCBbNTcuNiwgMjcuMl1dLCBbWy0xOC44LCA1NC40XSwgWzE4LjgsIDU0LjRdXV07XG5leHBvcnRzLndhbGxzTCA9IFtbWy02OC40LCAwXSwgWy02OC40LCAtMTA4LjhdXV07XG5leHBvcnRzLndhbGxzUiA9IFtbWzY4LjQsIDBdLCBbNjguNCwgLTEwOC44XV1dO1xuZXhwb3J0cy5lZGdlcyA9IFtbWy02OC40LCAwXSwgWy02My40LCAwXV0sIFtbNjguNCwgMF0sIFs2My40LCAwXV1dO1xuLy9lZGdlT2Zmc2V0ID0gW1stNzEuMywtMjMuN10sWzcxLjMsLTIzLjddXTtcbmV4cG9ydHMuZWRnZU9mZnNldCA9IFtbLTIuOSwgLTIzLjddLCBbMi45LCAtMjMuN11dO1xuZXhwb3J0cy5lZGdlT3JpZW50YXRpb24gPSBbMSwgLTFdO1xuZXhwb3J0cy5yZXNwYXduUG9pbnRzID0gW1stNTAsIDUwLCAxXSwgWzUwLCA1MCwgLTFdLCBbMjUsIDM1LCAxXSwgWy0yNSwgMzUsIC0xXV07XG5leHBvcnRzLnN0YWdlU2VsZWN0ID0gMDtcbmZ1bmN0aW9uIHNldFN0YWdlU2VsZWN0KHZhbCkge1xuICAgIGV4cG9ydHMuc3RhZ2VTZWxlY3QgPSB2YWw7XG59XG5leHBvcnRzLmJsYXN0em9uZSA9IG5ldyBCb3gyRF8xLkJveDJEKFstMjI0LCAyMDBdLCBbMjI0LCAtMTA4LjhdKTtcbmV4cG9ydHMuc3RhcnRpbmcgPSB0cnVlO1xuZnVuY3Rpb24gc2V0U3RhcnRpbmcodmFsKSB7XG4gICAgZXhwb3J0cy5zdGFydGluZyA9IHZhbDtcbn1cbmV4cG9ydHMuc3RhcnRUaW1lciA9IDEuNTtcbmZ1bmN0aW9uIHNldFN0YXJ0VGltZXIodmFsKSB7XG4gICAgZXhwb3J0cy5zdGFydFRpbWVyID0gdmFsO1xufVxuZnVuY3Rpb24gZ2V0U3RhcnRUaW1lcigpIHtcbiAgICByZXR1cm4gZXhwb3J0cy5zdGFydFRpbWVyO1xufVxuLy9tYXRjaFRpbWVyID0gNTk5OS45OTtcbmV4cG9ydHMubWF0Y2hUaW1lciA9IDQ4MDtcbmZ1bmN0aW9uIGFkZE1hdGNoVGltZXIodmFsKSB7XG4gICAgZXhwb3J0cy5tYXRjaFRpbWVyICs9IHZhbDtcbn1cbmZ1bmN0aW9uIHNldE1hdGNoVGltZXIodmFsKSB7XG4gICAgZXhwb3J0cy5tYXRjaFRpbWVyID0gdmFsO1xufVxuZnVuY3Rpb24gZ2V0TWF0Y2hUaW1lcigpIHtcbiAgICByZXR1cm4gZXhwb3J0cy5tYXRjaFRpbWVyO1xufVxuZXhwb3J0cy51c2luZ0xvY2FsU3RvcmFnZSA9IGZhbHNlO1xuaWYgKHR5cGVvZiAoU3RvcmFnZSkgIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAvLyBDb2RlIGZvciBsb2NhbFN0b3JhZ2Uvc2Vzc2lvblN0b3JhZ2UuXG4gICAgZXhwb3J0cy51c2luZ0xvY2FsU3RvcmFnZSA9IHRydWU7XG4gICAgY29uc29sZS5sb2coXCJsb2NhbCBzdG9yYWdlIHdvcmtzXCIpO1xufVxuZWxzZSB7XG4gICAgLy8gU29ycnkhIE5vIFdlYiBTdG9yYWdlIHN1cHBvcnQuLlxuICAgIGNvbnNvbGUubG9nKFwibG9jYWwgc3RvcmFnZSBkb2VzIG5vdCB3b3JrXCIpO1xufVxuZnVuY3Rpb24gc2V0Q29va2llKGNuYW1lLCBjdmFsdWUsIGV4ZGF5cykge1xuICAgIHZhciBkID0gbmV3IERhdGUoKTtcbiAgICBkLnNldFRpbWUoZC5nZXRUaW1lKCkgKyAoZXhkYXlzICogMjQgKiA2MCAqIDYwICogMTAwMCkpO1xuICAgIHZhciBleHAgPSBcImV4cGlyZXM9XCIgKyBkLnRvVVRDU3RyaW5nKCk7XG4gICAgZG9jdW1lbnQuY29va2llID0gY25hbWUgKyBcIj1cIiArIGN2YWx1ZSArIFwiOyBcIiArIGV4cDtcbiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShjbmFtZSwgY3ZhbHVlKTtcbn1cbmZ1bmN0aW9uIHNldFZlcnN1c01vZGUodmFsKSB7XG4gICAgZXhwb3J0cy52ZXJzdXNNb2RlID0gdmFsO1xufVxuZnVuY3Rpb24gZ2V0Q29va2llKGNuYW1lKSB7XG4gICAgaWYgKGV4cG9ydHMudXNpbmdMb2NhbFN0b3JhZ2UpIHtcbiAgICAgICAgcmV0dXJuIGxvY2FsU3RvcmFnZS5nZXRJdGVtKGNuYW1lKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHZhciBuYW1lID0gY25hbWUgKyBcIj1cIjtcbiAgICAgICAgdmFyIGNhID0gZG9jdW1lbnQuY29va2llLnNwbGl0KCc7Jyk7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2EubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBjID0gY2FbaV07XG4gICAgICAgICAgICB3aGlsZSAoYy5jaGFyQXQoMCkgPT0gJyAnKVxuICAgICAgICAgICAgICAgIGMgPSBjLnN1YnN0cmluZygxKTtcbiAgICAgICAgICAgIGlmIChjLmluZGV4T2YobmFtZSkgPT0gMClcbiAgICAgICAgICAgICAgICByZXR1cm4gYy5zdWJzdHJpbmcobmFtZS5sZW5ndGgsIGMubGVuZ3RoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gXCJcIjtcbiAgICB9XG59XG5leHBvcnRzLmtleXMgPSB7fTtcbmV4cG9ydHMua2V5QmluZCA9IDA7XG5leHBvcnRzLmtleUJpbmRpbmcgPSBmYWxzZTtcbmZ1bmN0aW9uIHNldEtleUJpbmRpbmcodmFsKSB7XG4gICAgZXhwb3J0cy5rZXlCaW5kaW5nID0gdmFsO1xufVxuZnVuY3Rpb24gb3ZlcnJpZGVLZXlib2FyZEV2ZW50KGUpIHtcbiAgICBpZiAoIXNob3dpbmdDb2RlICYmIGNzc18xLmNob29zaW5nVGFnID09IC0xICYmIGUua2V5Q29kZSAhPSAxMjIgJiYgZS5rZXlDb2RlICE9IDExNikge1xuICAgICAgICBzd2l0Y2ggKGUudHlwZSkge1xuICAgICAgICAgICAgY2FzZSBcImtleWRvd25cIjpcbiAgICAgICAgICAgICAgICBpZiAoIWV4cG9ydHMua2V5c1tlLmtleUNvZGVdKSB7XG4gICAgICAgICAgICAgICAgICAgIGV4cG9ydHMua2V5c1tlLmtleUNvZGVdID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgZXhwb3J0cy5rZXlCaW5kID0gZS5rZXlDb2RlO1xuICAgICAgICAgICAgICAgICAgICBleHBvcnRzLmtleUJpbmRpbmcgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAvLyBkbyBrZXkgZG93biBzdHVmZiBoZXJlXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcImtleXVwXCI6XG4gICAgICAgICAgICAgICAgZGVsZXRlIChleHBvcnRzLmtleXNbZS5rZXlDb2RlXSk7XG4gICAgICAgICAgICAgICAgLy8gZG8ga2V5IHVwIHN0dWZmIGhlcmVcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICBkaXNhYmxlZEV2ZW50UHJvcGFnYXRpb24oZSk7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgaWYgKGNzc18xLmNob29zaW5nVGFnID4gLTEpIHtcbiAgICAgICAgICAgIGlmIChlLmtleUNvZGUgPT0gMTMpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKGUudHlwZSkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIFwia2V5ZG93blwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgZXhwb3J0cy5rZXlzWzEzXSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcImtleXVwXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgKGV4cG9ydHMua2V5c1sxM10pO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxufVxuO1xuZnVuY3Rpb24gZGlzYWJsZWRFdmVudFByb3BhZ2F0aW9uKGUpIHtcbiAgICBpZiAoZSkge1xuICAgICAgICBpZiAoZS5zdG9wUHJvcGFnYXRpb24pIHtcbiAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoZXZlbnQpIHtcbiAgICAgICAgICAgIGV2ZW50LmNhbmNlbEJ1YmJsZSA9IHRydWU7XG4gICAgICAgIH1cbiAgICB9XG59XG47XG5kb2N1bWVudC5vbmtleWRvd24gPSBvdmVycmlkZUtleWJvYXJkRXZlbnQ7XG5kb2N1bWVudC5vbmtleXVwID0gb3ZlcnJpZGVLZXlib2FyZEV2ZW50O1xuLyp2YXIga2V5cyA9IFtdO1xuZXhwb3J0IGNvbnN0IG9ua2V5dXAgKGUpIHtcbiAga2V5c1tlLmtleUNvZGVdPWZhbHNlO1xufVxuZXhwb3J0IGNvbnN0IG9ua2V5ZG93biAoZSkge1xuICBrZXlzW2Uua2V5Q29kZV09dHJ1ZTtcbn0qL1xuZnVuY3Rpb24gU1ZHKHRhZykge1xuICAgIHJldHVybiBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJywgdGFnKTtcbn1cbi8qaWYgKEdhbWVwYWQuc3VwcG9ydGVkKSB7XG4gICAgY29uc29sZS5sb2coXCJnYW1lcGFkIHN1cHBvcnRlZFwiKTtcbn0gZWxzZSB7XG4gICAgY29uc29sZS5sb2coXCJnYW1lcGFkIG5vdCBzdXBwb3J0ZWRcIik7XG59Ki9cbndpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwiZ2FtZXBhZGNvbm5lY3RlZFwiLCBmdW5jdGlvbiAoZSkge1xuICAgIGNvbnNvbGUubG9nKFwiR2FtZXBhZCBjb25uZWN0ZWQgYXQgaW5kZXggJWQ6ICVzLiAlZCBidXR0b25zLCAlZCBheGVzLlwiLCBlLmdhbWVwYWQuaW5kZXgsIGUuZ2FtZXBhZC5pZCwgZS5nYW1lcGFkLmJ1dHRvbnMubGVuZ3RoLCBlLmdhbWVwYWQuYXhlcy5sZW5ndGgpO1xufSk7XG5pZiAobmF2aWdhdG9yLmdldEdhbWVwYWRzKVxuICAgIGNvbnNvbGUubG9nKG5hdmlnYXRvci5nZXRHYW1lcGFkcygpKTtcbmZ1bmN0aW9uIG1hdGNoVGltZXJUaWNrKGlucHV0KSB7XG4gICAgZXhwb3J0cy5tYXRjaFRpbWVyIC09IDAuMDE2NjY3O1xuICAgIGlmIChkb20ubWF0Y2hNaW51dGVzICYmIGRvbS5tYXRjaFNlY29uZHMpIHtcbiAgICAgICAgdmFyIHNlYyA9IChleHBvcnRzLm1hdGNoVGltZXIgJSA2MCkudG9GaXhlZCgyKTtcbiAgICAgICAgZG9tLm1hdGNoTWludXRlcy5pbm5lckhUTUwgPSBNYXRoLmZsb29yKGV4cG9ydHMubWF0Y2hUaW1lciAvIDYwKTtcbiAgICAgICAgZG9tLm1hdGNoU2Vjb25kcy5pbm5lckhUTUwgPSBzZWMubGVuZ3RoIDwgNSA/IGAwJHtzZWN9YCA6IHNlYztcbiAgICB9XG4gICAgaWYgKGV4cG9ydHMubWF0Y2hUaW1lciA8PSAwKSB7XG4gICAgICAgIGZpbmlzaEdhbWUoaW5wdXQpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIHNjcmVlblNoYWtlKGtiKSB7XG4gICAgdmFyIHNlZWQgPSBbTWF0aC5yYW5kb20oKSwgTWF0aC5yYW5kb20oKSwgTWF0aC5yYW5kb20oKSwgTWF0aC5yYW5kb20oKV07XG4gICAgZXhwb3J0cy5mZzEudHJhbnNsYXRlKGtiICogMC4xICogc2VlZFswXSwga2IgKiAwLjEgKiBzZWVkWzFdKTtcbiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsgZXhwb3J0cy5mZzEudHJhbnNsYXRlKC1rYiAqIDAuMDUgKiBzZWVkWzBdLCAta2IgKiAwLjA1ICogc2VlZFsxXSk7IH0sIDIwKTtcbiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsgZXhwb3J0cy5mZzEudHJhbnNsYXRlKC1rYiAqIDAuMDUgKiBzZWVkWzBdLCAta2IgKiAwLjA1ICogc2VlZFsxXSk7IGV4cG9ydHMuZmcxLnRyYW5zbGF0ZSgta2IgKiAwLjEgKiBzZWVkWzJdLCAta2IgKiAwLjEgKiBzZWVkWzNdKTsgfSwgNDApO1xuICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgeyBleHBvcnRzLmZnMS50cmFuc2xhdGUoa2IgKiAwLjA1ICogc2VlZFsyXSwga2IgKiAwLjA1ICogc2VlZFszXSk7IH0sIDYwKTtcbiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsgZXhwb3J0cy5mZzEudHJhbnNsYXRlKGtiICogMC4wNSAqIHNlZWRbMl0sIGtiICogMC4wNSAqIHNlZWRbM10pOyB9LCA4MCk7XG59XG5mdW5jdGlvbiBwZXJjZW50U2hha2Uoa2IsIGkpIHtcbiAgICBleHBvcnRzLnBsYXllcltpXS5wZXJjZW50U2hha2UgPSBuZXcgVmVjMkRfMS5WZWMyRChrYiAqIDAuMSAqIE1hdGgucmFuZG9tKCksIGtiICogMC4xICogTWF0aC5yYW5kb20oKSk7XG4gICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7IGV4cG9ydHMucGxheWVyW2ldLnBlcmNlbnRTaGFrZSA9IG5ldyBWZWMyRF8xLlZlYzJEKGtiICogMC4wNSAqIE1hdGgucmFuZG9tKCksIGtiICogMC4wNSAqIE1hdGgucmFuZG9tKCkpOyB9LCAyMCk7XG4gICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7IGV4cG9ydHMucGxheWVyW2ldLnBlcmNlbnRTaGFrZSA9IG5ldyBWZWMyRF8xLlZlYzJEKC1rYiAqIDAuMSAqIE1hdGgucmFuZG9tKCksIC1rYiAqIDAuMSAqIE1hdGgucmFuZG9tKCkpOyB9LCA0MCk7XG4gICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7IGV4cG9ydHMucGxheWVyW2ldLnBlcmNlbnRTaGFrZSA9IG5ldyBWZWMyRF8xLlZlYzJEKC1rYiAqIDAuMDUgKiBNYXRoLnJhbmRvbSgpLCAta2IgKiAwLjA1ICogTWF0aC5yYW5kb20oKSk7IH0sIDYwKTtcbiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsgZXhwb3J0cy5wbGF5ZXJbaV0ucGVyY2VudFNoYWtlID0gbmV3IFZlYzJEXzEuVmVjMkQoMCwgMCk7IH0sIDgwKTtcbn1cbmZ1bmN0aW9uIGZpbmRQbGF5ZXJzKCkge1xuICAgIHZhciBncHMgPSBuYXZpZ2F0b3IuZ2V0R2FtZXBhZHMgPyBuYXZpZ2F0b3IuZ2V0R2FtZXBhZHMoKSA6IChuYXZpZ2F0b3Iud2Via2l0R2V0R2FtZXBhZHMgPyBuYXZpZ2F0b3Iud2Via2l0R2V0R2FtZXBhZHMoKSA6IFtdKTtcbiAgICAvKmlmICh0eXBlb2YgZ3BzICE9IFwidW5kZWZpbmVkXCIpe1xuICAgICAgY29uc29sZS5sb2coZ3BzKTtcbiAgICB9Ki9cbiAgICBpZiAoIWtleWJvYXJkT2NjdXBpZWQpIHtcbiAgICAgICAgaWYgKGV4cG9ydHMuZ2FtZU1vZGUgPCAyIHx8IGV4cG9ydHMuZ2FtZU1vZGUgPT0gMjApIHtcbiAgICAgICAgICAgIGlmIChleHBvcnRzLmtleXNbMTNdIHx8IGV4cG9ydHMua2V5c1tzZXR0aW5nc18xLmtleU1hcC5zWzBdXSB8fCBleHBvcnRzLmtleXNbc2V0dGluZ3NfMS5rZXlNYXAuc1sxXV0pIHtcbiAgICAgICAgICAgICAgICBpZiAoZXhwb3J0cy5wb3J0cyA8IDQpIHtcbiAgICAgICAgICAgICAgICAgICAgY2hhbmdlR2FtZW1vZGUoMSk7XG4gICAgICAgICAgICAgICAgICAgICgwLCBqcXVlcnlfMS5kZWZhdWx0KShcIiNrZXlib2FyZFByb21wdFwiKS5oaWRlKCk7XG4gICAgICAgICAgICAgICAgICAgIGtleWJvYXJkT2NjdXBpZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBzZnhfMS5zb3VuZHMubWVudUZvcndhcmQucGxheSgpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoZXhwb3J0cy5wb3J0cyA9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBtdXNpY18xLk11c2ljTWFuYWdlci5wbGF5TWVudUxvb3AoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBhZGRQbGF5ZXIoZXhwb3J0cy5wb3J0cywgXCJrZXlib2FyZFwiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBpZiAoZXhwb3J0cy5rZXlzW3NldHRpbmdzXzEua2V5TWFwLmFbMF1dIHx8IGV4cG9ydHMua2V5c1tzZXR0aW5nc18xLmtleU1hcC5hWzFdXSkge1xuICAgICAgICAgICAgICAgIGlmIChleHBvcnRzLnBvcnRzIDwgNCkge1xuICAgICAgICAgICAgICAgICAgICBrZXlib2FyZE9jY3VwaWVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgYWRkUGxheWVyKGV4cG9ydHMucG9ydHMsIFwia2V5Ym9hcmRcIik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZ3BzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHZhciBnYW1lcGFkID0gbmF2aWdhdG9yLmdldEdhbWVwYWRzID8gbmF2aWdhdG9yLmdldEdhbWVwYWRzKClbaV0gOiAobmF2aWdhdG9yLndlYmtpdEdldEdhbWVwYWRzID8gbmF2aWdhdG9yLndlYmtpdEdldEdhbWVwYWRzKClbaV0gOiBudWxsKTtcbiAgICAgICAgaWYgKGV4cG9ydHMucGxheWVyVHlwZVtpXSA9PT0gMikge1xuICAgICAgICAgICAgdmFyIGFscmVhZHlJbiA9IGZhbHNlO1xuICAgICAgICAgICAgZm9yICh2YXIgayA9IDA7IGsgPCBleHBvcnRzLnBvcnRzOyBrKyspIHtcbiAgICAgICAgICAgICAgICBpZiAoZXhwb3J0cy5jdXJyZW50UGxheWVyc1trXSA9PT0gaSkge1xuICAgICAgICAgICAgICAgICAgICBhbHJlYWR5SW4gPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghYWxyZWFkeUluKSB7XG4gICAgICAgICAgICAgICAgaWYgKGV4cG9ydHMucG9ydHMgPCA0KSB7XG4gICAgICAgICAgICAgICAgICAgIGFkZFBsYXllcihpLCA5OSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGdhbWVwYWQgPSBuYXZpZ2F0b3IuZ2V0R2FtZXBhZHMgPyBuYXZpZ2F0b3IuZ2V0R2FtZXBhZHMoKVtpXSA6IChuYXZpZ2F0b3Iud2Via2l0R2V0R2FtZXBhZHMgPyBuYXZpZ2F0b3Iud2Via2l0R2V0R2FtZXBhZHMoKVtpXSA6IG51bGwpO1xuICAgICAgICBpZiAodHlwZW9mIGdhbWVwYWQgIT0gXCJ1bmRlZmluZWRcIiAmJiBnYW1lcGFkICE9IG51bGwpIHtcbiAgICAgICAgICAgIHZhciBkZXRlY3RlZCA9IGZhbHNlO1xuICAgICAgICAgICAgdmFyIGdwZE5hbWU7XG4gICAgICAgICAgICB2YXIgZ3BkSW5mbztcbiAgICAgICAgICAgIGlmIChleHBvcnRzLnVzaW5nQ3VzdG9tQ29udHJvbHNbaV0gJiYgY3VzdG9tXzEuY3VzdG9tR2FtZXBhZEluZm9baV0gIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICBncGROYW1lID0gXCJjdXN0b20gY29udHJvbHNcIjtcbiAgICAgICAgICAgICAgICBncGRJbmZvID0gY3VzdG9tXzEuY3VzdG9tR2FtZXBhZEluZm9baV07XG4gICAgICAgICAgICAgICAgZGV0ZWN0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbWF5YmVOYW1lQW5kSW5mbyA9ICgwLCBmaW5kR2FtZXBhZEluZm9fMS5nZXRHYW1lcGFkTmFtZUFuZEluZm8pKGdhbWVwYWQuaWQpO1xuICAgICAgICAgICAgICAgIGlmIChtYXliZU5hbWVBbmRJbmZvID09PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiRXJyb3IgaW4gJ2ZpbmRQbGF5ZXJzJzogY29udHJvbGxlciBcIiArIChpICsgMSkgKyBcIiBkZXRlY3RlZCBidXQgbm90IHN1cHBvcnRlZC5cIik7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiVHJ5IG1hbnVhbCBjYWxpYnJhdGlvbiBvZiB5b3VyIGNvbnRyb2xsZXIuXCIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgZGV0ZWN0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBbZ3BkTmFtZSwgZ3BkSW5mb10gPSBtYXliZU5hbWVBbmRJbmZvO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChkZXRlY3RlZCkge1xuICAgICAgICAgICAgICAgIGlmIChleHBvcnRzLmZpcnN0VGltZURldGVjdGVkW2ldKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiQ29udHJvbGxlciBcIiArIChpICsgMSkgKyBcIiBpczogXCIgKyBncGROYW1lICsgXCIuXCIpO1xuICAgICAgICAgICAgICAgICAgICBleHBvcnRzLmZpcnN0VGltZURldGVjdGVkW2ldID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChleHBvcnRzLmdhbWVNb2RlIDwgMiB8fCBleHBvcnRzLmdhbWVNb2RlID09IDIwKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICgoMCwgcmV0cmlldmVHYW1lcGFkSW5wdXRzXzEuYnV0dG9uU3RhdGUpKGdhbWVwYWQsIGdwZEluZm8sIFwic1wiKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFscmVhZHlJbiA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgayA9IDA7IGsgPCBleHBvcnRzLnBvcnRzOyBrKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXhwb3J0cy5jdXJyZW50UGxheWVyc1trXSA9PSBpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFscmVhZHlJbiA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhbHJlYWR5SW4pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXhwb3J0cy5wb3J0cyA8IDQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hhbmdlR2FtZW1vZGUoMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICgwLCBqcXVlcnlfMS5kZWZhdWx0KShcIiNrZXlib2FyZFByb21wdFwiKS5oaWRlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNmeF8xLnNvdW5kcy5tZW51Rm9yd2FyZC5wbGF5KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChleHBvcnRzLnBvcnRzID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtdXNpY18xLk11c2ljTWFuYWdlci5wbGF5TWVudUxvb3AoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZGRQbGF5ZXIoaSwgZ3BkSW5mbyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBpZiAoKDAsIHJldHJpZXZlR2FtZXBhZElucHV0c18xLmJ1dHRvblN0YXRlKShnYW1lcGFkLCBncGRJbmZvLCBcImFcIikpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhbHJlYWR5SW4gPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGsgPSAwOyBrIDwgZXhwb3J0cy5wb3J0czsgaysrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGV4cG9ydHMuY3VycmVudFBsYXllcnNba10gPT0gaSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbHJlYWR5SW4gPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYWxyZWFkeUluKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGV4cG9ydHMucG9ydHMgPCA0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkZFBsYXllcihpLCBncGRJbmZvKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIk5vIGNvbnRyb2xsZXIgZGV0ZWN0ZWQgYnkgYnJvd3NlclwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn1cbmZ1bmN0aW9uIHNldFBsYXllclR5cGUocGxheWVyU2xvdCwgdHlwZSkge1xuICAgIGV4cG9ydHMucGxheWVyVHlwZVtwbGF5ZXJTbG90XSA9IHR5cGU7XG59XG5mdW5jdGlvbiBhZGRQbGF5ZXIoaSwgY29udHJvbGxlckluZm8pIHtcbiAgICBpZiAoY29udHJvbGxlckluZm8gPT09IDk5KSB7XG4gICAgICAgIGV4cG9ydHMucG9ydHMrKztcbiAgICAgICAgZXhwb3J0cy5jdXJyZW50UGxheWVyc1tleHBvcnRzLnBvcnRzIC0gMV0gPSBpO1xuICAgICAgICBleHBvcnRzLnBsYXllclR5cGVbZXhwb3J0cy5wb3J0cyAtIDFdID0gMjtcbiAgICAgICAgZXhwb3J0cy5tVHlwZVtleHBvcnRzLnBvcnRzIC0gMV0gPSBjb250cm9sbGVySW5mbztcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGV4cG9ydHMucG9ydHMrKztcbiAgICAgICAgZXhwb3J0cy5jdXJyZW50UGxheWVyc1tleHBvcnRzLnBvcnRzIC0gMV0gPSBpO1xuICAgICAgICBleHBvcnRzLnBsYXllclR5cGVbZXhwb3J0cy5wb3J0cyAtIDFdID0gMDtcbiAgICAgICAgZXhwb3J0cy5tVHlwZVtleHBvcnRzLnBvcnRzIC0gMV0gPSBjb250cm9sbGVySW5mbztcbiAgICAgICAgaWYgKGV4cG9ydHMuc2hvd0RlYnVnKSB7XG4gICAgICAgICAgICAoMCwgZHJhd0dhbWVwYWRfMS51cGRhdGVHYW1lcGFkU1ZHQ29sb3VyKShpLCBcImdhbWVwYWRTVkdcIiArIGkpO1xuICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJnYW1lcGFkU1ZHXCIgKyBpKS5zdHlsZS5kaXNwbGF5ID0gXCJcIjtcbiAgICAgICAgfVxuICAgIH1cbn1cbmZ1bmN0aW9uIHRvZ2dsZVBvcnQoaSkge1xuICAgIGV4cG9ydHMucGxheWVyVHlwZVtpXSsrO1xuICAgIGlmIChleHBvcnRzLnBsYXllclR5cGVbaV0gPT0gMykge1xuICAgICAgICBleHBvcnRzLnBsYXllclR5cGVbaV0gPSAtMTtcbiAgICAgICAgaWYgKGV4cG9ydHMuc2hvd0RlYnVnKSB7XG4gICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImdhbWVwYWRTVkdcIiArIGkpLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcbiAgICAgICAgfVxuICAgIH1cbiAgICBpZiAoZXhwb3J0cy5wbGF5ZXJUeXBlW2ldID09IDAgJiYgZXhwb3J0cy5wb3J0cyA8PSBpKSB7XG4gICAgICAgIGV4cG9ydHMucGxheWVyVHlwZVtpXSA9IDE7XG4gICAgICAgICgwLCBkcmF3R2FtZXBhZF8xLnNldEdhbWVwYWRTVkdDb2xvdXIpKGksIFwiYmxhY2tcIik7XG4gICAgICAgIGlmIChleHBvcnRzLnNob3dEZWJ1Zykge1xuICAgICAgICAgICAgKDAsIGRyYXdHYW1lcGFkXzEudXBkYXRlR2FtZXBhZFNWR0NvbG91cikoaSwgXCJnYW1lcGFkU1ZHXCIgKyBpKTtcbiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZ2FtZXBhZFNWR1wiICsgaSkuc3R5bGUuZGlzcGxheSA9IFwiXCI7XG4gICAgICAgIH1cbiAgICB9XG59XG5mdW5jdGlvbiBwb3NpdGlvblBsYXllcnNJbkNTUygpIHtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IDQ7IGkrKykge1xuICAgICAgICB2YXIgeCA9ICgtODAgKyBpICogNTApICogMiAvIDM7XG4gICAgICAgIHZhciB5ID0gLTMwO1xuICAgICAgICBleHBvcnRzLnBsYXllcltpXS5waHlzLnBvcyA9IG5ldyBWZWMyRF8xLlZlYzJEKHgsIHkpO1xuICAgICAgICBleHBvcnRzLnBsYXllcltpXS5waHlzLmh1cnRib3ggPSBuZXcgQm94MkRfMS5Cb3gyRChbLTQgKyB4LCAxOCArIHldLCBbNCArIHgsIHldKTtcbiAgICB9XG59XG4vLyAyMDpTdGFydHVwXG4vLyAxNDpDb250cm9sbGVyIE1lbnVcbi8vIDEzOkRhdGEgTWVudVxuLy8gMTI6S2V5Ym9hcmQgQ29udHJvbHNcbi8vIDExOkdhbWVwbGF5IE1lbnVcbi8vIDEwOlNvdW5kIE1lbnVcbi8vIDk6IC1cbi8vIDg6IC1cbi8vIDc6VGFyZ2V0IFNlbGVjdFxuLy8gNjpTdGFnZSBTZWxlY3QgKFZTKVxuLy8gNTpUYXJnZXQgUGxheWluZ1xuLy8gNDpUYXJnZXQgQnVpbGRlclxuLy8gMzpQbGF5aW5nIChWUylcbi8vIDI6Q1NTXG4vLyAxOk1haW4gTWVudVxuLy8gMDpUaXRsZSBTY3JlZW5cbmZ1bmN0aW9uIGNoYW5nZUdhbWVtb2RlKG5ld0dhbWVtb2RlKSB7XG4gICAgZXhwb3J0cy5iZzEuZmlsbFN0eWxlID0gXCJibGFja1wiO1xuICAgIGV4cG9ydHMuYmcxLmZpbGxSZWN0KDAsIDAsIGV4cG9ydHMubGF5ZXJzLkJHMS53aWR0aCwgZXhwb3J0cy5sYXllcnMuQkcxLmhlaWdodCk7XG4gICAgZXhwb3J0cy5mZzEuY2xlYXJSZWN0KDAsIDAsIGV4cG9ydHMubGF5ZXJzLkZHMS53aWR0aCwgZXhwb3J0cy5sYXllcnMuRkcxLmhlaWdodCk7XG4gICAgZXhwb3J0cy5nYW1lTW9kZSA9IG5ld0dhbWVtb2RlO1xuICAgIHN3aXRjaCAobmV3R2FtZW1vZGUpIHtcbiAgICAgICAgLy8gVElUTEVTQ1JFRU5cbiAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgKDAsIHN0YXJ0c2NyZWVuXzEuZHJhd1N0YXJ0U2NyZWVuSW5pdCkoKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAvLyBNQUlOIE1FTlVcbiAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgKDAsIGpxdWVyeV8xLmRlZmF1bHQpKFwiI2xvZ29WaWRcIikucmVtb3ZlKCk7XG4gICAgICAgICAgICAoMCwgbWVudV8xLmRyYXdNYWluTWVudUluaXQpKCk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgLy8gQ1NTXG4gICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICgwLCBjc3NfMS5kcmF3Q1NTSW5pdCkoKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAvLyBQbGF5aW5nIChWUylcbiAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgKDAsIHN0YWdlcmVuZGVyXzEuZHJhd0JhY2tncm91bmRJbml0KSgpO1xuICAgICAgICAgICAgKDAsIHN0YWdlcmVuZGVyXzEuZHJhd1N0YWdlSW5pdCkoKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAvLyBUYXJnZXQgQnVpbGRlclxuICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgLy8gVGFyZ2V0IFBsYXlpbmdcbiAgICAgICAgY2FzZSA1OlxuICAgICAgICAgICAgKDAsIHN0YWdlcmVuZGVyXzEuZHJhd0JhY2tncm91bmRJbml0KSgpO1xuICAgICAgICAgICAgKDAsIHN0YWdlcmVuZGVyXzEuZHJhd1N0YWdlSW5pdCkoKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAvLyBTdGFnZSBzZWxlY3QgKHZzKVxuICAgICAgICBjYXNlIDY6XG4gICAgICAgICAgICAoMCwgc3RhZ2VzZWxlY3RfMS5kcmF3U1NTSW5pdCkoKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAvLyBUYXJnZXQgU2VsZWN0XG4gICAgICAgIGNhc2UgNzpcbiAgICAgICAgICAgIC8vIGRyYXdUU1NJbml0KCk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgLy8gc291bmQgbWVudVxuICAgICAgICBjYXNlIDEwOlxuICAgICAgICAgICAgKDAsIGF1ZGlvbWVudV8xLmRyYXdBdWRpb01lbnVJbml0KSgpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIC8vIGdhbWVwbGF5IG1lbnVcbiAgICAgICAgY2FzZSAxMTpcbiAgICAgICAgICAgICgwLCBnYW1lcGxheW1lbnVfMS5kcmF3R2FtZXBsYXlNZW51SW5pdCkoKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAvLyBrZXlib2FyZCBtZW51XG4gICAgICAgIGNhc2UgMTI6XG4gICAgICAgICAgICAoMCwga2V5Ym9hcmRtZW51XzEuZHJhd0tleWJvYXJkTWVudUluaXQpKCk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgLy8gY3JlZGl0c1xuICAgICAgICBjYXNlIDEzOlxuICAgICAgICAgICAgLy8gZHJhd0NyZWRpdHNJbml0KCk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgLy8gTXVsdGlwbGF5ZXIgTW9kZXNcbiAgICAgICAgY2FzZSAxNDpcbiAgICAgICAgICAgICgwLCBjb250cm9sbGVybWVudV8xLmRyYXdDb250cm9sbGVyTWVudUluaXQpKCk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAxNTpcbiAgICAgICAgICAgICgwLCBjc3NfMS5kcmF3Q1NTSW5pdCkoKTtcbiAgICAgICAgICAgICgwLCBzdHJlYW1jbGllbnRfMS5jb25uZWN0VG9NUFNlcnZlcikoKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAvLyBzdGFydHVwXG4gICAgICAgIGNhc2UgMjA6XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIGJyZWFrO1xuICAgIH1cbn1cbi8qZXhwb3J0IGNvbnN0IGFkZFBsYXllciAoaSxnVHlwZSxwVHlwZSl7XG4gIGNvbnNvbGUubG9nKGksZ1R5cGUscFR5cGUpO1xuXG4gIGN1cnJlbnRQbGF5ZXJzLnB1c2goaSk7XG4gIGlmIChwVHlwZSA9PSAwKXtcbiAgICBwb3J0cysrO1xuICAgIG1UeXBlW3BvcnRzLTFdID0gZ1R5cGU7XG4gICAgcGxheWVyVHlwZVtwb3J0cy0xXSA9IHBUeXBlO1xuXG4gICAgY29zdHVtZVRpbWVvdXQucHVzaChmYWxzZSk7XG4gICAgcFBhbC5wdXNoKHBvcnRzLTEpO1xuICAgIGJ1aWxkUGxheWVyT2JqZWN0KHBvcnRzLTEpO1xuICAgIHBsYXllcltwbGF5ZXJBbW91bnQtMV0ucGh5cy5wb3MgPSBuZXcgVmVjMkQoLTEwMCsyNSoocGxheWVyQW1vdW50PTEpLC00MCk7XG4gICAgcGxheWVyW3BvcnRzLTFdLnBoeXMuZmFjZSA9IDE7XG4gICAgcGxheWVyW3BvcnRzLTFdLmFjdGlvblN0YXRlID0gMDtcbiAgICAkKFwiI2N1cnJlbnRQbGF5ZXJzXCIpLmFwcGVuZCgnPGRpdiBjbGFzcz1cInBCb3hCb3hcIj48ZGl2IGNsYXNzPVwicGxheWVyQm94XCIgaWQ9XCJwQm94JysocG9ydHMtMSkrJ1wiIHN0eWxlPVwiYmFja2dyb3VuZC1jb2xvcjonK3BhbGV0dGVzW3BQYWxbcG9ydHMtMV1dWzBdKyc7Ym9yZGVyOjVweCBzb2xpZCAnK3BhbGV0dGVzW3BQYWxbcG9ydHMtMV1dWzJdKycwLjgpXCI+PHA+UCcrcG9ydHMrJzxicj48c3BhbiBjbGFzcz1cImNvbnRcIj4oQ29udC4gJytpKycpPC9zcGFuPjwvcD48L2Rpdj48ZGl2IGlkPVwicFRhZycrKHBvcnRzLTEpKydcIiBjbGFzcz1cInBUYWdcIj48dGV4dGFyZWEgaWQ9XCJwVGFnRWRpdCcrKHBvcnRzLTEpKydcIiBjbGFzcz1cInBUYWdFZGl0XCIgbWF4bGVuZ3RoPVwiMTBcIj48L3RleHRhcmVhPjwvZGl2PjwvZGl2PicpO1xuICB9XG4gIGVsc2Uge1xuICAgIG1UeXBlW2ldID0gZ1R5cGU7XG5cbiAgICBjb3N0dW1lVGltZW91dC5wdXNoKGZhbHNlKTtcbiAgICBwUGFsLnB1c2goaSk7XG4gICAgYnVpbGRQbGF5ZXJPYmplY3QoaSk7XG4gICAgcGxheWVyW3BsYXllckFtb3VudC0xXS5waHlzLnBvcyA9IG5ldyBWZWMyRCgtMTAwKzI1KihwbGF5ZXJBbW91bnQ9MSksLTQwKTtcbiAgICBwbGF5ZXJbaV0ucGh5cy5mYWNlID0gMTtcbiAgICBwbGF5ZXJbaV0uYWN0aW9uU3RhdGUgPSAwO1xuICAgICQoXCIjY3VycmVudFBsYXllcnNcIikuYXBwZW5kKCc8ZGl2IGNsYXNzPVwicEJveEJveFwiPjxkaXYgY2xhc3M9XCJwbGF5ZXJCb3hcIiBpZD1cInBCb3gnK2krJ1wiIHN0eWxlPVwiYmFja2dyb3VuZC1jb2xvcjonK3BhbGV0dGVzW3BQYWxbaV1dWzBdKyc7Ym9yZGVyOjVweCBzb2xpZCAnK3BhbGV0dGVzW3BQYWxbaV1dWzJdKycwLjgpXCI+PHA+UCcrKGkrMSkrJzxicj48c3BhbiBjbGFzcz1cImNvbnRcIj4oQ29udC4gJytpKycpPC9zcGFuPjwvcD48L2Rpdj48ZGl2IGlkPVwicFRhZycraSsnXCIgY2xhc3M9XCJwVGFnXCI+PHRleHRhcmVhIGlkPVwicFRhZ0VkaXQnK2krJ1wiIGNsYXNzPVwicFRhZ0VkaXRcIiBtYXhsZW5ndGg9XCIxMFwiPjwvdGV4dGFyZWE+PC9kaXY+PC9kaXY+Jyk7XG4gIH1cbiAgcGxheWVyQW1vdW50Kys7XG59XG5cbmV4cG9ydCBjb25zdCByZW1vdmVQbGF5ZXIgKGkpe1xuICBwbGF5ZXJUeXBlW2ldID0gLTE7XG4gIHBsYXllckFtb3VudC0tO1xufSovXG5mdW5jdGlvbiBpbnRlcnByZXRJbnB1dHMoaSwgYWN0aXZlLCBwbGF5ZXJ0eXBlLCBpbnB1dEJ1ZmZlcikge1xuICAgIGxldCB0ZW1wQnVmZmVyID0gKDAsIGlucHV0XzEubnVsbElucHV0cykoKTtcbiAgICAvLyBrZWVwIHVwZGF0aW5nIFogYW5kIFN0YXJ0IGFsbCB0aGUgdGltZSwgZXZlbiB3aGVuIHBhdXNlZFxuICAgIGZvciAodmFyIGsgPSAwOyBrIDwgNzsgaysrKSB7XG4gICAgICAgIHRlbXBCdWZmZXJbNyAtIGtdLnogPSBpbnB1dEJ1ZmZlcls2IC0ga10uejtcbiAgICAgICAgdGVtcEJ1ZmZlcls3IC0ga10ucyA9IGlucHV0QnVmZmVyWzYgLSBrXS5zO1xuICAgIH1cbiAgICB0ZW1wQnVmZmVyWzBdID0gKDAsIGlucHV0XzEucG9sbElucHV0cykoZXhwb3J0cy5nYW1lTW9kZSwgZXhwb3J0cy5mcmFtZUJ5RnJhbWUsIGV4cG9ydHMubVR5cGVbaV0sIGksIGV4cG9ydHMuY3VycmVudFBsYXllcnNbaV0sIGV4cG9ydHMua2V5cywgcGxheWVydHlwZSk7XG4gICAgbGV0IHBhc3RPZmZzZXQgPSAwO1xuICAgIGlmICgoZXhwb3J0cy5nYW1lTW9kZSAhPT0gMyAmJiBleHBvcnRzLmdhbWVNb2RlICE9PSA1KSB8fCAoZXhwb3J0cy5wbGF5aW5nICYmIChleHBvcnRzLnBhdXNlW2ldWzFdIHx8ICFleHBvcnRzLnBhdXNlW2ldWzBdKSlcbiAgICAgICAgfHwgZXhwb3J0cy53YXNGcmFtZUJ5RnJhbWVcbiAgICAgICAgfHwgKCFleHBvcnRzLnBsYXlpbmcgJiYgZXhwb3J0cy5wYXVzZVtpXVswXSAmJiAhZXhwb3J0cy5wYXVzZVtpXVsxXSkpIHtcbiAgICAgICAgcGFzdE9mZnNldCA9IDE7XG4gICAgfVxuICAgIGV4cG9ydHMucGF1c2VbaV1bMV0gPSBleHBvcnRzLnBhdXNlW2ldWzBdO1xuICAgIGV4cG9ydHMud2FzRnJhbWVCeUZyYW1lID0gZmFsc2U7XG4gICAgZXhwb3J0cy5mcmFtZUFkdmFuY2VbaV1bMV0gPSBleHBvcnRzLmZyYW1lQWR2YW5jZVtpXVswXTtcbiAgICBmb3IgKHZhciBrID0gMDsgayA8IDc7IGsrKykge1xuICAgICAgICB0ZW1wQnVmZmVyWzcgLSBrXS5sc1ggPSBpbnB1dEJ1ZmZlcls3IC0gayAtIHBhc3RPZmZzZXRdLmxzWDtcbiAgICAgICAgdGVtcEJ1ZmZlcls3IC0ga10ubHNZID0gaW5wdXRCdWZmZXJbNyAtIGsgLSBwYXN0T2Zmc2V0XS5sc1k7XG4gICAgICAgIHRlbXBCdWZmZXJbNyAtIGtdLnJhd1ggPSBpbnB1dEJ1ZmZlcls3IC0gayAtIHBhc3RPZmZzZXRdLnJhd1g7XG4gICAgICAgIHRlbXBCdWZmZXJbNyAtIGtdLnJhd1kgPSBpbnB1dEJ1ZmZlcls3IC0gayAtIHBhc3RPZmZzZXRdLnJhd1k7XG4gICAgICAgIHRlbXBCdWZmZXJbNyAtIGtdLmNzWCA9IGlucHV0QnVmZmVyWzcgLSBrIC0gcGFzdE9mZnNldF0uY3NYO1xuICAgICAgICB0ZW1wQnVmZmVyWzcgLSBrXS5jc1kgPSBpbnB1dEJ1ZmZlcls3IC0gayAtIHBhc3RPZmZzZXRdLmNzWTtcbiAgICAgICAgdGVtcEJ1ZmZlcls3IC0ga10ucmF3Y3NYID0gaW5wdXRCdWZmZXJbNyAtIGsgLSBwYXN0T2Zmc2V0XS5yYXdjc1g7XG4gICAgICAgIHRlbXBCdWZmZXJbNyAtIGtdLnJhd2NzWSA9IGlucHV0QnVmZmVyWzcgLSBrIC0gcGFzdE9mZnNldF0ucmF3Y3NZO1xuICAgICAgICB0ZW1wQnVmZmVyWzcgLSBrXS5sQSA9IGlucHV0QnVmZmVyWzcgLSBrIC0gcGFzdE9mZnNldF0ubEE7XG4gICAgICAgIHRlbXBCdWZmZXJbNyAtIGtdLnJBID0gaW5wdXRCdWZmZXJbNyAtIGsgLSBwYXN0T2Zmc2V0XS5yQTtcbiAgICAgICAgdGVtcEJ1ZmZlcls3IC0ga10uYSA9IGlucHV0QnVmZmVyWzcgLSBrIC0gcGFzdE9mZnNldF0uYTtcbiAgICAgICAgdGVtcEJ1ZmZlcls3IC0ga10uYiA9IGlucHV0QnVmZmVyWzcgLSBrIC0gcGFzdE9mZnNldF0uYjtcbiAgICAgICAgdGVtcEJ1ZmZlcls3IC0ga10ueCA9IGlucHV0QnVmZmVyWzcgLSBrIC0gcGFzdE9mZnNldF0ueDtcbiAgICAgICAgdGVtcEJ1ZmZlcls3IC0ga10ueSA9IGlucHV0QnVmZmVyWzcgLSBrIC0gcGFzdE9mZnNldF0ueTtcbiAgICAgICAgdGVtcEJ1ZmZlcls3IC0ga10uciA9IGlucHV0QnVmZmVyWzcgLSBrIC0gcGFzdE9mZnNldF0ucjtcbiAgICAgICAgdGVtcEJ1ZmZlcls3IC0ga10ubCA9IGlucHV0QnVmZmVyWzcgLSBrIC0gcGFzdE9mZnNldF0ubDtcbiAgICAgICAgdGVtcEJ1ZmZlcls3IC0ga10uZGwgPSBpbnB1dEJ1ZmZlcls3IC0gayAtIHBhc3RPZmZzZXRdLmRsO1xuICAgICAgICB0ZW1wQnVmZmVyWzcgLSBrXS5kZCA9IGlucHV0QnVmZmVyWzcgLSBrIC0gcGFzdE9mZnNldF0uZGQ7XG4gICAgICAgIHRlbXBCdWZmZXJbNyAtIGtdLmRyID0gaW5wdXRCdWZmZXJbNyAtIGsgLSBwYXN0T2Zmc2V0XS5kcjtcbiAgICAgICAgdGVtcEJ1ZmZlcls3IC0ga10uZHUgPSBpbnB1dEJ1ZmZlcls3IC0gayAtIHBhc3RPZmZzZXRdLmR1O1xuICAgIH1cbiAgICBpZiAoZXhwb3J0cy5tVHlwZSAhPT0gbnVsbCkge1xuICAgICAgICBpZiAoKGV4cG9ydHMubVR5cGVbaV0gPT09IFwia2V5Ym9hcmRcIiAmJiAodGVtcEJ1ZmZlclswXS56IHx8IHRlbXBCdWZmZXJbMV0ueikpXG4gICAgICAgICAgICB8fCAoZXhwb3J0cy5tVHlwZVtpXSAhPT0gXCJrZXlib2FyZFwiICYmICh0ZW1wQnVmZmVyWzBdLnogJiYgIXRlbXBCdWZmZXJbMV0ueikpKSB7XG4gICAgICAgICAgICBleHBvcnRzLmZyYW1lQWR2YW5jZVtpXVswXSA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBleHBvcnRzLmZyYW1lQWR2YW5jZVtpXVswXSA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgfVxuICAgIGlmIChleHBvcnRzLmZyYW1lQWR2YW5jZVtpXVswXSAmJiAhZXhwb3J0cy5mcmFtZUFkdmFuY2VbaV1bMV0gJiYgIWV4cG9ydHMucGxheWluZyAmJiBleHBvcnRzLmdhbWVNb2RlICE9PSA0KSB7XG4gICAgICAgIGV4cG9ydHMuZnJhbWVCeUZyYW1lID0gdHJ1ZTtcbiAgICB9XG4gICAgaWYgKGV4cG9ydHMubVR5cGVbaV0gPT09IFwia2V5Ym9hcmRcIikgeyAvLyBrZXlib2FyZCBjb250cm9sc1xuICAgICAgICBpZiAodGVtcEJ1ZmZlclswXS5zIHx8IHRlbXBCdWZmZXJbMV0ucyB8fCAoZXhwb3J0cy5nYW1lTW9kZSA9PT0gNSAmJiAodGVtcEJ1ZmZlclswXS5kdSB8fCB0ZW1wQnVmZmVyWzFdLmR1KSkpIHtcbiAgICAgICAgICAgIGV4cG9ydHMucGF1c2VbaV1bMF0gPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgZXhwb3J0cy5wYXVzZVtpXVswXSA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGlmICghZXhwb3J0cy5wbGF5aW5nICYmIChleHBvcnRzLmdhbWVNb2RlID09IDMgfHwgZXhwb3J0cy5nYW1lTW9kZSA9PSA1KVxuICAgICAgICAgICAgJiYgKHRlbXBCdWZmZXJbMF0uYSB8fCB0ZW1wQnVmZmVyWzFdLmEpICYmICh0ZW1wQnVmZmVyWzBdLmwgfHwgdGVtcEJ1ZmZlclsxXS5sKVxuICAgICAgICAgICAgJiYgKHRlbXBCdWZmZXJbMF0uciB8fCB0ZW1wQnVmZmVyWzFdLnIpICYmICh0ZW1wQnVmZmVyWzBdLnMgfHwgdGVtcEJ1ZmZlclsxXS5zKSkge1xuICAgICAgICAgICAgaWYgKHRlbXBCdWZmZXJbMF0uYiB8fCB0ZW1wQnVmZmVyWzFdLmIpIHtcbiAgICAgICAgICAgICAgICBzdGFydEdhbWUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGVuZEdhbWUoaW5wdXRCdWZmZXIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGludGVycHJldFBhdXNlKGV4cG9ydHMucGF1c2VbaV1bMF0sIGV4cG9ydHMucGF1c2VbaV1bMV0pO1xuICAgIH1cbiAgICBlbHNlIGlmIChleHBvcnRzLm1UeXBlW2ldICE9PSBudWxsKSB7IC8vIGdhbWVwYWQgY29udHJvbHNcbiAgICAgICAgaWYgKCFleHBvcnRzLnBsYXlpbmcgJiYgKGV4cG9ydHMuZ2FtZU1vZGUgPT0gMyB8fCBleHBvcnRzLmdhbWVNb2RlID09IDUpICYmXG4gICAgICAgICAgICAodGVtcEJ1ZmZlclswXS5hICYmIHRlbXBCdWZmZXJbMF0ubCAmJiB0ZW1wQnVmZmVyWzBdLnIgJiYgdGVtcEJ1ZmZlclswXS5zKVxuICAgICAgICAgICAgJiYgKCEodGVtcEJ1ZmZlclsxXS5hICYmIHRlbXBCdWZmZXJbMV0ubCAmJiB0ZW1wQnVmZmVyWzFdLnIgJiYgdGVtcEJ1ZmZlclsxXS5zKSkpIHtcbiAgICAgICAgICAgIGlmICh0ZW1wQnVmZmVyWzBdLmIpIHtcbiAgICAgICAgICAgICAgICBzdGFydEdhbWUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGVuZEdhbWUoaW5wdXRCdWZmZXIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmICh0ZW1wQnVmZmVyWzBdLnMgfHwgdGVtcEJ1ZmZlclswXS5kdSAmJiBleHBvcnRzLmdhbWVNb2RlID09IDUpIHtcbiAgICAgICAgICAgIGV4cG9ydHMucGF1c2VbaV1bMF0gPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgZXhwb3J0cy5wYXVzZVtpXVswXSA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIC8vIENvbnRyb2xsZXIgcmVzZXQgZnVuY3Rpb25hbGl0eVxuICAgICAgICBpZiAoKHRlbXBCdWZmZXJbMF0ueiB8fCB0ZW1wQnVmZmVyWzBdLmR1KSAmJiB0ZW1wQnVmZmVyWzBdLnggJiYgdGVtcEJ1ZmZlclswXS55KSB7XG4gICAgICAgICAgICBleHBvcnRzLmNvbnRyb2xsZXJSZXNldENvdW50ZG93bnNbaV0gLT0gMTtcbiAgICAgICAgICAgIGlmIChleHBvcnRzLmNvbnRyb2xsZXJSZXNldENvdW50ZG93bnNbaV0gPT09IDApIHtcbiAgICAgICAgICAgICAgICAvLyB0cmlnZ2VycyBjb2RlIGluIGlucHV0LmpzXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJDb250cm9sbGVyICNcIiArIChpICsgMSkgKyBcIiB3YXMgcmVzZXQhXCIpO1xuICAgICAgICAgICAgICAgICgwLCBqcXVlcnlfMS5kZWZhdWx0KShcIiNyZXNldEluZGljYXRvclwiICsgaSkuZmFkZUluKDEwMCk7XG4gICAgICAgICAgICAgICAgKDAsIGpxdWVyeV8xLmRlZmF1bHQpKFwiI3Jlc2V0SW5kaWNhdG9yXCIgKyBpKS5mYWRlT3V0KDUwMCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBleHBvcnRzLmNvbnRyb2xsZXJSZXNldENvdW50ZG93bnNbaV0gPSAxMjU7XG4gICAgICAgIH1cbiAgICAgICAgaW50ZXJwcmV0UGF1c2UoZXhwb3J0cy5wYXVzZVtpXVswXSwgZXhwb3J0cy5wYXVzZVtpXVsxXSk7XG4gICAgfVxuICAgIGVsc2UgeyAvLyBBSVxuICAgICAgICB0ZW1wQnVmZmVyWzBdLnJhd1ggPSB0ZW1wQnVmZmVyWzBdLmxzWDtcbiAgICAgICAgdGVtcEJ1ZmZlclswXS5yYXdZID0gdGVtcEJ1ZmZlclswXS5sc1k7XG4gICAgICAgIHRlbXBCdWZmZXJbMF0ucmF3Y3NYID0gdGVtcEJ1ZmZlclswXS5jc1g7XG4gICAgICAgIHRlbXBCdWZmZXJbMF0ucmF3Y3NZID0gdGVtcEJ1ZmZlclswXS5jc1k7XG4gICAgICAgIHRlbXBCdWZmZXJbMF0ubHNYID0gKDAsIG1lbGVlSW5wdXRzXzEuZGVhZGVuKSh0ZW1wQnVmZmVyWzBdLnJhd1gpO1xuICAgICAgICB0ZW1wQnVmZmVyWzBdLmxzWSA9ICgwLCBtZWxlZUlucHV0c18xLmRlYWRlbikodGVtcEJ1ZmZlclswXS5yYXdZKTtcbiAgICAgICAgdGVtcEJ1ZmZlclswXS5jc1ggPSAoMCwgbWVsZWVJbnB1dHNfMS5kZWFkZW4pKHRlbXBCdWZmZXJbMF0ucmF3Y3NYKTtcbiAgICAgICAgdGVtcEJ1ZmZlclswXS5jc1kgPSAoMCwgbWVsZWVJbnB1dHNfMS5kZWFkZW4pKHRlbXBCdWZmZXJbMF0ucmF3Y3NZKTtcbiAgICB9XG4gICAgaWYgKGV4cG9ydHMuc2hvd0RlYnVnKSB7XG4gICAgICAgICgwLCBqcXVlcnlfMS5kZWZhdWx0KShcIiNsc0F4aXNYXCIgKyBpKS5lbXB0eSgpLmFwcGVuZCh0ZW1wQnVmZmVyWzBdLmxzWC50b0ZpeGVkKDMpKTtcbiAgICAgICAgKDAsIGpxdWVyeV8xLmRlZmF1bHQpKFwiI2xzQXhpc1lcIiArIGkpLmVtcHR5KCkuYXBwZW5kKHRlbXBCdWZmZXJbMF0ubHNZLnRvRml4ZWQoMykpO1xuICAgICAgICAoMCwganF1ZXJ5XzEuZGVmYXVsdCkoXCIjY3NBeGlzWFwiICsgaSkuZW1wdHkoKS5hcHBlbmQodGVtcEJ1ZmZlclswXS5jc1gudG9GaXhlZCgzKSk7XG4gICAgICAgICgwLCBqcXVlcnlfMS5kZWZhdWx0KShcIiNjc0F4aXNZXCIgKyBpKS5lbXB0eSgpLmFwcGVuZCh0ZW1wQnVmZmVyWzBdLmNzWS50b0ZpeGVkKDMpKTtcbiAgICAgICAgKDAsIGpxdWVyeV8xLmRlZmF1bHQpKFwiI2xBbmFsb2dcIiArIGkpLmVtcHR5KCkuYXBwZW5kKHRlbXBCdWZmZXJbMF0ubEEudG9GaXhlZCgzKSk7XG4gICAgICAgICgwLCBqcXVlcnlfMS5kZWZhdWx0KShcIiNyQW5hbG9nXCIgKyBpKS5lbXB0eSgpLmFwcGVuZCh0ZW1wQnVmZmVyWzBdLnJBLnRvRml4ZWQoMykpO1xuICAgICAgICAoMCwgZHJhd0dhbWVwYWRfMS51cGRhdGVHYW1lcGFkU1ZHU3RhdGUpKGksIFwiZ2FtZXBhZFNWR1wiICsgaSwgdGVtcEJ1ZmZlclswXSk7XG4gICAgfVxuICAgIGlmIChleHBvcnRzLmdhbWVNb2RlID09PSAxNCkgeyAvLyBjb250cm9sbGVyIGNhbGlicmF0aW9uIHNjcmVlblxuICAgICAgICAoMCwgZHJhd0dhbWVwYWRfMS51cGRhdGVHYW1lcGFkU1ZHU3RhdGUpKGksIFwiZ2FtZXBhZFNWR0NhbGlicmF0aW9uXCIsIHRlbXBCdWZmZXJbMF0pO1xuICAgIH1cbiAgICBpZiAoZXhwb3J0cy5zaG93RGVidWcgfHwgZXhwb3J0cy5nYW1lTW9kZSA9PT0gMTQpIHtcbiAgICAgICAgY29uc3Qgd2hpY2ggPSAoZXhwb3J0cy5zaG93RGVidWcgJiYgZXhwb3J0cy5nYW1lTW9kZSA9PT0gMTQpID8gXCJib3RoXCIgOiBleHBvcnRzLnNob3dEZWJ1ZyA/IFwiZGVidWdcIiA6IFwiY2FsaWJyYXRpb25cIjtcbiAgICAgICAgaWYgKHRlbXBCdWZmZXJbMF0ueCAmJiAhdGVtcEJ1ZmZlclsxXS54ICYmIHRlbXBCdWZmZXJbMF0uZHUpIHtcbiAgICAgICAgICAgICgwLCBkcmF3R2FtZXBhZF8xLmN5Y2xlR2FtZXBhZENvbG91cikoaSwgd2hpY2gsIHRydWUpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0ZW1wQnVmZmVyWzBdLnkgJiYgIXRlbXBCdWZmZXJbMV0ueSAmJiB0ZW1wQnVmZmVyWzBdLmR1KSB7XG4gICAgICAgICAgICAoMCwgZHJhd0dhbWVwYWRfMS5jeWNsZUdhbWVwYWRDb2xvdXIpKGksIHdoaWNoLCBmYWxzZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaWYgKHN0cmVhbWNsaWVudF8xLmdpdmVJbnB1dHNbaV0gPT09IHRydWUpIHtcbiAgICAgICAgLy90dXJucyBvdXQga2V5Ym9hcmRzIGxlYXZlIGdhcHMgaW4gdGhlIGlucHV0IGJ1ZmZlclxuICAgICAgICAoMCwgZGVlcENvcHlPYmplY3RfMS5kZWVwT2JqZWN0TWVyZ2UpKHRydWUsICgwLCBpbnB1dF8xLm51bGxJbnB1dCkoKSwgdGVtcEJ1ZmZlclswXSk7XG4gICAgICAgICgwLCBzdHJlYW1jbGllbnRfMS51cGRhdGVOZXR3b3JrSW5wdXRzKSh0ZW1wQnVmZmVyWzBdLCBpKTtcbiAgICB9XG4gICAgaWYgKGFjdGl2ZSkge1xuICAgICAgICBpZiAodGVtcEJ1ZmZlclswXS5kbCAmJiAhdGVtcEJ1ZmZlclsxXS5kbCkge1xuICAgICAgICAgICAgZXhwb3J0cy5wbGF5ZXJbaV0uc2hvd0xlZGdlR3JhYkJveCBePSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0ZW1wQnVmZmVyWzBdLmRkICYmICF0ZW1wQnVmZmVyWzFdLmRkKSB7XG4gICAgICAgICAgICBleHBvcnRzLnBsYXllcltpXS5zaG93RUNCIF49IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRlbXBCdWZmZXJbMF0uZHIgJiYgIXRlbXBCdWZmZXJbMV0uZHIpIHtcbiAgICAgICAgICAgIGV4cG9ydHMucGxheWVyW2ldLnNob3dIaXRib3ggXj0gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBpZiAoZXhwb3J0cy5mcmFtZUJ5RnJhbWUpIHtcbiAgICAgICAgdGVtcEJ1ZmZlclswXS56ID0gZmFsc2U7XG4gICAgfVxuICAgIHJldHVybiB0ZW1wQnVmZmVyO1xufVxuZnVuY3Rpb24gaW50ZXJwcmV0UGF1c2UocGF1c2UwLCBwYXVzZTEpIHtcbiAgICBpZiAocGF1c2UwICYmICFwYXVzZTEpIHtcbiAgICAgICAgaWYgKGV4cG9ydHMuZ2FtZU1vZGUgPT0gMyB8fCBleHBvcnRzLmdhbWVNb2RlID09IDUpIHtcbiAgICAgICAgICAgIGV4cG9ydHMucGxheWluZyBePSB0cnVlO1xuICAgICAgICAgICAgaWYgKCFleHBvcnRzLnBsYXlpbmcpIHtcbiAgICAgICAgICAgICAgICBzZnhfMS5zb3VuZHMucGF1c2UucGxheSgpO1xuICAgICAgICAgICAgICAgIGNoYW5nZVZvbHVtZShtdXNpY18xLk11c2ljTWFuYWdlciwgYXVkaW9tZW51XzEubWFzdGVyVm9sdW1lWzFdICogMC4zLCAxKTtcbiAgICAgICAgICAgICAgICAoMCwgcmVuZGVyXzEucmVuZGVyRm9yZWdyb3VuZCkoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGNoYW5nZVZvbHVtZShtdXNpY18xLk11c2ljTWFuYWdlciwgYXVkaW9tZW51XzEubWFzdGVyVm9sdW1lWzFdLCAxKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn1cbmV4cG9ydHMuYmcxID0gMDtcbmV4cG9ydHMuYmcyID0gMDtcbmV4cG9ydHMuZmcxID0gMDtcbmV4cG9ydHMuZmcyID0gMDtcbmV4cG9ydHMudWkgPSAwO1xuZXhwb3J0cy5jID0gMDtcbmV4cG9ydHMuY2FudmFzTWFpbiA9IDA7XG5leHBvcnRzLmxheWVycyA9IHtcbiAgICBCRzE6IG51bGwsXG4gICAgQkcyOiBudWxsLFxuICAgIEZHMTogbnVsbCxcbiAgICBGRzI6IG51bGwsXG4gICAgVUk6IG51bGxcbn07XG5leHBvcnRzLmxheWVyU3dpdGNoZXMgPSB7XG4gICAgQkcxOiB0cnVlLFxuICAgIEJHMjogdHJ1ZSxcbiAgICBGRzE6IHRydWUsXG4gICAgRkcyOiB0cnVlLFxuICAgIFVJOiB0cnVlXG59O1xuZnVuY3Rpb24gcmVuZGVyVG9NYWluKCkge1xuICAgIHZhciBrZXlzID0gT2JqZWN0LmtleXMoZXhwb3J0cy5sYXllcnMpO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwga2V5cy5sZW5ndGg7IGkrKykge1xuICAgICAgICBpZiAoZXhwb3J0cy5sYXllclN3aXRjaGVzW2tleXNbaV1dKSB7XG4gICAgICAgICAgICBleHBvcnRzLmMuZHJhd0ltYWdlKGV4cG9ydHMubGF5ZXJzW2tleXNbaV1dLCAwLCAwKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbmZ1bmN0aW9uIHVwZGF0ZShpLCBpbnB1dEJ1ZmZlcnMpIHtcbiAgICBpZiAoIWV4cG9ydHMuc3RhcnRpbmcpIHtcbiAgICAgICAgaWYgKGV4cG9ydHMuY3VycmVudFBsYXllcnNbaV0gIT0gLTEpIHtcbiAgICAgICAgICAgIGlmIChleHBvcnRzLnBsYXllclR5cGVbaV0gPT0gMCkge1xuICAgICAgICAgICAgICAgIC8vIGRvIG5vdGhpbmcsIHVzZSB0aGUgcHJvdmlkZWQgcGxheWVyIGkgaW5wdXRzXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChleHBvcnRzLnBsYXllclR5cGVbaV0gPT09IDEpIHtcbiAgICAgICAgICAgICAgICBpZiAoZXhwb3J0cy5wbGF5ZXJbaV0uYWN0aW9uU3RhdGUgIT0gXCJTTEVFUFwiKSB7XG4gICAgICAgICAgICAgICAgICAgICgwLCBhaV8xLnJ1bkFJKShpKTsgLy8gbm8gbmVlZCB0byByZXR1cm4gaW5wdXQgc2luY2UgcG9sbGluZyByZXR1cm5zIGFpIGlucHV0IGlmIHRoZXkgYXJlIGFjdGl2ZVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICAoMCwgcGh5c2ljc18xLnBoeXNpY3MpKGksIGlucHV0QnVmZmVycyk7XG59XG5sZXQgZGVsdGEgPSAwO1xubGV0IGxhc3RGcmFtZVRpbWVNcyA9IDA7XG5sZXQgbGFzdFVwZGF0ZSA9IHBlcmZvcm1hbmNlLm5vdygpO1xuZnVuY3Rpb24gZ2FtZVRpY2sob2xkSW5wdXRCdWZmZXJzKSB7XG4gICAgdmFyIHN0YXJ0ID0gcGVyZm9ybWFuY2Uubm93KCk7XG4gICAgdmFyIGRpZmYgPSAwO1xuICAgIGxldCBpbnB1dCA9IFsoMCwgaW5wdXRfMS5udWxsSW5wdXRzKSgpLCAoMCwgaW5wdXRfMS5udWxsSW5wdXRzKSgpLCAoMCwgaW5wdXRfMS5udWxsSW5wdXRzKSgpLCAoMCwgaW5wdXRfMS5udWxsSW5wdXRzKSgpXTtcbiAgICBpZiAoZXhwb3J0cy5nYW1lTW9kZSA9PSAwIHx8IGV4cG9ydHMuZ2FtZU1vZGUgPT0gMjApIHtcbiAgICAgICAgZmluZFBsYXllcnMoKTtcbiAgICB9XG4gICAgZWxzZSBpZiAoZXhwb3J0cy5nYW1lTW9kZSA9PSAxKSB7XG4gICAgICAgIC8vY29uc29sZS5sb2cocGxheWVyVHlwZSk7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZXhwb3J0cy5wb3J0czsgaSsrKSB7XG4gICAgICAgICAgICBpbnB1dFtpXSA9IGludGVycHJldElucHV0cyhpLCB0cnVlLCBleHBvcnRzLnBsYXllclR5cGVbaV0sIG9sZElucHV0QnVmZmVyc1tpXSk7XG4gICAgICAgICAgICAoMCwgbWVudV8xLm1lbnVNb3ZlKShpLCBpbnB1dCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSBpZiAoZXhwb3J0cy5nYW1lTW9kZSA9PSAxMCkge1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGV4cG9ydHMucG9ydHM7IGkrKykge1xuICAgICAgICAgICAgaW5wdXRbaV0gPSBpbnRlcnByZXRJbnB1dHMoaSwgdHJ1ZSwgZXhwb3J0cy5wbGF5ZXJUeXBlW2ldLCBvbGRJbnB1dEJ1ZmZlcnNbaV0pO1xuICAgICAgICAgICAgKDAsIGF1ZGlvbWVudV8xLmF1ZGlvTWVudUNvbnRyb2xzKShpLCBpbnB1dCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSBpZiAoZXhwb3J0cy5nYW1lTW9kZSA9PSAxMSkge1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGV4cG9ydHMucG9ydHM7IGkrKykge1xuICAgICAgICAgICAgaW5wdXRbaV0gPSBpbnRlcnByZXRJbnB1dHMoaSwgdHJ1ZSwgZXhwb3J0cy5wbGF5ZXJUeXBlW2ldLCBvbGRJbnB1dEJ1ZmZlcnNbaV0pO1xuICAgICAgICAgICAgKDAsIGdhbWVwbGF5bWVudV8xLmdhbWVwbGF5TWVudUNvbnRyb2xzKShpLCBpbnB1dCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSBpZiAoZXhwb3J0cy5nYW1lTW9kZSA9PSAxMikge1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGV4cG9ydHMucG9ydHM7IGkrKykge1xuICAgICAgICAgICAgaW5wdXRbaV0gPSBpbnRlcnByZXRJbnB1dHMoaSwgdHJ1ZSwgZXhwb3J0cy5wbGF5ZXJUeXBlW2ldLCBvbGRJbnB1dEJ1ZmZlcnNbaV0pO1xuICAgICAgICAgICAgKDAsIGtleWJvYXJkbWVudV8xLmtleWJvYXJkTWVudUNvbnRyb2xzKShpLCBpbnB1dCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSBpZiAoZXhwb3J0cy5nYW1lTW9kZSA9PSAxMykge1xuICAgICAgICAvL3RhcmdldFxuICAgIH1cbiAgICBlbHNlIGlmIChleHBvcnRzLmdhbWVNb2RlID09IDE0KSB7XG4gICAgICAgIC8vIGNvbnRyb2xsZXIgY2FsaWJyYXRpb25cbiAgICAgICAgaW5wdXRbZXhwb3J0cy5jYWxpYnJhdGlvblBsYXllcl0gPSBpbnRlcnByZXRJbnB1dHMoZXhwb3J0cy5jYWxpYnJhdGlvblBsYXllciwgdHJ1ZSwgZXhwb3J0cy5wbGF5ZXJUeXBlW2V4cG9ydHMuY2FsaWJyYXRpb25QbGF5ZXJdLCBvbGRJbnB1dEJ1ZmZlcnNbZXhwb3J0cy5jYWxpYnJhdGlvblBsYXllcl0pO1xuICAgIH1cbiAgICBlbHNlIGlmIChleHBvcnRzLmdhbWVNb2RlID09IDE1KSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZXhwb3J0cy5wb3J0czsgaSsrKSB7XG4gICAgICAgICAgICBpbnB1dFtpXSA9IGludGVycHJldElucHV0cyhpLCB0cnVlLCBleHBvcnRzLnBsYXllclR5cGVbaV0sIG9sZElucHV0QnVmZmVyc1tpXSk7XG4gICAgICAgICAgICAoMCwgbWVudV8xLm1lbnVNb3ZlKShpLCBpbnB1dCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSBpZiAoZXhwb3J0cy5nYW1lTW9kZSA9PSAyKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgNDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAoaSA8IGV4cG9ydHMucG9ydHMpIHtcbiAgICAgICAgICAgICAgICBpbnB1dFtpXSA9IGludGVycHJldElucHV0cyhpLCB0cnVlLCBleHBvcnRzLnBsYXllclR5cGVbaV0sIG9sZElucHV0QnVmZmVyc1tpXSk7XG4gICAgICAgICAgICAgICAgKDAsIGNzc18xLmNzc0NvbnRyb2xzKShpLCBpbnB1dCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBhY3Rpb25TdGF0ZVNob3J0Y3V0c18xLmFjdGlvblN0YXRlc1tleHBvcnRzLmNoYXJhY3RlclNlbGVjdGlvbnNbaV1dW2V4cG9ydHMucGxheWVyW2ldLmFjdGlvblN0YXRlXS5tYWluKGksIGlucHV0KTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IDQ7IGkrKykge1xuICAgICAgICAgICAgaWYgKGV4cG9ydHMucGxheWVyVHlwZVtpXSA+IC0xKSB7XG4gICAgICAgICAgICAgICAgKDAsIGhpdERldGVjdGlvbl8xLmhpdERldGVjdCkoaSwgaW5wdXQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgICgwLCBoaXREZXRlY3Rpb25fMS5leGVjdXRlSGl0cykoaW5wdXQpO1xuICAgICAgICAoMCwgaGl0RGV0ZWN0aW9uXzEucmVzZXRIaXRRdWV1ZSkoKTtcbiAgICAgICAgZmluZFBsYXllcnMoKTtcbiAgICB9XG4gICAgZWxzZSBpZiAoZXhwb3J0cy5nYW1lTW9kZSA9PSA2KSB7XG4gICAgICAgIC8vIHN0YWdlIHNlbGVjdFxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IDQ7IGkrKykge1xuICAgICAgICAgICAgaWYgKGkgPCBleHBvcnRzLnBvcnRzKSB7XG4gICAgICAgICAgICAgICAgaW5wdXRbaV0gPSBpbnRlcnByZXRJbnB1dHMoaSwgdHJ1ZSwgZXhwb3J0cy5wbGF5ZXJUeXBlW2ldLCBvbGRJbnB1dEJ1ZmZlcnNbaV0pO1xuICAgICAgICAgICAgICAgICgwLCBzdGFnZXNlbGVjdF8xLnNzc0NvbnRyb2xzKShpLCBpbnB1dCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSBpZiAoZXhwb3J0cy5wbGF5aW5nIHx8IGV4cG9ydHMuZnJhbWVCeUZyYW1lKSB7XG4gICAgICAgIC8vY29uc29sZS5sb2coXCJ0ZXN0MFwiKTtcbiAgICAgICAgLypkZWx0YSA9IHRpbWVzdGFtcCAtIGxhc3RGcmFtZVRpbWVNczsgLy8gZ2V0IHRoZSBkZWx0YSB0aW1lIHNpbmNlIGxhc3QgZnJhbWVcbiAgICAgICAgbGFzdEZyYW1lVGltZU1zID0gdGltZXN0YW1wO1xuICAgICAgICBjb25zb2xlLmxvZyhkZWx0YSk7Ki9cbiAgICAgICAgdmFyIG5vdyA9IHBlcmZvcm1hbmNlLm5vdygpO1xuICAgICAgICB2YXIgZHQgPSBub3cgLSBsYXN0VXBkYXRlO1xuICAgICAgICAvL2NvbnNvbGUubG9nKG5vdyk7XG4gICAgICAgIC8vY29uc29sZS5sb2coZHQpO1xuICAgICAgICBsYXN0VXBkYXRlID0gbm93O1xuICAgICAgICAoMCwgaGl0RGV0ZWN0aW9uXzEucmVzZXRIaXRRdWV1ZSkoKTtcbiAgICAgICAgKDAsIGFjdGl2ZVN0YWdlXzEuZ2V0QWN0aXZlU3RhZ2UpKCkubW92aW5nUGxhdGZvcm1zKCk7XG4gICAgICAgICgwLCBhcnRpY2xlXzEuZGVzdHJveUFydGljbGVzKSgpO1xuICAgICAgICAoMCwgYXJ0aWNsZV8xLmV4ZWN1dGVBcnRpY2xlcykoKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCA0OyBpKyspIHtcbiAgICAgICAgICAgIGlmIChleHBvcnRzLnBsYXllclR5cGVbaV0gPiAtMSkge1xuICAgICAgICAgICAgICAgIGlmICghZXhwb3J0cy5zdGFydGluZykge1xuICAgICAgICAgICAgICAgICAgICBpbnB1dFtpXSA9IGludGVycHJldElucHV0cyhpLCB0cnVlLCBleHBvcnRzLnBsYXllclR5cGVbaV0sIG9sZElucHV0QnVmZmVyc1tpXSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHVwZGF0ZShpLCBpbnB1dCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgKDAsIGhpdERldGVjdGlvbl8xLmNoZWNrUGhhbnRvbXMpKCk7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgNDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAoZXhwb3J0cy5wbGF5ZXJUeXBlW2ldID4gLTEpIHtcbiAgICAgICAgICAgICAgICAoMCwgaGl0RGV0ZWN0aW9uXzEuaGl0RGV0ZWN0KShpLCBpbnB1dCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgKDAsIGhpdERldGVjdGlvbl8xLmV4ZWN1dGVIaXRzKShpbnB1dCk7XG4gICAgICAgICgwLCBhcnRpY2xlXzEuYXJ0aWNsZXNIaXREZXRlY3Rpb24pKCk7XG4gICAgICAgICgwLCBhcnRpY2xlXzEuZXhlY3V0ZUFydGljbGVIaXRzKShpbnB1dCk7XG4gICAgICAgIGlmICghZXhwb3J0cy5zdGFydGluZyAmJiAhZXhwb3J0cy52ZXJzdXNNb2RlKSB7XG4gICAgICAgICAgICBtYXRjaFRpbWVyVGljayhpbnB1dCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBleHBvcnRzLnN0YXJ0VGltZXIgLT0gMC4wMTY2NjY2NztcbiAgICAgICAgICAgIGlmIChleHBvcnRzLnN0YXJ0VGltZXIgPCAwKSB7XG4gICAgICAgICAgICAgICAgZXhwb3J0cy5zdGFydGluZyA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChleHBvcnRzLmZyYW1lQnlGcmFtZSkge1xuICAgICAgICAgICAgZXhwb3J0cy5mcmFtZUJ5RnJhbWVSZW5kZXIgPSB0cnVlO1xuICAgICAgICAgICAgZXhwb3J0cy53YXNGcmFtZUJ5RnJhbWUgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGV4cG9ydHMuZnJhbWVCeUZyYW1lID0gZmFsc2U7XG4gICAgICAgIGlmIChleHBvcnRzLnNob3dEZWJ1Zykge1xuICAgICAgICAgICAgZGlmZiA9IHBlcmZvcm1hbmNlLm5vdygpIC0gc3RhcnQ7XG4gICAgICAgICAgICBleHBvcnRzLmdhbWVsb2dpY1RpbWVbMF0gKz0gZGlmZjtcbiAgICAgICAgICAgIGV4cG9ydHMuZ2FtZWxvZ2ljVGltZVswXSAvPSAyO1xuICAgICAgICAgICAgaWYgKGRpZmYgPj0gMTApIHtcbiAgICAgICAgICAgICAgICBleHBvcnRzLmdhbWVsb2dpY1RpbWVbM10rKztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChkaWZmIDwgZXhwb3J0cy5nYW1lbG9naWNUaW1lWzJdKSB7XG4gICAgICAgICAgICAgICAgZXhwb3J0cy5nYW1lbG9naWNUaW1lWzJdID0gZGlmZjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChkaWZmID4gZXhwb3J0cy5nYW1lbG9naWNUaW1lWzFdKSB7XG4gICAgICAgICAgICAgICAgZXhwb3J0cy5nYW1lbG9naWNUaW1lWzFdID0gZGlmZjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGRvbS5nYW1lbG9naWNBdmcuaW5uZXJIVE1MID0gTWF0aC5yb3VuZChleHBvcnRzLmdhbWVsb2dpY1RpbWVbMF0pO1xuICAgICAgICAgICAgZG9tLmdhbWVsb2dpY0hpZ2guaW5uZXJIVE1MID0gTWF0aC5yb3VuZChleHBvcnRzLmdhbWVsb2dpY1RpbWVbMV0pO1xuICAgICAgICAgICAgZG9tLmdhbWVsb2dpY0xvdy5pbm5lckhUTUwgPSBNYXRoLnJvdW5kKGV4cG9ydHMuZ2FtZWxvZ2ljVGltZVsyXSk7XG4gICAgICAgICAgICBkb20uZ2FtZWxvZ2ljUGVhay5pbm5lckhUTUwgPSBleHBvcnRzLmdhbWVsb2dpY1RpbWVbM107XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSBpZiAoZXhwb3J0cy5maW5kaW5nUGxheWVycykge1xuICAgICAgICBmaW5kUGxheWVycygpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgaWYgKCFleHBvcnRzLmdhbWVFbmQpIHtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgNDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgaWYgKGV4cG9ydHMucGxheWVyVHlwZVtpXSA9PSAwIHx8IGV4cG9ydHMucGxheWVyVHlwZVtpXSA9PSAyKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChleHBvcnRzLmN1cnJlbnRQbGF5ZXJzW2ldICE9IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpbnB1dFtpXSA9IGludGVycHJldElucHV0cyhpLCBmYWxzZSwgZXhwb3J0cy5wbGF5ZXJUeXBlW2ldLCBvbGRJbnB1dEJ1ZmZlcnNbaV0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIC8qXG4gIFxuICAgIHZhciBiZWZvcmVXYXN0ZXIgPSBwZXJmb3JtYW5jZS5ub3coKTtcbiAgICAvLyBuZWVlZCB0byB3YXN0ZSAwLjY2Nm1zXG4gICAgdmFyIHRpbWVXYXN0ZWQgPSBmYWxzZTtcbiAgICB2YXIgdCA9IDA7XG4gICAgdmFyIG8gPSBwZXJmb3JtYW5jZS5ub3coKTtcbiAgICB3aGlsZSghdGltZVdhc3RlZCl7XG4gICAgICB2YXIgbiA9IHBlcmZvcm1hbmNlLm5vdygpO1xuICAgICAgdCArPSBuIC0gbztcbiAgICAgIC8vY29uc29sZS5sb2codCk7XG4gICAgICBpZiAodCA+IDAuNjY2Nil7XG4gICAgICAgIHRpbWVXYXN0ZWQgPSB0cnVlO1xuICAgICAgfVxuICAgICAgbyA9IG47XG4gICAgICAvL2NvbnNvbGUubG9nKFwiLlwiKTtcbiAgICB9XG4gICAgLy9jb25zb2xlLmxvZyhwZXJmb3JtYW5jZS5ub3coKSAtIGJlZm9yZVdhc3Rlcik7Ki9cbiAgICAoMCwgcmVwbGF5XzEuc2F2ZUdhbWVTdGF0ZSkoaW5wdXQsIGV4cG9ydHMucG9ydHMpO1xuICAgIHNldFRpbWVvdXQoZ2FtZVRpY2ssIDE2LCBpbnB1dCk7XG59XG5mdW5jdGlvbiBjbGVhclNjcmVlbigpIHtcbiAgICAvL2JnMS5maWxsU3R5bGUgPSBcInJnYigwLCAwLCAwKVwiO1xuICAgIC8vYmcxLmZpbGxSZWN0KDAsMCxsYXllcnMuQkcxLndpZHRoLGxheWVycy5CRzEuaGVpZ2h0KTtcbiAgICBleHBvcnRzLmJnMi5jbGVhclJlY3QoMCwgMCwgZXhwb3J0cy5sYXllcnMuQkcyLndpZHRoLCBleHBvcnRzLmxheWVycy5CRzIuaGVpZ2h0KTtcbiAgICAvL2ZnMS5jbGVhclJlY3QoMCwwLGxheWVycy5GRzEud2lkdGgsbGF5ZXJzLkZHMS5oZWlnaHQpO1xuICAgIGV4cG9ydHMuZmcyLmNsZWFyUmVjdCgwLCAwLCBleHBvcnRzLmxheWVycy5GRzIud2lkdGgsIGV4cG9ydHMubGF5ZXJzLkZHMi5oZWlnaHQpO1xuICAgIGV4cG9ydHMudWkuY2xlYXJSZWN0KDAsIDAsIGV4cG9ydHMubGF5ZXJzLlVJLndpZHRoLCBleHBvcnRzLmxheWVycy5VSS5oZWlnaHQpO1xufVxubGV0IG90aGVyRnJhbWUgPSB0cnVlO1xubGV0IGZwczMwID0gZmFsc2U7XG5mdW5jdGlvbiByZW5kZXJUaWNrKCkge1xuICAgIHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUocmVuZGVyVGljayk7XG4gICAgb3RoZXJGcmFtZSBePSB0cnVlO1xuICAgIGlmICgoZnBzMzAgJiYgb3RoZXJGcmFtZSkgfHwgIWZwczMwKSB7XG4gICAgICAgIC8vY29uc29sZS5sb2coXCItLS0tLS1cIik7XG4gICAgICAgIGlmIChleHBvcnRzLmdhbWVNb2RlID09IDIwKSB7XG4gICAgICAgICAgICAoMCwgc3RhcnR1cF8xLmRyYXdTdGFydFVwKSgpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGV4cG9ydHMuZ2FtZU1vZGUgPT0gMTApIHtcbiAgICAgICAgICAgICgwLCBhdWRpb21lbnVfMS5kcmF3QXVkaW9NZW51KSgpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGV4cG9ydHMuZ2FtZU1vZGUgPT0gMTEpIHtcbiAgICAgICAgICAgICgwLCBnYW1lcGxheW1lbnVfMS5kcmF3R2FtZXBsYXlNZW51KSgpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGV4cG9ydHMuZ2FtZU1vZGUgPT0gMTIpIHtcbiAgICAgICAgICAgICgwLCBrZXlib2FyZG1lbnVfMS5kcmF3S2V5Ym9hcmRNZW51KSgpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGV4cG9ydHMuZ2FtZU1vZGUgPT0gMTMpIHtcbiAgICAgICAgICAgIGRyYXdDcmVkaXRzKCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoZXhwb3J0cy5nYW1lTW9kZSA9PSAxNCkge1xuICAgICAgICAgICAgKDAsIGNvbnRyb2xsZXJtZW51XzEuZHJhd0NvbnRyb2xsZXJNZW51KSgpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGV4cG9ydHMuZ2FtZU1vZGUgPT0gMCkge1xuICAgICAgICAgICAgKDAsIHN0YXJ0c2NyZWVuXzEuZHJhd1N0YXJ0U2NyZWVuKSgpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGV4cG9ydHMuZ2FtZU1vZGUgPT0gMSkge1xuICAgICAgICAgICAgKDAsIG1lbnVfMS5kcmF3TWFpbk1lbnUpKCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoZXhwb3J0cy5nYW1lTW9kZSA9PSAyKSB7XG4gICAgICAgICAgICAoMCwgY3NzXzEuZHJhd0NTUykoKTtcbiAgICAgICAgICAgIC8vcmVuZGVyVmZ4KCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoZXhwb3J0cy5nYW1lTW9kZSA9PSA2KSB7XG4gICAgICAgICAgICAoMCwgc3RhZ2VzZWxlY3RfMS5kcmF3U1NTKSgpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGV4cG9ydHMucGxheWluZyB8fCBleHBvcnRzLmZyYW1lQnlGcmFtZVJlbmRlcikge1xuICAgICAgICAgICAgLypkZWx0YSA9IHRpbWVzdGFtcCAtIGxhc3RGcmFtZVRpbWVNczsgLy8gZ2V0IHRoZSBkZWx0YSB0aW1lIHNpbmNlIGxhc3QgZnJhbWVcbiAgICAgICAgICAgIGxhc3RGcmFtZVRpbWVNcyA9IHRpbWVzdGFtcDtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGRlbHRhKTsqL1xuICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhcInRlc3QyXCIpO1xuICAgICAgICAgICAgdmFyIHJTdGFydCA9IHBlcmZvcm1hbmNlLm5vdygpO1xuICAgICAgICAgICAgY2xlYXJTY3JlZW4oKTtcbiAgICAgICAgICAgIGlmICgoMCwgdmZ4XzEuaXNTaG93U0ZYKSgpKSB7XG4gICAgICAgICAgICAgICAgKDAsIHN0YWdlcmVuZGVyXzEuZHJhd0JhY2tncm91bmQpKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAoMCwgc3RhZ2VyZW5kZXJfMS5kcmF3U3RhZ2UpKCk7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IDQ7IGkrKykge1xuICAgICAgICAgICAgICAgIGlmIChleHBvcnRzLnBsYXllclR5cGVbaV0gPiAtMSkge1xuICAgICAgICAgICAgICAgICAgICAoMCwgcmVuZGVyXzEucmVuZGVyUGxheWVyKShpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAoMCwgYXJ0aWNsZV8xLnJlbmRlckFydGljbGVzKSgpO1xuICAgICAgICAgICAgKDAsIHJlbmRlclZmeF8xLnJlbmRlclZmeCkoKTtcbiAgICAgICAgICAgICgwLCByZW5kZXJfMS5yZW5kZXJPdmVybGF5KSh0cnVlKTtcbiAgICAgICAgICAgIGlmIChleHBvcnRzLnNob3dEZWJ1Zykge1xuICAgICAgICAgICAgICAgIHZhciBkaWZmID0gcGVyZm9ybWFuY2Uubm93KCkgLSByU3RhcnQ7XG4gICAgICAgICAgICAgICAgZXhwb3J0cy5yZW5kZXJUaW1lWzBdICs9IGRpZmY7XG4gICAgICAgICAgICAgICAgZXhwb3J0cy5yZW5kZXJUaW1lWzBdIC89IDI7XG4gICAgICAgICAgICAgICAgaWYgKGRpZmYgPj0gMTApIHtcbiAgICAgICAgICAgICAgICAgICAgZXhwb3J0cy5yZW5kZXJUaW1lWzNdKys7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChkaWZmID4gZXhwb3J0cy5yZW5kZXJUaW1lWzFdKSB7XG4gICAgICAgICAgICAgICAgICAgIGV4cG9ydHMucmVuZGVyVGltZVsxXSA9IGRpZmY7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChkaWZmIDwgZXhwb3J0cy5yZW5kZXJUaW1lWzJdKSB7XG4gICAgICAgICAgICAgICAgICAgIGV4cG9ydHMucmVuZGVyVGltZVsyXSA9IGRpZmY7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGRvbS5yZW5kZXJBdmcuaW5uZXJIVE1MID0gTWF0aC5yb3VuZChleHBvcnRzLnJlbmRlclRpbWVbMF0pO1xuICAgICAgICAgICAgICAgIGRvbS5yZW5kZXJIaWdoLmlubmVySFRNTCA9IE1hdGgucm91bmQoZXhwb3J0cy5yZW5kZXJUaW1lWzFdKTtcbiAgICAgICAgICAgICAgICBkb20ucmVuZGVyTG93LmlubmVySFRNTCA9IE1hdGgucm91bmQoZXhwb3J0cy5yZW5kZXJUaW1lWzJdKTtcbiAgICAgICAgICAgICAgICBkb20ucmVuZGVyUGVhay5pbm5lckhUTUwgPSBleHBvcnRzLnJlbmRlclRpbWVbM107XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGV4cG9ydHMuZnJhbWVCeUZyYW1lUmVuZGVyKSB7XG4gICAgICAgICAgICAoMCwgcmVuZGVyXzEucmVuZGVyRm9yZWdyb3VuZCkoKTtcbiAgICAgICAgfVxuICAgICAgICBleHBvcnRzLmZyYW1lQnlGcmFtZVJlbmRlciA9IGZhbHNlO1xuICAgICAgICAvL3JlbmRlclRvTWFpbigpO1xuICAgICAgICAvL2NvbnNvbGUubG9nKHBlcmZvcm1hbmNlLm5vdygpKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGlmIChleHBvcnRzLnBsYXlpbmcpIHtcbiAgICAgICAgICAgICgwLCByZW5kZXJWZnhfMS5yZW5kZXJWZngpKHRydWUpO1xuICAgICAgICB9XG4gICAgfVxufVxuZnVuY3Rpb24gYnVpbGRQbGF5ZXJPYmplY3QoaSkge1xuICAgIGV4cG9ydHMucGxheWVyW2ldID0gbmV3IHBsYXllcl8xLnBsYXllck9iamVjdChleHBvcnRzLmNoYXJhY3RlclNlbGVjdGlvbnNbaV0sIGV4cG9ydHMuc3RhcnRpbmdQb2ludFtpXSwgZXhwb3J0cy5zdGFydGluZ0ZhY2VbaV0pO1xuICAgIGV4cG9ydHMucGxheWVyW2ldLnBoeXMuRUNCMSA9IFtuZXcgVmVjMkRfMS5WZWMyRChleHBvcnRzLnN0YXJ0aW5nUG9pbnRbaV0ueCwgZXhwb3J0cy5zdGFydGluZ1BvaW50W2ldLnkpLCBuZXcgVmVjMkRfMS5WZWMyRChleHBvcnRzLnN0YXJ0aW5nUG9pbnRbaV0ueCwgZXhwb3J0cy5zdGFydGluZ1BvaW50W2ldLnkpLCBuZXcgVmVjMkRfMS5WZWMyRChleHBvcnRzLnN0YXJ0aW5nUG9pbnRbaV0ueCwgZXhwb3J0cy5zdGFydGluZ1BvaW50W2ldLnkpLCBuZXcgVmVjMkRfMS5WZWMyRChleHBvcnRzLnN0YXJ0aW5nUG9pbnRbaV0ueCwgZXhwb3J0cy5zdGFydGluZ1BvaW50W2ldLnkpXTtcbiAgICBleHBvcnRzLnBsYXllcltpXS5waHlzLkVDQnAgPSBbbmV3IFZlYzJEXzEuVmVjMkQoZXhwb3J0cy5zdGFydGluZ1BvaW50W2ldLngsIGV4cG9ydHMuc3RhcnRpbmdQb2ludFtpXS55KSwgbmV3IFZlYzJEXzEuVmVjMkQoZXhwb3J0cy5zdGFydGluZ1BvaW50W2ldLngsIGV4cG9ydHMuc3RhcnRpbmdQb2ludFtpXS55KSwgbmV3IFZlYzJEXzEuVmVjMkQoZXhwb3J0cy5zdGFydGluZ1BvaW50W2ldLngsIGV4cG9ydHMuc3RhcnRpbmdQb2ludFtpXS55KSwgbmV3IFZlYzJEXzEuVmVjMkQoZXhwb3J0cy5zdGFydGluZ1BvaW50W2ldLngsIGV4cG9ydHMuc3RhcnRpbmdQb2ludFtpXS55KV07XG4gICAgZXhwb3J0cy5wbGF5ZXJbaV0uZGlmZmljdWx0eSA9IGV4cG9ydHMuY3B1RGlmZmljdWx0eVtpXTtcbn1cbmZ1bmN0aW9uIGluaXRpYWxpemVQbGF5ZXJzKGksIHRhcmdldCkge1xuICAgIGJ1aWxkUGxheWVyT2JqZWN0KGkpO1xuICAgIGlmICh0YXJnZXQpIHtcbiAgICAgICAgKDAsIGRyYXdWZnhfMS5kcmF3VmZ4KSh7XG4gICAgICAgICAgICBuYW1lOiBcImVudHJhbmNlXCIsXG4gICAgICAgICAgICBwb3M6IG5ldyBWZWMyRF8xLlZlYzJEKGFjdGl2ZVN0YWdlXzEuYWN0aXZlU3RhZ2Uuc3RhcnRpbmdQb2ludFswXS54LCBhY3RpdmVTdGFnZV8xLmFjdGl2ZVN0YWdlLnN0YXJ0aW5nUG9pbnRbMF0ueSlcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICAoMCwgZHJhd1ZmeF8xLmRyYXdWZngpKHtcbiAgICAgICAgICAgIG5hbWU6IFwiZW50cmFuY2VcIixcbiAgICAgICAgICAgIHBvczogbmV3IFZlYzJEXzEuVmVjMkQoZXhwb3J0cy5zdGFydGluZ1BvaW50W2ldWzBdLCBleHBvcnRzLnN0YXJ0aW5nUG9pbnRbaV1bMV0pXG4gICAgICAgIH0pO1xuICAgIH1cbn1cbmZ1bmN0aW9uIHN0YXJ0R2FtZSgpIHtcbiAgICAoMCwgYWN0aXZlU3RhZ2VfMS5zZXRWc1N0YWdlKShleHBvcnRzLnN0YWdlU2VsZWN0KTtcbiAgICAoMCwgc3RhZ2VyZW5kZXJfMS5zZXRCYWNrZ3JvdW5kVHlwZSkoTWF0aC5yb3VuZChNYXRoLnJhbmRvbSgpKSk7XG4gICAgY2hhbmdlR2FtZW1vZGUoMyk7XG4gICAgKDAsIHZmeFF1ZXVlXzEucmVzZXRWZnhRdWV1ZSkoKTtcbiAgICBmb3IgKHZhciBuID0gMDsgbiA8IDQ7IG4rKykge1xuICAgICAgICBpZiAoZXhwb3J0cy5wbGF5ZXJUeXBlW25dID4gLTEpIHtcbiAgICAgICAgICAgIGluaXRpYWxpemVQbGF5ZXJzKG4sIGZhbHNlKTtcbiAgICAgICAgICAgICgwLCByZW5kZXJfMS5yZW5kZXJQbGF5ZXIpKG4pO1xuICAgICAgICAgICAgZXhwb3J0cy5wbGF5ZXJbbl0uaW5DU1MgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZXhwb3J0cy52ZXJzdXNNb2RlKSB7XG4gICAgICAgICAgICBleHBvcnRzLnBsYXllcltuXS5zdG9ja3MgPSAxO1xuICAgICAgICB9XG4gICAgfVxuICAgIGV4cG9ydHMubWF0Y2hUaW1lciA9IDQ4MDtcbiAgICBleHBvcnRzLnN0YXJ0VGltZXIgPSAxLjU7XG4gICAgZXhwb3J0cy5zdGFydGluZyA9IHRydWU7XG4gICAgbXVzaWNfMS5NdXNpY01hbmFnZXIuc3RvcFdoYXRpc1BsYXlpbmcoKTtcbiAgICBzd2l0Y2ggKGV4cG9ydHMuc3RhZ2VTZWxlY3QpIHtcbiAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgbXVzaWNfMS5NdXNpY01hbmFnZXIucGxheUJhdHRsZUZpZWxkTG9vcCgpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgIG11c2ljXzEuTXVzaWNNYW5hZ2VyLnBsYXl5U3RvcnlMb29wKCk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgbXVzaWNfMS5NdXNpY01hbmFnZXIucGxheXBTdGFkaXVtTG9vcCgpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgIG11c2ljXzEuTXVzaWNNYW5hZ2VyLnBsYXlEcmVhbUxhbmRMb29wKCk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgbXVzaWNfMS5NdXNpY01hbmFnZXIucGxheWZpbmFsZExvb3AoKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIDU6XG4gICAgICAgICAgICBtdXNpY18xLk11c2ljTWFuYWdlci5wbGF5Zm9kTG9vcCgpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICBicmVhaztcbiAgICB9XG4gICAgKDAsIGRyYXdWZnhfMS5kcmF3VmZ4KSh7XG4gICAgICAgIG5hbWU6IFwic3RhcnRcIixcbiAgICAgICAgcG9zOiBuZXcgVmVjMkRfMS5WZWMyRCgwLCAwKVxuICAgIH0pO1xuICAgIGV4cG9ydHMuZmluZGluZ1BsYXllcnMgPSBmYWxzZTtcbiAgICBleHBvcnRzLnBsYXlpbmcgPSB0cnVlO1xufVxuZnVuY3Rpb24gZW5kR2FtZShpbnB1dCkge1xuICAgIGV4cG9ydHMuZ2FtZUVuZCA9IGZhbHNlO1xuICAgICgwLCByZW5kZXJfMS5yZXNldExvc3RTdG9ja1F1ZXVlKSgpO1xuICAgICgwLCBoaXREZXRlY3Rpb25fMS5zZXRQaGFudG9uUXVldWUpKFtdKTtcbiAgICAoMCwgYXJ0aWNsZV8xLnJlc2V0QUFydGljbGVzKSgpO1xuICAgIG11c2ljXzEuTXVzaWNNYW5hZ2VyLnN0b3BXaGF0aXNQbGF5aW5nKCk7XG4gICAgY2hhbmdlVm9sdW1lKG11c2ljXzEuTXVzaWNNYW5hZ2VyLCBhdWRpb21lbnVfMS5tYXN0ZXJWb2x1bWVbMV0sIDEpO1xuICAgIGV4cG9ydHMucGxheWluZyA9IGZhbHNlO1xuICAgIGNsZWFyU2NyZWVuKCk7XG4gICAgKDAsIHN0YWdlcmVuZGVyXzEuZHJhd1N0YWdlKSgpO1xuICAgICgwLCBjc3NfMi5zZXRUb2tlblBvc1NuYXBUb0NoYXIpKDApO1xuICAgICgwLCBjc3NfMi5zZXRUb2tlblBvc1NuYXBUb0NoYXIpKDEpO1xuICAgICgwLCBjc3NfMi5zZXRUb2tlblBvc1NuYXBUb0NoYXIpKDIpO1xuICAgICgwLCBjc3NfMi5zZXRUb2tlblBvc1NuYXBUb0NoYXIpKDMpO1xuICAgIGlmIChleHBvcnRzLmdhbWVNb2RlID09IDMpIHtcbiAgICAgICAgY2hhbmdlR2FtZW1vZGUoMik7XG4gICAgICAgIG11c2ljXzEuTXVzaWNNYW5hZ2VyLnBsYXlNZW51TG9vcCgpO1xuICAgICAgICBleHBvcnRzLnBhdXNlID0gW1t0cnVlLCB0cnVlXSwgW3RydWUsIHRydWVdLCBbdHJ1ZSwgdHJ1ZV0sIFt0cnVlLCB0cnVlXV07XG4gICAgICAgIGV4cG9ydHMuZnJhbWVBZHZhbmNlID0gW1xuICAgICAgICAgICAgW3RydWUsIHRydWVdLFxuICAgICAgICAgICAgW3RydWUsIHRydWVdLFxuICAgICAgICAgICAgW3RydWUsIHRydWVdLFxuICAgICAgICAgICAgW3RydWUsIHRydWVdXG4gICAgICAgIF07XG4gICAgICAgIGV4cG9ydHMuZmluZGluZ1BsYXllcnMgPSB0cnVlO1xuICAgICAgICBwb3NpdGlvblBsYXllcnNJbkNTUygpO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IDQ7IGkrKykge1xuICAgICAgICAgICAgaWYgKGV4cG9ydHMucGxheWVyVHlwZVtpXSA+IC0xKSB7XG4gICAgICAgICAgICAgICAgaWYgKGV4cG9ydHMucGxheWVyW2ldLmFjdGlvblN0YXRlID09IFwiRlVSQUZVUkFcIikge1xuICAgICAgICAgICAgICAgICAgICBzZnhfMS5zb3VuZHMuZnVyYWxvb3Auc3RvcChleHBvcnRzLnBsYXllcltpXS5mdXJhTG9vcElEKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy9pbnB1dFtpXVswXS5hID0gdHJ1ZTsgLy8gZG9cbiAgICAgICAgICAgICAgICAvL2lucHV0W2ldWzFdLmEgPSB0cnVlOyAvLyBub3RcbiAgICAgICAgICAgICAgICBleHBvcnRzLnBsYXllcltpXS5pbkNTUyA9IHRydWU7XG4gICAgICAgICAgICAgICAgZXhwb3J0cy5wbGF5ZXJbaV0ucGh5cy5mYWNlID0gMTtcbiAgICAgICAgICAgICAgICBleHBvcnRzLnBsYXllcltpXS5hY3Rpb25TdGF0ZSA9IFwiV0FJVFwiO1xuICAgICAgICAgICAgICAgIGV4cG9ydHMucGxheWVyW2ldLnRpbWVyID0gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn1cbmZ1bmN0aW9uIGZpbmlzaEdhbWUoaW5wdXQpIHtcbiAgICBleHBvcnRzLmdhbWVFbmQgPSB0cnVlO1xuICAgIGV4cG9ydHMucGxheWluZyA9IGZhbHNlO1xuICAgIGV4cG9ydHMuZmcyLnNhdmUoKTtcbiAgICBleHBvcnRzLmZnMi50ZXh0QWxpZ24gPSBcImNlbnRlclwiO1xuICAgIHZhciB0ZXh0ID0gXCJHYW1lIVwiO1xuICAgIHZhciBzaXplID0gMzAwO1xuICAgIHZhciB0ZXh0U2NhbGUgPSAxO1xuICAgIHZhciB0ZXh0R3JhZCA9IGV4cG9ydHMuZmcyLmNyZWF0ZUxpbmVhckdyYWRpZW50KDAsIDIwMCwgMCwgNTIwKTtcbiAgICBpZiAoZXhwb3J0cy5tYXRjaFRpbWVyIDw9IDApIHtcbiAgICAgICAgdGV4dCA9IFwiVGltZSFcIjtcbiAgICAgICAgc2Z4XzEuc291bmRzLnRpbWUucGxheSgpO1xuICAgICAgICB0ZXh0R3JhZC5hZGRDb2xvclN0b3AoMCwgXCJibGFja1wiKTtcbiAgICAgICAgdGV4dEdyYWQuYWRkQ29sb3JTdG9wKDAuNSwgXCJibGFja1wiKTtcbiAgICAgICAgdGV4dEdyYWQuYWRkQ29sb3JTdG9wKDAuNywgXCJyZ2IoMjEsIDUxLCAxODApXCIpO1xuICAgICAgICB0ZXh0R3JhZC5hZGRDb2xvclN0b3AoMSwgXCJyZ2IoNzEsIDk0LCAyNTApXCIpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgc2Z4XzEuc291bmRzLmdhbWUucGxheSgpO1xuICAgICAgICB0ZXh0R3JhZC5hZGRDb2xvclN0b3AoMCwgXCJibGFja1wiKTtcbiAgICAgICAgdGV4dEdyYWQuYWRkQ29sb3JTdG9wKDAuNCwgXCJibGFja1wiKTtcbiAgICAgICAgdGV4dEdyYWQuYWRkQ29sb3JTdG9wKDAuNywgXCJyZ2IoMTY3LCAyNywgNDApXCIpO1xuICAgICAgICB0ZXh0R3JhZC5hZGRDb2xvclN0b3AoMSwgXCJyZ2IoMjU1LCAzMSwgNTIpXCIpO1xuICAgIH1cbiAgICBleHBvcnRzLmZnMi5zY2FsZSgxLCB0ZXh0U2NhbGUpO1xuICAgIGV4cG9ydHMuZmcyLmZpbGxTdHlsZSA9IHRleHRHcmFkO1xuICAgIGV4cG9ydHMuZmcyLmxpbmVXaWR0aCA9IDQwO1xuICAgIGV4cG9ydHMuZmcyLnN0cm9rZVN0eWxlID0gXCJibGFja1wiO1xuICAgIGV4cG9ydHMuZmcyLmZvbnQgPSBcIjkwMCBcIiArIHNpemUgKyBcInB4IEFyaWFsXCI7XG4gICAgZXhwb3J0cy5mZzIuc3Ryb2tlVGV4dCh0ZXh0LCA2MDAsIDQ3MCAvIHRleHRTY2FsZSk7XG4gICAgZXhwb3J0cy5mZzIubGluZVdpZHRoID0gMjA7XG4gICAgZXhwb3J0cy5mZzIuc3Ryb2tlU3R5bGUgPSBcIndoaXRlXCI7XG4gICAgZXhwb3J0cy5mZzIuZm9udCA9IFwiOTAwIFwiICsgc2l6ZSArIFwicHggQXJpYWxcIjtcbiAgICBleHBvcnRzLmZnMi5zdHJva2VUZXh0KHRleHQsIDYwMCwgNDcwIC8gdGV4dFNjYWxlKTtcbiAgICBleHBvcnRzLmZnMi5mb250ID0gXCI5MDAgXCIgKyBzaXplICsgXCJweCBBcmlhbFwiO1xuICAgIGV4cG9ydHMuZmcyLmZpbGxUZXh0KHRleHQsIDYwMCwgNDcwIC8gdGV4dFNjYWxlKTtcbiAgICBleHBvcnRzLmZnMi5yZXN0b3JlKCk7XG4gICAgbXVzaWNfMS5NdXNpY01hbmFnZXIuc3RvcFdoYXRpc1BsYXlpbmcoKTtcbiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZW5kR2FtZShpbnB1dCk7XG4gICAgfSwgMjUwMCk7XG59XG5mdW5jdGlvbiBvbkZ1bGxTY3JlZW5DaGFuZ2UoKSB7XG4gICAgdmFyIGZ1bGxzY3JlZW5FbGVtZW50ID0gZG9jdW1lbnQuZnVsbHNjcmVlbkVsZW1lbnQgfHwgZG9jdW1lbnQubW96RnVsbFNjcmVlbkVsZW1lbnQgfHwgZG9jdW1lbnQud2Via2l0RnVsbHNjcmVlbkVsZW1lbnQ7XG4gICAgLy8gaWYgaW4gZnVsbHNjcmVlbiBtb2RlIGZ1bGxzY3JlZW5FbGVtZW50IHdvbid0IGJlIG51bGxcbiAgICB2YXIgY29udCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidG9wQnV0dG9uQ29udGFpbmVyXCIpO1xuICAgIHZhciBpY24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLnRvcEJ1dHRvblwiKTtcbiAgICBpZiAoZnVsbHNjcmVlbkVsZW1lbnQgIT0gbnVsbCkge1xuICAgICAgICBjb250LnN0eWxlLnRyYW5zaXRpb24gPSBcIm9wYWNpdHkgMC41cyBsaW5lYXIgMHNcIjtcbiAgICAgICAgY29udC5zdHlsZS5vcGFjaXR5ID0gMDtcbiAgICAgICAgO1xuICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBpO1xuICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IGljbi5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIGljbltpXS5zdHlsZS5oZWlnaHQgPSBcIjVweFwiO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29udC5zdHlsZS5oZWlnaHQgPSBcIjVweFwiO1xuICAgICAgICAgICAgcmVzaXplKCk7XG4gICAgICAgIH0sIDUwMCk7XG4gICAgICAgICgwLCBqcXVlcnlfMS5kZWZhdWx0KShcIiNrZXlib2FyZFByb21wdFwiKS5oaWRlKCk7XG4gICAgICAgICgwLCBqcXVlcnlfMS5kZWZhdWx0KShcIiNrZXlib2FyZENvbnRyb2xzSW1nXCIpLmhpZGUoKTtcbiAgICAgICAgKDAsIGpxdWVyeV8xLmRlZmF1bHQpKFwiI2NvbnRyb2xsZXJTdXBwb3J0Q29udGFpbmVyXCIpLmhpZGUoKTtcbiAgICAgICAgKDAsIGpxdWVyeV8xLmRlZmF1bHQpKFwiI2RlYnVnQnV0dG9uRWRpdFwiKS5lbXB0eSgpLmFwcGVuZChcIk9GRlwiKTtcbiAgICAgICAgKDAsIGpxdWVyeV8xLmRlZmF1bHQpKFwiI2RlYnVnXCIpLmhpZGUoKTtcbiAgICAgICAgKDAsIGpxdWVyeV8xLmRlZmF1bHQpKFwiI3BsYXllcnNcIikuaGlkZSgpO1xuICAgICAgICAoMCwganF1ZXJ5XzEuZGVmYXVsdCkoXCJib2R5XCIpLmNzcyhcIm92ZXJmbG93XCIsIFwiaGlkZGVuXCIpO1xuICAgICAgICBzaG93SGVhZGVyID0gZmFsc2U7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICB2YXIgaTtcbiAgICAgICAgZm9yIChpID0gMDsgaSA8IGljbi5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgaWNuW2ldLnN0eWxlLmhlaWdodCA9IFwiMjVweFwiO1xuICAgICAgICB9XG4gICAgICAgIGNvbnQuc3R5bGUuaGVpZ2h0ID0gXCIzMXB4XCI7XG4gICAgICAgIGNvbnQuc3R5bGUudHJhbnNpdGlvbiA9IFwib3BhY2l0eSAwLjVzIGxpbmVhciAwc1wiO1xuICAgICAgICBjb250LnN0eWxlLm9wYWNpdHkgPSAxO1xuICAgIH1cbn1cbmZ1bmN0aW9uIHN0YXJ0KCkge1xuICAgIGlmIChleHBvcnRzLmhvbGlkYXkgPT09IDEpIHtcbiAgICAgICAgKDAsIGpxdWVyeV8xLmRlZmF1bHQpKFwiI2xheWVyQnV0dG9uXCIpLmFmdGVyKCc8ZGl2IGlkPVwic25vd0J1dHRvblwiIGNsYXNzPVwiZ2FtZUJ1dHRvblwiIHN0eWxlPVwid2lkdGg6OTBweFwiPjxpbWcgc3JjPVwiYXNzZXRzL2NocmlzdG1hcy9zbm93Zmxha2UucG5nXCIgaGVpZ2h0PTE3IHdpZHRoPTE3IHN0eWxlPVwiZGlzcGxheTppbmxpbmUtYmxvY2tcIi8+PHAgc3R5bGU9XCJ3aWR0aDozMHB4O2Rpc3BsYXk6aW5saW5lLWJsb2NrXCI+PHNwYW4gaWQ9XCJzbm93QnV0dG9uRWRpdFwiPjE1MDwvc3Bhbj48L3A+PGRpdiBpZD1cInNub3dNaW51c1wiIGNsYXNzPVwic25vd0NvbnRyb2xcIiBzdHlsZT1cImRpc3BsYXk6aW5saW5lLWJsb2NrO3BhZGRpbmc6M3B4XCI+PHAgc3R5bGU9XCJwYWRkaW5nOjA7Zm9udC1zaXplOjIwcHhcIj4tPC9wPjwvZGl2PjxkaXYgaWQ9XCJzbm93UGx1c1wiIHN0eWxlPVwiZGlzcGxheTppbmxpbmUtYmxvY2s7cGFkZGluZzozcHhcIj48cCBzdHlsZT1cInBhZGRpbmc6MDtmb250LXNpemU6MTdweFwiPis8L3A+PC9kaXY+PC9kaXY+Jyk7XG4gICAgfVxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgNDsgaSsrKSB7XG4gICAgICAgIGJ1aWxkUGxheWVyT2JqZWN0KGkpO1xuICAgICAgICBleHBvcnRzLnBsYXllcltpXS5waHlzLmZhY2UgPSAxO1xuICAgICAgICBleHBvcnRzLnBsYXllcltpXS5hY3Rpb25TdGF0ZSA9IFwiV0FJVFwiO1xuICAgIH1cbiAgICBjYWNoZURvbSgpO1xuICAgICgwLCBrZXlib2FyZG1lbnVfMS5nZXRLZXlib2FyZENvb2tpZSkoKTtcbiAgICBnaXZlTWVkYWxzKCk7XG4gICAgKDAsIGF1ZGlvbWVudV8xLmdldEF1ZGlvQ29va2llcykoKTtcbiAgICAoMCwgZ2FtZXBsYXltZW51XzEuZ2V0R2FtZXBsYXlDb29raWVzKSgpO1xuICAgICgwLCBqcXVlcnlfMS5kZWZhdWx0KShcIiNrZXlib2FyZEJ1dHRvblwiKS5jbGljayhmdW5jdGlvbiAoKSB7XG4gICAgICAgICgwLCBqcXVlcnlfMS5kZWZhdWx0KShcIiNrZXlib2FyZENvbnRyb2xzSW1nXCIpLnRvZ2dsZSgpO1xuICAgICAgICAoMCwganF1ZXJ5XzEuZGVmYXVsdCkoXCIja2V5Ym9hcmRQcm9tcHRcIikuaGlkZSgpO1xuICAgIH0pO1xuICAgICgwLCBqcXVlcnlfMS5kZWZhdWx0KShcIiNjb250cm9sbGVyQnV0dG9uXCIpLmNsaWNrKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgKDAsIGpxdWVyeV8xLmRlZmF1bHQpKFwiI2NvbnRyb2xsZXJTdXBwb3J0Q29udGFpbmVyXCIpLnRvZ2dsZSgpO1xuICAgIH0pO1xuICAgIGV4cG9ydHMubGF5ZXJzLkJHMSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYmFja2dyb3VuZDFDYW52YXNcIik7XG4gICAgZXhwb3J0cy5iZzEgPSBleHBvcnRzLmxheWVycy5CRzEuZ2V0Q29udGV4dChcIjJkXCIpO1xuICAgIGV4cG9ydHMubGF5ZXJzLkJHMiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYmFja2dyb3VuZDJDYW52YXNcIik7XG4gICAgZXhwb3J0cy5iZzIgPSBleHBvcnRzLmxheWVycy5CRzIuZ2V0Q29udGV4dChcIjJkXCIpO1xuICAgIGV4cG9ydHMubGF5ZXJzLkZHMSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZm9yZWdyb3VuZDFDYW52YXNcIik7XG4gICAgZXhwb3J0cy5mZzEgPSBleHBvcnRzLmxheWVycy5GRzEuZ2V0Q29udGV4dChcIjJkXCIpO1xuICAgIGV4cG9ydHMubGF5ZXJzLkZHMiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZm9yZWdyb3VuZDJDYW52YXNcIik7XG4gICAgZXhwb3J0cy5mZzIgPSBleHBvcnRzLmxheWVycy5GRzIuZ2V0Q29udGV4dChcIjJkXCIpO1xuICAgIGV4cG9ydHMubGF5ZXJzLlVJID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ1aUNhbnZhc1wiKTtcbiAgICBleHBvcnRzLnVpID0gZXhwb3J0cy5sYXllcnMuVUkuZ2V0Q29udGV4dChcIjJkXCIpO1xuICAgIGV4cG9ydHMuYmcxLmZpbGxTdHlsZSA9IFwicmdiKDAsIDAsIDApXCI7XG4gICAgZXhwb3J0cy5iZzEuZmlsbFJlY3QoMCwgMCwgZXhwb3J0cy5sYXllcnMuQkcxLndpZHRoLCBleHBvcnRzLmxheWVycy5CRzEuaGVpZ2h0KTtcbiAgICBsZXQgbnVsbElucHV0QnVmZmVycyA9IFsoMCwgaW5wdXRfMS5udWxsSW5wdXRzKSgpLCAoMCwgaW5wdXRfMS5udWxsSW5wdXRzKSgpLCAoMCwgaW5wdXRfMS5udWxsSW5wdXRzKSgpLCAoMCwgaW5wdXRfMS5udWxsSW5wdXRzKSgpXTtcbiAgICBnYW1lVGljayhudWxsSW5wdXRCdWZmZXJzKTtcbiAgICByZW5kZXJUaWNrKCk7XG4gICAgKDAsIGpxdWVyeV8xLmRlZmF1bHQpKFwiI2VmZmVjdHNCdXR0b25cIikuY2xpY2soZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoKDAsIHZmeF8xLmlzU2hvd1NGWCkoKSkge1xuICAgICAgICAgICAgKDAsIGpxdWVyeV8xLmRlZmF1bHQpKFwiI2VmZmVjdHNCdXR0b25FZGl0XCIpLmVtcHR5KCkuYXBwZW5kKFwiT0ZGXCIpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgKDAsIGpxdWVyeV8xLmRlZmF1bHQpKFwiI2VmZmVjdHNCdXR0b25FZGl0XCIpLmVtcHR5KCkuYXBwZW5kKFwiT05cIik7XG4gICAgICAgIH1cbiAgICAgICAgKDAsIHZmeF8xLnRvZ2dsZVNob3dTRlgpKCk7XG4gICAgfSk7XG4gICAgKDAsIGpxdWVyeV8xLmRlZmF1bHQpKFwiI2Zwc0J1dHRvblwiKS5jbGljayhmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmIChmcHMzMCkge1xuICAgICAgICAgICAgKDAsIGpxdWVyeV8xLmRlZmF1bHQpKFwiI2Zwc0J1dHRvbkVkaXRcIikuZW1wdHkoKS5hcHBlbmQoXCI2MFwiKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICgwLCBqcXVlcnlfMS5kZWZhdWx0KShcIiNmcHNCdXR0b25FZGl0XCIpLmVtcHR5KCkuYXBwZW5kKFwiMzBcIik7XG4gICAgICAgIH1cbiAgICAgICAgZnBzMzAgXj0gdHJ1ZTtcbiAgICB9KTtcbiAgICAoMCwganF1ZXJ5XzEuZGVmYXVsdCkoXCIjYWxwaGFCdXR0b25cIikuY2xpY2soZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoKDAsIHRyYW5zcGFyZW5jeV8xLmdldFRyYW5zcGFyZW5jeSkoKSkge1xuICAgICAgICAgICAgKDAsIGpxdWVyeV8xLmRlZmF1bHQpKFwiI2FscGhhQnV0dG9uRWRpdFwiKS5lbXB0eSgpLmFwcGVuZChcIk9GRlwiKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICgwLCBqcXVlcnlfMS5kZWZhdWx0KShcIiNhbHBoYUJ1dHRvbkVkaXRcIikuZW1wdHkoKS5hcHBlbmQoXCJPTlwiKTtcbiAgICAgICAgfVxuICAgICAgICAoMCwgdHJhbnNwYXJlbmN5XzEudG9nZ2xlVHJhbnNwYXJlbmN5KSgpO1xuICAgIH0pO1xuICAgICgwLCBqcXVlcnlfMS5kZWZhdWx0KShcIiNsYXllckJ1dHRvblwiKS5ob3ZlcihmdW5jdGlvbiAoKSB7XG4gICAgICAgICgwLCBqcXVlcnlfMS5kZWZhdWx0KShcIiNsYXllckRyb3Bkb3duXCIpLnRvZ2dsZSgpO1xuICAgIH0pO1xuICAgICgwLCBqcXVlcnlfMS5kZWZhdWx0KShcIi5sYXllclwiKS5jbGljayhmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBpZCA9ICgwLCBqcXVlcnlfMS5kZWZhdWx0KSh0aGlzKS5hdHRyKFwiaWRcIik7XG4gICAgICAgIHN3aXRjaCAoaWQpIHtcbiAgICAgICAgICAgIGNhc2UgXCJsYXllcjFcIjpcbiAgICAgICAgICAgICAgICBleHBvcnRzLmxheWVyU3dpdGNoZXMuQkcxIF49IHRydWU7XG4gICAgICAgICAgICAgICAgKDAsIGpxdWVyeV8xLmRlZmF1bHQpKFwiI2JhY2tncm91bmQxQ2FudmFzXCIpLnRvZ2dsZSgpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcImxheWVyMlwiOlxuICAgICAgICAgICAgICAgIGV4cG9ydHMubGF5ZXJTd2l0Y2hlcy5CRzIgXj0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAoMCwganF1ZXJ5XzEuZGVmYXVsdCkoXCIjYmFja2dyb3VuZDJDYW52YXNcIikudG9nZ2xlKCk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwibGF5ZXIzXCI6XG4gICAgICAgICAgICAgICAgZXhwb3J0cy5sYXllclN3aXRjaGVzLkZHMSBePSB0cnVlO1xuICAgICAgICAgICAgICAgICgwLCBqcXVlcnlfMS5kZWZhdWx0KShcIiNmb3JlZ3JvdW5kMUNhbnZhc1wiKS50b2dnbGUoKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJsYXllcjRcIjpcbiAgICAgICAgICAgICAgICBleHBvcnRzLmxheWVyU3dpdGNoZXMuRkcyIF49IHRydWU7XG4gICAgICAgICAgICAgICAgKDAsIGpxdWVyeV8xLmRlZmF1bHQpKFwiI2ZvcmVncm91bmQyQ2FudmFzXCIpLnRvZ2dsZSgpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcImxheWVyNVwiOlxuICAgICAgICAgICAgICAgIGV4cG9ydHMubGF5ZXJTd2l0Y2hlcy5VSSBePSB0cnVlO1xuICAgICAgICAgICAgICAgICgwLCBqcXVlcnlfMS5kZWZhdWx0KShcIiN1aUNhbnZhc1wiKS50b2dnbGUoKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgKDAsIGpxdWVyeV8xLmRlZmF1bHQpKHRoaXMpLnRvZ2dsZUNsYXNzKFwibGF5ZXJPblwiKTtcbiAgICB9KTtcbiAgICAoMCwganF1ZXJ5XzEuZGVmYXVsdCkoXCIjZGVidWdCdXR0b25cIikuY2xpY2soZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoZXhwb3J0cy5zaG93RGVidWcpIHtcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgNDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJnYW1lcGFkU1ZHXCIgKyBpKS5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAoMCwganF1ZXJ5XzEuZGVmYXVsdCkoXCIjZGVidWdCdXR0b25FZGl0XCIpLmVtcHR5KCkuYXBwZW5kKFwiT0ZGXCIpO1xuICAgICAgICAgICAgKDAsIGpxdWVyeV8xLmRlZmF1bHQpKFwiI2RlYnVnXCIpLmhpZGUoKTtcbiAgICAgICAgICAgICgwLCBqcXVlcnlfMS5kZWZhdWx0KShcIiNwbGF5ZXJzXCIpLmhpZGUoKTtcbiAgICAgICAgICAgICgwLCBqcXVlcnlfMS5kZWZhdWx0KShcImJvZHlcIikuY3NzKFwib3ZlcmZsb3dcIiwgXCJoaWRkZW5cIik7XG4gICAgICAgICAgICAvL3ZhciBtWSA9IE1hdGgubWF4KCgkKHdpbmRvdykuaGVpZ2h0KCktNzUwKS8yLDApO1xuICAgICAgICAgICAgLy8kKFwiI2Rpc3BsYXlcIikuY3NzKFwibWFyZ2luXCIsbVkrXCJweCAwcHggMHB4IFwiK21YK1wicHhcIik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDQ7IGkrKykge1xuICAgICAgICAgICAgICAgIGlmIChleHBvcnRzLnBsYXllclR5cGVbaV0gIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICgwLCBkcmF3R2FtZXBhZF8xLnVwZGF0ZUdhbWVwYWRTVkdDb2xvdXIpKGksIFwiZ2FtZXBhZFNWR1wiICsgaSk7XG4gICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZ2FtZXBhZFNWR1wiICsgaSkuc3R5bGUuZGlzcGxheSA9IFwiXCI7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgKDAsIGpxdWVyeV8xLmRlZmF1bHQpKFwiI2RlYnVnQnV0dG9uRWRpdFwiKS5lbXB0eSgpLmFwcGVuZChcIk9OXCIpO1xuICAgICAgICAgICAgKDAsIGpxdWVyeV8xLmRlZmF1bHQpKFwiI2RlYnVnXCIpLnNob3coKTtcbiAgICAgICAgICAgICgwLCBqcXVlcnlfMS5kZWZhdWx0KShcIiNwbGF5ZXJzXCIpLnNob3coKTtcbiAgICAgICAgICAgICgwLCBqcXVlcnlfMS5kZWZhdWx0KShcImJvZHlcIikuY3NzKFwib3ZlcmZsb3dcIiwgXCJzY3JvbGxcIik7XG4gICAgICAgICAgICAvL3ZhciBtWSA9IE1hdGgubWF4KCgkKHdpbmRvdykuaGVpZ2h0KCktOTAwKS8yLDApO1xuICAgICAgICAgICAgLy8kKFwiI2Rpc3BsYXlcIikuY3NzKFwibWFyZ2luXCIsbVkrXCIgMHB4IDBweCBweCBcIittWCtcInB4XCIpO1xuICAgICAgICB9XG4gICAgICAgIGV4cG9ydHMuc2hvd0RlYnVnIF49IHRydWU7XG4gICAgICAgIHJlc2l6ZSgpO1xuICAgIH0pO1xuICAgICgwLCBqcXVlcnlfMS5kZWZhdWx0KShcIiNoaWRlQnV0dG9uXCIpLmNsaWNrKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgKDAsIGpxdWVyeV8xLmRlZmF1bHQpKFwiI2hlYWRlclwiKS50b2dnbGUoKTtcbiAgICAgICAgc2hvd0hlYWRlciBePSB0cnVlO1xuICAgICAgICByZXNpemUoKTtcbiAgICB9KTtcbiAgICAoMCwganF1ZXJ5XzEuZGVmYXVsdCkoXCIjZnVsbHNjcmVlbkJ1dHRvblwiKS5jbGljayhmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICgoZG9jdW1lbnQuZnVsbFNjcmVlbkVsZW1lbnQgJiYgZG9jdW1lbnQuZnVsbFNjcmVlbkVsZW1lbnQgIT09IG51bGwpIHx8ICghZG9jdW1lbnQubW96RnVsbFNjcmVlbiAmJiAhZG9jdW1lbnQud2Via2l0SXNGdWxsU2NyZWVuKSkge1xuICAgICAgICAgICAgaWYgKGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5yZXF1ZXN0RnVsbFNjcmVlbikge1xuICAgICAgICAgICAgICAgIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5yZXF1ZXN0RnVsbFNjcmVlbigpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50Lm1velJlcXVlc3RGdWxsU2NyZWVuKSB7XG4gICAgICAgICAgICAgICAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50Lm1velJlcXVlc3RGdWxsU2NyZWVuKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQud2Via2l0UmVxdWVzdEZ1bGxTY3JlZW4pIHtcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQud2Via2l0UmVxdWVzdEZ1bGxTY3JlZW4oRWxlbWVudC5BTExPV19LRVlCT0FSRF9JTlBVVCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBpZiAoZG9jdW1lbnQuY2FuY2VsRnVsbFNjcmVlbikge1xuICAgICAgICAgICAgICAgIGRvY3VtZW50LmNhbmNlbEZ1bGxTY3JlZW4oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGRvY3VtZW50Lm1vekNhbmNlbEZ1bGxTY3JlZW4pIHtcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5tb3pDYW5jZWxGdWxsU2NyZWVuKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChkb2N1bWVudC53ZWJraXRDYW5jZWxGdWxsU2NyZWVuKSB7XG4gICAgICAgICAgICAgICAgZG9jdW1lbnQud2Via2l0Q2FuY2VsRnVsbFNjcmVlbigpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIC8vIHJlc2l6ZSgpO1xuICAgIH0pO1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJmdWxsc2NyZWVuY2hhbmdlXCIsIG9uRnVsbFNjcmVlbkNoYW5nZSwgZmFsc2UpO1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJ3ZWJraXRmdWxsc2NyZWVuY2hhbmdlXCIsIG9uRnVsbFNjcmVlbkNoYW5nZSwgZmFsc2UpO1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3pmdWxsc2NyZWVuY2hhbmdlXCIsIG9uRnVsbFNjcmVlbkNoYW5nZSwgZmFsc2UpO1xuICAgICgwLCBqcXVlcnlfMS5kZWZhdWx0KShcIi50b3BCdXR0b25cIikuaG92ZXIoZnVuY3Rpb24gKCkge1xuICAgICAgICAoMCwganF1ZXJ5XzEuZGVmYXVsdCkodGhpcykuY2hpbGRyZW4oXCIuYnV0dG9uRGV0YWlsc1wiKS50b2dnbGUoKTtcbiAgICB9KTtcbiAgICBpZiAobW9iaWxlID09PSBmYWxzZSkge1xuICAgICAgICAoMCwganF1ZXJ5XzEuZGVmYXVsdCkoXCIuYnV0dG9uXCIpLmhvdmVyKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICgwLCBqcXVlcnlfMS5kZWZhdWx0KSh0aGlzKS50b2dnbGVDbGFzcyhcImJ1dHRvbmhpZ2hsaWdodGVkXCIpO1xuICAgICAgICB9KTtcbiAgICAgICAgKDAsIGpxdWVyeV8xLmRlZmF1bHQpKFwiLnNvY2lhbG1lZGlhXCIpLmhvdmVyKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICgwLCBqcXVlcnlfMS5kZWZhdWx0KSh0aGlzKS50b2dnbGVDbGFzcyhcInNvY2lhbG1lZGlhaGlnaGxpZ2h0XCIpO1xuICAgICAgICB9KTtcbiAgICAgICAgKDAsIGpxdWVyeV8xLmRlZmF1bHQpKFwiLnN1Z2J0blwiKS5ob3ZlcihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAoMCwganF1ZXJ5XzEuZGVmYXVsdCkodGhpcykudG9nZ2xlQ2xhc3MoXCJzdWdidG5oaWdobGlnaHRcIik7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICAoMCwganF1ZXJ5XzEuZGVmYXVsdCkoXCIjYXBwc0J1dHRvblwiKS5ob3ZlcihmdW5jdGlvbiAoKSB7XG4gICAgICAgICgwLCBqcXVlcnlfMS5kZWZhdWx0KShcIiNhcHBzRHJvcGRvd25cIikuc2hvdygpO1xuICAgIH0sIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgKDAsIGpxdWVyeV8xLmRlZmF1bHQpKFwiI2FwcHNEcm9wZG93blwiKS5oaWRlKCk7XG4gICAgfSk7XG4gICAgaWYgKGV4cG9ydHMuaG9saWRheSA9PT0gMSkge1xuICAgICAgICAoMCwganF1ZXJ5XzEuZGVmYXVsdCkoXCIjc25vd01pbnVzXCIpLmNsaWNrKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGV4cG9ydHMuc25vd0NvdW50IC09IDIwO1xuICAgICAgICAgICAgaWYgKGV4cG9ydHMuc25vd0NvdW50IDwgMCkge1xuICAgICAgICAgICAgICAgIGV4cG9ydHMuc25vd0NvdW50ID0gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICgwLCBqcXVlcnlfMS5kZWZhdWx0KShcIiNzbm93QnV0dG9uRWRpdFwiKS50ZXh0KGV4cG9ydHMuc25vd0NvdW50KTtcbiAgICAgICAgfSk7XG4gICAgICAgICgwLCBqcXVlcnlfMS5kZWZhdWx0KShcIiNzbm93UGx1c1wiKS5jbGljayhmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBleHBvcnRzLnNub3dDb3VudCArPSAyMDtcbiAgICAgICAgICAgIGlmIChleHBvcnRzLnNub3dDb3VudCA+IDEyMDApIHtcbiAgICAgICAgICAgICAgICBleHBvcnRzLnNub3dDb3VudCA9IDEyMDA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAoMCwganF1ZXJ5XzEuZGVmYXVsdCkoXCIjc25vd0J1dHRvbkVkaXRcIikudGV4dChleHBvcnRzLnNub3dDb3VudCk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICAoMCwganF1ZXJ5XzEuZGVmYXVsdCkoXCIjcmVwbGF5XCIpLmNoYW5nZShmdW5jdGlvbiAoKSB7XG4gICAgICAgIC8vIGdyYWIgdGhlIGZpcnN0IGltYWdlIGluIHRoZSBGaWxlTGlzdCBvYmplY3QgYW5kIHBhc3MgaXQgdG8gdGhlIGZ1bmN0aW9uXG4gICAgICAgICgwLCByZXBsYXlfMS5sb2FkUmVwbGF5KSh0aGlzLmZpbGVzWzBdKTtcbiAgICB9KTtcbiAgICByZXNpemUoKTtcbn1cbndpbmRvdy5zdGFydCA9IHN0YXJ0O1xuZnVuY3Rpb24gY3VzdG9tRGVhZHpvbmUoKSB7XG4gICAgdGhpcy5scyA9IG5ldyBWZWMyRF8xLlZlYzJEKDAsIDApO1xuICAgIHRoaXMuY3MgPSBuZXcgVmVjMkRfMS5WZWMyRCgwLCAwKTtcbiAgICB0aGlzLmwgPSAwO1xuICAgIHRoaXMuciA9IDA7XG59XG5mdW5jdGlvbiBhZGRTaGluZSh2YWwpIHtcbiAgICBleHBvcnRzLnNoaW5lICs9IHZhbDtcbn1cbmZ1bmN0aW9uIHNldFNoaW5lKHZhbCkge1xuICAgIGV4cG9ydHMuc2hpbmUgPSB2YWw7XG59XG5mdW5jdGlvbiBzZXRGaW5kaW5nUGxheWVycyh2YWwpIHtcbiAgICBleHBvcnRzLmZpbmRpbmdQbGF5ZXJzID0gdmFsO1xufVxuZnVuY3Rpb24gc2V0UGxheWluZyh2YWwpIHtcbiAgICBleHBvcnRzLnBsYXlpbmcgPSB2YWw7XG59XG5mdW5jdGlvbiBzZXRDcmVkaXRzUGxheWVyKHZhbCkge1xuICAgIGNyZWRpdHNQbGF5ZXIgPSB2YWw7XG59XG5mdW5jdGlvbiBzZXRDYWxpYnJhdGlvblBsYXllcih2YWwpIHtcbiAgICBleHBvcnRzLmNhbGlicmF0aW9uUGxheWVyID0gdmFsO1xufVxuY29uc3QgZG9tID0ge307XG5mdW5jdGlvbiBjYWNoZURvbSgpIHtcbiAgICBjb25zdCBlbGVtZW50SWRzID0gW1xuICAgICAgICBcIm1hdGNoTWludXRlc1wiLFxuICAgICAgICBcIm1hdGNoU2Vjb25kc1wiLFxuICAgICAgICBcImdhbWVsb2dpY0F2Z1wiLFxuICAgICAgICBcImdhbWVsb2dpY0hpZ2hcIixcbiAgICAgICAgXCJnYW1lbG9naWNMb3dcIixcbiAgICAgICAgXCJnYW1lbG9naWNQZWFrXCIsXG4gICAgICAgIFwicmVuZGVyQXZnXCIsXG4gICAgICAgIFwicmVuZGVySGlnaFwiLFxuICAgICAgICBcInJlbmRlckxvd1wiLFxuICAgICAgICBcInJlbmRlclBlYWtcIixcbiAgICBdO1xuICAgIGVsZW1lbnRJZHMuZm9yRWFjaCgoaWQpID0+IHtcbiAgICAgICAgZG9tW2lkXSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKTtcbiAgICB9KTtcbn1cbjtcbmZ1bmN0aW9uIHNldENTKGluZGV4LCB2YWwpIHtcbiAgICBleHBvcnRzLmNoYXJhY3RlclNlbGVjdGlvbnNbaW5kZXhdID0gdmFsO1xufVxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/main/main.ts\n");

/***/ })

},
/******/ function(__webpack_require__) { // webpackRuntimeModules
/******/ /* webpack/runtime/getFullHash */
/******/ (() => {
/******/ 	__webpack_require__.h = () => ("6f9fd246bb20724cee55")
/******/ })();
/******/ 
/******/ }
);