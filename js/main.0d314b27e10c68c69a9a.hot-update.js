"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdatemeleelight"]("main",{

/***/ "./src/main/main.ts":
/*!**************************!*\
  !*** ./src/main/main.ts ***!
  \**************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

eval("\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.starting = exports.blastzone = exports.stageSelect = exports.respawnPoints = exports.edgeOrientation = exports.edgeOffset = exports.edges = exports.wallsR = exports.wallsL = exports.platforms = exports.ground = exports.startingFace = exports.startingPoint = exports.frameAdvance = exports.pause = exports.colours = exports.costumeTimeout = exports.pPal = exports.tagText = exports.hasTag = exports.palettes = exports.randomTags = exports.versusMode = exports.gameMode = exports.showDebug = exports.findingPlayers = exports.frameByFrameRender = exports.wasFrameByFrame = exports.frameByFrame = exports.playing = exports.activePorts = exports.ports = exports.cpuDifficulty = exports.playerType = exports.playerAmount = exports.currentPlayers = exports.mType = exports.firstTimeDetected = exports.usingCustomControls = exports.controllerResetCountdowns = exports.gameEnd = exports.calibrationPlayer = exports.shine = exports.characterSelections = exports.framerate = exports.gamelogicTime = exports.renderTime = exports.player = exports.snowCount = exports.holiday = void 0;\nexports.layerSwitches = exports.layers = exports.canvasMain = exports.c = exports.ui = exports.fg2 = exports.fg1 = exports.bg2 = exports.bg1 = exports.keyBinding = exports.keyBind = exports.keys = exports.usingLocalStorage = exports.matchTimer = exports.startTimer = void 0;\nexports.setControllerReset = setControllerReset;\nexports.setUsingCustomControls = setUsingCustomControls;\nexports.setMtype = setMtype;\nexports.setCurrentPlayer = setCurrentPlayer;\nexports.setTagText = setTagText;\nexports.setStageSelect = setStageSelect;\nexports.setStarting = setStarting;\nexports.setStartTimer = setStartTimer;\nexports.getStartTimer = getStartTimer;\nexports.addMatchTimer = addMatchTimer;\nexports.setMatchTimer = setMatchTimer;\nexports.getMatchTimer = getMatchTimer;\nexports.setCookie = setCookie;\nexports.setVersusMode = setVersusMode;\nexports.getCookie = getCookie;\nexports.setKeyBinding = setKeyBinding;\nexports.overrideKeyboardEvent = overrideKeyboardEvent;\nexports.disabledEventPropagation = disabledEventPropagation;\nexports.SVG = SVG;\nexports.matchTimerTick = matchTimerTick;\nexports.screenShake = screenShake;\nexports.percentShake = percentShake;\nexports.findPlayers = findPlayers;\nexports.setPlayerType = setPlayerType;\nexports.addPlayer = addPlayer;\nexports.togglePort = togglePort;\nexports.positionPlayersInCSS = positionPlayersInCSS;\nexports.changeGamemode = changeGamemode;\nexports.interpretInputs = interpretInputs;\nexports.renderToMain = renderToMain;\nexports.update = update;\nexports.gameTick = gameTick;\nexports.clearScreen = clearScreen;\nexports.renderTick = renderTick;\nexports.buildPlayerObject = buildPlayerObject;\nexports.initializePlayers = initializePlayers;\nexports.startGame = startGame;\nexports.endGame = endGame;\nexports.finishGame = finishGame;\nexports.start = start;\nexports.customDeadzone = customDeadzone;\nexports.addShine = addShine;\nexports.setShine = setShine;\nexports.setFindingPlayers = setFindingPlayers;\nexports.setPlaying = setPlaying;\nexports.setCalibrationPlayer = setCalibrationPlayer;\nexports.cacheDom = cacheDom;\nexports.setCS = setCS;\n/* eslint-disable */\nconst css_1 = __webpack_require__(/*! ../menus/css */ \"./src/menus/css.ts\");\nconst player_1 = __webpack_require__(/*! ../main/player */ \"./src/main/player.ts\");\nconst settings_1 = __webpack_require__(/*! ../settings */ \"./src/settings.ts\");\nconst startup_1 = __webpack_require__(/*! ../menus/startup */ \"./src/menus/startup.ts\");\nconst menu_1 = __webpack_require__(/*! ../menus/menu */ \"./src/menus/menu.ts\");\nconst sfx_1 = __webpack_require__(/*! ../main/sfx */ \"./src/main/sfx.ts\");\nconst startscreen_1 = __webpack_require__(/*! ../menus/startscreen */ \"./src/menus/startscreen.ts\");\nconst stagerender_1 = __webpack_require__(/*! ../stages/stagerender */ \"./src/stages/stagerender.ts\");\nconst stageselect_1 = __webpack_require__(/*! ../menus/stageselect */ \"./src/menus/stageselect.ts\");\nconst audiomenu_1 = __webpack_require__(/*! ../menus/audiomenu */ \"./src/menus/audiomenu.ts\");\nconst gameplaymenu_1 = __webpack_require__(/*! ../menus/gameplaymenu */ \"./src/menus/gameplaymenu.ts\");\nconst keyboardmenu_1 = __webpack_require__(/*! ../menus/keyboardmenu */ \"./src/menus/keyboardmenu.ts\");\nconst controllermenu_1 = __webpack_require__(/*! ../menus/controllermenu */ \"./src/menus/controllermenu.ts\");\nconst render_1 = __webpack_require__(/*! ../main/render */ \"./src/main/render.ts\");\nconst actionStateShortcuts_1 = __webpack_require__(/*! ../physics/actionStateShortcuts */ \"./src/physics/actionStateShortcuts.ts\");\nconst hitDetection_1 = __webpack_require__(/*! ../physics/hitDetection */ \"./src/physics/hitDetection.ts\");\nconst article_1 = __webpack_require__(/*! ../physics/article */ \"./src/physics/article.ts\");\nconst ai_1 = __webpack_require__(/*! ../main/ai */ \"./src/main/ai.ts\");\nconst physics_1 = __webpack_require__(/*! ../physics/physics */ \"./src/physics/physics.ts\");\nconst jquery_1 = __importDefault(__webpack_require__(/*! jquery */ \"./node_modules/jquery/dist/jquery.js\"));\nconst transparency_1 = __webpack_require__(/*! ../main/vfx/transparency */ \"./src/main/vfx/transparency.js\");\nconst drawVfx_1 = __webpack_require__(/*! ../main/vfx/drawVfx */ \"./src/main/vfx/drawVfx.js\");\nconst vfxQueue_1 = __webpack_require__(/*! ../main/vfx/vfxQueue */ \"./src/main/vfx/vfxQueue.js\");\nconst activeStage_1 = __webpack_require__(/*! ../stages/activeStage */ \"./src/stages/activeStage.ts\");\nconst music_1 = __webpack_require__(/*! ./music */ \"./src/main/music.ts\");\nconst vfx_1 = __webpack_require__(/*! ../main/vfx */ \"./src/main/vfx.ts\");\nconst renderVfx_1 = __webpack_require__(/*! ./vfx/renderVfx */ \"./src/main/vfx/renderVfx.js\");\nconst Box2D_1 = __webpack_require__(/*! ./util/Box2D */ \"./src/main/util/Box2D.ts\");\nconst Vec2D_1 = __webpack_require__(/*! ./util/Vec2D */ \"./src/main/util/Vec2D.ts\");\nconst streamclient_1 = __webpack_require__(/*! ./multiplayer/streamclient */ \"./src/main/multiplayer/streamclient.js\");\nconst replay_1 = __webpack_require__(/*! ./replay */ \"./src/main/replay.ts\");\nconst input_1 = __webpack_require__(/*! ../input/input */ \"./src/input/input.ts\");\nconst meleeInputs_1 = __webpack_require__(/*! ../input/meleeInputs */ \"./src/input/meleeInputs.ts\");\nconst findGamepadInfo_1 = __webpack_require__(/*! ../input/gamepad/findGamepadInfo */ \"./src/input/gamepad/findGamepadInfo.ts\");\nconst custom_1 = __webpack_require__(/*! ../input/gamepad/gamepads/custom */ \"./src/input/gamepad/gamepads/custom.js\");\nconst retrieveGamepadInputs_1 = __webpack_require__(/*! ../input/gamepad/retrieveGamepadInputs */ \"./src/input/gamepad/retrieveGamepadInputs.ts\");\nconst drawGamepad_1 = __webpack_require__(/*! ../input/gamepad/drawGamepad */ \"./src/input/gamepad/drawGamepad.ts\");\nconst deepCopyObject_1 = __webpack_require__(/*! ./util/deepCopyObject */ \"./src/main/util/deepCopyObject.ts\");\nconst css_2 = __webpack_require__(/*! ../menus/css */ \"./src/menus/css.ts\");\n/*globals performance*/\nexports.holiday = 0;\nexports.snowCount = 150;\n//todo find 'Player' object\nexports.player = [0, 0, 0, 0];\nexports.renderTime = [10, 0, 100, 0];\nexports.gamelogicTime = [5, 0, 100, 0];\nexports.framerate = [0, 0, 0];\nexports.characterSelections = [0, 0, 0, 0];\nexports.shine = 0.5;\nexports.calibrationPlayer = 0;\nexports.gameEnd = false;\nexports.controllerResetCountdowns = [0, 0, 0, 0];\nfunction setControllerReset(i) {\n    exports.controllerResetCountdowns[i] = 0;\n}\nlet keyboardOccupied = false;\nexports.usingCustomControls = [false, false, false, false];\nfunction setUsingCustomControls(i, boolean, info) {\n    exports.usingCustomControls[i] = boolean;\n    if (bool) {\n        exports.mType[i] = custom_1.customGamepadInfo[exports.currentPlayers[i]];\n    }\n    else {\n        exports.mType[i] = info;\n    }\n}\nexports.firstTimeDetected = [true, true, true, true];\nwindow.mType = [null, null, null, null];\nexports.mType = [null, null, null, null];\nfunction setMtype(index, val) {\n    exports.mType[index] = val;\n}\nexports.currentPlayers = [];\nfunction setCurrentPlayer(index, val) {\n    exports.currentPlayers[index] = val;\n}\nexports.playerAmount = 0;\nexports.playerType = [-1, -1, -1, -1];\nexports.cpuDifficulty = [3, 3, 3, 3];\nexports.ports = 0;\nexports.activePorts = [];\nexports.playing = false;\nexports.frameByFrame = false;\nexports.wasFrameByFrame = false;\nexports.frameByFrameRender = false;\nexports.findingPlayers = true;\nexports.showDebug = false;\nexports.gameMode = 20;\n// 20:Startup\n// 13:Data Menu\n// 12:Keyboard Controls\n// 11:Gameplay Menu\n// 10:Sound Menu\n// 9: -\n// 8: -\n// 7:Target Select\n// 6:Stage Select (VS)\n// 5:Target Playing\n// 4:Target Builder\n// 3:Playing (VS)\n// 2:CSS\n// 1:Main Menu\n// 0:Title Screen\nexports.versusMode = 0;\nexports.randomTags = [\"NEO!\", \"SELF\", \"NOVA\", \"PNDA\", \"Panda\", \"LFFN\", \"Scorp\", \"AZ\", \"AXE\", \"Tempo\", \"TMPO\", \"[A]rmada\", \"WBALLZ\", \"Westballz\", \"PPMD\", \"Kreygasm\", \"M2K\", \"Mang0\", \"USA\", \"SCAR\", \"TOPH\", \"(.Y.)\", \"HBOX\", \"HungryBox\", \"PLUP\", \"Shroomed\", \"SFAT\", \"Wizz\", \"Lucky\", \"S2J\", \"SilentWolf\", \"aMSa\", \"S2J\", \"Hax$\"];\nexports.palettes = [[\"rgb(250, 89, 89)\", \"rgb(255, 170, 170)\", \"rgba(255, 206, 111, \", \"rgb(244, 68, 68)\", \"rgba(255, 225, 167, \"],\n    [\"rgb(95, 216, 84)\", \"rgb(184, 253, 154)\", \"rgba(252, 95, 95, \", \"rgb(255, 182, 96)\", \"rgba(254, 141, 141, \"],\n    [\"rgb(5, 195, 255)\", \"rgb(121, 223, 255)\", \"rgba(218, 96, 254, \", \"rgb(231, 134, 255)\", \"rgba(230, 144, 255, \"],\n    [\"rgb(255, 187, 70)\", \"rgb(248, 255, 122)\", \"rgba(80, 182, 255, \", \"rgb(255, 142, 70)\", \"rgba(139, 203, 249, \"],\n    [\"rgb(177, 89, 255)\", \"rgb(203, 144, 255)\", \"rgba(144, 255, 110, \", \"rgb(247, 126, 250)\", \"rgba(190, 255, 170, \"],\n    [\"rgb(182, 131, 70)\", \"rgb(252, 194, 126)\", \"rgba(47, 186, 123, \", \"rgb(255, 112, 66)\", \"rgba(111, 214, 168, \"],\n    [\"rgb(232, 232, 208)\", \"rgb(255, 255, 255)\", \"rgba(244, 255, 112, \", \"rgb(191, 119, 119)\", \"rgba(255, 255, 200, \"]];\nexports.hasTag = [false, false, false, false];\nexports.tagText = [\"\", \"\", \"\", \"\"];\nfunction setTagText(index, value) {\n    exports.tagText[index] = value;\n    exports.hasTag[index] = true;\n}\nexports.pPal = [0, 1, 2, 3];\nexports.costumeTimeout = [];\nexports.colours = [\"rgba(4, 255, 82, 0.62)\", \"rgba(117, 20, 255, 0.63)\", \"rgba(255, 20, 20, 0.63)\", \"rgba(255, 232, 20, 0.63)\"];\nexports.pause = [[true, true], [true, true], [true, true], [true, true]];\nexports.frameAdvance = [[true, true], [true, true], [true, true], [true, true]];\nexports.startingPoint = [[-50, 50], [50, 50], [-25, 5], [25, 5]];\nexports.startingFace = [1, -1, 1, -1];\nexports.ground = [[-68.4, 0], [68.4, 0]];\nexports.platforms = [[[-57.6, 27.2], [-20, 27.2]], [[20, 27.2], [57.6, 27.2]], [[-18.8, 54.4], [18.8, 54.4]]];\nexports.wallsL = [[[-68.4, 0], [-68.4, -108.8]]];\nexports.wallsR = [[[68.4, 0], [68.4, -108.8]]];\nexports.edges = [[[-68.4, 0], [-63.4, 0]], [[68.4, 0], [63.4, 0]]];\n//edgeOffset = [[-71.3,-23.7],[71.3,-23.7]];\nexports.edgeOffset = [[-2.9, -23.7], [2.9, -23.7]];\nexports.edgeOrientation = [1, -1];\nexports.respawnPoints = [[-50, 50, 1], [50, 50, -1], [25, 35, 1], [-25, 35, -1]];\nexports.stageSelect = 0;\nfunction setStageSelect(val) {\n    exports.stageSelect = val;\n}\nexports.blastzone = new Box2D_1.Box2D([-224, 200], [224, -108.8]);\nexports.starting = true;\nfunction setStarting(val) {\n    exports.starting = val;\n}\nexports.startTimer = 1.5;\nfunction setStartTimer(val) {\n    exports.startTimer = val;\n}\nfunction getStartTimer() {\n    return exports.startTimer;\n}\n//matchTimer = 5999.99;\nexports.matchTimer = 480;\nfunction addMatchTimer(val) {\n    exports.matchTimer += val;\n}\nfunction setMatchTimer(val) {\n    exports.matchTimer = val;\n}\nfunction getMatchTimer() {\n    return exports.matchTimer;\n}\nexports.usingLocalStorage = false;\nif (typeof (Storage) !== \"undefined\") {\n    // Code for localStorage/sessionStorage.\n    exports.usingLocalStorage = true;\n    console.log(\"local storage works\");\n}\nelse {\n    // Sorry! No Web Storage support..\n    console.log(\"local storage does not work\");\n}\nfunction setCookie(cname, cvalue, exdays) {\n    var d = new Date();\n    d.setTime(d.getTime() + (exdays * 24 * 60 * 60 * 1000));\n    var exp = \"expires=\" + d.toUTCString();\n    document.cookie = cname + \"=\" + cvalue + \"; \" + exp;\n    localStorage.setItem(cname, cvalue);\n}\nfunction setVersusMode(val) {\n    exports.versusMode = val;\n}\nfunction getCookie(cname) {\n    if (exports.usingLocalStorage) {\n        return localStorage.getItem(cname);\n    }\n    else {\n        var name = cname + \"=\";\n        var ca = document.cookie.split(';');\n        for (var i = 0; i < ca.length; i++) {\n            var c = ca[i];\n            while (c.charAt(0) == ' ')\n                c = c.substring(1);\n            if (c.indexOf(name) == 0)\n                return c.substring(name.length, c.length);\n        }\n        return \"\";\n    }\n}\nexports.keys = {};\nexports.keyBind = 0;\nexports.keyBinding = false;\nfunction setKeyBinding(val) {\n    exports.keyBinding = val;\n}\nfunction overrideKeyboardEvent(e) {\n    if (!showingCode && css_1.choosingTag == -1 && e.keyCode != 122 && e.keyCode != 116) {\n        switch (e.type) {\n            case \"keydown\":\n                if (!exports.keys[e.keyCode]) {\n                    exports.keys[e.keyCode] = true;\n                    exports.keyBind = e.keyCode;\n                    exports.keyBinding = true;\n                    // do key down stuff here\n                }\n                break;\n            case \"keyup\":\n                delete (exports.keys[e.keyCode]);\n                // do key up stuff here\n                break;\n        }\n        disabledEventPropagation(e);\n        e.preventDefault();\n        return false;\n    }\n    else {\n        if (css_1.choosingTag > -1) {\n            if (e.keyCode == 13) {\n                switch (e.type) {\n                    case \"keydown\":\n                        exports.keys[13] = true;\n                        break;\n                    case \"keyup\":\n                        delete (exports.keys[13]);\n                        break;\n                    default:\n                        break;\n                }\n            }\n        }\n        return true;\n    }\n}\n;\nfunction disabledEventPropagation(e) {\n    if (e) {\n        if (e.stopPropagation) {\n            e.stopPropagation();\n        }\n        else if (event) {\n            event.cancelBubble = true;\n        }\n    }\n}\n;\ndocument.onkeydown = overrideKeyboardEvent;\ndocument.onkeyup = overrideKeyboardEvent;\n/*var keys = [];\nexport const onkeyup (e) {\n  keys[e.keyCode]=false;\n}\nexport const onkeydown (e) {\n  keys[e.keyCode]=true;\n}*/\nfunction SVG(tag) {\n    return document.createElementNS('http://www.w3.org/2000/svg', tag);\n}\n/*if (Gamepad.supported) {\n    console.log(\"gamepad supported\");\n} else {\n    console.log(\"gamepad not supported\");\n}*/\nwindow.addEventListener(\"gamepadconnected\", function (e) {\n    console.log(\"Gamepad connected at index %d: %s. %d buttons, %d axes.\", e.gamepad.index, e.gamepad.id, e.gamepad.buttons.length, e.gamepad.axes.length);\n});\nif (navigator.getGamepads)\n    console.log(navigator.getGamepads());\nfunction matchTimerTick(input) {\n    exports.matchTimer -= 0.016667;\n    if (dom.matchMinutes && dom.matchSeconds) {\n        var sec = (exports.matchTimer % 60).toFixed(2);\n        dom.matchMinutes.innerHTML = Math.floor(exports.matchTimer / 60);\n        dom.matchSeconds.innerHTML = sec.length < 5 ? `0${sec}` : sec;\n    }\n    if (exports.matchTimer <= 0) {\n        finishGame(input);\n    }\n}\nfunction screenShake(kb) {\n    var seed = [Math.random(), Math.random(), Math.random(), Math.random()];\n    exports.fg1.translate(kb * 0.1 * seed[0], kb * 0.1 * seed[1]);\n    setTimeout(function () { exports.fg1.translate(-kb * 0.05 * seed[0], -kb * 0.05 * seed[1]); }, 20);\n    setTimeout(function () { exports.fg1.translate(-kb * 0.05 * seed[0], -kb * 0.05 * seed[1]); exports.fg1.translate(-kb * 0.1 * seed[2], -kb * 0.1 * seed[3]); }, 40);\n    setTimeout(function () { exports.fg1.translate(kb * 0.05 * seed[2], kb * 0.05 * seed[3]); }, 60);\n    setTimeout(function () { exports.fg1.translate(kb * 0.05 * seed[2], kb * 0.05 * seed[3]); }, 80);\n}\nfunction percentShake(kb, i) {\n    exports.player[i].percentShake = new Vec2D_1.Vec2D(kb * 0.1 * Math.random(), kb * 0.1 * Math.random());\n    setTimeout(function () { exports.player[i].percentShake = new Vec2D_1.Vec2D(kb * 0.05 * Math.random(), kb * 0.05 * Math.random()); }, 20);\n    setTimeout(function () { exports.player[i].percentShake = new Vec2D_1.Vec2D(-kb * 0.1 * Math.random(), -kb * 0.1 * Math.random()); }, 40);\n    setTimeout(function () { exports.player[i].percentShake = new Vec2D_1.Vec2D(-kb * 0.05 * Math.random(), -kb * 0.05 * Math.random()); }, 60);\n    setTimeout(function () { exports.player[i].percentShake = new Vec2D_1.Vec2D(0, 0); }, 80);\n}\nfunction findPlayers() {\n    var gps = navigator.getGamepads ? navigator.getGamepads() : (navigator.webkitGetGamepads ? navigator.webkitGetGamepads() : []);\n    /*if (typeof gps != \"undefined\"){\n      console.log(gps);\n    }*/\n    if (!keyboardOccupied) {\n        if (exports.gameMode < 2 || exports.gameMode == 20) {\n            if (exports.keys[13] || exports.keys[settings_1.keyMap.s[0]] || exports.keys[settings_1.keyMap.s[1]]) {\n                if (exports.ports < 4) {\n                    changeGamemode(1);\n                    (0, jquery_1.default)(\"#keyboardPrompt\").hide();\n                    keyboardOccupied = true;\n                    sfx_1.sounds.menuForward.play();\n                    if (exports.ports == 0) {\n                        music_1.MusicManager.playMenuLoop();\n                    }\n                    addPlayer(exports.ports, \"keyboard\");\n                }\n            }\n        }\n        else {\n            if (exports.keys[settings_1.keyMap.a[0]] || exports.keys[settings_1.keyMap.a[1]]) {\n                if (exports.ports < 4) {\n                    keyboardOccupied = true;\n                    addPlayer(exports.ports, \"keyboard\");\n                }\n            }\n        }\n    }\n    for (var i = 0; i < gps.length; i++) {\n        var gamepad = navigator.getGamepads ? navigator.getGamepads()[i] : (navigator.webkitGetGamepads ? navigator.webkitGetGamepads()[i] : null);\n        if (exports.playerType[i] === 2) {\n            var alreadyIn = false;\n            for (var k = 0; k < exports.ports; k++) {\n                if (exports.currentPlayers[k] === i) {\n                    alreadyIn = true;\n                }\n            }\n            if (!alreadyIn) {\n                if (exports.ports < 4) {\n                    addPlayer(i, 99);\n                }\n            }\n            continue;\n        }\n        var gamepad = navigator.getGamepads ? navigator.getGamepads()[i] : (navigator.webkitGetGamepads ? navigator.webkitGetGamepads()[i] : null);\n        if (typeof gamepad != \"undefined\" && gamepad != null) {\n            var detected = false;\n            var gpdName;\n            var gpdInfo;\n            if (exports.usingCustomControls[i] && custom_1.customGamepadInfo[i] !== null) {\n                gpdName = \"custom controls\";\n                gpdInfo = custom_1.customGamepadInfo[i];\n                detected = true;\n            }\n            else {\n                const maybeNameAndInfo = (0, findGamepadInfo_1.getGamepadNameAndInfo)(gamepad.id);\n                if (maybeNameAndInfo === null) {\n                    console.log(\"Error in 'findPlayers': controller \" + (i + 1) + \" detected but not supported.\");\n                    console.log(\"Try manual calibration of your controller.\");\n                }\n                else {\n                    detected = true;\n                    [gpdName, gpdInfo] = maybeNameAndInfo;\n                }\n            }\n            if (detected) {\n                if (exports.firstTimeDetected[i]) {\n                    console.log(\"Controller \" + (i + 1) + \" is: \" + gpdName + \".\");\n                    exports.firstTimeDetected[i] = false;\n                }\n                if (exports.gameMode < 2 || exports.gameMode == 20) {\n                    if ((0, retrieveGamepadInputs_1.buttonState)(gamepad, gpdInfo, \"s\")) {\n                        var alreadyIn = false;\n                        for (var k = 0; k < exports.ports; k++) {\n                            if (exports.currentPlayers[k] == i) {\n                                alreadyIn = true;\n                            }\n                        }\n                        if (!alreadyIn) {\n                            if (exports.ports < 4) {\n                                changeGamemode(1);\n                                (0, jquery_1.default)(\"#keyboardPrompt\").hide();\n                                sfx_1.sounds.menuForward.play();\n                                if (exports.ports === 0) {\n                                    music_1.MusicManager.playMenuLoop();\n                                }\n                                addPlayer(i, gpdInfo);\n                            }\n                        }\n                    }\n                }\n                else {\n                    if ((0, retrieveGamepadInputs_1.buttonState)(gamepad, gpdInfo, \"a\")) {\n                        var alreadyIn = false;\n                        for (var k = 0; k < exports.ports; k++) {\n                            if (exports.currentPlayers[k] == i) {\n                                alreadyIn = true;\n                            }\n                        }\n                        if (!alreadyIn) {\n                            if (exports.ports < 4) {\n                                addPlayer(i, gpdInfo);\n                            }\n                        }\n                    }\n                }\n            }\n            else {\n                console.log(\"No controller detected by browser\");\n            }\n        }\n    }\n}\nfunction setPlayerType(playerSlot, type) {\n    exports.playerType[playerSlot] = type;\n}\nfunction addPlayer(i, controllerInfo) {\n    if (controllerInfo === 99) {\n        exports.ports++;\n        exports.currentPlayers[exports.ports - 1] = i;\n        exports.playerType[exports.ports - 1] = 2;\n        exports.mType[exports.ports - 1] = controllerInfo;\n    }\n    else {\n        exports.ports++;\n        exports.currentPlayers[exports.ports - 1] = i;\n        exports.playerType[exports.ports - 1] = 0;\n        exports.mType[exports.ports - 1] = controllerInfo;\n        if (exports.showDebug) {\n            (0, drawGamepad_1.updateGamepadSVGColour)(i, \"gamepadSVG\" + i);\n            document.getElementById(\"gamepadSVG\" + i).style.display = \"\";\n        }\n    }\n}\nfunction togglePort(i) {\n    exports.playerType[i]++;\n    if (exports.playerType[i] == 3) {\n        exports.playerType[i] = -1;\n        if (exports.showDebug) {\n            document.getElementById(\"gamepadSVG\" + i).style.display = \"none\";\n        }\n    }\n    if (exports.playerType[i] == 0 && exports.ports <= i) {\n        exports.playerType[i] = 1;\n        (0, drawGamepad_1.setGamepadSVGColour)(i, \"black\");\n        if (exports.showDebug) {\n            (0, drawGamepad_1.updateGamepadSVGColour)(i, \"gamepadSVG\" + i);\n            document.getElementById(\"gamepadSVG\" + i).style.display = \"\";\n        }\n    }\n}\nfunction positionPlayersInCSS() {\n    for (var i = 0; i < 4; i++) {\n        var x = (-80 + i * 50) * 2 / 3;\n        var y = -30;\n        exports.player[i].phys.pos = new Vec2D_1.Vec2D(x, y);\n        exports.player[i].phys.hurtbox = new Box2D_1.Box2D([-4 + x, 18 + y], [4 + x, y]);\n    }\n}\n// 20:Startup\n// 14:Controller Menu\n// 13:Data Menu\n// 12:Keyboard Controls\n// 11:Gameplay Menu\n// 10:Sound Menu\n// 9: -\n// 8: -\n// 7:Target Select\n// 6:Stage Select (VS)\n// 5:Target Playing\n// 4:Target Builder\n// 3:Playing (VS)\n// 2:CSS\n// 1:Main Menu\n// 0:Title Screen\nfunction changeGamemode(newGamemode) {\n    exports.bg1.fillStyle = \"black\";\n    exports.bg1.fillRect(0, 0, exports.layers.BG1.width, exports.layers.BG1.height);\n    exports.fg1.clearRect(0, 0, exports.layers.FG1.width, exports.layers.FG1.height);\n    exports.gameMode = newGamemode;\n    switch (newGamemode) {\n        // TITLESCREEN\n        case 0:\n            (0, startscreen_1.drawStartScreenInit)();\n            break;\n        // MAIN MENU\n        case 1:\n            (0, jquery_1.default)(\"#logoVid\").remove();\n            (0, menu_1.drawMainMenuInit)();\n            break;\n        // CSS\n        case 2:\n            (0, css_1.drawCSSInit)();\n            break;\n        // Playing (VS)\n        case 3:\n            (0, stagerender_1.drawBackgroundInit)();\n            (0, stagerender_1.drawStageInit)();\n            break;\n        // Target Builder\n        case 4:\n            break;\n        // Target Playing\n        case 5:\n            (0, stagerender_1.drawBackgroundInit)();\n            (0, stagerender_1.drawStageInit)();\n            break;\n        // Stage select (vs)\n        case 6:\n            (0, stageselect_1.drawSSSInit)();\n            break;\n        // Target Select\n        case 7:\n            // drawTSSInit();\n            break;\n        // sound menu\n        case 10:\n            (0, audiomenu_1.drawAudioMenuInit)();\n            break;\n        // gameplay menu\n        case 11:\n            (0, gameplaymenu_1.drawGameplayMenuInit)();\n            break;\n        // keyboard menu\n        case 12:\n            (0, keyboardmenu_1.drawKeyboardMenuInit)();\n            break;\n        // credits\n        case 13:\n            // drawCreditsInit();\n            break;\n        // Multiplayer Modes\n        case 14:\n            (0, controllermenu_1.drawControllerMenuInit)();\n            break;\n        case 15:\n            (0, css_1.drawCSSInit)();\n            (0, streamclient_1.connectToMPServer)();\n            break;\n        // startup\n        case 20:\n            break;\n        default:\n            break;\n    }\n}\n/*export const addPlayer (i,gType,pType){\n  console.log(i,gType,pType);\n\n  currentPlayers.push(i);\n  if (pType == 0){\n    ports++;\n    mType[ports-1] = gType;\n    playerType[ports-1] = pType;\n\n    costumeTimeout.push(false);\n    pPal.push(ports-1);\n    buildPlayerObject(ports-1);\n    player[playerAmount-1].phys.pos = new Vec2D(-100+25*(playerAmount=1),-40);\n    player[ports-1].phys.face = 1;\n    player[ports-1].actionState = 0;\n    $(\"#currentPlayers\").append('<div class=\"pBoxBox\"><div class=\"playerBox\" id=\"pBox'+(ports-1)+'\" style=\"background-color:'+palettes[pPal[ports-1]][0]+';border:5px solid '+palettes[pPal[ports-1]][2]+'0.8)\"><p>P'+ports+'<br><span class=\"cont\">(Cont. '+i+')</span></p></div><div id=\"pTag'+(ports-1)+'\" class=\"pTag\"><textarea id=\"pTagEdit'+(ports-1)+'\" class=\"pTagEdit\" maxlength=\"10\"></textarea></div></div>');\n  }\n  else {\n    mType[i] = gType;\n\n    costumeTimeout.push(false);\n    pPal.push(i);\n    buildPlayerObject(i);\n    player[playerAmount-1].phys.pos = new Vec2D(-100+25*(playerAmount=1),-40);\n    player[i].phys.face = 1;\n    player[i].actionState = 0;\n    $(\"#currentPlayers\").append('<div class=\"pBoxBox\"><div class=\"playerBox\" id=\"pBox'+i+'\" style=\"background-color:'+palettes[pPal[i]][0]+';border:5px solid '+palettes[pPal[i]][2]+'0.8)\"><p>P'+(i+1)+'<br><span class=\"cont\">(Cont. '+i+')</span></p></div><div id=\"pTag'+i+'\" class=\"pTag\"><textarea id=\"pTagEdit'+i+'\" class=\"pTagEdit\" maxlength=\"10\"></textarea></div></div>');\n  }\n  playerAmount++;\n}\n\nexport const removePlayer (i){\n  playerType[i] = -1;\n  playerAmount--;\n}*/\nfunction interpretInputs(i, active, playertype, inputBuffer) {\n    let tempBuffer = (0, input_1.nullInputs)();\n    // keep updating Z and Start all the time, even when paused\n    for (var k = 0; k < 7; k++) {\n        tempBuffer[7 - k].z = inputBuffer[6 - k].z;\n        tempBuffer[7 - k].s = inputBuffer[6 - k].s;\n    }\n    tempBuffer[0] = (0, input_1.pollInputs)(exports.gameMode, exports.frameByFrame, exports.mType[i], i, exports.currentPlayers[i], exports.keys, playertype);\n    let pastOffset = 0;\n    if ((exports.gameMode !== 3 && exports.gameMode !== 5) || (exports.playing && (exports.pause[i][1] || !exports.pause[i][0]))\n        || exports.wasFrameByFrame\n        || (!exports.playing && exports.pause[i][0] && !exports.pause[i][1])) {\n        pastOffset = 1;\n    }\n    exports.pause[i][1] = exports.pause[i][0];\n    exports.wasFrameByFrame = false;\n    exports.frameAdvance[i][1] = exports.frameAdvance[i][0];\n    for (var k = 0; k < 7; k++) {\n        tempBuffer[7 - k].lsX = inputBuffer[7 - k - pastOffset].lsX;\n        tempBuffer[7 - k].lsY = inputBuffer[7 - k - pastOffset].lsY;\n        tempBuffer[7 - k].rawX = inputBuffer[7 - k - pastOffset].rawX;\n        tempBuffer[7 - k].rawY = inputBuffer[7 - k - pastOffset].rawY;\n        tempBuffer[7 - k].csX = inputBuffer[7 - k - pastOffset].csX;\n        tempBuffer[7 - k].csY = inputBuffer[7 - k - pastOffset].csY;\n        tempBuffer[7 - k].rawcsX = inputBuffer[7 - k - pastOffset].rawcsX;\n        tempBuffer[7 - k].rawcsY = inputBuffer[7 - k - pastOffset].rawcsY;\n        tempBuffer[7 - k].lA = inputBuffer[7 - k - pastOffset].lA;\n        tempBuffer[7 - k].rA = inputBuffer[7 - k - pastOffset].rA;\n        tempBuffer[7 - k].a = inputBuffer[7 - k - pastOffset].a;\n        tempBuffer[7 - k].b = inputBuffer[7 - k - pastOffset].b;\n        tempBuffer[7 - k].x = inputBuffer[7 - k - pastOffset].x;\n        tempBuffer[7 - k].y = inputBuffer[7 - k - pastOffset].y;\n        tempBuffer[7 - k].r = inputBuffer[7 - k - pastOffset].r;\n        tempBuffer[7 - k].l = inputBuffer[7 - k - pastOffset].l;\n        tempBuffer[7 - k].dl = inputBuffer[7 - k - pastOffset].dl;\n        tempBuffer[7 - k].dd = inputBuffer[7 - k - pastOffset].dd;\n        tempBuffer[7 - k].dr = inputBuffer[7 - k - pastOffset].dr;\n        tempBuffer[7 - k].du = inputBuffer[7 - k - pastOffset].du;\n    }\n    if (exports.mType !== null) {\n        if ((exports.mType[i] === \"keyboard\" && (tempBuffer[0].z || tempBuffer[1].z))\n            || (exports.mType[i] !== \"keyboard\" && (tempBuffer[0].z && !tempBuffer[1].z))) {\n            exports.frameAdvance[i][0] = true;\n        }\n        else {\n            exports.frameAdvance[i][0] = false;\n        }\n    }\n    if (exports.frameAdvance[i][0] && !exports.frameAdvance[i][1] && !exports.playing && exports.gameMode !== 4) {\n        exports.frameByFrame = true;\n    }\n    if (exports.mType[i] === \"keyboard\") { // keyboard controls\n        if (tempBuffer[0].s || tempBuffer[1].s || (exports.gameMode === 5 && (tempBuffer[0].du || tempBuffer[1].du))) {\n            exports.pause[i][0] = true;\n        }\n        else {\n            exports.pause[i][0] = false;\n        }\n        if (!exports.playing && (exports.gameMode == 3 || exports.gameMode == 5)\n            && (tempBuffer[0].a || tempBuffer[1].a) && (tempBuffer[0].l || tempBuffer[1].l)\n            && (tempBuffer[0].r || tempBuffer[1].r) && (tempBuffer[0].s || tempBuffer[1].s)) {\n            if (tempBuffer[0].b || tempBuffer[1].b) {\n                startGame();\n            }\n            else {\n                endGame(inputBuffer);\n            }\n        }\n        interpretPause(exports.pause[i][0], exports.pause[i][1]);\n    }\n    else if (exports.mType[i] !== null) { // gamepad controls\n        if (!exports.playing && (exports.gameMode == 3 || exports.gameMode == 5) &&\n            (tempBuffer[0].a && tempBuffer[0].l && tempBuffer[0].r && tempBuffer[0].s)\n            && (!(tempBuffer[1].a && tempBuffer[1].l && tempBuffer[1].r && tempBuffer[1].s))) {\n            if (tempBuffer[0].b) {\n                startGame();\n            }\n            else {\n                endGame(inputBuffer);\n            }\n        }\n        if (tempBuffer[0].s || tempBuffer[0].du && exports.gameMode == 5) {\n            exports.pause[i][0] = true;\n        }\n        else {\n            exports.pause[i][0] = false;\n        }\n        // Controller reset functionality\n        if ((tempBuffer[0].z || tempBuffer[0].du) && tempBuffer[0].x && tempBuffer[0].y) {\n            exports.controllerResetCountdowns[i] -= 1;\n            if (exports.controllerResetCountdowns[i] === 0) {\n                // triggers code in input.js\n                console.log(\"Controller #\" + (i + 1) + \" was reset!\");\n                (0, jquery_1.default)(\"#resetIndicator\" + i).fadeIn(100);\n                (0, jquery_1.default)(\"#resetIndicator\" + i).fadeOut(500);\n            }\n        }\n        else {\n            exports.controllerResetCountdowns[i] = 125;\n        }\n        interpretPause(exports.pause[i][0], exports.pause[i][1]);\n    }\n    else { // AI\n        tempBuffer[0].rawX = tempBuffer[0].lsX;\n        tempBuffer[0].rawY = tempBuffer[0].lsY;\n        tempBuffer[0].rawcsX = tempBuffer[0].csX;\n        tempBuffer[0].rawcsY = tempBuffer[0].csY;\n        tempBuffer[0].lsX = (0, meleeInputs_1.deaden)(tempBuffer[0].rawX);\n        tempBuffer[0].lsY = (0, meleeInputs_1.deaden)(tempBuffer[0].rawY);\n        tempBuffer[0].csX = (0, meleeInputs_1.deaden)(tempBuffer[0].rawcsX);\n        tempBuffer[0].csY = (0, meleeInputs_1.deaden)(tempBuffer[0].rawcsY);\n    }\n    if (exports.showDebug) {\n        (0, jquery_1.default)(\"#lsAxisX\" + i).empty().append(tempBuffer[0].lsX.toFixed(3));\n        (0, jquery_1.default)(\"#lsAxisY\" + i).empty().append(tempBuffer[0].lsY.toFixed(3));\n        (0, jquery_1.default)(\"#csAxisX\" + i).empty().append(tempBuffer[0].csX.toFixed(3));\n        (0, jquery_1.default)(\"#csAxisY\" + i).empty().append(tempBuffer[0].csY.toFixed(3));\n        (0, jquery_1.default)(\"#lAnalog\" + i).empty().append(tempBuffer[0].lA.toFixed(3));\n        (0, jquery_1.default)(\"#rAnalog\" + i).empty().append(tempBuffer[0].rA.toFixed(3));\n        (0, drawGamepad_1.updateGamepadSVGState)(i, \"gamepadSVG\" + i, tempBuffer[0]);\n    }\n    if (exports.gameMode === 14) { // controller calibration screen\n        (0, drawGamepad_1.updateGamepadSVGState)(i, \"gamepadSVGCalibration\", tempBuffer[0]);\n    }\n    if (exports.showDebug || exports.gameMode === 14) {\n        const which = (exports.showDebug && exports.gameMode === 14) ? \"both\" : exports.showDebug ? \"debug\" : \"calibration\";\n        if (tempBuffer[0].x && !tempBuffer[1].x && tempBuffer[0].du) {\n            (0, drawGamepad_1.cycleGamepadColour)(i, which, true);\n        }\n        if (tempBuffer[0].y && !tempBuffer[1].y && tempBuffer[0].du) {\n            (0, drawGamepad_1.cycleGamepadColour)(i, which, false);\n        }\n    }\n    if (streamclient_1.giveInputs[i] === true) {\n        //turns out keyboards leave gaps in the input buffer\n        (0, deepCopyObject_1.deepObjectMerge)(true, (0, input_1.nullInput)(), tempBuffer[0]);\n        (0, streamclient_1.updateNetworkInputs)(tempBuffer[0], i);\n    }\n    if (active) {\n        if (tempBuffer[0].dl && !tempBuffer[1].dl) {\n            exports.player[i].showLedgeGrabBox ^= true;\n        }\n        if (tempBuffer[0].dd && !tempBuffer[1].dd) {\n            exports.player[i].showECB ^= true;\n        }\n        if (tempBuffer[0].dr && !tempBuffer[1].dr) {\n            exports.player[i].showHitbox ^= true;\n        }\n    }\n    if (exports.frameByFrame) {\n        tempBuffer[0].z = false;\n    }\n    return tempBuffer;\n}\nfunction interpretPause(pause0, pause1) {\n    if (pause0 && !pause1) {\n        if (exports.gameMode == 3 || exports.gameMode == 5) {\n            exports.playing ^= true;\n            if (!exports.playing) {\n                sfx_1.sounds.pause.play();\n                changeVolume(music_1.MusicManager, audiomenu_1.masterVolume[1] * 0.3, 1);\n                (0, render_1.renderForeground)();\n            }\n            else {\n                changeVolume(music_1.MusicManager, audiomenu_1.masterVolume[1], 1);\n            }\n        }\n    }\n}\nexports.bg1 = 0;\nexports.bg2 = 0;\nexports.fg1 = 0;\nexports.fg2 = 0;\nexports.ui = 0;\nexports.c = 0;\nexports.canvasMain = 0;\nexports.layers = {\n    BG1: null,\n    BG2: null,\n    FG1: null,\n    FG2: null,\n    UI: null\n};\nexports.layerSwitches = {\n    BG1: true,\n    BG2: true,\n    FG1: true,\n    FG2: true,\n    UI: true\n};\nfunction renderToMain() {\n    var keys = Object.keys(exports.layers);\n    for (var i = 0; i < keys.length; i++) {\n        if (exports.layerSwitches[keys[i]]) {\n            exports.c.drawImage(exports.layers[keys[i]], 0, 0);\n        }\n    }\n}\nfunction update(i, inputBuffers) {\n    if (!exports.starting) {\n        if (exports.currentPlayers[i] != -1) {\n            if (exports.playerType[i] == 0) {\n                // do nothing, use the provided player i inputs\n            }\n            else if (exports.playerType[i] === 1) {\n                if (exports.player[i].actionState != \"SLEEP\") {\n                    (0, ai_1.runAI)(i); // no need to return input since polling returns ai input if they are active\n                }\n            }\n        }\n    }\n    (0, physics_1.physics)(i, inputBuffers);\n}\nlet delta = 0;\nlet lastFrameTimeMs = 0;\nlet lastUpdate = performance.now();\nfunction gameTick(oldInputBuffers) {\n    var start = performance.now();\n    var diff = 0;\n    let input = [(0, input_1.nullInputs)(), (0, input_1.nullInputs)(), (0, input_1.nullInputs)(), (0, input_1.nullInputs)()];\n    if (exports.gameMode == 0 || exports.gameMode == 20) {\n        findPlayers();\n    }\n    else if (exports.gameMode == 1) {\n        //console.log(playerType);\n        for (var i = 0; i < exports.ports; i++) {\n            input[i] = interpretInputs(i, true, exports.playerType[i], oldInputBuffers[i]);\n            (0, menu_1.menuMove)(i, input);\n        }\n    }\n    else if (exports.gameMode == 10) {\n        for (var i = 0; i < exports.ports; i++) {\n            input[i] = interpretInputs(i, true, exports.playerType[i], oldInputBuffers[i]);\n            (0, audiomenu_1.audioMenuControls)(i, input);\n        }\n    }\n    else if (exports.gameMode == 11) {\n        for (var i = 0; i < exports.ports; i++) {\n            input[i] = interpretInputs(i, true, exports.playerType[i], oldInputBuffers[i]);\n            (0, gameplaymenu_1.gameplayMenuControls)(i, input);\n        }\n    }\n    else if (exports.gameMode == 12) {\n        for (var i = 0; i < exports.ports; i++) {\n            input[i] = interpretInputs(i, true, exports.playerType[i], oldInputBuffers[i]);\n            (0, keyboardmenu_1.keyboardMenuControls)(i, input);\n        }\n    }\n    else if (exports.gameMode == 13) {\n        //target\n    }\n    else if (exports.gameMode == 14) {\n        // controller calibration\n        input[exports.calibrationPlayer] = interpretInputs(exports.calibrationPlayer, true, exports.playerType[exports.calibrationPlayer], oldInputBuffers[exports.calibrationPlayer]);\n    }\n    else if (exports.gameMode == 15) {\n        for (var i = 0; i < exports.ports; i++) {\n            input[i] = interpretInputs(i, true, exports.playerType[i], oldInputBuffers[i]);\n            (0, menu_1.menuMove)(i, input);\n        }\n    }\n    else if (exports.gameMode == 2) {\n        for (var i = 0; i < 4; i++) {\n            if (i < exports.ports) {\n                input[i] = interpretInputs(i, true, exports.playerType[i], oldInputBuffers[i]);\n                (0, css_1.cssControls)(i, input);\n            }\n            actionStateShortcuts_1.actionStates[exports.characterSelections[i]][exports.player[i].actionState].main(i, input);\n        }\n        for (var i = 0; i < 4; i++) {\n            if (exports.playerType[i] > -1) {\n                (0, hitDetection_1.hitDetect)(i, input);\n            }\n        }\n        (0, hitDetection_1.executeHits)(input);\n        (0, hitDetection_1.resetHitQueue)();\n        findPlayers();\n    }\n    else if (exports.gameMode == 6) {\n        // stage select\n        for (var i = 0; i < 4; i++) {\n            if (i < exports.ports) {\n                input[i] = interpretInputs(i, true, exports.playerType[i], oldInputBuffers[i]);\n                (0, stageselect_1.sssControls)(i, input);\n            }\n        }\n    }\n    else if (exports.playing || exports.frameByFrame) {\n        //console.log(\"test0\");\n        /*delta = timestamp - lastFrameTimeMs; // get the delta time since last frame\n        lastFrameTimeMs = timestamp;\n        console.log(delta);*/\n        var now = performance.now();\n        var dt = now - lastUpdate;\n        //console.log(now);\n        //console.log(dt);\n        lastUpdate = now;\n        (0, hitDetection_1.resetHitQueue)();\n        (0, activeStage_1.getActiveStage)().movingPlatforms();\n        (0, article_1.destroyArticles)();\n        (0, article_1.executeArticles)();\n        for (var i = 0; i < 4; i++) {\n            if (exports.playerType[i] > -1) {\n                if (!exports.starting) {\n                    input[i] = interpretInputs(i, true, exports.playerType[i], oldInputBuffers[i]);\n                }\n                update(i, input);\n            }\n        }\n        (0, hitDetection_1.checkPhantoms)();\n        for (var i = 0; i < 4; i++) {\n            if (exports.playerType[i] > -1) {\n                (0, hitDetection_1.hitDetect)(i, input);\n            }\n        }\n        (0, hitDetection_1.executeHits)(input);\n        (0, article_1.articlesHitDetection)();\n        (0, article_1.executeArticleHits)(input);\n        if (!exports.starting && !exports.versusMode) {\n            matchTimerTick(input);\n        }\n        else {\n            exports.startTimer -= 0.01666667;\n            if (exports.startTimer < 0) {\n                exports.starting = false;\n            }\n        }\n        if (exports.frameByFrame) {\n            exports.frameByFrameRender = true;\n            exports.wasFrameByFrame = true;\n        }\n        exports.frameByFrame = false;\n        if (exports.showDebug) {\n            diff = performance.now() - start;\n            exports.gamelogicTime[0] += diff;\n            exports.gamelogicTime[0] /= 2;\n            if (diff >= 10) {\n                exports.gamelogicTime[3]++;\n            }\n            if (diff < exports.gamelogicTime[2]) {\n                exports.gamelogicTime[2] = diff;\n            }\n            if (diff > exports.gamelogicTime[1]) {\n                exports.gamelogicTime[1] = diff;\n            }\n            dom.gamelogicAvg.innerHTML = Math.round(exports.gamelogicTime[0]);\n            dom.gamelogicHigh.innerHTML = Math.round(exports.gamelogicTime[1]);\n            dom.gamelogicLow.innerHTML = Math.round(exports.gamelogicTime[2]);\n            dom.gamelogicPeak.innerHTML = exports.gamelogicTime[3];\n        }\n    }\n    else if (exports.findingPlayers) {\n        findPlayers();\n    }\n    else {\n        if (!exports.gameEnd) {\n            for (var i = 0; i < 4; i++) {\n                if (exports.playerType[i] == 0 || exports.playerType[i] == 2) {\n                    if (exports.currentPlayers[i] != -1) {\n                        input[i] = interpretInputs(i, false, exports.playerType[i], oldInputBuffers[i]);\n                    }\n                }\n            }\n        }\n    }\n    /*\n  \n    var beforeWaster = performance.now();\n    // neeed to waste 0.666ms\n    var timeWasted = false;\n    var t = 0;\n    var o = performance.now();\n    while(!timeWasted){\n      var n = performance.now();\n      t += n - o;\n      //console.log(t);\n      if (t > 0.6666){\n        timeWasted = true;\n      }\n      o = n;\n      //console.log(\".\");\n    }\n    //console.log(performance.now() - beforeWaster);*/\n    (0, replay_1.saveGameState)(input, exports.ports);\n    setTimeout(gameTick, 16, input);\n}\nfunction clearScreen() {\n    //bg1.fillStyle = \"rgb(0, 0, 0)\";\n    //bg1.fillRect(0,0,layers.BG1.width,layers.BG1.height);\n    exports.bg2.clearRect(0, 0, exports.layers.BG2.width, exports.layers.BG2.height);\n    //fg1.clearRect(0,0,layers.FG1.width,layers.FG1.height);\n    exports.fg2.clearRect(0, 0, exports.layers.FG2.width, exports.layers.FG2.height);\n    exports.ui.clearRect(0, 0, exports.layers.UI.width, exports.layers.UI.height);\n}\nlet otherFrame = true;\nlet fps30 = false;\nfunction renderTick() {\n    window.requestAnimationFrame(renderTick);\n    otherFrame ^= true;\n    if ((fps30 && otherFrame) || !fps30) {\n        //console.log(\"------\");\n        if (exports.gameMode == 20) {\n            (0, startup_1.drawStartUp)();\n        }\n        else if (exports.gameMode == 10) {\n            (0, audiomenu_1.drawAudioMenu)();\n        }\n        else if (exports.gameMode == 11) {\n            (0, gameplaymenu_1.drawGameplayMenu)();\n        }\n        else if (exports.gameMode == 12) {\n            (0, keyboardmenu_1.drawKeyboardMenu)();\n        }\n        else if (exports.gameMode == 13) {\n            // drawCredits();\n        }\n        else if (exports.gameMode == 14) {\n            (0, controllermenu_1.drawControllerMenu)();\n        }\n        else if (exports.gameMode == 0) {\n            (0, startscreen_1.drawStartScreen)();\n        }\n        else if (exports.gameMode == 1) {\n            (0, menu_1.drawMainMenu)();\n        }\n        else if (exports.gameMode == 2) {\n            (0, css_1.drawCSS)();\n            //renderVfx();\n        }\n        else if (exports.gameMode == 6) {\n            (0, stageselect_1.drawSSS)();\n        }\n        else if (exports.playing || exports.frameByFrameRender) {\n            /*delta = timestamp - lastFrameTimeMs; // get the delta time since last frame\n            lastFrameTimeMs = timestamp;\n            console.log(delta);*/\n            //console.log(\"test2\");\n            var rStart = performance.now();\n            clearScreen();\n            if ((0, vfx_1.isShowSFX)()) {\n                (0, stagerender_1.drawBackground)();\n            }\n            (0, stagerender_1.drawStage)();\n            for (var i = 0; i < 4; i++) {\n                if (exports.playerType[i] > -1) {\n                    (0, render_1.renderPlayer)(i);\n                }\n            }\n            (0, article_1.renderArticles)();\n            (0, renderVfx_1.renderVfx)();\n            (0, render_1.renderOverlay)(true);\n            if (exports.showDebug) {\n                var diff = performance.now() - rStart;\n                exports.renderTime[0] += diff;\n                exports.renderTime[0] /= 2;\n                if (diff >= 10) {\n                    exports.renderTime[3]++;\n                }\n                if (diff > exports.renderTime[1]) {\n                    exports.renderTime[1] = diff;\n                }\n                if (diff < exports.renderTime[2]) {\n                    exports.renderTime[2] = diff;\n                }\n                dom.renderAvg.innerHTML = Math.round(exports.renderTime[0]);\n                dom.renderHigh.innerHTML = Math.round(exports.renderTime[1]);\n                dom.renderLow.innerHTML = Math.round(exports.renderTime[2]);\n                dom.renderPeak.innerHTML = exports.renderTime[3];\n            }\n        }\n        if (exports.frameByFrameRender) {\n            (0, render_1.renderForeground)();\n        }\n        exports.frameByFrameRender = false;\n        //renderToMain();\n        //console.log(performance.now());\n    }\n    else {\n        if (exports.playing) {\n            (0, renderVfx_1.renderVfx)(true);\n        }\n    }\n}\nfunction buildPlayerObject(i) {\n    exports.player[i] = new player_1.playerObject(exports.characterSelections[i], exports.startingPoint[i], exports.startingFace[i]);\n    exports.player[i].phys.ECB1 = [new Vec2D_1.Vec2D(exports.startingPoint[i].x, exports.startingPoint[i].y), new Vec2D_1.Vec2D(exports.startingPoint[i].x, exports.startingPoint[i].y), new Vec2D_1.Vec2D(exports.startingPoint[i].x, exports.startingPoint[i].y), new Vec2D_1.Vec2D(exports.startingPoint[i].x, exports.startingPoint[i].y)];\n    exports.player[i].phys.ECBp = [new Vec2D_1.Vec2D(exports.startingPoint[i].x, exports.startingPoint[i].y), new Vec2D_1.Vec2D(exports.startingPoint[i].x, exports.startingPoint[i].y), new Vec2D_1.Vec2D(exports.startingPoint[i].x, exports.startingPoint[i].y), new Vec2D_1.Vec2D(exports.startingPoint[i].x, exports.startingPoint[i].y)];\n    exports.player[i].difficulty = exports.cpuDifficulty[i];\n}\nfunction initializePlayers(i, target) {\n    buildPlayerObject(i);\n    if (target) {\n        (0, drawVfx_1.drawVfx)({\n            name: \"entrance\",\n            pos: new Vec2D_1.Vec2D(activeStage_1.activeStage.startingPoint[0].x, activeStage_1.activeStage.startingPoint[0].y)\n        });\n    }\n    else {\n        (0, drawVfx_1.drawVfx)({\n            name: \"entrance\",\n            pos: new Vec2D_1.Vec2D(exports.startingPoint[i][0], exports.startingPoint[i][1])\n        });\n    }\n}\nfunction startGame() {\n    (0, activeStage_1.setVsStage)(exports.stageSelect);\n    (0, stagerender_1.setBackgroundType)(Math.round(Math.random()));\n    changeGamemode(3);\n    (0, vfxQueue_1.resetVfxQueue)();\n    for (var n = 0; n < 4; n++) {\n        if (exports.playerType[n] > -1) {\n            initializePlayers(n, false);\n            (0, render_1.renderPlayer)(n);\n            exports.player[n].inCSS = false;\n        }\n        if (exports.versusMode) {\n            exports.player[n].stocks = 1;\n        }\n    }\n    exports.matchTimer = 480;\n    exports.startTimer = 1.5;\n    exports.starting = true;\n    music_1.MusicManager.stopWhatisPlaying();\n    switch (exports.stageSelect) {\n        case 0:\n            music_1.MusicManager.playBattleFieldLoop();\n            break;\n        case 1:\n            music_1.MusicManager.playyStoryLoop();\n            break;\n        case 2:\n            music_1.MusicManager.playpStadiumLoop();\n            break;\n        case 3:\n            music_1.MusicManager.playDreamLandLoop();\n            break;\n        case 4:\n            music_1.MusicManager.playfinaldLoop();\n            break;\n        case 5:\n            music_1.MusicManager.playfodLoop();\n            break;\n        default:\n            break;\n    }\n    (0, drawVfx_1.drawVfx)({\n        name: \"start\",\n        pos: new Vec2D_1.Vec2D(0, 0)\n    });\n    exports.findingPlayers = false;\n    exports.playing = true;\n}\nfunction endGame(input) {\n    exports.gameEnd = false;\n    (0, render_1.resetLostStockQueue)();\n    (0, hitDetection_1.setPhantonQueue)([]);\n    (0, article_1.resetAArticles)();\n    music_1.MusicManager.stopWhatisPlaying();\n    changeVolume(music_1.MusicManager, audiomenu_1.masterVolume[1], 1);\n    exports.playing = false;\n    clearScreen();\n    (0, stagerender_1.drawStage)();\n    (0, css_2.setTokenPosSnapToChar)(0);\n    (0, css_2.setTokenPosSnapToChar)(1);\n    (0, css_2.setTokenPosSnapToChar)(2);\n    (0, css_2.setTokenPosSnapToChar)(3);\n    if (exports.gameMode == 3) {\n        changeGamemode(2);\n        music_1.MusicManager.playMenuLoop();\n        exports.pause = [[true, true], [true, true], [true, true], [true, true]];\n        exports.frameAdvance = [\n            [true, true],\n            [true, true],\n            [true, true],\n            [true, true]\n        ];\n        exports.findingPlayers = true;\n        positionPlayersInCSS();\n        for (var i = 0; i < 4; i++) {\n            if (exports.playerType[i] > -1) {\n                if (exports.player[i].actionState == \"FURAFURA\") {\n                    sfx_1.sounds.furaloop.stop(exports.player[i].furaLoopID);\n                }\n                //input[i][0].a = true; // do\n                //input[i][1].a = true; // not\n                exports.player[i].inCSS = true;\n                exports.player[i].phys.face = 1;\n                exports.player[i].actionState = \"WAIT\";\n                exports.player[i].timer = 0;\n            }\n        }\n    }\n}\nfunction finishGame(input) {\n    exports.gameEnd = true;\n    exports.playing = false;\n    exports.fg2.save();\n    exports.fg2.textAlign = \"center\";\n    var text = \"Game!\";\n    var size = 300;\n    var textScale = 1;\n    var textGrad = exports.fg2.createLinearGradient(0, 200, 0, 520);\n    if (exports.matchTimer <= 0) {\n        text = \"Time!\";\n        sfx_1.sounds.time.play();\n        textGrad.addColorStop(0, \"black\");\n        textGrad.addColorStop(0.5, \"black\");\n        textGrad.addColorStop(0.7, \"rgb(21, 51, 180)\");\n        textGrad.addColorStop(1, \"rgb(71, 94, 250)\");\n    }\n    else {\n        sfx_1.sounds.game.play();\n        textGrad.addColorStop(0, \"black\");\n        textGrad.addColorStop(0.4, \"black\");\n        textGrad.addColorStop(0.7, \"rgb(167, 27, 40)\");\n        textGrad.addColorStop(1, \"rgb(255, 31, 52)\");\n    }\n    exports.fg2.scale(1, textScale);\n    exports.fg2.fillStyle = textGrad;\n    exports.fg2.lineWidth = 40;\n    exports.fg2.strokeStyle = \"black\";\n    exports.fg2.font = \"900 \" + size + \"px Arial\";\n    exports.fg2.strokeText(text, 600, 470 / textScale);\n    exports.fg2.lineWidth = 20;\n    exports.fg2.strokeStyle = \"white\";\n    exports.fg2.font = \"900 \" + size + \"px Arial\";\n    exports.fg2.strokeText(text, 600, 470 / textScale);\n    exports.fg2.font = \"900 \" + size + \"px Arial\";\n    exports.fg2.fillText(text, 600, 470 / textScale);\n    exports.fg2.restore();\n    music_1.MusicManager.stopWhatisPlaying();\n    setTimeout(function () {\n        endGame(input);\n    }, 2500);\n}\nfunction onFullScreenChange() {\n    var fullscreenElement = document.fullscreenElement || document.mozFullScreenElement || document.webkitFullscreenElement;\n    // if in fullscreen mode fullscreenElement won't be null\n    var cont = document.getElementById(\"topButtonContainer\");\n    var icn = document.querySelectorAll(\".topButton\");\n    if (fullscreenElement != null) {\n        cont.style.transition = \"opacity 0.5s linear 0s\";\n        cont.style.opacity = 0;\n        ;\n        setTimeout(function () {\n            var i;\n            for (i = 0; i < icn.length; i++) {\n                icn[i].style.height = \"5px\";\n            }\n            cont.style.height = \"5px\";\n            resize();\n        }, 500);\n        (0, jquery_1.default)(\"#keyboardPrompt\").hide();\n        (0, jquery_1.default)(\"#keyboardControlsImg\").hide();\n        (0, jquery_1.default)(\"#controllerSupportContainer\").hide();\n        (0, jquery_1.default)(\"#debugButtonEdit\").empty().append(\"OFF\");\n        (0, jquery_1.default)(\"#debug\").hide();\n        (0, jquery_1.default)(\"#players\").hide();\n        (0, jquery_1.default)(\"body\").css(\"overflow\", \"hidden\");\n        showHeader = false;\n    }\n    else {\n        var i;\n        for (i = 0; i < icn.length; i++) {\n            icn[i].style.height = \"25px\";\n        }\n        cont.style.height = \"31px\";\n        cont.style.transition = \"opacity 0.5s linear 0s\";\n        cont.style.opacity = 1;\n    }\n}\nfunction start() {\n    if (exports.holiday === 1) {\n        (0, jquery_1.default)(\"#layerButton\").after('<div id=\"snowButton\" class=\"gameButton\" style=\"width:90px\"><img src=\"assets/christmas/snowflake.png\" height=17 width=17 style=\"display:inline-block\"/><p style=\"width:30px;display:inline-block\"><span id=\"snowButtonEdit\">150</span></p><div id=\"snowMinus\" class=\"snowControl\" style=\"display:inline-block;padding:3px\"><p style=\"padding:0;font-size:20px\">-</p></div><div id=\"snowPlus\" style=\"display:inline-block;padding:3px\"><p style=\"padding:0;font-size:17px\">+</p></div></div>');\n    }\n    for (var i = 0; i < 4; i++) {\n        buildPlayerObject(i);\n        exports.player[i].phys.face = 1;\n        exports.player[i].actionState = \"WAIT\";\n    }\n    cacheDom();\n    (0, keyboardmenu_1.getKeyboardCookie)();\n    giveMedals();\n    (0, audiomenu_1.getAudioCookies)();\n    (0, gameplaymenu_1.getGameplayCookies)();\n    (0, jquery_1.default)(\"#keyboardButton\").click(function () {\n        (0, jquery_1.default)(\"#keyboardControlsImg\").toggle();\n        (0, jquery_1.default)(\"#keyboardPrompt\").hide();\n    });\n    (0, jquery_1.default)(\"#controllerButton\").click(function () {\n        (0, jquery_1.default)(\"#controllerSupportContainer\").toggle();\n    });\n    exports.layers.BG1 = document.getElementById(\"background1Canvas\");\n    exports.bg1 = exports.layers.BG1.getContext(\"2d\");\n    exports.layers.BG2 = document.getElementById(\"background2Canvas\");\n    exports.bg2 = exports.layers.BG2.getContext(\"2d\");\n    exports.layers.FG1 = document.getElementById(\"foreground1Canvas\");\n    exports.fg1 = exports.layers.FG1.getContext(\"2d\");\n    exports.layers.FG2 = document.getElementById(\"foreground2Canvas\");\n    exports.fg2 = exports.layers.FG2.getContext(\"2d\");\n    exports.layers.UI = document.getElementById(\"uiCanvas\");\n    exports.ui = exports.layers.UI.getContext(\"2d\");\n    exports.bg1.fillStyle = \"rgb(0, 0, 0)\";\n    exports.bg1.fillRect(0, 0, exports.layers.BG1.width, exports.layers.BG1.height);\n    let nullInputBuffers = [(0, input_1.nullInputs)(), (0, input_1.nullInputs)(), (0, input_1.nullInputs)(), (0, input_1.nullInputs)()];\n    gameTick(nullInputBuffers);\n    renderTick();\n    (0, jquery_1.default)(\"#effectsButton\").click(function () {\n        if ((0, vfx_1.isShowSFX)()) {\n            (0, jquery_1.default)(\"#effectsButtonEdit\").empty().append(\"OFF\");\n        }\n        else {\n            (0, jquery_1.default)(\"#effectsButtonEdit\").empty().append(\"ON\");\n        }\n        (0, vfx_1.toggleShowSFX)();\n    });\n    (0, jquery_1.default)(\"#fpsButton\").click(function () {\n        if (fps30) {\n            (0, jquery_1.default)(\"#fpsButtonEdit\").empty().append(\"60\");\n        }\n        else {\n            (0, jquery_1.default)(\"#fpsButtonEdit\").empty().append(\"30\");\n        }\n        fps30 ^= true;\n    });\n    (0, jquery_1.default)(\"#alphaButton\").click(function () {\n        if ((0, transparency_1.getTransparency)()) {\n            (0, jquery_1.default)(\"#alphaButtonEdit\").empty().append(\"OFF\");\n        }\n        else {\n            (0, jquery_1.default)(\"#alphaButtonEdit\").empty().append(\"ON\");\n        }\n        (0, transparency_1.toggleTransparency)();\n    });\n    (0, jquery_1.default)(\"#layerButton\").hover(function () {\n        (0, jquery_1.default)(\"#layerDropdown\").toggle();\n    });\n    (0, jquery_1.default)(\".layer\").click(function () {\n        var id = (0, jquery_1.default)(this).attr(\"id\");\n        switch (id) {\n            case \"layer1\":\n                exports.layerSwitches.BG1 ^= true;\n                (0, jquery_1.default)(\"#background1Canvas\").toggle();\n                break;\n            case \"layer2\":\n                exports.layerSwitches.BG2 ^= true;\n                (0, jquery_1.default)(\"#background2Canvas\").toggle();\n                break;\n            case \"layer3\":\n                exports.layerSwitches.FG1 ^= true;\n                (0, jquery_1.default)(\"#foreground1Canvas\").toggle();\n                break;\n            case \"layer4\":\n                exports.layerSwitches.FG2 ^= true;\n                (0, jquery_1.default)(\"#foreground2Canvas\").toggle();\n                break;\n            case \"layer5\":\n                exports.layerSwitches.UI ^= true;\n                (0, jquery_1.default)(\"#uiCanvas\").toggle();\n                break;\n            default:\n                break;\n        }\n        (0, jquery_1.default)(this).toggleClass(\"layerOn\");\n    });\n    (0, jquery_1.default)(\"#debugButton\").click(function () {\n        if (exports.showDebug) {\n            for (let i = 0; i < 4; i++) {\n                document.getElementById(\"gamepadSVG\" + i).style.display = \"none\";\n            }\n            (0, jquery_1.default)(\"#debugButtonEdit\").empty().append(\"OFF\");\n            (0, jquery_1.default)(\"#debug\").hide();\n            (0, jquery_1.default)(\"#players\").hide();\n            (0, jquery_1.default)(\"body\").css(\"overflow\", \"hidden\");\n            //var mY = Math.max(($(window).height()-750)/2,0);\n            //$(\"#display\").css(\"margin\",mY+\"px 0px 0px \"+mX+\"px\");\n        }\n        else {\n            for (let i = 0; i < 4; i++) {\n                if (exports.playerType[i] !== -1) {\n                    (0, drawGamepad_1.updateGamepadSVGColour)(i, \"gamepadSVG\" + i);\n                    document.getElementById(\"gamepadSVG\" + i).style.display = \"\";\n                }\n            }\n            (0, jquery_1.default)(\"#debugButtonEdit\").empty().append(\"ON\");\n            (0, jquery_1.default)(\"#debug\").show();\n            (0, jquery_1.default)(\"#players\").show();\n            (0, jquery_1.default)(\"body\").css(\"overflow\", \"scroll\");\n            //var mY = Math.max(($(window).height()-900)/2,0);\n            //$(\"#display\").css(\"margin\",mY+\" 0px 0px px \"+mX+\"px\");\n        }\n        exports.showDebug ^= true;\n        resize();\n    });\n    (0, jquery_1.default)(\"#hideButton\").click(function () {\n        (0, jquery_1.default)(\"#header\").toggle();\n        showHeader ^= true;\n        resize();\n    });\n    (0, jquery_1.default)(\"#fullscreenButton\").click(function () {\n        if ((document.fullScreenElement && document.fullScreenElement !== null) || (!document.mozFullScreen && !document.webkitIsFullScreen)) {\n            if (document.documentElement.requestFullScreen) {\n                document.documentElement.requestFullScreen();\n            }\n            else if (document.documentElement.mozRequestFullScreen) {\n                document.documentElement.mozRequestFullScreen();\n            }\n            else if (document.documentElement.webkitRequestFullScreen) {\n                document.documentElement.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT);\n            }\n        }\n        else {\n            if (document.cancelFullScreen) {\n                document.cancelFullScreen();\n            }\n            else if (document.mozCancelFullScreen) {\n                document.mozCancelFullScreen();\n            }\n            else if (document.webkitCancelFullScreen) {\n                document.webkitCancelFullScreen();\n            }\n        }\n        // resize();\n    });\n    document.addEventListener(\"fullscreenchange\", onFullScreenChange, false);\n    document.addEventListener(\"webkitfullscreenchange\", onFullScreenChange, false);\n    document.addEventListener(\"mozfullscreenchange\", onFullScreenChange, false);\n    (0, jquery_1.default)(\".topButton\").hover(function () {\n        (0, jquery_1.default)(this).children(\".buttonDetails\").toggle();\n    });\n    if (mobile === false) {\n        (0, jquery_1.default)(\".button\").hover(function () {\n            (0, jquery_1.default)(this).toggleClass(\"buttonhighlighted\");\n        });\n        (0, jquery_1.default)(\".socialmedia\").hover(function () {\n            (0, jquery_1.default)(this).toggleClass(\"socialmediahighlight\");\n        });\n        (0, jquery_1.default)(\".sugbtn\").hover(function () {\n            (0, jquery_1.default)(this).toggleClass(\"sugbtnhighlight\");\n        });\n    }\n    (0, jquery_1.default)(\"#appsButton\").hover(function () {\n        (0, jquery_1.default)(\"#appsDropdown\").show();\n    }, function () {\n        (0, jquery_1.default)(\"#appsDropdown\").hide();\n    });\n    if (exports.holiday === 1) {\n        (0, jquery_1.default)(\"#snowMinus\").click(function () {\n            exports.snowCount -= 20;\n            if (exports.snowCount < 0) {\n                exports.snowCount = 0;\n            }\n            (0, jquery_1.default)(\"#snowButtonEdit\").text(exports.snowCount);\n        });\n        (0, jquery_1.default)(\"#snowPlus\").click(function () {\n            exports.snowCount += 20;\n            if (exports.snowCount > 1200) {\n                exports.snowCount = 1200;\n            }\n            (0, jquery_1.default)(\"#snowButtonEdit\").text(exports.snowCount);\n        });\n    }\n    (0, jquery_1.default)(\"#replay\").change(function () {\n        // grab the first image in the FileList object and pass it to the function\n        (0, replay_1.loadReplay)(this.files[0]);\n    });\n    resize();\n}\nwindow.start = start;\nfunction customDeadzone() {\n    this.ls = new Vec2D_1.Vec2D(0, 0);\n    this.cs = new Vec2D_1.Vec2D(0, 0);\n    this.l = 0;\n    this.r = 0;\n}\nfunction addShine(val) {\n    exports.shine += val;\n}\nfunction setShine(val) {\n    exports.shine = val;\n}\nfunction setFindingPlayers(val) {\n    exports.findingPlayers = val;\n}\nfunction setPlaying(val) {\n    exports.playing = val;\n}\nfunction setCalibrationPlayer(val) {\n    exports.calibrationPlayer = val;\n}\nconst dom = {};\nfunction cacheDom() {\n    const elementIds = [\n        \"matchMinutes\",\n        \"matchSeconds\",\n        \"gamelogicAvg\",\n        \"gamelogicHigh\",\n        \"gamelogicLow\",\n        \"gamelogicPeak\",\n        \"renderAvg\",\n        \"renderHigh\",\n        \"renderLow\",\n        \"renderPeak\",\n    ];\n    elementIds.forEach((id) => {\n        dom[id] = document.getElementById(id);\n    });\n}\n;\nfunction setCS(index, val) {\n    exports.characterSelections[index] = val;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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U0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWSxpQkFBaUI7QUFDN0I7QUFDQSxnQkFBZ0IsaUJBQWlCO0FBQ2pDO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxZQUFZLGlCQUFpQjtBQUM3QjtBQUNBLGdCQUFnQixpQkFBaUI7QUFDakM7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUksYUFBYTtBQUNqQjtBQUNBO0FBQ0EsSUFBSSxhQUFhO0FBQ2pCO0FBQ0E7QUFDQSxJQUFJLHNCQUFzQjtBQUMxQjtBQUNBO0FBQ0EsSUFBSSxlQUFlO0FBQ25CO0FBQ0E7QUFDQSxJQUFJLHlCQUF5QjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9tZWxlZWxpZ2h0Ly4vc3JjL21haW4vbWFpbi50cz8xM2UzIl0sInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xudmFyIF9faW1wb3J0RGVmYXVsdCA9ICh0aGlzICYmIHRoaXMuX19pbXBvcnREZWZhdWx0KSB8fCBmdW5jdGlvbiAobW9kKSB7XG4gICAgcmV0dXJuIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpID8gbW9kIDogeyBcImRlZmF1bHRcIjogbW9kIH07XG59O1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuZXhwb3J0cy5zdGFydGluZyA9IGV4cG9ydHMuYmxhc3R6b25lID0gZXhwb3J0cy5zdGFnZVNlbGVjdCA9IGV4cG9ydHMucmVzcGF3blBvaW50cyA9IGV4cG9ydHMuZWRnZU9yaWVudGF0aW9uID0gZXhwb3J0cy5lZGdlT2Zmc2V0ID0gZXhwb3J0cy5lZGdlcyA9IGV4cG9ydHMud2FsbHNSID0gZXhwb3J0cy53YWxsc0wgPSBleHBvcnRzLnBsYXRmb3JtcyA9IGV4cG9ydHMuZ3JvdW5kID0gZXhwb3J0cy5zdGFydGluZ0ZhY2UgPSBleHBvcnRzLnN0YXJ0aW5nUG9pbnQgPSBleHBvcnRzLmZyYW1lQWR2YW5jZSA9IGV4cG9ydHMucGF1c2UgPSBleHBvcnRzLmNvbG91cnMgPSBleHBvcnRzLmNvc3R1bWVUaW1lb3V0ID0gZXhwb3J0cy5wUGFsID0gZXhwb3J0cy50YWdUZXh0ID0gZXhwb3J0cy5oYXNUYWcgPSBleHBvcnRzLnBhbGV0dGVzID0gZXhwb3J0cy5yYW5kb21UYWdzID0gZXhwb3J0cy52ZXJzdXNNb2RlID0gZXhwb3J0cy5nYW1lTW9kZSA9IGV4cG9ydHMuc2hvd0RlYnVnID0gZXhwb3J0cy5maW5kaW5nUGxheWVycyA9IGV4cG9ydHMuZnJhbWVCeUZyYW1lUmVuZGVyID0gZXhwb3J0cy53YXNGcmFtZUJ5RnJhbWUgPSBleHBvcnRzLmZyYW1lQnlGcmFtZSA9IGV4cG9ydHMucGxheWluZyA9IGV4cG9ydHMuYWN0aXZlUG9ydHMgPSBleHBvcnRzLnBvcnRzID0gZXhwb3J0cy5jcHVEaWZmaWN1bHR5ID0gZXhwb3J0cy5wbGF5ZXJUeXBlID0gZXhwb3J0cy5wbGF5ZXJBbW91bnQgPSBleHBvcnRzLmN1cnJlbnRQbGF5ZXJzID0gZXhwb3J0cy5tVHlwZSA9IGV4cG9ydHMuZmlyc3RUaW1lRGV0ZWN0ZWQgPSBleHBvcnRzLnVzaW5nQ3VzdG9tQ29udHJvbHMgPSBleHBvcnRzLmNvbnRyb2xsZXJSZXNldENvdW50ZG93bnMgPSBleHBvcnRzLmdhbWVFbmQgPSBleHBvcnRzLmNhbGlicmF0aW9uUGxheWVyID0gZXhwb3J0cy5zaGluZSA9IGV4cG9ydHMuY2hhcmFjdGVyU2VsZWN0aW9ucyA9IGV4cG9ydHMuZnJhbWVyYXRlID0gZXhwb3J0cy5nYW1lbG9naWNUaW1lID0gZXhwb3J0cy5yZW5kZXJUaW1lID0gZXhwb3J0cy5wbGF5ZXIgPSBleHBvcnRzLnNub3dDb3VudCA9IGV4cG9ydHMuaG9saWRheSA9IHZvaWQgMDtcbmV4cG9ydHMubGF5ZXJTd2l0Y2hlcyA9IGV4cG9ydHMubGF5ZXJzID0gZXhwb3J0cy5jYW52YXNNYWluID0gZXhwb3J0cy5jID0gZXhwb3J0cy51aSA9IGV4cG9ydHMuZmcyID0gZXhwb3J0cy5mZzEgPSBleHBvcnRzLmJnMiA9IGV4cG9ydHMuYmcxID0gZXhwb3J0cy5rZXlCaW5kaW5nID0gZXhwb3J0cy5rZXlCaW5kID0gZXhwb3J0cy5rZXlzID0gZXhwb3J0cy51c2luZ0xvY2FsU3RvcmFnZSA9IGV4cG9ydHMubWF0Y2hUaW1lciA9IGV4cG9ydHMuc3RhcnRUaW1lciA9IHZvaWQgMDtcbmV4cG9ydHMuc2V0Q29udHJvbGxlclJlc2V0ID0gc2V0Q29udHJvbGxlclJlc2V0O1xuZXhwb3J0cy5zZXRVc2luZ0N1c3RvbUNvbnRyb2xzID0gc2V0VXNpbmdDdXN0b21Db250cm9scztcbmV4cG9ydHMuc2V0TXR5cGUgPSBzZXRNdHlwZTtcbmV4cG9ydHMuc2V0Q3VycmVudFBsYXllciA9IHNldEN1cnJlbnRQbGF5ZXI7XG5leHBvcnRzLnNldFRhZ1RleHQgPSBzZXRUYWdUZXh0O1xuZXhwb3J0cy5zZXRTdGFnZVNlbGVjdCA9IHNldFN0YWdlU2VsZWN0O1xuZXhwb3J0cy5zZXRTdGFydGluZyA9IHNldFN0YXJ0aW5nO1xuZXhwb3J0cy5zZXRTdGFydFRpbWVyID0gc2V0U3RhcnRUaW1lcjtcbmV4cG9ydHMuZ2V0U3RhcnRUaW1lciA9IGdldFN0YXJ0VGltZXI7XG5leHBvcnRzLmFkZE1hdGNoVGltZXIgPSBhZGRNYXRjaFRpbWVyO1xuZXhwb3J0cy5zZXRNYXRjaFRpbWVyID0gc2V0TWF0Y2hUaW1lcjtcbmV4cG9ydHMuZ2V0TWF0Y2hUaW1lciA9IGdldE1hdGNoVGltZXI7XG5leHBvcnRzLnNldENvb2tpZSA9IHNldENvb2tpZTtcbmV4cG9ydHMuc2V0VmVyc3VzTW9kZSA9IHNldFZlcnN1c01vZGU7XG5leHBvcnRzLmdldENvb2tpZSA9IGdldENvb2tpZTtcbmV4cG9ydHMuc2V0S2V5QmluZGluZyA9IHNldEtleUJpbmRpbmc7XG5leHBvcnRzLm92ZXJyaWRlS2V5Ym9hcmRFdmVudCA9IG92ZXJyaWRlS2V5Ym9hcmRFdmVudDtcbmV4cG9ydHMuZGlzYWJsZWRFdmVudFByb3BhZ2F0aW9uID0gZGlzYWJsZWRFdmVudFByb3BhZ2F0aW9uO1xuZXhwb3J0cy5TVkcgPSBTVkc7XG5leHBvcnRzLm1hdGNoVGltZXJUaWNrID0gbWF0Y2hUaW1lclRpY2s7XG5leHBvcnRzLnNjcmVlblNoYWtlID0gc2NyZWVuU2hha2U7XG5leHBvcnRzLnBlcmNlbnRTaGFrZSA9IHBlcmNlbnRTaGFrZTtcbmV4cG9ydHMuZmluZFBsYXllcnMgPSBmaW5kUGxheWVycztcbmV4cG9ydHMuc2V0UGxheWVyVHlwZSA9IHNldFBsYXllclR5cGU7XG5leHBvcnRzLmFkZFBsYXllciA9IGFkZFBsYXllcjtcbmV4cG9ydHMudG9nZ2xlUG9ydCA9IHRvZ2dsZVBvcnQ7XG5leHBvcnRzLnBvc2l0aW9uUGxheWVyc0luQ1NTID0gcG9zaXRpb25QbGF5ZXJzSW5DU1M7XG5leHBvcnRzLmNoYW5nZUdhbWVtb2RlID0gY2hhbmdlR2FtZW1vZGU7XG5leHBvcnRzLmludGVycHJldElucHV0cyA9IGludGVycHJldElucHV0cztcbmV4cG9ydHMucmVuZGVyVG9NYWluID0gcmVuZGVyVG9NYWluO1xuZXhwb3J0cy51cGRhdGUgPSB1cGRhdGU7XG5leHBvcnRzLmdhbWVUaWNrID0gZ2FtZVRpY2s7XG5leHBvcnRzLmNsZWFyU2NyZWVuID0gY2xlYXJTY3JlZW47XG5leHBvcnRzLnJlbmRlclRpY2sgPSByZW5kZXJUaWNrO1xuZXhwb3J0cy5idWlsZFBsYXllck9iamVjdCA9IGJ1aWxkUGxheWVyT2JqZWN0O1xuZXhwb3J0cy5pbml0aWFsaXplUGxheWVycyA9IGluaXRpYWxpemVQbGF5ZXJzO1xuZXhwb3J0cy5zdGFydEdhbWUgPSBzdGFydEdhbWU7XG5leHBvcnRzLmVuZEdhbWUgPSBlbmRHYW1lO1xuZXhwb3J0cy5maW5pc2hHYW1lID0gZmluaXNoR2FtZTtcbmV4cG9ydHMuc3RhcnQgPSBzdGFydDtcbmV4cG9ydHMuY3VzdG9tRGVhZHpvbmUgPSBjdXN0b21EZWFkem9uZTtcbmV4cG9ydHMuYWRkU2hpbmUgPSBhZGRTaGluZTtcbmV4cG9ydHMuc2V0U2hpbmUgPSBzZXRTaGluZTtcbmV4cG9ydHMuc2V0RmluZGluZ1BsYXllcnMgPSBzZXRGaW5kaW5nUGxheWVycztcbmV4cG9ydHMuc2V0UGxheWluZyA9IHNldFBsYXlpbmc7XG5leHBvcnRzLnNldENhbGlicmF0aW9uUGxheWVyID0gc2V0Q2FsaWJyYXRpb25QbGF5ZXI7XG5leHBvcnRzLmNhY2hlRG9tID0gY2FjaGVEb207XG5leHBvcnRzLnNldENTID0gc2V0Q1M7XG4vKiBlc2xpbnQtZGlzYWJsZSAqL1xuY29uc3QgY3NzXzEgPSByZXF1aXJlKFwiLi4vbWVudXMvY3NzXCIpO1xuY29uc3QgcGxheWVyXzEgPSByZXF1aXJlKFwiLi4vbWFpbi9wbGF5ZXJcIik7XG5jb25zdCBzZXR0aW5nc18xID0gcmVxdWlyZShcIi4uL3NldHRpbmdzXCIpO1xuY29uc3Qgc3RhcnR1cF8xID0gcmVxdWlyZShcIi4uL21lbnVzL3N0YXJ0dXBcIik7XG5jb25zdCBtZW51XzEgPSByZXF1aXJlKFwiLi4vbWVudXMvbWVudVwiKTtcbmNvbnN0IHNmeF8xID0gcmVxdWlyZShcIi4uL21haW4vc2Z4XCIpO1xuY29uc3Qgc3RhcnRzY3JlZW5fMSA9IHJlcXVpcmUoXCIuLi9tZW51cy9zdGFydHNjcmVlblwiKTtcbmNvbnN0IHN0YWdlcmVuZGVyXzEgPSByZXF1aXJlKFwiLi4vc3RhZ2VzL3N0YWdlcmVuZGVyXCIpO1xuY29uc3Qgc3RhZ2VzZWxlY3RfMSA9IHJlcXVpcmUoXCIuLi9tZW51cy9zdGFnZXNlbGVjdFwiKTtcbmNvbnN0IGF1ZGlvbWVudV8xID0gcmVxdWlyZShcIi4uL21lbnVzL2F1ZGlvbWVudVwiKTtcbmNvbnN0IGdhbWVwbGF5bWVudV8xID0gcmVxdWlyZShcIi4uL21lbnVzL2dhbWVwbGF5bWVudVwiKTtcbmNvbnN0IGtleWJvYXJkbWVudV8xID0gcmVxdWlyZShcIi4uL21lbnVzL2tleWJvYXJkbWVudVwiKTtcbmNvbnN0IGNvbnRyb2xsZXJtZW51XzEgPSByZXF1aXJlKFwiLi4vbWVudXMvY29udHJvbGxlcm1lbnVcIik7XG5jb25zdCByZW5kZXJfMSA9IHJlcXVpcmUoXCIuLi9tYWluL3JlbmRlclwiKTtcbmNvbnN0IGFjdGlvblN0YXRlU2hvcnRjdXRzXzEgPSByZXF1aXJlKFwiLi4vcGh5c2ljcy9hY3Rpb25TdGF0ZVNob3J0Y3V0c1wiKTtcbmNvbnN0IGhpdERldGVjdGlvbl8xID0gcmVxdWlyZShcIi4uL3BoeXNpY3MvaGl0RGV0ZWN0aW9uXCIpO1xuY29uc3QgYXJ0aWNsZV8xID0gcmVxdWlyZShcIi4uL3BoeXNpY3MvYXJ0aWNsZVwiKTtcbmNvbnN0IGFpXzEgPSByZXF1aXJlKFwiLi4vbWFpbi9haVwiKTtcbmNvbnN0IHBoeXNpY3NfMSA9IHJlcXVpcmUoXCIuLi9waHlzaWNzL3BoeXNpY3NcIik7XG5jb25zdCBqcXVlcnlfMSA9IF9faW1wb3J0RGVmYXVsdChyZXF1aXJlKFwianF1ZXJ5XCIpKTtcbmNvbnN0IHRyYW5zcGFyZW5jeV8xID0gcmVxdWlyZShcIi4uL21haW4vdmZ4L3RyYW5zcGFyZW5jeVwiKTtcbmNvbnN0IGRyYXdWZnhfMSA9IHJlcXVpcmUoXCIuLi9tYWluL3ZmeC9kcmF3VmZ4XCIpO1xuY29uc3QgdmZ4UXVldWVfMSA9IHJlcXVpcmUoXCIuLi9tYWluL3ZmeC92ZnhRdWV1ZVwiKTtcbmNvbnN0IGFjdGl2ZVN0YWdlXzEgPSByZXF1aXJlKFwiLi4vc3RhZ2VzL2FjdGl2ZVN0YWdlXCIpO1xuY29uc3QgbXVzaWNfMSA9IHJlcXVpcmUoXCIuL211c2ljXCIpO1xuY29uc3QgdmZ4XzEgPSByZXF1aXJlKFwiLi4vbWFpbi92ZnhcIik7XG5jb25zdCByZW5kZXJWZnhfMSA9IHJlcXVpcmUoXCIuL3ZmeC9yZW5kZXJWZnhcIik7XG5jb25zdCBCb3gyRF8xID0gcmVxdWlyZShcIi4vdXRpbC9Cb3gyRFwiKTtcbmNvbnN0IFZlYzJEXzEgPSByZXF1aXJlKFwiLi91dGlsL1ZlYzJEXCIpO1xuY29uc3Qgc3RyZWFtY2xpZW50XzEgPSByZXF1aXJlKFwiLi9tdWx0aXBsYXllci9zdHJlYW1jbGllbnRcIik7XG5jb25zdCByZXBsYXlfMSA9IHJlcXVpcmUoXCIuL3JlcGxheVwiKTtcbmNvbnN0IGlucHV0XzEgPSByZXF1aXJlKFwiLi4vaW5wdXQvaW5wdXRcIik7XG5jb25zdCBtZWxlZUlucHV0c18xID0gcmVxdWlyZShcIi4uL2lucHV0L21lbGVlSW5wdXRzXCIpO1xuY29uc3QgZmluZEdhbWVwYWRJbmZvXzEgPSByZXF1aXJlKFwiLi4vaW5wdXQvZ2FtZXBhZC9maW5kR2FtZXBhZEluZm9cIik7XG5jb25zdCBjdXN0b21fMSA9IHJlcXVpcmUoXCIuLi9pbnB1dC9nYW1lcGFkL2dhbWVwYWRzL2N1c3RvbVwiKTtcbmNvbnN0IHJldHJpZXZlR2FtZXBhZElucHV0c18xID0gcmVxdWlyZShcIi4uL2lucHV0L2dhbWVwYWQvcmV0cmlldmVHYW1lcGFkSW5wdXRzXCIpO1xuY29uc3QgZHJhd0dhbWVwYWRfMSA9IHJlcXVpcmUoXCIuLi9pbnB1dC9nYW1lcGFkL2RyYXdHYW1lcGFkXCIpO1xuY29uc3QgZGVlcENvcHlPYmplY3RfMSA9IHJlcXVpcmUoXCIuL3V0aWwvZGVlcENvcHlPYmplY3RcIik7XG5jb25zdCBjc3NfMiA9IHJlcXVpcmUoXCIuLi9tZW51cy9jc3NcIik7XG4vKmdsb2JhbHMgcGVyZm9ybWFuY2UqL1xuZXhwb3J0cy5ob2xpZGF5ID0gMDtcbmV4cG9ydHMuc25vd0NvdW50ID0gMTUwO1xuLy90b2RvIGZpbmQgJ1BsYXllcicgb2JqZWN0XG5leHBvcnRzLnBsYXllciA9IFswLCAwLCAwLCAwXTtcbmV4cG9ydHMucmVuZGVyVGltZSA9IFsxMCwgMCwgMTAwLCAwXTtcbmV4cG9ydHMuZ2FtZWxvZ2ljVGltZSA9IFs1LCAwLCAxMDAsIDBdO1xuZXhwb3J0cy5mcmFtZXJhdGUgPSBbMCwgMCwgMF07XG5leHBvcnRzLmNoYXJhY3RlclNlbGVjdGlvbnMgPSBbMCwgMCwgMCwgMF07XG5leHBvcnRzLnNoaW5lID0gMC41O1xuZXhwb3J0cy5jYWxpYnJhdGlvblBsYXllciA9IDA7XG5leHBvcnRzLmdhbWVFbmQgPSBmYWxzZTtcbmV4cG9ydHMuY29udHJvbGxlclJlc2V0Q291bnRkb3ducyA9IFswLCAwLCAwLCAwXTtcbmZ1bmN0aW9uIHNldENvbnRyb2xsZXJSZXNldChpKSB7XG4gICAgZXhwb3J0cy5jb250cm9sbGVyUmVzZXRDb3VudGRvd25zW2ldID0gMDtcbn1cbmxldCBrZXlib2FyZE9jY3VwaWVkID0gZmFsc2U7XG5leHBvcnRzLnVzaW5nQ3VzdG9tQ29udHJvbHMgPSBbZmFsc2UsIGZhbHNlLCBmYWxzZSwgZmFsc2VdO1xuZnVuY3Rpb24gc2V0VXNpbmdDdXN0b21Db250cm9scyhpLCBib29sZWFuLCBpbmZvKSB7XG4gICAgZXhwb3J0cy51c2luZ0N1c3RvbUNvbnRyb2xzW2ldID0gYm9vbGVhbjtcbiAgICBpZiAoYm9vbCkge1xuICAgICAgICBleHBvcnRzLm1UeXBlW2ldID0gY3VzdG9tXzEuY3VzdG9tR2FtZXBhZEluZm9bZXhwb3J0cy5jdXJyZW50UGxheWVyc1tpXV07XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBleHBvcnRzLm1UeXBlW2ldID0gaW5mbztcbiAgICB9XG59XG5leHBvcnRzLmZpcnN0VGltZURldGVjdGVkID0gW3RydWUsIHRydWUsIHRydWUsIHRydWVdO1xud2luZG93Lm1UeXBlID0gW251bGwsIG51bGwsIG51bGwsIG51bGxdO1xuZXhwb3J0cy5tVHlwZSA9IFtudWxsLCBudWxsLCBudWxsLCBudWxsXTtcbmZ1bmN0aW9uIHNldE10eXBlKGluZGV4LCB2YWwpIHtcbiAgICBleHBvcnRzLm1UeXBlW2luZGV4XSA9IHZhbDtcbn1cbmV4cG9ydHMuY3VycmVudFBsYXllcnMgPSBbXTtcbmZ1bmN0aW9uIHNldEN1cnJlbnRQbGF5ZXIoaW5kZXgsIHZhbCkge1xuICAgIGV4cG9ydHMuY3VycmVudFBsYXllcnNbaW5kZXhdID0gdmFsO1xufVxuZXhwb3J0cy5wbGF5ZXJBbW91bnQgPSAwO1xuZXhwb3J0cy5wbGF5ZXJUeXBlID0gWy0xLCAtMSwgLTEsIC0xXTtcbmV4cG9ydHMuY3B1RGlmZmljdWx0eSA9IFszLCAzLCAzLCAzXTtcbmV4cG9ydHMucG9ydHMgPSAwO1xuZXhwb3J0cy5hY3RpdmVQb3J0cyA9IFtdO1xuZXhwb3J0cy5wbGF5aW5nID0gZmFsc2U7XG5leHBvcnRzLmZyYW1lQnlGcmFtZSA9IGZhbHNlO1xuZXhwb3J0cy53YXNGcmFtZUJ5RnJhbWUgPSBmYWxzZTtcbmV4cG9ydHMuZnJhbWVCeUZyYW1lUmVuZGVyID0gZmFsc2U7XG5leHBvcnRzLmZpbmRpbmdQbGF5ZXJzID0gdHJ1ZTtcbmV4cG9ydHMuc2hvd0RlYnVnID0gZmFsc2U7XG5leHBvcnRzLmdhbWVNb2RlID0gMjA7XG4vLyAyMDpTdGFydHVwXG4vLyAxMzpEYXRhIE1lbnVcbi8vIDEyOktleWJvYXJkIENvbnRyb2xzXG4vLyAxMTpHYW1lcGxheSBNZW51XG4vLyAxMDpTb3VuZCBNZW51XG4vLyA5OiAtXG4vLyA4OiAtXG4vLyA3OlRhcmdldCBTZWxlY3Rcbi8vIDY6U3RhZ2UgU2VsZWN0IChWUylcbi8vIDU6VGFyZ2V0IFBsYXlpbmdcbi8vIDQ6VGFyZ2V0IEJ1aWxkZXJcbi8vIDM6UGxheWluZyAoVlMpXG4vLyAyOkNTU1xuLy8gMTpNYWluIE1lbnVcbi8vIDA6VGl0bGUgU2NyZWVuXG5leHBvcnRzLnZlcnN1c01vZGUgPSAwO1xuZXhwb3J0cy5yYW5kb21UYWdzID0gW1wiTkVPIVwiLCBcIlNFTEZcIiwgXCJOT1ZBXCIsIFwiUE5EQVwiLCBcIlBhbmRhXCIsIFwiTEZGTlwiLCBcIlNjb3JwXCIsIFwiQVpcIiwgXCJBWEVcIiwgXCJUZW1wb1wiLCBcIlRNUE9cIiwgXCJbQV1ybWFkYVwiLCBcIldCQUxMWlwiLCBcIldlc3RiYWxselwiLCBcIlBQTURcIiwgXCJLcmV5Z2FzbVwiLCBcIk0yS1wiLCBcIk1hbmcwXCIsIFwiVVNBXCIsIFwiU0NBUlwiLCBcIlRPUEhcIiwgXCIoLlkuKVwiLCBcIkhCT1hcIiwgXCJIdW5ncnlCb3hcIiwgXCJQTFVQXCIsIFwiU2hyb29tZWRcIiwgXCJTRkFUXCIsIFwiV2l6elwiLCBcIkx1Y2t5XCIsIFwiUzJKXCIsIFwiU2lsZW50V29sZlwiLCBcImFNU2FcIiwgXCJTMkpcIiwgXCJIYXgkXCJdO1xuZXhwb3J0cy5wYWxldHRlcyA9IFtbXCJyZ2IoMjUwLCA4OSwgODkpXCIsIFwicmdiKDI1NSwgMTcwLCAxNzApXCIsIFwicmdiYSgyNTUsIDIwNiwgMTExLCBcIiwgXCJyZ2IoMjQ0LCA2OCwgNjgpXCIsIFwicmdiYSgyNTUsIDIyNSwgMTY3LCBcIl0sXG4gICAgW1wicmdiKDk1LCAyMTYsIDg0KVwiLCBcInJnYigxODQsIDI1MywgMTU0KVwiLCBcInJnYmEoMjUyLCA5NSwgOTUsIFwiLCBcInJnYigyNTUsIDE4MiwgOTYpXCIsIFwicmdiYSgyNTQsIDE0MSwgMTQxLCBcIl0sXG4gICAgW1wicmdiKDUsIDE5NSwgMjU1KVwiLCBcInJnYigxMjEsIDIyMywgMjU1KVwiLCBcInJnYmEoMjE4LCA5NiwgMjU0LCBcIiwgXCJyZ2IoMjMxLCAxMzQsIDI1NSlcIiwgXCJyZ2JhKDIzMCwgMTQ0LCAyNTUsIFwiXSxcbiAgICBbXCJyZ2IoMjU1LCAxODcsIDcwKVwiLCBcInJnYigyNDgsIDI1NSwgMTIyKVwiLCBcInJnYmEoODAsIDE4MiwgMjU1LCBcIiwgXCJyZ2IoMjU1LCAxNDIsIDcwKVwiLCBcInJnYmEoMTM5LCAyMDMsIDI0OSwgXCJdLFxuICAgIFtcInJnYigxNzcsIDg5LCAyNTUpXCIsIFwicmdiKDIwMywgMTQ0LCAyNTUpXCIsIFwicmdiYSgxNDQsIDI1NSwgMTEwLCBcIiwgXCJyZ2IoMjQ3LCAxMjYsIDI1MClcIiwgXCJyZ2JhKDE5MCwgMjU1LCAxNzAsIFwiXSxcbiAgICBbXCJyZ2IoMTgyLCAxMzEsIDcwKVwiLCBcInJnYigyNTIsIDE5NCwgMTI2KVwiLCBcInJnYmEoNDcsIDE4NiwgMTIzLCBcIiwgXCJyZ2IoMjU1LCAxMTIsIDY2KVwiLCBcInJnYmEoMTExLCAyMTQsIDE2OCwgXCJdLFxuICAgIFtcInJnYigyMzIsIDIzMiwgMjA4KVwiLCBcInJnYigyNTUsIDI1NSwgMjU1KVwiLCBcInJnYmEoMjQ0LCAyNTUsIDExMiwgXCIsIFwicmdiKDE5MSwgMTE5LCAxMTkpXCIsIFwicmdiYSgyNTUsIDI1NSwgMjAwLCBcIl1dO1xuZXhwb3J0cy5oYXNUYWcgPSBbZmFsc2UsIGZhbHNlLCBmYWxzZSwgZmFsc2VdO1xuZXhwb3J0cy50YWdUZXh0ID0gW1wiXCIsIFwiXCIsIFwiXCIsIFwiXCJdO1xuZnVuY3Rpb24gc2V0VGFnVGV4dChpbmRleCwgdmFsdWUpIHtcbiAgICBleHBvcnRzLnRhZ1RleHRbaW5kZXhdID0gdmFsdWU7XG4gICAgZXhwb3J0cy5oYXNUYWdbaW5kZXhdID0gdHJ1ZTtcbn1cbmV4cG9ydHMucFBhbCA9IFswLCAxLCAyLCAzXTtcbmV4cG9ydHMuY29zdHVtZVRpbWVvdXQgPSBbXTtcbmV4cG9ydHMuY29sb3VycyA9IFtcInJnYmEoNCwgMjU1LCA4MiwgMC42MilcIiwgXCJyZ2JhKDExNywgMjAsIDI1NSwgMC42MylcIiwgXCJyZ2JhKDI1NSwgMjAsIDIwLCAwLjYzKVwiLCBcInJnYmEoMjU1LCAyMzIsIDIwLCAwLjYzKVwiXTtcbmV4cG9ydHMucGF1c2UgPSBbW3RydWUsIHRydWVdLCBbdHJ1ZSwgdHJ1ZV0sIFt0cnVlLCB0cnVlXSwgW3RydWUsIHRydWVdXTtcbmV4cG9ydHMuZnJhbWVBZHZhbmNlID0gW1t0cnVlLCB0cnVlXSwgW3RydWUsIHRydWVdLCBbdHJ1ZSwgdHJ1ZV0sIFt0cnVlLCB0cnVlXV07XG5leHBvcnRzLnN0YXJ0aW5nUG9pbnQgPSBbWy01MCwgNTBdLCBbNTAsIDUwXSwgWy0yNSwgNV0sIFsyNSwgNV1dO1xuZXhwb3J0cy5zdGFydGluZ0ZhY2UgPSBbMSwgLTEsIDEsIC0xXTtcbmV4cG9ydHMuZ3JvdW5kID0gW1stNjguNCwgMF0sIFs2OC40LCAwXV07XG5leHBvcnRzLnBsYXRmb3JtcyA9IFtbWy01Ny42LCAyNy4yXSwgWy0yMCwgMjcuMl1dLCBbWzIwLCAyNy4yXSwgWzU3LjYsIDI3LjJdXSwgW1stMTguOCwgNTQuNF0sIFsxOC44LCA1NC40XV1dO1xuZXhwb3J0cy53YWxsc0wgPSBbW1stNjguNCwgMF0sIFstNjguNCwgLTEwOC44XV1dO1xuZXhwb3J0cy53YWxsc1IgPSBbW1s2OC40LCAwXSwgWzY4LjQsIC0xMDguOF1dXTtcbmV4cG9ydHMuZWRnZXMgPSBbW1stNjguNCwgMF0sIFstNjMuNCwgMF1dLCBbWzY4LjQsIDBdLCBbNjMuNCwgMF1dXTtcbi8vZWRnZU9mZnNldCA9IFtbLTcxLjMsLTIzLjddLFs3MS4zLC0yMy43XV07XG5leHBvcnRzLmVkZ2VPZmZzZXQgPSBbWy0yLjksIC0yMy43XSwgWzIuOSwgLTIzLjddXTtcbmV4cG9ydHMuZWRnZU9yaWVudGF0aW9uID0gWzEsIC0xXTtcbmV4cG9ydHMucmVzcGF3blBvaW50cyA9IFtbLTUwLCA1MCwgMV0sIFs1MCwgNTAsIC0xXSwgWzI1LCAzNSwgMV0sIFstMjUsIDM1LCAtMV1dO1xuZXhwb3J0cy5zdGFnZVNlbGVjdCA9IDA7XG5mdW5jdGlvbiBzZXRTdGFnZVNlbGVjdCh2YWwpIHtcbiAgICBleHBvcnRzLnN0YWdlU2VsZWN0ID0gdmFsO1xufVxuZXhwb3J0cy5ibGFzdHpvbmUgPSBuZXcgQm94MkRfMS5Cb3gyRChbLTIyNCwgMjAwXSwgWzIyNCwgLTEwOC44XSk7XG5leHBvcnRzLnN0YXJ0aW5nID0gdHJ1ZTtcbmZ1bmN0aW9uIHNldFN0YXJ0aW5nKHZhbCkge1xuICAgIGV4cG9ydHMuc3RhcnRpbmcgPSB2YWw7XG59XG5leHBvcnRzLnN0YXJ0VGltZXIgPSAxLjU7XG5mdW5jdGlvbiBzZXRTdGFydFRpbWVyKHZhbCkge1xuICAgIGV4cG9ydHMuc3RhcnRUaW1lciA9IHZhbDtcbn1cbmZ1bmN0aW9uIGdldFN0YXJ0VGltZXIoKSB7XG4gICAgcmV0dXJuIGV4cG9ydHMuc3RhcnRUaW1lcjtcbn1cbi8vbWF0Y2hUaW1lciA9IDU5OTkuOTk7XG5leHBvcnRzLm1hdGNoVGltZXIgPSA0ODA7XG5mdW5jdGlvbiBhZGRNYXRjaFRpbWVyKHZhbCkge1xuICAgIGV4cG9ydHMubWF0Y2hUaW1lciArPSB2YWw7XG59XG5mdW5jdGlvbiBzZXRNYXRjaFRpbWVyKHZhbCkge1xuICAgIGV4cG9ydHMubWF0Y2hUaW1lciA9IHZhbDtcbn1cbmZ1bmN0aW9uIGdldE1hdGNoVGltZXIoKSB7XG4gICAgcmV0dXJuIGV4cG9ydHMubWF0Y2hUaW1lcjtcbn1cbmV4cG9ydHMudXNpbmdMb2NhbFN0b3JhZ2UgPSBmYWxzZTtcbmlmICh0eXBlb2YgKFN0b3JhZ2UpICE9PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgLy8gQ29kZSBmb3IgbG9jYWxTdG9yYWdlL3Nlc3Npb25TdG9yYWdlLlxuICAgIGV4cG9ydHMudXNpbmdMb2NhbFN0b3JhZ2UgPSB0cnVlO1xuICAgIGNvbnNvbGUubG9nKFwibG9jYWwgc3RvcmFnZSB3b3Jrc1wiKTtcbn1cbmVsc2Uge1xuICAgIC8vIFNvcnJ5ISBObyBXZWIgU3RvcmFnZSBzdXBwb3J0Li5cbiAgICBjb25zb2xlLmxvZyhcImxvY2FsIHN0b3JhZ2UgZG9lcyBub3Qgd29ya1wiKTtcbn1cbmZ1bmN0aW9uIHNldENvb2tpZShjbmFtZSwgY3ZhbHVlLCBleGRheXMpIHtcbiAgICB2YXIgZCA9IG5ldyBEYXRlKCk7XG4gICAgZC5zZXRUaW1lKGQuZ2V0VGltZSgpICsgKGV4ZGF5cyAqIDI0ICogNjAgKiA2MCAqIDEwMDApKTtcbiAgICB2YXIgZXhwID0gXCJleHBpcmVzPVwiICsgZC50b1VUQ1N0cmluZygpO1xuICAgIGRvY3VtZW50LmNvb2tpZSA9IGNuYW1lICsgXCI9XCIgKyBjdmFsdWUgKyBcIjsgXCIgKyBleHA7XG4gICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oY25hbWUsIGN2YWx1ZSk7XG59XG5mdW5jdGlvbiBzZXRWZXJzdXNNb2RlKHZhbCkge1xuICAgIGV4cG9ydHMudmVyc3VzTW9kZSA9IHZhbDtcbn1cbmZ1bmN0aW9uIGdldENvb2tpZShjbmFtZSkge1xuICAgIGlmIChleHBvcnRzLnVzaW5nTG9jYWxTdG9yYWdlKSB7XG4gICAgICAgIHJldHVybiBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShjbmFtZSk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICB2YXIgbmFtZSA9IGNuYW1lICsgXCI9XCI7XG4gICAgICAgIHZhciBjYSA9IGRvY3VtZW50LmNvb2tpZS5zcGxpdCgnOycpO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNhLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgYyA9IGNhW2ldO1xuICAgICAgICAgICAgd2hpbGUgKGMuY2hhckF0KDApID09ICcgJylcbiAgICAgICAgICAgICAgICBjID0gYy5zdWJzdHJpbmcoMSk7XG4gICAgICAgICAgICBpZiAoYy5pbmRleE9mKG5hbWUpID09IDApXG4gICAgICAgICAgICAgICAgcmV0dXJuIGMuc3Vic3RyaW5nKG5hbWUubGVuZ3RoLCBjLmxlbmd0aCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFwiXCI7XG4gICAgfVxufVxuZXhwb3J0cy5rZXlzID0ge307XG5leHBvcnRzLmtleUJpbmQgPSAwO1xuZXhwb3J0cy5rZXlCaW5kaW5nID0gZmFsc2U7XG5mdW5jdGlvbiBzZXRLZXlCaW5kaW5nKHZhbCkge1xuICAgIGV4cG9ydHMua2V5QmluZGluZyA9IHZhbDtcbn1cbmZ1bmN0aW9uIG92ZXJyaWRlS2V5Ym9hcmRFdmVudChlKSB7XG4gICAgaWYgKCFzaG93aW5nQ29kZSAmJiBjc3NfMS5jaG9vc2luZ1RhZyA9PSAtMSAmJiBlLmtleUNvZGUgIT0gMTIyICYmIGUua2V5Q29kZSAhPSAxMTYpIHtcbiAgICAgICAgc3dpdGNoIChlLnR5cGUpIHtcbiAgICAgICAgICAgIGNhc2UgXCJrZXlkb3duXCI6XG4gICAgICAgICAgICAgICAgaWYgKCFleHBvcnRzLmtleXNbZS5rZXlDb2RlXSkge1xuICAgICAgICAgICAgICAgICAgICBleHBvcnRzLmtleXNbZS5rZXlDb2RlXSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIGV4cG9ydHMua2V5QmluZCA9IGUua2V5Q29kZTtcbiAgICAgICAgICAgICAgICAgICAgZXhwb3J0cy5rZXlCaW5kaW5nID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgLy8gZG8ga2V5IGRvd24gc3R1ZmYgaGVyZVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJrZXl1cFwiOlxuICAgICAgICAgICAgICAgIGRlbGV0ZSAoZXhwb3J0cy5rZXlzW2Uua2V5Q29kZV0pO1xuICAgICAgICAgICAgICAgIC8vIGRvIGtleSB1cCBzdHVmZiBoZXJlXG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgZGlzYWJsZWRFdmVudFByb3BhZ2F0aW9uKGUpO1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGlmIChjc3NfMS5jaG9vc2luZ1RhZyA+IC0xKSB7XG4gICAgICAgICAgICBpZiAoZS5rZXlDb2RlID09IDEzKSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChlLnR5cGUpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcImtleWRvd25cIjpcbiAgICAgICAgICAgICAgICAgICAgICAgIGV4cG9ydHMua2V5c1sxM10gPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJrZXl1cFwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIChleHBvcnRzLmtleXNbMTNdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbn1cbjtcbmZ1bmN0aW9uIGRpc2FibGVkRXZlbnRQcm9wYWdhdGlvbihlKSB7XG4gICAgaWYgKGUpIHtcbiAgICAgICAgaWYgKGUuc3RvcFByb3BhZ2F0aW9uKSB7XG4gICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGV2ZW50KSB7XG4gICAgICAgICAgICBldmVudC5jYW5jZWxCdWJibGUgPSB0cnVlO1xuICAgICAgICB9XG4gICAgfVxufVxuO1xuZG9jdW1lbnQub25rZXlkb3duID0gb3ZlcnJpZGVLZXlib2FyZEV2ZW50O1xuZG9jdW1lbnQub25rZXl1cCA9IG92ZXJyaWRlS2V5Ym9hcmRFdmVudDtcbi8qdmFyIGtleXMgPSBbXTtcbmV4cG9ydCBjb25zdCBvbmtleXVwIChlKSB7XG4gIGtleXNbZS5rZXlDb2RlXT1mYWxzZTtcbn1cbmV4cG9ydCBjb25zdCBvbmtleWRvd24gKGUpIHtcbiAga2V5c1tlLmtleUNvZGVdPXRydWU7XG59Ki9cbmZ1bmN0aW9uIFNWRyh0YWcpIHtcbiAgICByZXR1cm4gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsIHRhZyk7XG59XG4vKmlmIChHYW1lcGFkLnN1cHBvcnRlZCkge1xuICAgIGNvbnNvbGUubG9nKFwiZ2FtZXBhZCBzdXBwb3J0ZWRcIik7XG59IGVsc2Uge1xuICAgIGNvbnNvbGUubG9nKFwiZ2FtZXBhZCBub3Qgc3VwcG9ydGVkXCIpO1xufSovXG53aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcImdhbWVwYWRjb25uZWN0ZWRcIiwgZnVuY3Rpb24gKGUpIHtcbiAgICBjb25zb2xlLmxvZyhcIkdhbWVwYWQgY29ubmVjdGVkIGF0IGluZGV4ICVkOiAlcy4gJWQgYnV0dG9ucywgJWQgYXhlcy5cIiwgZS5nYW1lcGFkLmluZGV4LCBlLmdhbWVwYWQuaWQsIGUuZ2FtZXBhZC5idXR0b25zLmxlbmd0aCwgZS5nYW1lcGFkLmF4ZXMubGVuZ3RoKTtcbn0pO1xuaWYgKG5hdmlnYXRvci5nZXRHYW1lcGFkcylcbiAgICBjb25zb2xlLmxvZyhuYXZpZ2F0b3IuZ2V0R2FtZXBhZHMoKSk7XG5mdW5jdGlvbiBtYXRjaFRpbWVyVGljayhpbnB1dCkge1xuICAgIGV4cG9ydHMubWF0Y2hUaW1lciAtPSAwLjAxNjY2NztcbiAgICBpZiAoZG9tLm1hdGNoTWludXRlcyAmJiBkb20ubWF0Y2hTZWNvbmRzKSB7XG4gICAgICAgIHZhciBzZWMgPSAoZXhwb3J0cy5tYXRjaFRpbWVyICUgNjApLnRvRml4ZWQoMik7XG4gICAgICAgIGRvbS5tYXRjaE1pbnV0ZXMuaW5uZXJIVE1MID0gTWF0aC5mbG9vcihleHBvcnRzLm1hdGNoVGltZXIgLyA2MCk7XG4gICAgICAgIGRvbS5tYXRjaFNlY29uZHMuaW5uZXJIVE1MID0gc2VjLmxlbmd0aCA8IDUgPyBgMCR7c2VjfWAgOiBzZWM7XG4gICAgfVxuICAgIGlmIChleHBvcnRzLm1hdGNoVGltZXIgPD0gMCkge1xuICAgICAgICBmaW5pc2hHYW1lKGlucHV0KTtcbiAgICB9XG59XG5mdW5jdGlvbiBzY3JlZW5TaGFrZShrYikge1xuICAgIHZhciBzZWVkID0gW01hdGgucmFuZG9tKCksIE1hdGgucmFuZG9tKCksIE1hdGgucmFuZG9tKCksIE1hdGgucmFuZG9tKCldO1xuICAgIGV4cG9ydHMuZmcxLnRyYW5zbGF0ZShrYiAqIDAuMSAqIHNlZWRbMF0sIGtiICogMC4xICogc2VlZFsxXSk7XG4gICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7IGV4cG9ydHMuZmcxLnRyYW5zbGF0ZSgta2IgKiAwLjA1ICogc2VlZFswXSwgLWtiICogMC4wNSAqIHNlZWRbMV0pOyB9LCAyMCk7XG4gICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7IGV4cG9ydHMuZmcxLnRyYW5zbGF0ZSgta2IgKiAwLjA1ICogc2VlZFswXSwgLWtiICogMC4wNSAqIHNlZWRbMV0pOyBleHBvcnRzLmZnMS50cmFuc2xhdGUoLWtiICogMC4xICogc2VlZFsyXSwgLWtiICogMC4xICogc2VlZFszXSk7IH0sIDQwKTtcbiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsgZXhwb3J0cy5mZzEudHJhbnNsYXRlKGtiICogMC4wNSAqIHNlZWRbMl0sIGtiICogMC4wNSAqIHNlZWRbM10pOyB9LCA2MCk7XG4gICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7IGV4cG9ydHMuZmcxLnRyYW5zbGF0ZShrYiAqIDAuMDUgKiBzZWVkWzJdLCBrYiAqIDAuMDUgKiBzZWVkWzNdKTsgfSwgODApO1xufVxuZnVuY3Rpb24gcGVyY2VudFNoYWtlKGtiLCBpKSB7XG4gICAgZXhwb3J0cy5wbGF5ZXJbaV0ucGVyY2VudFNoYWtlID0gbmV3IFZlYzJEXzEuVmVjMkQoa2IgKiAwLjEgKiBNYXRoLnJhbmRvbSgpLCBrYiAqIDAuMSAqIE1hdGgucmFuZG9tKCkpO1xuICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgeyBleHBvcnRzLnBsYXllcltpXS5wZXJjZW50U2hha2UgPSBuZXcgVmVjMkRfMS5WZWMyRChrYiAqIDAuMDUgKiBNYXRoLnJhbmRvbSgpLCBrYiAqIDAuMDUgKiBNYXRoLnJhbmRvbSgpKTsgfSwgMjApO1xuICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgeyBleHBvcnRzLnBsYXllcltpXS5wZXJjZW50U2hha2UgPSBuZXcgVmVjMkRfMS5WZWMyRCgta2IgKiAwLjEgKiBNYXRoLnJhbmRvbSgpLCAta2IgKiAwLjEgKiBNYXRoLnJhbmRvbSgpKTsgfSwgNDApO1xuICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgeyBleHBvcnRzLnBsYXllcltpXS5wZXJjZW50U2hha2UgPSBuZXcgVmVjMkRfMS5WZWMyRCgta2IgKiAwLjA1ICogTWF0aC5yYW5kb20oKSwgLWtiICogMC4wNSAqIE1hdGgucmFuZG9tKCkpOyB9LCA2MCk7XG4gICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7IGV4cG9ydHMucGxheWVyW2ldLnBlcmNlbnRTaGFrZSA9IG5ldyBWZWMyRF8xLlZlYzJEKDAsIDApOyB9LCA4MCk7XG59XG5mdW5jdGlvbiBmaW5kUGxheWVycygpIHtcbiAgICB2YXIgZ3BzID0gbmF2aWdhdG9yLmdldEdhbWVwYWRzID8gbmF2aWdhdG9yLmdldEdhbWVwYWRzKCkgOiAobmF2aWdhdG9yLndlYmtpdEdldEdhbWVwYWRzID8gbmF2aWdhdG9yLndlYmtpdEdldEdhbWVwYWRzKCkgOiBbXSk7XG4gICAgLyppZiAodHlwZW9mIGdwcyAhPSBcInVuZGVmaW5lZFwiKXtcbiAgICAgIGNvbnNvbGUubG9nKGdwcyk7XG4gICAgfSovXG4gICAgaWYgKCFrZXlib2FyZE9jY3VwaWVkKSB7XG4gICAgICAgIGlmIChleHBvcnRzLmdhbWVNb2RlIDwgMiB8fCBleHBvcnRzLmdhbWVNb2RlID09IDIwKSB7XG4gICAgICAgICAgICBpZiAoZXhwb3J0cy5rZXlzWzEzXSB8fCBleHBvcnRzLmtleXNbc2V0dGluZ3NfMS5rZXlNYXAuc1swXV0gfHwgZXhwb3J0cy5rZXlzW3NldHRpbmdzXzEua2V5TWFwLnNbMV1dKSB7XG4gICAgICAgICAgICAgICAgaWYgKGV4cG9ydHMucG9ydHMgPCA0KSB7XG4gICAgICAgICAgICAgICAgICAgIGNoYW5nZUdhbWVtb2RlKDEpO1xuICAgICAgICAgICAgICAgICAgICAoMCwganF1ZXJ5XzEuZGVmYXVsdCkoXCIja2V5Ym9hcmRQcm9tcHRcIikuaGlkZSgpO1xuICAgICAgICAgICAgICAgICAgICBrZXlib2FyZE9jY3VwaWVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgc2Z4XzEuc291bmRzLm1lbnVGb3J3YXJkLnBsYXkoKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGV4cG9ydHMucG9ydHMgPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbXVzaWNfMS5NdXNpY01hbmFnZXIucGxheU1lbnVMb29wKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYWRkUGxheWVyKGV4cG9ydHMucG9ydHMsIFwia2V5Ym9hcmRcIik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgaWYgKGV4cG9ydHMua2V5c1tzZXR0aW5nc18xLmtleU1hcC5hWzBdXSB8fCBleHBvcnRzLmtleXNbc2V0dGluZ3NfMS5rZXlNYXAuYVsxXV0pIHtcbiAgICAgICAgICAgICAgICBpZiAoZXhwb3J0cy5wb3J0cyA8IDQpIHtcbiAgICAgICAgICAgICAgICAgICAga2V5Ym9hcmRPY2N1cGllZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIGFkZFBsYXllcihleHBvcnRzLnBvcnRzLCBcImtleWJvYXJkXCIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGdwcy5sZW5ndGg7IGkrKykge1xuICAgICAgICB2YXIgZ2FtZXBhZCA9IG5hdmlnYXRvci5nZXRHYW1lcGFkcyA/IG5hdmlnYXRvci5nZXRHYW1lcGFkcygpW2ldIDogKG5hdmlnYXRvci53ZWJraXRHZXRHYW1lcGFkcyA/IG5hdmlnYXRvci53ZWJraXRHZXRHYW1lcGFkcygpW2ldIDogbnVsbCk7XG4gICAgICAgIGlmIChleHBvcnRzLnBsYXllclR5cGVbaV0gPT09IDIpIHtcbiAgICAgICAgICAgIHZhciBhbHJlYWR5SW4gPSBmYWxzZTtcbiAgICAgICAgICAgIGZvciAodmFyIGsgPSAwOyBrIDwgZXhwb3J0cy5wb3J0czsgaysrKSB7XG4gICAgICAgICAgICAgICAgaWYgKGV4cG9ydHMuY3VycmVudFBsYXllcnNba10gPT09IGkpIHtcbiAgICAgICAgICAgICAgICAgICAgYWxyZWFkeUluID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIWFscmVhZHlJbikge1xuICAgICAgICAgICAgICAgIGlmIChleHBvcnRzLnBvcnRzIDwgNCkge1xuICAgICAgICAgICAgICAgICAgICBhZGRQbGF5ZXIoaSwgOTkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIHZhciBnYW1lcGFkID0gbmF2aWdhdG9yLmdldEdhbWVwYWRzID8gbmF2aWdhdG9yLmdldEdhbWVwYWRzKClbaV0gOiAobmF2aWdhdG9yLndlYmtpdEdldEdhbWVwYWRzID8gbmF2aWdhdG9yLndlYmtpdEdldEdhbWVwYWRzKClbaV0gOiBudWxsKTtcbiAgICAgICAgaWYgKHR5cGVvZiBnYW1lcGFkICE9IFwidW5kZWZpbmVkXCIgJiYgZ2FtZXBhZCAhPSBudWxsKSB7XG4gICAgICAgICAgICB2YXIgZGV0ZWN0ZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIHZhciBncGROYW1lO1xuICAgICAgICAgICAgdmFyIGdwZEluZm87XG4gICAgICAgICAgICBpZiAoZXhwb3J0cy51c2luZ0N1c3RvbUNvbnRyb2xzW2ldICYmIGN1c3RvbV8xLmN1c3RvbUdhbWVwYWRJbmZvW2ldICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgZ3BkTmFtZSA9IFwiY3VzdG9tIGNvbnRyb2xzXCI7XG4gICAgICAgICAgICAgICAgZ3BkSW5mbyA9IGN1c3RvbV8xLmN1c3RvbUdhbWVwYWRJbmZvW2ldO1xuICAgICAgICAgICAgICAgIGRldGVjdGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnN0IG1heWJlTmFtZUFuZEluZm8gPSAoMCwgZmluZEdhbWVwYWRJbmZvXzEuZ2V0R2FtZXBhZE5hbWVBbmRJbmZvKShnYW1lcGFkLmlkKTtcbiAgICAgICAgICAgICAgICBpZiAobWF5YmVOYW1lQW5kSW5mbyA9PT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkVycm9yIGluICdmaW5kUGxheWVycyc6IGNvbnRyb2xsZXIgXCIgKyAoaSArIDEpICsgXCIgZGV0ZWN0ZWQgYnV0IG5vdCBzdXBwb3J0ZWQuXCIpO1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlRyeSBtYW51YWwgY2FsaWJyYXRpb24gb2YgeW91ciBjb250cm9sbGVyLlwiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGRldGVjdGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgW2dwZE5hbWUsIGdwZEluZm9dID0gbWF5YmVOYW1lQW5kSW5mbztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZGV0ZWN0ZWQpIHtcbiAgICAgICAgICAgICAgICBpZiAoZXhwb3J0cy5maXJzdFRpbWVEZXRlY3RlZFtpXSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkNvbnRyb2xsZXIgXCIgKyAoaSArIDEpICsgXCIgaXM6IFwiICsgZ3BkTmFtZSArIFwiLlwiKTtcbiAgICAgICAgICAgICAgICAgICAgZXhwb3J0cy5maXJzdFRpbWVEZXRlY3RlZFtpXSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoZXhwb3J0cy5nYW1lTW9kZSA8IDIgfHwgZXhwb3J0cy5nYW1lTW9kZSA9PSAyMCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoKDAsIHJldHJpZXZlR2FtZXBhZElucHV0c18xLmJ1dHRvblN0YXRlKShnYW1lcGFkLCBncGRJbmZvLCBcInNcIikpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhbHJlYWR5SW4gPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGsgPSAwOyBrIDwgZXhwb3J0cy5wb3J0czsgaysrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGV4cG9ydHMuY3VycmVudFBsYXllcnNba10gPT0gaSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbHJlYWR5SW4gPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYWxyZWFkeUluKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGV4cG9ydHMucG9ydHMgPCA0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoYW5nZUdhbWVtb2RlKDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoMCwganF1ZXJ5XzEuZGVmYXVsdCkoXCIja2V5Ym9hcmRQcm9tcHRcIikuaGlkZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZnhfMS5zb3VuZHMubWVudUZvcndhcmQucGxheSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXhwb3J0cy5wb3J0cyA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbXVzaWNfMS5NdXNpY01hbmFnZXIucGxheU1lbnVMb29wKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWRkUGxheWVyKGksIGdwZEluZm8pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCgwLCByZXRyaWV2ZUdhbWVwYWRJbnB1dHNfMS5idXR0b25TdGF0ZSkoZ2FtZXBhZCwgZ3BkSW5mbywgXCJhXCIpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYWxyZWFkeUluID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBrID0gMDsgayA8IGV4cG9ydHMucG9ydHM7IGsrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChleHBvcnRzLmN1cnJlbnRQbGF5ZXJzW2tdID09IGkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxyZWFkeUluID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWFscmVhZHlJbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChleHBvcnRzLnBvcnRzIDwgNCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZGRQbGF5ZXIoaSwgZ3BkSW5mbyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJObyBjb250cm9sbGVyIGRldGVjdGVkIGJ5IGJyb3dzZXJcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59XG5mdW5jdGlvbiBzZXRQbGF5ZXJUeXBlKHBsYXllclNsb3QsIHR5cGUpIHtcbiAgICBleHBvcnRzLnBsYXllclR5cGVbcGxheWVyU2xvdF0gPSB0eXBlO1xufVxuZnVuY3Rpb24gYWRkUGxheWVyKGksIGNvbnRyb2xsZXJJbmZvKSB7XG4gICAgaWYgKGNvbnRyb2xsZXJJbmZvID09PSA5OSkge1xuICAgICAgICBleHBvcnRzLnBvcnRzKys7XG4gICAgICAgIGV4cG9ydHMuY3VycmVudFBsYXllcnNbZXhwb3J0cy5wb3J0cyAtIDFdID0gaTtcbiAgICAgICAgZXhwb3J0cy5wbGF5ZXJUeXBlW2V4cG9ydHMucG9ydHMgLSAxXSA9IDI7XG4gICAgICAgIGV4cG9ydHMubVR5cGVbZXhwb3J0cy5wb3J0cyAtIDFdID0gY29udHJvbGxlckluZm87XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBleHBvcnRzLnBvcnRzKys7XG4gICAgICAgIGV4cG9ydHMuY3VycmVudFBsYXllcnNbZXhwb3J0cy5wb3J0cyAtIDFdID0gaTtcbiAgICAgICAgZXhwb3J0cy5wbGF5ZXJUeXBlW2V4cG9ydHMucG9ydHMgLSAxXSA9IDA7XG4gICAgICAgIGV4cG9ydHMubVR5cGVbZXhwb3J0cy5wb3J0cyAtIDFdID0gY29udHJvbGxlckluZm87XG4gICAgICAgIGlmIChleHBvcnRzLnNob3dEZWJ1Zykge1xuICAgICAgICAgICAgKDAsIGRyYXdHYW1lcGFkXzEudXBkYXRlR2FtZXBhZFNWR0NvbG91cikoaSwgXCJnYW1lcGFkU1ZHXCIgKyBpKTtcbiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZ2FtZXBhZFNWR1wiICsgaSkuc3R5bGUuZGlzcGxheSA9IFwiXCI7XG4gICAgICAgIH1cbiAgICB9XG59XG5mdW5jdGlvbiB0b2dnbGVQb3J0KGkpIHtcbiAgICBleHBvcnRzLnBsYXllclR5cGVbaV0rKztcbiAgICBpZiAoZXhwb3J0cy5wbGF5ZXJUeXBlW2ldID09IDMpIHtcbiAgICAgICAgZXhwb3J0cy5wbGF5ZXJUeXBlW2ldID0gLTE7XG4gICAgICAgIGlmIChleHBvcnRzLnNob3dEZWJ1Zykge1xuICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJnYW1lcGFkU1ZHXCIgKyBpKS5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaWYgKGV4cG9ydHMucGxheWVyVHlwZVtpXSA9PSAwICYmIGV4cG9ydHMucG9ydHMgPD0gaSkge1xuICAgICAgICBleHBvcnRzLnBsYXllclR5cGVbaV0gPSAxO1xuICAgICAgICAoMCwgZHJhd0dhbWVwYWRfMS5zZXRHYW1lcGFkU1ZHQ29sb3VyKShpLCBcImJsYWNrXCIpO1xuICAgICAgICBpZiAoZXhwb3J0cy5zaG93RGVidWcpIHtcbiAgICAgICAgICAgICgwLCBkcmF3R2FtZXBhZF8xLnVwZGF0ZUdhbWVwYWRTVkdDb2xvdXIpKGksIFwiZ2FtZXBhZFNWR1wiICsgaSk7XG4gICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImdhbWVwYWRTVkdcIiArIGkpLnN0eWxlLmRpc3BsYXkgPSBcIlwiO1xuICAgICAgICB9XG4gICAgfVxufVxuZnVuY3Rpb24gcG9zaXRpb25QbGF5ZXJzSW5DU1MoKSB7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCA0OyBpKyspIHtcbiAgICAgICAgdmFyIHggPSAoLTgwICsgaSAqIDUwKSAqIDIgLyAzO1xuICAgICAgICB2YXIgeSA9IC0zMDtcbiAgICAgICAgZXhwb3J0cy5wbGF5ZXJbaV0ucGh5cy5wb3MgPSBuZXcgVmVjMkRfMS5WZWMyRCh4LCB5KTtcbiAgICAgICAgZXhwb3J0cy5wbGF5ZXJbaV0ucGh5cy5odXJ0Ym94ID0gbmV3IEJveDJEXzEuQm94MkQoWy00ICsgeCwgMTggKyB5XSwgWzQgKyB4LCB5XSk7XG4gICAgfVxufVxuLy8gMjA6U3RhcnR1cFxuLy8gMTQ6Q29udHJvbGxlciBNZW51XG4vLyAxMzpEYXRhIE1lbnVcbi8vIDEyOktleWJvYXJkIENvbnRyb2xzXG4vLyAxMTpHYW1lcGxheSBNZW51XG4vLyAxMDpTb3VuZCBNZW51XG4vLyA5OiAtXG4vLyA4OiAtXG4vLyA3OlRhcmdldCBTZWxlY3Rcbi8vIDY6U3RhZ2UgU2VsZWN0IChWUylcbi8vIDU6VGFyZ2V0IFBsYXlpbmdcbi8vIDQ6VGFyZ2V0IEJ1aWxkZXJcbi8vIDM6UGxheWluZyAoVlMpXG4vLyAyOkNTU1xuLy8gMTpNYWluIE1lbnVcbi8vIDA6VGl0bGUgU2NyZWVuXG5mdW5jdGlvbiBjaGFuZ2VHYW1lbW9kZShuZXdHYW1lbW9kZSkge1xuICAgIGV4cG9ydHMuYmcxLmZpbGxTdHlsZSA9IFwiYmxhY2tcIjtcbiAgICBleHBvcnRzLmJnMS5maWxsUmVjdCgwLCAwLCBleHBvcnRzLmxheWVycy5CRzEud2lkdGgsIGV4cG9ydHMubGF5ZXJzLkJHMS5oZWlnaHQpO1xuICAgIGV4cG9ydHMuZmcxLmNsZWFyUmVjdCgwLCAwLCBleHBvcnRzLmxheWVycy5GRzEud2lkdGgsIGV4cG9ydHMubGF5ZXJzLkZHMS5oZWlnaHQpO1xuICAgIGV4cG9ydHMuZ2FtZU1vZGUgPSBuZXdHYW1lbW9kZTtcbiAgICBzd2l0Y2ggKG5ld0dhbWVtb2RlKSB7XG4gICAgICAgIC8vIFRJVExFU0NSRUVOXG4gICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICgwLCBzdGFydHNjcmVlbl8xLmRyYXdTdGFydFNjcmVlbkluaXQpKCk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgLy8gTUFJTiBNRU5VXG4gICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICgwLCBqcXVlcnlfMS5kZWZhdWx0KShcIiNsb2dvVmlkXCIpLnJlbW92ZSgpO1xuICAgICAgICAgICAgKDAsIG1lbnVfMS5kcmF3TWFpbk1lbnVJbml0KSgpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIC8vIENTU1xuICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAoMCwgY3NzXzEuZHJhd0NTU0luaXQpKCk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgLy8gUGxheWluZyAoVlMpXG4gICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICgwLCBzdGFnZXJlbmRlcl8xLmRyYXdCYWNrZ3JvdW5kSW5pdCkoKTtcbiAgICAgICAgICAgICgwLCBzdGFnZXJlbmRlcl8xLmRyYXdTdGFnZUluaXQpKCk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgLy8gVGFyZ2V0IEJ1aWxkZXJcbiAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIC8vIFRhcmdldCBQbGF5aW5nXG4gICAgICAgIGNhc2UgNTpcbiAgICAgICAgICAgICgwLCBzdGFnZXJlbmRlcl8xLmRyYXdCYWNrZ3JvdW5kSW5pdCkoKTtcbiAgICAgICAgICAgICgwLCBzdGFnZXJlbmRlcl8xLmRyYXdTdGFnZUluaXQpKCk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgLy8gU3RhZ2Ugc2VsZWN0ICh2cylcbiAgICAgICAgY2FzZSA2OlxuICAgICAgICAgICAgKDAsIHN0YWdlc2VsZWN0XzEuZHJhd1NTU0luaXQpKCk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgLy8gVGFyZ2V0IFNlbGVjdFxuICAgICAgICBjYXNlIDc6XG4gICAgICAgICAgICAvLyBkcmF3VFNTSW5pdCgpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIC8vIHNvdW5kIG1lbnVcbiAgICAgICAgY2FzZSAxMDpcbiAgICAgICAgICAgICgwLCBhdWRpb21lbnVfMS5kcmF3QXVkaW9NZW51SW5pdCkoKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAvLyBnYW1lcGxheSBtZW51XG4gICAgICAgIGNhc2UgMTE6XG4gICAgICAgICAgICAoMCwgZ2FtZXBsYXltZW51XzEuZHJhd0dhbWVwbGF5TWVudUluaXQpKCk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgLy8ga2V5Ym9hcmQgbWVudVxuICAgICAgICBjYXNlIDEyOlxuICAgICAgICAgICAgKDAsIGtleWJvYXJkbWVudV8xLmRyYXdLZXlib2FyZE1lbnVJbml0KSgpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIC8vIGNyZWRpdHNcbiAgICAgICAgY2FzZSAxMzpcbiAgICAgICAgICAgIC8vIGRyYXdDcmVkaXRzSW5pdCgpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIC8vIE11bHRpcGxheWVyIE1vZGVzXG4gICAgICAgIGNhc2UgMTQ6XG4gICAgICAgICAgICAoMCwgY29udHJvbGxlcm1lbnVfMS5kcmF3Q29udHJvbGxlck1lbnVJbml0KSgpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgMTU6XG4gICAgICAgICAgICAoMCwgY3NzXzEuZHJhd0NTU0luaXQpKCk7XG4gICAgICAgICAgICAoMCwgc3RyZWFtY2xpZW50XzEuY29ubmVjdFRvTVBTZXJ2ZXIpKCk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgLy8gc3RhcnR1cFxuICAgICAgICBjYXNlIDIwOlxuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICBicmVhaztcbiAgICB9XG59XG4vKmV4cG9ydCBjb25zdCBhZGRQbGF5ZXIgKGksZ1R5cGUscFR5cGUpe1xuICBjb25zb2xlLmxvZyhpLGdUeXBlLHBUeXBlKTtcblxuICBjdXJyZW50UGxheWVycy5wdXNoKGkpO1xuICBpZiAocFR5cGUgPT0gMCl7XG4gICAgcG9ydHMrKztcbiAgICBtVHlwZVtwb3J0cy0xXSA9IGdUeXBlO1xuICAgIHBsYXllclR5cGVbcG9ydHMtMV0gPSBwVHlwZTtcblxuICAgIGNvc3R1bWVUaW1lb3V0LnB1c2goZmFsc2UpO1xuICAgIHBQYWwucHVzaChwb3J0cy0xKTtcbiAgICBidWlsZFBsYXllck9iamVjdChwb3J0cy0xKTtcbiAgICBwbGF5ZXJbcGxheWVyQW1vdW50LTFdLnBoeXMucG9zID0gbmV3IFZlYzJEKC0xMDArMjUqKHBsYXllckFtb3VudD0xKSwtNDApO1xuICAgIHBsYXllcltwb3J0cy0xXS5waHlzLmZhY2UgPSAxO1xuICAgIHBsYXllcltwb3J0cy0xXS5hY3Rpb25TdGF0ZSA9IDA7XG4gICAgJChcIiNjdXJyZW50UGxheWVyc1wiKS5hcHBlbmQoJzxkaXYgY2xhc3M9XCJwQm94Qm94XCI+PGRpdiBjbGFzcz1cInBsYXllckJveFwiIGlkPVwicEJveCcrKHBvcnRzLTEpKydcIiBzdHlsZT1cImJhY2tncm91bmQtY29sb3I6JytwYWxldHRlc1twUGFsW3BvcnRzLTFdXVswXSsnO2JvcmRlcjo1cHggc29saWQgJytwYWxldHRlc1twUGFsW3BvcnRzLTFdXVsyXSsnMC44KVwiPjxwPlAnK3BvcnRzKyc8YnI+PHNwYW4gY2xhc3M9XCJjb250XCI+KENvbnQuICcraSsnKTwvc3Bhbj48L3A+PC9kaXY+PGRpdiBpZD1cInBUYWcnKyhwb3J0cy0xKSsnXCIgY2xhc3M9XCJwVGFnXCI+PHRleHRhcmVhIGlkPVwicFRhZ0VkaXQnKyhwb3J0cy0xKSsnXCIgY2xhc3M9XCJwVGFnRWRpdFwiIG1heGxlbmd0aD1cIjEwXCI+PC90ZXh0YXJlYT48L2Rpdj48L2Rpdj4nKTtcbiAgfVxuICBlbHNlIHtcbiAgICBtVHlwZVtpXSA9IGdUeXBlO1xuXG4gICAgY29zdHVtZVRpbWVvdXQucHVzaChmYWxzZSk7XG4gICAgcFBhbC5wdXNoKGkpO1xuICAgIGJ1aWxkUGxheWVyT2JqZWN0KGkpO1xuICAgIHBsYXllcltwbGF5ZXJBbW91bnQtMV0ucGh5cy5wb3MgPSBuZXcgVmVjMkQoLTEwMCsyNSoocGxheWVyQW1vdW50PTEpLC00MCk7XG4gICAgcGxheWVyW2ldLnBoeXMuZmFjZSA9IDE7XG4gICAgcGxheWVyW2ldLmFjdGlvblN0YXRlID0gMDtcbiAgICAkKFwiI2N1cnJlbnRQbGF5ZXJzXCIpLmFwcGVuZCgnPGRpdiBjbGFzcz1cInBCb3hCb3hcIj48ZGl2IGNsYXNzPVwicGxheWVyQm94XCIgaWQ9XCJwQm94JytpKydcIiBzdHlsZT1cImJhY2tncm91bmQtY29sb3I6JytwYWxldHRlc1twUGFsW2ldXVswXSsnO2JvcmRlcjo1cHggc29saWQgJytwYWxldHRlc1twUGFsW2ldXVsyXSsnMC44KVwiPjxwPlAnKyhpKzEpKyc8YnI+PHNwYW4gY2xhc3M9XCJjb250XCI+KENvbnQuICcraSsnKTwvc3Bhbj48L3A+PC9kaXY+PGRpdiBpZD1cInBUYWcnK2krJ1wiIGNsYXNzPVwicFRhZ1wiPjx0ZXh0YXJlYSBpZD1cInBUYWdFZGl0JytpKydcIiBjbGFzcz1cInBUYWdFZGl0XCIgbWF4bGVuZ3RoPVwiMTBcIj48L3RleHRhcmVhPjwvZGl2PjwvZGl2PicpO1xuICB9XG4gIHBsYXllckFtb3VudCsrO1xufVxuXG5leHBvcnQgY29uc3QgcmVtb3ZlUGxheWVyIChpKXtcbiAgcGxheWVyVHlwZVtpXSA9IC0xO1xuICBwbGF5ZXJBbW91bnQtLTtcbn0qL1xuZnVuY3Rpb24gaW50ZXJwcmV0SW5wdXRzKGksIGFjdGl2ZSwgcGxheWVydHlwZSwgaW5wdXRCdWZmZXIpIHtcbiAgICBsZXQgdGVtcEJ1ZmZlciA9ICgwLCBpbnB1dF8xLm51bGxJbnB1dHMpKCk7XG4gICAgLy8ga2VlcCB1cGRhdGluZyBaIGFuZCBTdGFydCBhbGwgdGhlIHRpbWUsIGV2ZW4gd2hlbiBwYXVzZWRcbiAgICBmb3IgKHZhciBrID0gMDsgayA8IDc7IGsrKykge1xuICAgICAgICB0ZW1wQnVmZmVyWzcgLSBrXS56ID0gaW5wdXRCdWZmZXJbNiAtIGtdLno7XG4gICAgICAgIHRlbXBCdWZmZXJbNyAtIGtdLnMgPSBpbnB1dEJ1ZmZlcls2IC0ga10ucztcbiAgICB9XG4gICAgdGVtcEJ1ZmZlclswXSA9ICgwLCBpbnB1dF8xLnBvbGxJbnB1dHMpKGV4cG9ydHMuZ2FtZU1vZGUsIGV4cG9ydHMuZnJhbWVCeUZyYW1lLCBleHBvcnRzLm1UeXBlW2ldLCBpLCBleHBvcnRzLmN1cnJlbnRQbGF5ZXJzW2ldLCBleHBvcnRzLmtleXMsIHBsYXllcnR5cGUpO1xuICAgIGxldCBwYXN0T2Zmc2V0ID0gMDtcbiAgICBpZiAoKGV4cG9ydHMuZ2FtZU1vZGUgIT09IDMgJiYgZXhwb3J0cy5nYW1lTW9kZSAhPT0gNSkgfHwgKGV4cG9ydHMucGxheWluZyAmJiAoZXhwb3J0cy5wYXVzZVtpXVsxXSB8fCAhZXhwb3J0cy5wYXVzZVtpXVswXSkpXG4gICAgICAgIHx8IGV4cG9ydHMud2FzRnJhbWVCeUZyYW1lXG4gICAgICAgIHx8ICghZXhwb3J0cy5wbGF5aW5nICYmIGV4cG9ydHMucGF1c2VbaV1bMF0gJiYgIWV4cG9ydHMucGF1c2VbaV1bMV0pKSB7XG4gICAgICAgIHBhc3RPZmZzZXQgPSAxO1xuICAgIH1cbiAgICBleHBvcnRzLnBhdXNlW2ldWzFdID0gZXhwb3J0cy5wYXVzZVtpXVswXTtcbiAgICBleHBvcnRzLndhc0ZyYW1lQnlGcmFtZSA9IGZhbHNlO1xuICAgIGV4cG9ydHMuZnJhbWVBZHZhbmNlW2ldWzFdID0gZXhwb3J0cy5mcmFtZUFkdmFuY2VbaV1bMF07XG4gICAgZm9yICh2YXIgayA9IDA7IGsgPCA3OyBrKyspIHtcbiAgICAgICAgdGVtcEJ1ZmZlcls3IC0ga10ubHNYID0gaW5wdXRCdWZmZXJbNyAtIGsgLSBwYXN0T2Zmc2V0XS5sc1g7XG4gICAgICAgIHRlbXBCdWZmZXJbNyAtIGtdLmxzWSA9IGlucHV0QnVmZmVyWzcgLSBrIC0gcGFzdE9mZnNldF0ubHNZO1xuICAgICAgICB0ZW1wQnVmZmVyWzcgLSBrXS5yYXdYID0gaW5wdXRCdWZmZXJbNyAtIGsgLSBwYXN0T2Zmc2V0XS5yYXdYO1xuICAgICAgICB0ZW1wQnVmZmVyWzcgLSBrXS5yYXdZID0gaW5wdXRCdWZmZXJbNyAtIGsgLSBwYXN0T2Zmc2V0XS5yYXdZO1xuICAgICAgICB0ZW1wQnVmZmVyWzcgLSBrXS5jc1ggPSBpbnB1dEJ1ZmZlcls3IC0gayAtIHBhc3RPZmZzZXRdLmNzWDtcbiAgICAgICAgdGVtcEJ1ZmZlcls3IC0ga10uY3NZID0gaW5wdXRCdWZmZXJbNyAtIGsgLSBwYXN0T2Zmc2V0XS5jc1k7XG4gICAgICAgIHRlbXBCdWZmZXJbNyAtIGtdLnJhd2NzWCA9IGlucHV0QnVmZmVyWzcgLSBrIC0gcGFzdE9mZnNldF0ucmF3Y3NYO1xuICAgICAgICB0ZW1wQnVmZmVyWzcgLSBrXS5yYXdjc1kgPSBpbnB1dEJ1ZmZlcls3IC0gayAtIHBhc3RPZmZzZXRdLnJhd2NzWTtcbiAgICAgICAgdGVtcEJ1ZmZlcls3IC0ga10ubEEgPSBpbnB1dEJ1ZmZlcls3IC0gayAtIHBhc3RPZmZzZXRdLmxBO1xuICAgICAgICB0ZW1wQnVmZmVyWzcgLSBrXS5yQSA9IGlucHV0QnVmZmVyWzcgLSBrIC0gcGFzdE9mZnNldF0uckE7XG4gICAgICAgIHRlbXBCdWZmZXJbNyAtIGtdLmEgPSBpbnB1dEJ1ZmZlcls3IC0gayAtIHBhc3RPZmZzZXRdLmE7XG4gICAgICAgIHRlbXBCdWZmZXJbNyAtIGtdLmIgPSBpbnB1dEJ1ZmZlcls3IC0gayAtIHBhc3RPZmZzZXRdLmI7XG4gICAgICAgIHRlbXBCdWZmZXJbNyAtIGtdLnggPSBpbnB1dEJ1ZmZlcls3IC0gayAtIHBhc3RPZmZzZXRdLng7XG4gICAgICAgIHRlbXBCdWZmZXJbNyAtIGtdLnkgPSBpbnB1dEJ1ZmZlcls3IC0gayAtIHBhc3RPZmZzZXRdLnk7XG4gICAgICAgIHRlbXBCdWZmZXJbNyAtIGtdLnIgPSBpbnB1dEJ1ZmZlcls3IC0gayAtIHBhc3RPZmZzZXRdLnI7XG4gICAgICAgIHRlbXBCdWZmZXJbNyAtIGtdLmwgPSBpbnB1dEJ1ZmZlcls3IC0gayAtIHBhc3RPZmZzZXRdLmw7XG4gICAgICAgIHRlbXBCdWZmZXJbNyAtIGtdLmRsID0gaW5wdXRCdWZmZXJbNyAtIGsgLSBwYXN0T2Zmc2V0XS5kbDtcbiAgICAgICAgdGVtcEJ1ZmZlcls3IC0ga10uZGQgPSBpbnB1dEJ1ZmZlcls3IC0gayAtIHBhc3RPZmZzZXRdLmRkO1xuICAgICAgICB0ZW1wQnVmZmVyWzcgLSBrXS5kciA9IGlucHV0QnVmZmVyWzcgLSBrIC0gcGFzdE9mZnNldF0uZHI7XG4gICAgICAgIHRlbXBCdWZmZXJbNyAtIGtdLmR1ID0gaW5wdXRCdWZmZXJbNyAtIGsgLSBwYXN0T2Zmc2V0XS5kdTtcbiAgICB9XG4gICAgaWYgKGV4cG9ydHMubVR5cGUgIT09IG51bGwpIHtcbiAgICAgICAgaWYgKChleHBvcnRzLm1UeXBlW2ldID09PSBcImtleWJvYXJkXCIgJiYgKHRlbXBCdWZmZXJbMF0ueiB8fCB0ZW1wQnVmZmVyWzFdLnopKVxuICAgICAgICAgICAgfHwgKGV4cG9ydHMubVR5cGVbaV0gIT09IFwia2V5Ym9hcmRcIiAmJiAodGVtcEJ1ZmZlclswXS56ICYmICF0ZW1wQnVmZmVyWzFdLnopKSkge1xuICAgICAgICAgICAgZXhwb3J0cy5mcmFtZUFkdmFuY2VbaV1bMF0gPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgZXhwb3J0cy5mcmFtZUFkdmFuY2VbaV1bMF0gPSBmYWxzZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBpZiAoZXhwb3J0cy5mcmFtZUFkdmFuY2VbaV1bMF0gJiYgIWV4cG9ydHMuZnJhbWVBZHZhbmNlW2ldWzFdICYmICFleHBvcnRzLnBsYXlpbmcgJiYgZXhwb3J0cy5nYW1lTW9kZSAhPT0gNCkge1xuICAgICAgICBleHBvcnRzLmZyYW1lQnlGcmFtZSA9IHRydWU7XG4gICAgfVxuICAgIGlmIChleHBvcnRzLm1UeXBlW2ldID09PSBcImtleWJvYXJkXCIpIHsgLy8ga2V5Ym9hcmQgY29udHJvbHNcbiAgICAgICAgaWYgKHRlbXBCdWZmZXJbMF0ucyB8fCB0ZW1wQnVmZmVyWzFdLnMgfHwgKGV4cG9ydHMuZ2FtZU1vZGUgPT09IDUgJiYgKHRlbXBCdWZmZXJbMF0uZHUgfHwgdGVtcEJ1ZmZlclsxXS5kdSkpKSB7XG4gICAgICAgICAgICBleHBvcnRzLnBhdXNlW2ldWzBdID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGV4cG9ydHMucGF1c2VbaV1bMF0gPSBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIWV4cG9ydHMucGxheWluZyAmJiAoZXhwb3J0cy5nYW1lTW9kZSA9PSAzIHx8IGV4cG9ydHMuZ2FtZU1vZGUgPT0gNSlcbiAgICAgICAgICAgICYmICh0ZW1wQnVmZmVyWzBdLmEgfHwgdGVtcEJ1ZmZlclsxXS5hKSAmJiAodGVtcEJ1ZmZlclswXS5sIHx8IHRlbXBCdWZmZXJbMV0ubClcbiAgICAgICAgICAgICYmICh0ZW1wQnVmZmVyWzBdLnIgfHwgdGVtcEJ1ZmZlclsxXS5yKSAmJiAodGVtcEJ1ZmZlclswXS5zIHx8IHRlbXBCdWZmZXJbMV0ucykpIHtcbiAgICAgICAgICAgIGlmICh0ZW1wQnVmZmVyWzBdLmIgfHwgdGVtcEJ1ZmZlclsxXS5iKSB7XG4gICAgICAgICAgICAgICAgc3RhcnRHYW1lKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBlbmRHYW1lKGlucHV0QnVmZmVyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpbnRlcnByZXRQYXVzZShleHBvcnRzLnBhdXNlW2ldWzBdLCBleHBvcnRzLnBhdXNlW2ldWzFdKTtcbiAgICB9XG4gICAgZWxzZSBpZiAoZXhwb3J0cy5tVHlwZVtpXSAhPT0gbnVsbCkgeyAvLyBnYW1lcGFkIGNvbnRyb2xzXG4gICAgICAgIGlmICghZXhwb3J0cy5wbGF5aW5nICYmIChleHBvcnRzLmdhbWVNb2RlID09IDMgfHwgZXhwb3J0cy5nYW1lTW9kZSA9PSA1KSAmJlxuICAgICAgICAgICAgKHRlbXBCdWZmZXJbMF0uYSAmJiB0ZW1wQnVmZmVyWzBdLmwgJiYgdGVtcEJ1ZmZlclswXS5yICYmIHRlbXBCdWZmZXJbMF0ucylcbiAgICAgICAgICAgICYmICghKHRlbXBCdWZmZXJbMV0uYSAmJiB0ZW1wQnVmZmVyWzFdLmwgJiYgdGVtcEJ1ZmZlclsxXS5yICYmIHRlbXBCdWZmZXJbMV0ucykpKSB7XG4gICAgICAgICAgICBpZiAodGVtcEJ1ZmZlclswXS5iKSB7XG4gICAgICAgICAgICAgICAgc3RhcnRHYW1lKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBlbmRHYW1lKGlucHV0QnVmZmVyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAodGVtcEJ1ZmZlclswXS5zIHx8IHRlbXBCdWZmZXJbMF0uZHUgJiYgZXhwb3J0cy5nYW1lTW9kZSA9PSA1KSB7XG4gICAgICAgICAgICBleHBvcnRzLnBhdXNlW2ldWzBdID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGV4cG9ydHMucGF1c2VbaV1bMF0gPSBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICAvLyBDb250cm9sbGVyIHJlc2V0IGZ1bmN0aW9uYWxpdHlcbiAgICAgICAgaWYgKCh0ZW1wQnVmZmVyWzBdLnogfHwgdGVtcEJ1ZmZlclswXS5kdSkgJiYgdGVtcEJ1ZmZlclswXS54ICYmIHRlbXBCdWZmZXJbMF0ueSkge1xuICAgICAgICAgICAgZXhwb3J0cy5jb250cm9sbGVyUmVzZXRDb3VudGRvd25zW2ldIC09IDE7XG4gICAgICAgICAgICBpZiAoZXhwb3J0cy5jb250cm9sbGVyUmVzZXRDb3VudGRvd25zW2ldID09PSAwKSB7XG4gICAgICAgICAgICAgICAgLy8gdHJpZ2dlcnMgY29kZSBpbiBpbnB1dC5qc1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiQ29udHJvbGxlciAjXCIgKyAoaSArIDEpICsgXCIgd2FzIHJlc2V0IVwiKTtcbiAgICAgICAgICAgICAgICAoMCwganF1ZXJ5XzEuZGVmYXVsdCkoXCIjcmVzZXRJbmRpY2F0b3JcIiArIGkpLmZhZGVJbigxMDApO1xuICAgICAgICAgICAgICAgICgwLCBqcXVlcnlfMS5kZWZhdWx0KShcIiNyZXNldEluZGljYXRvclwiICsgaSkuZmFkZU91dCg1MDApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgZXhwb3J0cy5jb250cm9sbGVyUmVzZXRDb3VudGRvd25zW2ldID0gMTI1O1xuICAgICAgICB9XG4gICAgICAgIGludGVycHJldFBhdXNlKGV4cG9ydHMucGF1c2VbaV1bMF0sIGV4cG9ydHMucGF1c2VbaV1bMV0pO1xuICAgIH1cbiAgICBlbHNlIHsgLy8gQUlcbiAgICAgICAgdGVtcEJ1ZmZlclswXS5yYXdYID0gdGVtcEJ1ZmZlclswXS5sc1g7XG4gICAgICAgIHRlbXBCdWZmZXJbMF0ucmF3WSA9IHRlbXBCdWZmZXJbMF0ubHNZO1xuICAgICAgICB0ZW1wQnVmZmVyWzBdLnJhd2NzWCA9IHRlbXBCdWZmZXJbMF0uY3NYO1xuICAgICAgICB0ZW1wQnVmZmVyWzBdLnJhd2NzWSA9IHRlbXBCdWZmZXJbMF0uY3NZO1xuICAgICAgICB0ZW1wQnVmZmVyWzBdLmxzWCA9ICgwLCBtZWxlZUlucHV0c18xLmRlYWRlbikodGVtcEJ1ZmZlclswXS5yYXdYKTtcbiAgICAgICAgdGVtcEJ1ZmZlclswXS5sc1kgPSAoMCwgbWVsZWVJbnB1dHNfMS5kZWFkZW4pKHRlbXBCdWZmZXJbMF0ucmF3WSk7XG4gICAgICAgIHRlbXBCdWZmZXJbMF0uY3NYID0gKDAsIG1lbGVlSW5wdXRzXzEuZGVhZGVuKSh0ZW1wQnVmZmVyWzBdLnJhd2NzWCk7XG4gICAgICAgIHRlbXBCdWZmZXJbMF0uY3NZID0gKDAsIG1lbGVlSW5wdXRzXzEuZGVhZGVuKSh0ZW1wQnVmZmVyWzBdLnJhd2NzWSk7XG4gICAgfVxuICAgIGlmIChleHBvcnRzLnNob3dEZWJ1Zykge1xuICAgICAgICAoMCwganF1ZXJ5XzEuZGVmYXVsdCkoXCIjbHNBeGlzWFwiICsgaSkuZW1wdHkoKS5hcHBlbmQodGVtcEJ1ZmZlclswXS5sc1gudG9GaXhlZCgzKSk7XG4gICAgICAgICgwLCBqcXVlcnlfMS5kZWZhdWx0KShcIiNsc0F4aXNZXCIgKyBpKS5lbXB0eSgpLmFwcGVuZCh0ZW1wQnVmZmVyWzBdLmxzWS50b0ZpeGVkKDMpKTtcbiAgICAgICAgKDAsIGpxdWVyeV8xLmRlZmF1bHQpKFwiI2NzQXhpc1hcIiArIGkpLmVtcHR5KCkuYXBwZW5kKHRlbXBCdWZmZXJbMF0uY3NYLnRvRml4ZWQoMykpO1xuICAgICAgICAoMCwganF1ZXJ5XzEuZGVmYXVsdCkoXCIjY3NBeGlzWVwiICsgaSkuZW1wdHkoKS5hcHBlbmQodGVtcEJ1ZmZlclswXS5jc1kudG9GaXhlZCgzKSk7XG4gICAgICAgICgwLCBqcXVlcnlfMS5kZWZhdWx0KShcIiNsQW5hbG9nXCIgKyBpKS5lbXB0eSgpLmFwcGVuZCh0ZW1wQnVmZmVyWzBdLmxBLnRvRml4ZWQoMykpO1xuICAgICAgICAoMCwganF1ZXJ5XzEuZGVmYXVsdCkoXCIjckFuYWxvZ1wiICsgaSkuZW1wdHkoKS5hcHBlbmQodGVtcEJ1ZmZlclswXS5yQS50b0ZpeGVkKDMpKTtcbiAgICAgICAgKDAsIGRyYXdHYW1lcGFkXzEudXBkYXRlR2FtZXBhZFNWR1N0YXRlKShpLCBcImdhbWVwYWRTVkdcIiArIGksIHRlbXBCdWZmZXJbMF0pO1xuICAgIH1cbiAgICBpZiAoZXhwb3J0cy5nYW1lTW9kZSA9PT0gMTQpIHsgLy8gY29udHJvbGxlciBjYWxpYnJhdGlvbiBzY3JlZW5cbiAgICAgICAgKDAsIGRyYXdHYW1lcGFkXzEudXBkYXRlR2FtZXBhZFNWR1N0YXRlKShpLCBcImdhbWVwYWRTVkdDYWxpYnJhdGlvblwiLCB0ZW1wQnVmZmVyWzBdKTtcbiAgICB9XG4gICAgaWYgKGV4cG9ydHMuc2hvd0RlYnVnIHx8IGV4cG9ydHMuZ2FtZU1vZGUgPT09IDE0KSB7XG4gICAgICAgIGNvbnN0IHdoaWNoID0gKGV4cG9ydHMuc2hvd0RlYnVnICYmIGV4cG9ydHMuZ2FtZU1vZGUgPT09IDE0KSA/IFwiYm90aFwiIDogZXhwb3J0cy5zaG93RGVidWcgPyBcImRlYnVnXCIgOiBcImNhbGlicmF0aW9uXCI7XG4gICAgICAgIGlmICh0ZW1wQnVmZmVyWzBdLnggJiYgIXRlbXBCdWZmZXJbMV0ueCAmJiB0ZW1wQnVmZmVyWzBdLmR1KSB7XG4gICAgICAgICAgICAoMCwgZHJhd0dhbWVwYWRfMS5jeWNsZUdhbWVwYWRDb2xvdXIpKGksIHdoaWNoLCB0cnVlKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGVtcEJ1ZmZlclswXS55ICYmICF0ZW1wQnVmZmVyWzFdLnkgJiYgdGVtcEJ1ZmZlclswXS5kdSkge1xuICAgICAgICAgICAgKDAsIGRyYXdHYW1lcGFkXzEuY3ljbGVHYW1lcGFkQ29sb3VyKShpLCB3aGljaCwgZmFsc2UpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGlmIChzdHJlYW1jbGllbnRfMS5naXZlSW5wdXRzW2ldID09PSB0cnVlKSB7XG4gICAgICAgIC8vdHVybnMgb3V0IGtleWJvYXJkcyBsZWF2ZSBnYXBzIGluIHRoZSBpbnB1dCBidWZmZXJcbiAgICAgICAgKDAsIGRlZXBDb3B5T2JqZWN0XzEuZGVlcE9iamVjdE1lcmdlKSh0cnVlLCAoMCwgaW5wdXRfMS5udWxsSW5wdXQpKCksIHRlbXBCdWZmZXJbMF0pO1xuICAgICAgICAoMCwgc3RyZWFtY2xpZW50XzEudXBkYXRlTmV0d29ya0lucHV0cykodGVtcEJ1ZmZlclswXSwgaSk7XG4gICAgfVxuICAgIGlmIChhY3RpdmUpIHtcbiAgICAgICAgaWYgKHRlbXBCdWZmZXJbMF0uZGwgJiYgIXRlbXBCdWZmZXJbMV0uZGwpIHtcbiAgICAgICAgICAgIGV4cG9ydHMucGxheWVyW2ldLnNob3dMZWRnZUdyYWJCb3ggXj0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGVtcEJ1ZmZlclswXS5kZCAmJiAhdGVtcEJ1ZmZlclsxXS5kZCkge1xuICAgICAgICAgICAgZXhwb3J0cy5wbGF5ZXJbaV0uc2hvd0VDQiBePSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0ZW1wQnVmZmVyWzBdLmRyICYmICF0ZW1wQnVmZmVyWzFdLmRyKSB7XG4gICAgICAgICAgICBleHBvcnRzLnBsYXllcltpXS5zaG93SGl0Ym94IF49IHRydWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaWYgKGV4cG9ydHMuZnJhbWVCeUZyYW1lKSB7XG4gICAgICAgIHRlbXBCdWZmZXJbMF0ueiA9IGZhbHNlO1xuICAgIH1cbiAgICByZXR1cm4gdGVtcEJ1ZmZlcjtcbn1cbmZ1bmN0aW9uIGludGVycHJldFBhdXNlKHBhdXNlMCwgcGF1c2UxKSB7XG4gICAgaWYgKHBhdXNlMCAmJiAhcGF1c2UxKSB7XG4gICAgICAgIGlmIChleHBvcnRzLmdhbWVNb2RlID09IDMgfHwgZXhwb3J0cy5nYW1lTW9kZSA9PSA1KSB7XG4gICAgICAgICAgICBleHBvcnRzLnBsYXlpbmcgXj0gdHJ1ZTtcbiAgICAgICAgICAgIGlmICghZXhwb3J0cy5wbGF5aW5nKSB7XG4gICAgICAgICAgICAgICAgc2Z4XzEuc291bmRzLnBhdXNlLnBsYXkoKTtcbiAgICAgICAgICAgICAgICBjaGFuZ2VWb2x1bWUobXVzaWNfMS5NdXNpY01hbmFnZXIsIGF1ZGlvbWVudV8xLm1hc3RlclZvbHVtZVsxXSAqIDAuMywgMSk7XG4gICAgICAgICAgICAgICAgKDAsIHJlbmRlcl8xLnJlbmRlckZvcmVncm91bmQpKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBjaGFuZ2VWb2x1bWUobXVzaWNfMS5NdXNpY01hbmFnZXIsIGF1ZGlvbWVudV8xLm1hc3RlclZvbHVtZVsxXSwgMSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59XG5leHBvcnRzLmJnMSA9IDA7XG5leHBvcnRzLmJnMiA9IDA7XG5leHBvcnRzLmZnMSA9IDA7XG5leHBvcnRzLmZnMiA9IDA7XG5leHBvcnRzLnVpID0gMDtcbmV4cG9ydHMuYyA9IDA7XG5leHBvcnRzLmNhbnZhc01haW4gPSAwO1xuZXhwb3J0cy5sYXllcnMgPSB7XG4gICAgQkcxOiBudWxsLFxuICAgIEJHMjogbnVsbCxcbiAgICBGRzE6IG51bGwsXG4gICAgRkcyOiBudWxsLFxuICAgIFVJOiBudWxsXG59O1xuZXhwb3J0cy5sYXllclN3aXRjaGVzID0ge1xuICAgIEJHMTogdHJ1ZSxcbiAgICBCRzI6IHRydWUsXG4gICAgRkcxOiB0cnVlLFxuICAgIEZHMjogdHJ1ZSxcbiAgICBVSTogdHJ1ZVxufTtcbmZ1bmN0aW9uIHJlbmRlclRvTWFpbigpIHtcbiAgICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKGV4cG9ydHMubGF5ZXJzKTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGtleXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYgKGV4cG9ydHMubGF5ZXJTd2l0Y2hlc1trZXlzW2ldXSkge1xuICAgICAgICAgICAgZXhwb3J0cy5jLmRyYXdJbWFnZShleHBvcnRzLmxheWVyc1trZXlzW2ldXSwgMCwgMCk7XG4gICAgICAgIH1cbiAgICB9XG59XG5mdW5jdGlvbiB1cGRhdGUoaSwgaW5wdXRCdWZmZXJzKSB7XG4gICAgaWYgKCFleHBvcnRzLnN0YXJ0aW5nKSB7XG4gICAgICAgIGlmIChleHBvcnRzLmN1cnJlbnRQbGF5ZXJzW2ldICE9IC0xKSB7XG4gICAgICAgICAgICBpZiAoZXhwb3J0cy5wbGF5ZXJUeXBlW2ldID09IDApIHtcbiAgICAgICAgICAgICAgICAvLyBkbyBub3RoaW5nLCB1c2UgdGhlIHByb3ZpZGVkIHBsYXllciBpIGlucHV0c1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoZXhwb3J0cy5wbGF5ZXJUeXBlW2ldID09PSAxKSB7XG4gICAgICAgICAgICAgICAgaWYgKGV4cG9ydHMucGxheWVyW2ldLmFjdGlvblN0YXRlICE9IFwiU0xFRVBcIikge1xuICAgICAgICAgICAgICAgICAgICAoMCwgYWlfMS5ydW5BSSkoaSk7IC8vIG5vIG5lZWQgdG8gcmV0dXJuIGlucHV0IHNpbmNlIHBvbGxpbmcgcmV0dXJucyBhaSBpbnB1dCBpZiB0aGV5IGFyZSBhY3RpdmVcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgKDAsIHBoeXNpY3NfMS5waHlzaWNzKShpLCBpbnB1dEJ1ZmZlcnMpO1xufVxubGV0IGRlbHRhID0gMDtcbmxldCBsYXN0RnJhbWVUaW1lTXMgPSAwO1xubGV0IGxhc3RVcGRhdGUgPSBwZXJmb3JtYW5jZS5ub3coKTtcbmZ1bmN0aW9uIGdhbWVUaWNrKG9sZElucHV0QnVmZmVycykge1xuICAgIHZhciBzdGFydCA9IHBlcmZvcm1hbmNlLm5vdygpO1xuICAgIHZhciBkaWZmID0gMDtcbiAgICBsZXQgaW5wdXQgPSBbKDAsIGlucHV0XzEubnVsbElucHV0cykoKSwgKDAsIGlucHV0XzEubnVsbElucHV0cykoKSwgKDAsIGlucHV0XzEubnVsbElucHV0cykoKSwgKDAsIGlucHV0XzEubnVsbElucHV0cykoKV07XG4gICAgaWYgKGV4cG9ydHMuZ2FtZU1vZGUgPT0gMCB8fCBleHBvcnRzLmdhbWVNb2RlID09IDIwKSB7XG4gICAgICAgIGZpbmRQbGF5ZXJzKCk7XG4gICAgfVxuICAgIGVsc2UgaWYgKGV4cG9ydHMuZ2FtZU1vZGUgPT0gMSkge1xuICAgICAgICAvL2NvbnNvbGUubG9nKHBsYXllclR5cGUpO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGV4cG9ydHMucG9ydHM7IGkrKykge1xuICAgICAgICAgICAgaW5wdXRbaV0gPSBpbnRlcnByZXRJbnB1dHMoaSwgdHJ1ZSwgZXhwb3J0cy5wbGF5ZXJUeXBlW2ldLCBvbGRJbnB1dEJ1ZmZlcnNbaV0pO1xuICAgICAgICAgICAgKDAsIG1lbnVfMS5tZW51TW92ZSkoaSwgaW5wdXQpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2UgaWYgKGV4cG9ydHMuZ2FtZU1vZGUgPT0gMTApIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBleHBvcnRzLnBvcnRzOyBpKyspIHtcbiAgICAgICAgICAgIGlucHV0W2ldID0gaW50ZXJwcmV0SW5wdXRzKGksIHRydWUsIGV4cG9ydHMucGxheWVyVHlwZVtpXSwgb2xkSW5wdXRCdWZmZXJzW2ldKTtcbiAgICAgICAgICAgICgwLCBhdWRpb21lbnVfMS5hdWRpb01lbnVDb250cm9scykoaSwgaW5wdXQpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2UgaWYgKGV4cG9ydHMuZ2FtZU1vZGUgPT0gMTEpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBleHBvcnRzLnBvcnRzOyBpKyspIHtcbiAgICAgICAgICAgIGlucHV0W2ldID0gaW50ZXJwcmV0SW5wdXRzKGksIHRydWUsIGV4cG9ydHMucGxheWVyVHlwZVtpXSwgb2xkSW5wdXRCdWZmZXJzW2ldKTtcbiAgICAgICAgICAgICgwLCBnYW1lcGxheW1lbnVfMS5nYW1lcGxheU1lbnVDb250cm9scykoaSwgaW5wdXQpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2UgaWYgKGV4cG9ydHMuZ2FtZU1vZGUgPT0gMTIpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBleHBvcnRzLnBvcnRzOyBpKyspIHtcbiAgICAgICAgICAgIGlucHV0W2ldID0gaW50ZXJwcmV0SW5wdXRzKGksIHRydWUsIGV4cG9ydHMucGxheWVyVHlwZVtpXSwgb2xkSW5wdXRCdWZmZXJzW2ldKTtcbiAgICAgICAgICAgICgwLCBrZXlib2FyZG1lbnVfMS5rZXlib2FyZE1lbnVDb250cm9scykoaSwgaW5wdXQpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2UgaWYgKGV4cG9ydHMuZ2FtZU1vZGUgPT0gMTMpIHtcbiAgICAgICAgLy90YXJnZXRcbiAgICB9XG4gICAgZWxzZSBpZiAoZXhwb3J0cy5nYW1lTW9kZSA9PSAxNCkge1xuICAgICAgICAvLyBjb250cm9sbGVyIGNhbGlicmF0aW9uXG4gICAgICAgIGlucHV0W2V4cG9ydHMuY2FsaWJyYXRpb25QbGF5ZXJdID0gaW50ZXJwcmV0SW5wdXRzKGV4cG9ydHMuY2FsaWJyYXRpb25QbGF5ZXIsIHRydWUsIGV4cG9ydHMucGxheWVyVHlwZVtleHBvcnRzLmNhbGlicmF0aW9uUGxheWVyXSwgb2xkSW5wdXRCdWZmZXJzW2V4cG9ydHMuY2FsaWJyYXRpb25QbGF5ZXJdKTtcbiAgICB9XG4gICAgZWxzZSBpZiAoZXhwb3J0cy5nYW1lTW9kZSA9PSAxNSkge1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGV4cG9ydHMucG9ydHM7IGkrKykge1xuICAgICAgICAgICAgaW5wdXRbaV0gPSBpbnRlcnByZXRJbnB1dHMoaSwgdHJ1ZSwgZXhwb3J0cy5wbGF5ZXJUeXBlW2ldLCBvbGRJbnB1dEJ1ZmZlcnNbaV0pO1xuICAgICAgICAgICAgKDAsIG1lbnVfMS5tZW51TW92ZSkoaSwgaW5wdXQpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2UgaWYgKGV4cG9ydHMuZ2FtZU1vZGUgPT0gMikge1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IDQ7IGkrKykge1xuICAgICAgICAgICAgaWYgKGkgPCBleHBvcnRzLnBvcnRzKSB7XG4gICAgICAgICAgICAgICAgaW5wdXRbaV0gPSBpbnRlcnByZXRJbnB1dHMoaSwgdHJ1ZSwgZXhwb3J0cy5wbGF5ZXJUeXBlW2ldLCBvbGRJbnB1dEJ1ZmZlcnNbaV0pO1xuICAgICAgICAgICAgICAgICgwLCBjc3NfMS5jc3NDb250cm9scykoaSwgaW5wdXQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYWN0aW9uU3RhdGVTaG9ydGN1dHNfMS5hY3Rpb25TdGF0ZXNbZXhwb3J0cy5jaGFyYWN0ZXJTZWxlY3Rpb25zW2ldXVtleHBvcnRzLnBsYXllcltpXS5hY3Rpb25TdGF0ZV0ubWFpbihpLCBpbnB1dCk7XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCA0OyBpKyspIHtcbiAgICAgICAgICAgIGlmIChleHBvcnRzLnBsYXllclR5cGVbaV0gPiAtMSkge1xuICAgICAgICAgICAgICAgICgwLCBoaXREZXRlY3Rpb25fMS5oaXREZXRlY3QpKGksIGlucHV0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAoMCwgaGl0RGV0ZWN0aW9uXzEuZXhlY3V0ZUhpdHMpKGlucHV0KTtcbiAgICAgICAgKDAsIGhpdERldGVjdGlvbl8xLnJlc2V0SGl0UXVldWUpKCk7XG4gICAgICAgIGZpbmRQbGF5ZXJzKCk7XG4gICAgfVxuICAgIGVsc2UgaWYgKGV4cG9ydHMuZ2FtZU1vZGUgPT0gNikge1xuICAgICAgICAvLyBzdGFnZSBzZWxlY3RcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCA0OyBpKyspIHtcbiAgICAgICAgICAgIGlmIChpIDwgZXhwb3J0cy5wb3J0cykge1xuICAgICAgICAgICAgICAgIGlucHV0W2ldID0gaW50ZXJwcmV0SW5wdXRzKGksIHRydWUsIGV4cG9ydHMucGxheWVyVHlwZVtpXSwgb2xkSW5wdXRCdWZmZXJzW2ldKTtcbiAgICAgICAgICAgICAgICAoMCwgc3RhZ2VzZWxlY3RfMS5zc3NDb250cm9scykoaSwgaW5wdXQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2UgaWYgKGV4cG9ydHMucGxheWluZyB8fCBleHBvcnRzLmZyYW1lQnlGcmFtZSkge1xuICAgICAgICAvL2NvbnNvbGUubG9nKFwidGVzdDBcIik7XG4gICAgICAgIC8qZGVsdGEgPSB0aW1lc3RhbXAgLSBsYXN0RnJhbWVUaW1lTXM7IC8vIGdldCB0aGUgZGVsdGEgdGltZSBzaW5jZSBsYXN0IGZyYW1lXG4gICAgICAgIGxhc3RGcmFtZVRpbWVNcyA9IHRpbWVzdGFtcDtcbiAgICAgICAgY29uc29sZS5sb2coZGVsdGEpOyovXG4gICAgICAgIHZhciBub3cgPSBwZXJmb3JtYW5jZS5ub3coKTtcbiAgICAgICAgdmFyIGR0ID0gbm93IC0gbGFzdFVwZGF0ZTtcbiAgICAgICAgLy9jb25zb2xlLmxvZyhub3cpO1xuICAgICAgICAvL2NvbnNvbGUubG9nKGR0KTtcbiAgICAgICAgbGFzdFVwZGF0ZSA9IG5vdztcbiAgICAgICAgKDAsIGhpdERldGVjdGlvbl8xLnJlc2V0SGl0UXVldWUpKCk7XG4gICAgICAgICgwLCBhY3RpdmVTdGFnZV8xLmdldEFjdGl2ZVN0YWdlKSgpLm1vdmluZ1BsYXRmb3JtcygpO1xuICAgICAgICAoMCwgYXJ0aWNsZV8xLmRlc3Ryb3lBcnRpY2xlcykoKTtcbiAgICAgICAgKDAsIGFydGljbGVfMS5leGVjdXRlQXJ0aWNsZXMpKCk7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgNDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAoZXhwb3J0cy5wbGF5ZXJUeXBlW2ldID4gLTEpIHtcbiAgICAgICAgICAgICAgICBpZiAoIWV4cG9ydHMuc3RhcnRpbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgaW5wdXRbaV0gPSBpbnRlcnByZXRJbnB1dHMoaSwgdHJ1ZSwgZXhwb3J0cy5wbGF5ZXJUeXBlW2ldLCBvbGRJbnB1dEJ1ZmZlcnNbaV0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB1cGRhdGUoaSwgaW5wdXQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgICgwLCBoaXREZXRlY3Rpb25fMS5jaGVja1BoYW50b21zKSgpO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IDQ7IGkrKykge1xuICAgICAgICAgICAgaWYgKGV4cG9ydHMucGxheWVyVHlwZVtpXSA+IC0xKSB7XG4gICAgICAgICAgICAgICAgKDAsIGhpdERldGVjdGlvbl8xLmhpdERldGVjdCkoaSwgaW5wdXQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgICgwLCBoaXREZXRlY3Rpb25fMS5leGVjdXRlSGl0cykoaW5wdXQpO1xuICAgICAgICAoMCwgYXJ0aWNsZV8xLmFydGljbGVzSGl0RGV0ZWN0aW9uKSgpO1xuICAgICAgICAoMCwgYXJ0aWNsZV8xLmV4ZWN1dGVBcnRpY2xlSGl0cykoaW5wdXQpO1xuICAgICAgICBpZiAoIWV4cG9ydHMuc3RhcnRpbmcgJiYgIWV4cG9ydHMudmVyc3VzTW9kZSkge1xuICAgICAgICAgICAgbWF0Y2hUaW1lclRpY2soaW5wdXQpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgZXhwb3J0cy5zdGFydFRpbWVyIC09IDAuMDE2NjY2Njc7XG4gICAgICAgICAgICBpZiAoZXhwb3J0cy5zdGFydFRpbWVyIDwgMCkge1xuICAgICAgICAgICAgICAgIGV4cG9ydHMuc3RhcnRpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoZXhwb3J0cy5mcmFtZUJ5RnJhbWUpIHtcbiAgICAgICAgICAgIGV4cG9ydHMuZnJhbWVCeUZyYW1lUmVuZGVyID0gdHJ1ZTtcbiAgICAgICAgICAgIGV4cG9ydHMud2FzRnJhbWVCeUZyYW1lID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBleHBvcnRzLmZyYW1lQnlGcmFtZSA9IGZhbHNlO1xuICAgICAgICBpZiAoZXhwb3J0cy5zaG93RGVidWcpIHtcbiAgICAgICAgICAgIGRpZmYgPSBwZXJmb3JtYW5jZS5ub3coKSAtIHN0YXJ0O1xuICAgICAgICAgICAgZXhwb3J0cy5nYW1lbG9naWNUaW1lWzBdICs9IGRpZmY7XG4gICAgICAgICAgICBleHBvcnRzLmdhbWVsb2dpY1RpbWVbMF0gLz0gMjtcbiAgICAgICAgICAgIGlmIChkaWZmID49IDEwKSB7XG4gICAgICAgICAgICAgICAgZXhwb3J0cy5nYW1lbG9naWNUaW1lWzNdKys7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZGlmZiA8IGV4cG9ydHMuZ2FtZWxvZ2ljVGltZVsyXSkge1xuICAgICAgICAgICAgICAgIGV4cG9ydHMuZ2FtZWxvZ2ljVGltZVsyXSA9IGRpZmY7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZGlmZiA+IGV4cG9ydHMuZ2FtZWxvZ2ljVGltZVsxXSkge1xuICAgICAgICAgICAgICAgIGV4cG9ydHMuZ2FtZWxvZ2ljVGltZVsxXSA9IGRpZmY7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBkb20uZ2FtZWxvZ2ljQXZnLmlubmVySFRNTCA9IE1hdGgucm91bmQoZXhwb3J0cy5nYW1lbG9naWNUaW1lWzBdKTtcbiAgICAgICAgICAgIGRvbS5nYW1lbG9naWNIaWdoLmlubmVySFRNTCA9IE1hdGgucm91bmQoZXhwb3J0cy5nYW1lbG9naWNUaW1lWzFdKTtcbiAgICAgICAgICAgIGRvbS5nYW1lbG9naWNMb3cuaW5uZXJIVE1MID0gTWF0aC5yb3VuZChleHBvcnRzLmdhbWVsb2dpY1RpbWVbMl0pO1xuICAgICAgICAgICAgZG9tLmdhbWVsb2dpY1BlYWsuaW5uZXJIVE1MID0gZXhwb3J0cy5nYW1lbG9naWNUaW1lWzNdO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2UgaWYgKGV4cG9ydHMuZmluZGluZ1BsYXllcnMpIHtcbiAgICAgICAgZmluZFBsYXllcnMoKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGlmICghZXhwb3J0cy5nYW1lRW5kKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IDQ7IGkrKykge1xuICAgICAgICAgICAgICAgIGlmIChleHBvcnRzLnBsYXllclR5cGVbaV0gPT0gMCB8fCBleHBvcnRzLnBsYXllclR5cGVbaV0gPT0gMikge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZXhwb3J0cy5jdXJyZW50UGxheWVyc1tpXSAhPSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaW5wdXRbaV0gPSBpbnRlcnByZXRJbnB1dHMoaSwgZmFsc2UsIGV4cG9ydHMucGxheWVyVHlwZVtpXSwgb2xkSW5wdXRCdWZmZXJzW2ldKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICAvKlxuICBcbiAgICB2YXIgYmVmb3JlV2FzdGVyID0gcGVyZm9ybWFuY2Uubm93KCk7XG4gICAgLy8gbmVlZWQgdG8gd2FzdGUgMC42NjZtc1xuICAgIHZhciB0aW1lV2FzdGVkID0gZmFsc2U7XG4gICAgdmFyIHQgPSAwO1xuICAgIHZhciBvID0gcGVyZm9ybWFuY2Uubm93KCk7XG4gICAgd2hpbGUoIXRpbWVXYXN0ZWQpe1xuICAgICAgdmFyIG4gPSBwZXJmb3JtYW5jZS5ub3coKTtcbiAgICAgIHQgKz0gbiAtIG87XG4gICAgICAvL2NvbnNvbGUubG9nKHQpO1xuICAgICAgaWYgKHQgPiAwLjY2NjYpe1xuICAgICAgICB0aW1lV2FzdGVkID0gdHJ1ZTtcbiAgICAgIH1cbiAgICAgIG8gPSBuO1xuICAgICAgLy9jb25zb2xlLmxvZyhcIi5cIik7XG4gICAgfVxuICAgIC8vY29uc29sZS5sb2cocGVyZm9ybWFuY2Uubm93KCkgLSBiZWZvcmVXYXN0ZXIpOyovXG4gICAgKDAsIHJlcGxheV8xLnNhdmVHYW1lU3RhdGUpKGlucHV0LCBleHBvcnRzLnBvcnRzKTtcbiAgICBzZXRUaW1lb3V0KGdhbWVUaWNrLCAxNiwgaW5wdXQpO1xufVxuZnVuY3Rpb24gY2xlYXJTY3JlZW4oKSB7XG4gICAgLy9iZzEuZmlsbFN0eWxlID0gXCJyZ2IoMCwgMCwgMClcIjtcbiAgICAvL2JnMS5maWxsUmVjdCgwLDAsbGF5ZXJzLkJHMS53aWR0aCxsYXllcnMuQkcxLmhlaWdodCk7XG4gICAgZXhwb3J0cy5iZzIuY2xlYXJSZWN0KDAsIDAsIGV4cG9ydHMubGF5ZXJzLkJHMi53aWR0aCwgZXhwb3J0cy5sYXllcnMuQkcyLmhlaWdodCk7XG4gICAgLy9mZzEuY2xlYXJSZWN0KDAsMCxsYXllcnMuRkcxLndpZHRoLGxheWVycy5GRzEuaGVpZ2h0KTtcbiAgICBleHBvcnRzLmZnMi5jbGVhclJlY3QoMCwgMCwgZXhwb3J0cy5sYXllcnMuRkcyLndpZHRoLCBleHBvcnRzLmxheWVycy5GRzIuaGVpZ2h0KTtcbiAgICBleHBvcnRzLnVpLmNsZWFyUmVjdCgwLCAwLCBleHBvcnRzLmxheWVycy5VSS53aWR0aCwgZXhwb3J0cy5sYXllcnMuVUkuaGVpZ2h0KTtcbn1cbmxldCBvdGhlckZyYW1lID0gdHJ1ZTtcbmxldCBmcHMzMCA9IGZhbHNlO1xuZnVuY3Rpb24gcmVuZGVyVGljaygpIHtcbiAgICB3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lKHJlbmRlclRpY2spO1xuICAgIG90aGVyRnJhbWUgXj0gdHJ1ZTtcbiAgICBpZiAoKGZwczMwICYmIG90aGVyRnJhbWUpIHx8ICFmcHMzMCkge1xuICAgICAgICAvL2NvbnNvbGUubG9nKFwiLS0tLS0tXCIpO1xuICAgICAgICBpZiAoZXhwb3J0cy5nYW1lTW9kZSA9PSAyMCkge1xuICAgICAgICAgICAgKDAsIHN0YXJ0dXBfMS5kcmF3U3RhcnRVcCkoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChleHBvcnRzLmdhbWVNb2RlID09IDEwKSB7XG4gICAgICAgICAgICAoMCwgYXVkaW9tZW51XzEuZHJhd0F1ZGlvTWVudSkoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChleHBvcnRzLmdhbWVNb2RlID09IDExKSB7XG4gICAgICAgICAgICAoMCwgZ2FtZXBsYXltZW51XzEuZHJhd0dhbWVwbGF5TWVudSkoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChleHBvcnRzLmdhbWVNb2RlID09IDEyKSB7XG4gICAgICAgICAgICAoMCwga2V5Ym9hcmRtZW51XzEuZHJhd0tleWJvYXJkTWVudSkoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChleHBvcnRzLmdhbWVNb2RlID09IDEzKSB7XG4gICAgICAgICAgICAvLyBkcmF3Q3JlZGl0cygpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGV4cG9ydHMuZ2FtZU1vZGUgPT0gMTQpIHtcbiAgICAgICAgICAgICgwLCBjb250cm9sbGVybWVudV8xLmRyYXdDb250cm9sbGVyTWVudSkoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChleHBvcnRzLmdhbWVNb2RlID09IDApIHtcbiAgICAgICAgICAgICgwLCBzdGFydHNjcmVlbl8xLmRyYXdTdGFydFNjcmVlbikoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChleHBvcnRzLmdhbWVNb2RlID09IDEpIHtcbiAgICAgICAgICAgICgwLCBtZW51XzEuZHJhd01haW5NZW51KSgpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGV4cG9ydHMuZ2FtZU1vZGUgPT0gMikge1xuICAgICAgICAgICAgKDAsIGNzc18xLmRyYXdDU1MpKCk7XG4gICAgICAgICAgICAvL3JlbmRlclZmeCgpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGV4cG9ydHMuZ2FtZU1vZGUgPT0gNikge1xuICAgICAgICAgICAgKDAsIHN0YWdlc2VsZWN0XzEuZHJhd1NTUykoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChleHBvcnRzLnBsYXlpbmcgfHwgZXhwb3J0cy5mcmFtZUJ5RnJhbWVSZW5kZXIpIHtcbiAgICAgICAgICAgIC8qZGVsdGEgPSB0aW1lc3RhbXAgLSBsYXN0RnJhbWVUaW1lTXM7IC8vIGdldCB0aGUgZGVsdGEgdGltZSBzaW5jZSBsYXN0IGZyYW1lXG4gICAgICAgICAgICBsYXN0RnJhbWVUaW1lTXMgPSB0aW1lc3RhbXA7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhkZWx0YSk7Ki9cbiAgICAgICAgICAgIC8vY29uc29sZS5sb2coXCJ0ZXN0MlwiKTtcbiAgICAgICAgICAgIHZhciByU3RhcnQgPSBwZXJmb3JtYW5jZS5ub3coKTtcbiAgICAgICAgICAgIGNsZWFyU2NyZWVuKCk7XG4gICAgICAgICAgICBpZiAoKDAsIHZmeF8xLmlzU2hvd1NGWCkoKSkge1xuICAgICAgICAgICAgICAgICgwLCBzdGFnZXJlbmRlcl8xLmRyYXdCYWNrZ3JvdW5kKSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgKDAsIHN0YWdlcmVuZGVyXzEuZHJhd1N0YWdlKSgpO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCA0OyBpKyspIHtcbiAgICAgICAgICAgICAgICBpZiAoZXhwb3J0cy5wbGF5ZXJUeXBlW2ldID4gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgKDAsIHJlbmRlcl8xLnJlbmRlclBsYXllcikoaSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgKDAsIGFydGljbGVfMS5yZW5kZXJBcnRpY2xlcykoKTtcbiAgICAgICAgICAgICgwLCByZW5kZXJWZnhfMS5yZW5kZXJWZngpKCk7XG4gICAgICAgICAgICAoMCwgcmVuZGVyXzEucmVuZGVyT3ZlcmxheSkodHJ1ZSk7XG4gICAgICAgICAgICBpZiAoZXhwb3J0cy5zaG93RGVidWcpIHtcbiAgICAgICAgICAgICAgICB2YXIgZGlmZiA9IHBlcmZvcm1hbmNlLm5vdygpIC0gclN0YXJ0O1xuICAgICAgICAgICAgICAgIGV4cG9ydHMucmVuZGVyVGltZVswXSArPSBkaWZmO1xuICAgICAgICAgICAgICAgIGV4cG9ydHMucmVuZGVyVGltZVswXSAvPSAyO1xuICAgICAgICAgICAgICAgIGlmIChkaWZmID49IDEwKSB7XG4gICAgICAgICAgICAgICAgICAgIGV4cG9ydHMucmVuZGVyVGltZVszXSsrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoZGlmZiA+IGV4cG9ydHMucmVuZGVyVGltZVsxXSkge1xuICAgICAgICAgICAgICAgICAgICBleHBvcnRzLnJlbmRlclRpbWVbMV0gPSBkaWZmO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoZGlmZiA8IGV4cG9ydHMucmVuZGVyVGltZVsyXSkge1xuICAgICAgICAgICAgICAgICAgICBleHBvcnRzLnJlbmRlclRpbWVbMl0gPSBkaWZmO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBkb20ucmVuZGVyQXZnLmlubmVySFRNTCA9IE1hdGgucm91bmQoZXhwb3J0cy5yZW5kZXJUaW1lWzBdKTtcbiAgICAgICAgICAgICAgICBkb20ucmVuZGVySGlnaC5pbm5lckhUTUwgPSBNYXRoLnJvdW5kKGV4cG9ydHMucmVuZGVyVGltZVsxXSk7XG4gICAgICAgICAgICAgICAgZG9tLnJlbmRlckxvdy5pbm5lckhUTUwgPSBNYXRoLnJvdW5kKGV4cG9ydHMucmVuZGVyVGltZVsyXSk7XG4gICAgICAgICAgICAgICAgZG9tLnJlbmRlclBlYWsuaW5uZXJIVE1MID0gZXhwb3J0cy5yZW5kZXJUaW1lWzNdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChleHBvcnRzLmZyYW1lQnlGcmFtZVJlbmRlcikge1xuICAgICAgICAgICAgKDAsIHJlbmRlcl8xLnJlbmRlckZvcmVncm91bmQpKCk7XG4gICAgICAgIH1cbiAgICAgICAgZXhwb3J0cy5mcmFtZUJ5RnJhbWVSZW5kZXIgPSBmYWxzZTtcbiAgICAgICAgLy9yZW5kZXJUb01haW4oKTtcbiAgICAgICAgLy9jb25zb2xlLmxvZyhwZXJmb3JtYW5jZS5ub3coKSk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBpZiAoZXhwb3J0cy5wbGF5aW5nKSB7XG4gICAgICAgICAgICAoMCwgcmVuZGVyVmZ4XzEucmVuZGVyVmZ4KSh0cnVlKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbmZ1bmN0aW9uIGJ1aWxkUGxheWVyT2JqZWN0KGkpIHtcbiAgICBleHBvcnRzLnBsYXllcltpXSA9IG5ldyBwbGF5ZXJfMS5wbGF5ZXJPYmplY3QoZXhwb3J0cy5jaGFyYWN0ZXJTZWxlY3Rpb25zW2ldLCBleHBvcnRzLnN0YXJ0aW5nUG9pbnRbaV0sIGV4cG9ydHMuc3RhcnRpbmdGYWNlW2ldKTtcbiAgICBleHBvcnRzLnBsYXllcltpXS5waHlzLkVDQjEgPSBbbmV3IFZlYzJEXzEuVmVjMkQoZXhwb3J0cy5zdGFydGluZ1BvaW50W2ldLngsIGV4cG9ydHMuc3RhcnRpbmdQb2ludFtpXS55KSwgbmV3IFZlYzJEXzEuVmVjMkQoZXhwb3J0cy5zdGFydGluZ1BvaW50W2ldLngsIGV4cG9ydHMuc3RhcnRpbmdQb2ludFtpXS55KSwgbmV3IFZlYzJEXzEuVmVjMkQoZXhwb3J0cy5zdGFydGluZ1BvaW50W2ldLngsIGV4cG9ydHMuc3RhcnRpbmdQb2ludFtpXS55KSwgbmV3IFZlYzJEXzEuVmVjMkQoZXhwb3J0cy5zdGFydGluZ1BvaW50W2ldLngsIGV4cG9ydHMuc3RhcnRpbmdQb2ludFtpXS55KV07XG4gICAgZXhwb3J0cy5wbGF5ZXJbaV0ucGh5cy5FQ0JwID0gW25ldyBWZWMyRF8xLlZlYzJEKGV4cG9ydHMuc3RhcnRpbmdQb2ludFtpXS54LCBleHBvcnRzLnN0YXJ0aW5nUG9pbnRbaV0ueSksIG5ldyBWZWMyRF8xLlZlYzJEKGV4cG9ydHMuc3RhcnRpbmdQb2ludFtpXS54LCBleHBvcnRzLnN0YXJ0aW5nUG9pbnRbaV0ueSksIG5ldyBWZWMyRF8xLlZlYzJEKGV4cG9ydHMuc3RhcnRpbmdQb2ludFtpXS54LCBleHBvcnRzLnN0YXJ0aW5nUG9pbnRbaV0ueSksIG5ldyBWZWMyRF8xLlZlYzJEKGV4cG9ydHMuc3RhcnRpbmdQb2ludFtpXS54LCBleHBvcnRzLnN0YXJ0aW5nUG9pbnRbaV0ueSldO1xuICAgIGV4cG9ydHMucGxheWVyW2ldLmRpZmZpY3VsdHkgPSBleHBvcnRzLmNwdURpZmZpY3VsdHlbaV07XG59XG5mdW5jdGlvbiBpbml0aWFsaXplUGxheWVycyhpLCB0YXJnZXQpIHtcbiAgICBidWlsZFBsYXllck9iamVjdChpKTtcbiAgICBpZiAodGFyZ2V0KSB7XG4gICAgICAgICgwLCBkcmF3VmZ4XzEuZHJhd1ZmeCkoe1xuICAgICAgICAgICAgbmFtZTogXCJlbnRyYW5jZVwiLFxuICAgICAgICAgICAgcG9zOiBuZXcgVmVjMkRfMS5WZWMyRChhY3RpdmVTdGFnZV8xLmFjdGl2ZVN0YWdlLnN0YXJ0aW5nUG9pbnRbMF0ueCwgYWN0aXZlU3RhZ2VfMS5hY3RpdmVTdGFnZS5zdGFydGluZ1BvaW50WzBdLnkpXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgKDAsIGRyYXdWZnhfMS5kcmF3VmZ4KSh7XG4gICAgICAgICAgICBuYW1lOiBcImVudHJhbmNlXCIsXG4gICAgICAgICAgICBwb3M6IG5ldyBWZWMyRF8xLlZlYzJEKGV4cG9ydHMuc3RhcnRpbmdQb2ludFtpXVswXSwgZXhwb3J0cy5zdGFydGluZ1BvaW50W2ldWzFdKVxuICAgICAgICB9KTtcbiAgICB9XG59XG5mdW5jdGlvbiBzdGFydEdhbWUoKSB7XG4gICAgKDAsIGFjdGl2ZVN0YWdlXzEuc2V0VnNTdGFnZSkoZXhwb3J0cy5zdGFnZVNlbGVjdCk7XG4gICAgKDAsIHN0YWdlcmVuZGVyXzEuc2V0QmFja2dyb3VuZFR5cGUpKE1hdGgucm91bmQoTWF0aC5yYW5kb20oKSkpO1xuICAgIGNoYW5nZUdhbWVtb2RlKDMpO1xuICAgICgwLCB2ZnhRdWV1ZV8xLnJlc2V0VmZ4UXVldWUpKCk7XG4gICAgZm9yICh2YXIgbiA9IDA7IG4gPCA0OyBuKyspIHtcbiAgICAgICAgaWYgKGV4cG9ydHMucGxheWVyVHlwZVtuXSA+IC0xKSB7XG4gICAgICAgICAgICBpbml0aWFsaXplUGxheWVycyhuLCBmYWxzZSk7XG4gICAgICAgICAgICAoMCwgcmVuZGVyXzEucmVuZGVyUGxheWVyKShuKTtcbiAgICAgICAgICAgIGV4cG9ydHMucGxheWVyW25dLmluQ1NTID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGV4cG9ydHMudmVyc3VzTW9kZSkge1xuICAgICAgICAgICAgZXhwb3J0cy5wbGF5ZXJbbl0uc3RvY2tzID0gMTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBleHBvcnRzLm1hdGNoVGltZXIgPSA0ODA7XG4gICAgZXhwb3J0cy5zdGFydFRpbWVyID0gMS41O1xuICAgIGV4cG9ydHMuc3RhcnRpbmcgPSB0cnVlO1xuICAgIG11c2ljXzEuTXVzaWNNYW5hZ2VyLnN0b3BXaGF0aXNQbGF5aW5nKCk7XG4gICAgc3dpdGNoIChleHBvcnRzLnN0YWdlU2VsZWN0KSB7XG4gICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgIG11c2ljXzEuTXVzaWNNYW5hZ2VyLnBsYXlCYXR0bGVGaWVsZExvb3AoKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICBtdXNpY18xLk11c2ljTWFuYWdlci5wbGF5eVN0b3J5TG9vcCgpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgIG11c2ljXzEuTXVzaWNNYW5hZ2VyLnBsYXlwU3RhZGl1bUxvb3AoKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICBtdXNpY18xLk11c2ljTWFuYWdlci5wbGF5RHJlYW1MYW5kTG9vcCgpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgIG11c2ljXzEuTXVzaWNNYW5hZ2VyLnBsYXlmaW5hbGRMb29wKCk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSA1OlxuICAgICAgICAgICAgbXVzaWNfMS5NdXNpY01hbmFnZXIucGxheWZvZExvb3AoKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgYnJlYWs7XG4gICAgfVxuICAgICgwLCBkcmF3VmZ4XzEuZHJhd1ZmeCkoe1xuICAgICAgICBuYW1lOiBcInN0YXJ0XCIsXG4gICAgICAgIHBvczogbmV3IFZlYzJEXzEuVmVjMkQoMCwgMClcbiAgICB9KTtcbiAgICBleHBvcnRzLmZpbmRpbmdQbGF5ZXJzID0gZmFsc2U7XG4gICAgZXhwb3J0cy5wbGF5aW5nID0gdHJ1ZTtcbn1cbmZ1bmN0aW9uIGVuZEdhbWUoaW5wdXQpIHtcbiAgICBleHBvcnRzLmdhbWVFbmQgPSBmYWxzZTtcbiAgICAoMCwgcmVuZGVyXzEucmVzZXRMb3N0U3RvY2tRdWV1ZSkoKTtcbiAgICAoMCwgaGl0RGV0ZWN0aW9uXzEuc2V0UGhhbnRvblF1ZXVlKShbXSk7XG4gICAgKDAsIGFydGljbGVfMS5yZXNldEFBcnRpY2xlcykoKTtcbiAgICBtdXNpY18xLk11c2ljTWFuYWdlci5zdG9wV2hhdGlzUGxheWluZygpO1xuICAgIGNoYW5nZVZvbHVtZShtdXNpY18xLk11c2ljTWFuYWdlciwgYXVkaW9tZW51XzEubWFzdGVyVm9sdW1lWzFdLCAxKTtcbiAgICBleHBvcnRzLnBsYXlpbmcgPSBmYWxzZTtcbiAgICBjbGVhclNjcmVlbigpO1xuICAgICgwLCBzdGFnZXJlbmRlcl8xLmRyYXdTdGFnZSkoKTtcbiAgICAoMCwgY3NzXzIuc2V0VG9rZW5Qb3NTbmFwVG9DaGFyKSgwKTtcbiAgICAoMCwgY3NzXzIuc2V0VG9rZW5Qb3NTbmFwVG9DaGFyKSgxKTtcbiAgICAoMCwgY3NzXzIuc2V0VG9rZW5Qb3NTbmFwVG9DaGFyKSgyKTtcbiAgICAoMCwgY3NzXzIuc2V0VG9rZW5Qb3NTbmFwVG9DaGFyKSgzKTtcbiAgICBpZiAoZXhwb3J0cy5nYW1lTW9kZSA9PSAzKSB7XG4gICAgICAgIGNoYW5nZUdhbWVtb2RlKDIpO1xuICAgICAgICBtdXNpY18xLk11c2ljTWFuYWdlci5wbGF5TWVudUxvb3AoKTtcbiAgICAgICAgZXhwb3J0cy5wYXVzZSA9IFtbdHJ1ZSwgdHJ1ZV0sIFt0cnVlLCB0cnVlXSwgW3RydWUsIHRydWVdLCBbdHJ1ZSwgdHJ1ZV1dO1xuICAgICAgICBleHBvcnRzLmZyYW1lQWR2YW5jZSA9IFtcbiAgICAgICAgICAgIFt0cnVlLCB0cnVlXSxcbiAgICAgICAgICAgIFt0cnVlLCB0cnVlXSxcbiAgICAgICAgICAgIFt0cnVlLCB0cnVlXSxcbiAgICAgICAgICAgIFt0cnVlLCB0cnVlXVxuICAgICAgICBdO1xuICAgICAgICBleHBvcnRzLmZpbmRpbmdQbGF5ZXJzID0gdHJ1ZTtcbiAgICAgICAgcG9zaXRpb25QbGF5ZXJzSW5DU1MoKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCA0OyBpKyspIHtcbiAgICAgICAgICAgIGlmIChleHBvcnRzLnBsYXllclR5cGVbaV0gPiAtMSkge1xuICAgICAgICAgICAgICAgIGlmIChleHBvcnRzLnBsYXllcltpXS5hY3Rpb25TdGF0ZSA9PSBcIkZVUkFGVVJBXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgc2Z4XzEuc291bmRzLmZ1cmFsb29wLnN0b3AoZXhwb3J0cy5wbGF5ZXJbaV0uZnVyYUxvb3BJRCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vaW5wdXRbaV1bMF0uYSA9IHRydWU7IC8vIGRvXG4gICAgICAgICAgICAgICAgLy9pbnB1dFtpXVsxXS5hID0gdHJ1ZTsgLy8gbm90XG4gICAgICAgICAgICAgICAgZXhwb3J0cy5wbGF5ZXJbaV0uaW5DU1MgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGV4cG9ydHMucGxheWVyW2ldLnBoeXMuZmFjZSA9IDE7XG4gICAgICAgICAgICAgICAgZXhwb3J0cy5wbGF5ZXJbaV0uYWN0aW9uU3RhdGUgPSBcIldBSVRcIjtcbiAgICAgICAgICAgICAgICBleHBvcnRzLnBsYXllcltpXS50aW1lciA9IDA7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59XG5mdW5jdGlvbiBmaW5pc2hHYW1lKGlucHV0KSB7XG4gICAgZXhwb3J0cy5nYW1lRW5kID0gdHJ1ZTtcbiAgICBleHBvcnRzLnBsYXlpbmcgPSBmYWxzZTtcbiAgICBleHBvcnRzLmZnMi5zYXZlKCk7XG4gICAgZXhwb3J0cy5mZzIudGV4dEFsaWduID0gXCJjZW50ZXJcIjtcbiAgICB2YXIgdGV4dCA9IFwiR2FtZSFcIjtcbiAgICB2YXIgc2l6ZSA9IDMwMDtcbiAgICB2YXIgdGV4dFNjYWxlID0gMTtcbiAgICB2YXIgdGV4dEdyYWQgPSBleHBvcnRzLmZnMi5jcmVhdGVMaW5lYXJHcmFkaWVudCgwLCAyMDAsIDAsIDUyMCk7XG4gICAgaWYgKGV4cG9ydHMubWF0Y2hUaW1lciA8PSAwKSB7XG4gICAgICAgIHRleHQgPSBcIlRpbWUhXCI7XG4gICAgICAgIHNmeF8xLnNvdW5kcy50aW1lLnBsYXkoKTtcbiAgICAgICAgdGV4dEdyYWQuYWRkQ29sb3JTdG9wKDAsIFwiYmxhY2tcIik7XG4gICAgICAgIHRleHRHcmFkLmFkZENvbG9yU3RvcCgwLjUsIFwiYmxhY2tcIik7XG4gICAgICAgIHRleHRHcmFkLmFkZENvbG9yU3RvcCgwLjcsIFwicmdiKDIxLCA1MSwgMTgwKVwiKTtcbiAgICAgICAgdGV4dEdyYWQuYWRkQ29sb3JTdG9wKDEsIFwicmdiKDcxLCA5NCwgMjUwKVwiKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHNmeF8xLnNvdW5kcy5nYW1lLnBsYXkoKTtcbiAgICAgICAgdGV4dEdyYWQuYWRkQ29sb3JTdG9wKDAsIFwiYmxhY2tcIik7XG4gICAgICAgIHRleHRHcmFkLmFkZENvbG9yU3RvcCgwLjQsIFwiYmxhY2tcIik7XG4gICAgICAgIHRleHRHcmFkLmFkZENvbG9yU3RvcCgwLjcsIFwicmdiKDE2NywgMjcsIDQwKVwiKTtcbiAgICAgICAgdGV4dEdyYWQuYWRkQ29sb3JTdG9wKDEsIFwicmdiKDI1NSwgMzEsIDUyKVwiKTtcbiAgICB9XG4gICAgZXhwb3J0cy5mZzIuc2NhbGUoMSwgdGV4dFNjYWxlKTtcbiAgICBleHBvcnRzLmZnMi5maWxsU3R5bGUgPSB0ZXh0R3JhZDtcbiAgICBleHBvcnRzLmZnMi5saW5lV2lkdGggPSA0MDtcbiAgICBleHBvcnRzLmZnMi5zdHJva2VTdHlsZSA9IFwiYmxhY2tcIjtcbiAgICBleHBvcnRzLmZnMi5mb250ID0gXCI5MDAgXCIgKyBzaXplICsgXCJweCBBcmlhbFwiO1xuICAgIGV4cG9ydHMuZmcyLnN0cm9rZVRleHQodGV4dCwgNjAwLCA0NzAgLyB0ZXh0U2NhbGUpO1xuICAgIGV4cG9ydHMuZmcyLmxpbmVXaWR0aCA9IDIwO1xuICAgIGV4cG9ydHMuZmcyLnN0cm9rZVN0eWxlID0gXCJ3aGl0ZVwiO1xuICAgIGV4cG9ydHMuZmcyLmZvbnQgPSBcIjkwMCBcIiArIHNpemUgKyBcInB4IEFyaWFsXCI7XG4gICAgZXhwb3J0cy5mZzIuc3Ryb2tlVGV4dCh0ZXh0LCA2MDAsIDQ3MCAvIHRleHRTY2FsZSk7XG4gICAgZXhwb3J0cy5mZzIuZm9udCA9IFwiOTAwIFwiICsgc2l6ZSArIFwicHggQXJpYWxcIjtcbiAgICBleHBvcnRzLmZnMi5maWxsVGV4dCh0ZXh0LCA2MDAsIDQ3MCAvIHRleHRTY2FsZSk7XG4gICAgZXhwb3J0cy5mZzIucmVzdG9yZSgpO1xuICAgIG11c2ljXzEuTXVzaWNNYW5hZ2VyLnN0b3BXaGF0aXNQbGF5aW5nKCk7XG4gICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgIGVuZEdhbWUoaW5wdXQpO1xuICAgIH0sIDI1MDApO1xufVxuZnVuY3Rpb24gb25GdWxsU2NyZWVuQ2hhbmdlKCkge1xuICAgIHZhciBmdWxsc2NyZWVuRWxlbWVudCA9IGRvY3VtZW50LmZ1bGxzY3JlZW5FbGVtZW50IHx8IGRvY3VtZW50Lm1vekZ1bGxTY3JlZW5FbGVtZW50IHx8IGRvY3VtZW50LndlYmtpdEZ1bGxzY3JlZW5FbGVtZW50O1xuICAgIC8vIGlmIGluIGZ1bGxzY3JlZW4gbW9kZSBmdWxsc2NyZWVuRWxlbWVudCB3b24ndCBiZSBudWxsXG4gICAgdmFyIGNvbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInRvcEJ1dHRvbkNvbnRhaW5lclwiKTtcbiAgICB2YXIgaWNuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi50b3BCdXR0b25cIik7XG4gICAgaWYgKGZ1bGxzY3JlZW5FbGVtZW50ICE9IG51bGwpIHtcbiAgICAgICAgY29udC5zdHlsZS50cmFuc2l0aW9uID0gXCJvcGFjaXR5IDAuNXMgbGluZWFyIDBzXCI7XG4gICAgICAgIGNvbnQuc3R5bGUub3BhY2l0eSA9IDA7XG4gICAgICAgIDtcbiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgaTtcbiAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBpY24ubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBpY25baV0uc3R5bGUuaGVpZ2h0ID0gXCI1cHhcIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnQuc3R5bGUuaGVpZ2h0ID0gXCI1cHhcIjtcbiAgICAgICAgICAgIHJlc2l6ZSgpO1xuICAgICAgICB9LCA1MDApO1xuICAgICAgICAoMCwganF1ZXJ5XzEuZGVmYXVsdCkoXCIja2V5Ym9hcmRQcm9tcHRcIikuaGlkZSgpO1xuICAgICAgICAoMCwganF1ZXJ5XzEuZGVmYXVsdCkoXCIja2V5Ym9hcmRDb250cm9sc0ltZ1wiKS5oaWRlKCk7XG4gICAgICAgICgwLCBqcXVlcnlfMS5kZWZhdWx0KShcIiNjb250cm9sbGVyU3VwcG9ydENvbnRhaW5lclwiKS5oaWRlKCk7XG4gICAgICAgICgwLCBqcXVlcnlfMS5kZWZhdWx0KShcIiNkZWJ1Z0J1dHRvbkVkaXRcIikuZW1wdHkoKS5hcHBlbmQoXCJPRkZcIik7XG4gICAgICAgICgwLCBqcXVlcnlfMS5kZWZhdWx0KShcIiNkZWJ1Z1wiKS5oaWRlKCk7XG4gICAgICAgICgwLCBqcXVlcnlfMS5kZWZhdWx0KShcIiNwbGF5ZXJzXCIpLmhpZGUoKTtcbiAgICAgICAgKDAsIGpxdWVyeV8xLmRlZmF1bHQpKFwiYm9keVwiKS5jc3MoXCJvdmVyZmxvd1wiLCBcImhpZGRlblwiKTtcbiAgICAgICAgc2hvd0hlYWRlciA9IGZhbHNlO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgdmFyIGk7XG4gICAgICAgIGZvciAoaSA9IDA7IGkgPCBpY24ubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGljbltpXS5zdHlsZS5oZWlnaHQgPSBcIjI1cHhcIjtcbiAgICAgICAgfVxuICAgICAgICBjb250LnN0eWxlLmhlaWdodCA9IFwiMzFweFwiO1xuICAgICAgICBjb250LnN0eWxlLnRyYW5zaXRpb24gPSBcIm9wYWNpdHkgMC41cyBsaW5lYXIgMHNcIjtcbiAgICAgICAgY29udC5zdHlsZS5vcGFjaXR5ID0gMTtcbiAgICB9XG59XG5mdW5jdGlvbiBzdGFydCgpIHtcbiAgICBpZiAoZXhwb3J0cy5ob2xpZGF5ID09PSAxKSB7XG4gICAgICAgICgwLCBqcXVlcnlfMS5kZWZhdWx0KShcIiNsYXllckJ1dHRvblwiKS5hZnRlcignPGRpdiBpZD1cInNub3dCdXR0b25cIiBjbGFzcz1cImdhbWVCdXR0b25cIiBzdHlsZT1cIndpZHRoOjkwcHhcIj48aW1nIHNyYz1cImFzc2V0cy9jaHJpc3RtYXMvc25vd2ZsYWtlLnBuZ1wiIGhlaWdodD0xNyB3aWR0aD0xNyBzdHlsZT1cImRpc3BsYXk6aW5saW5lLWJsb2NrXCIvPjxwIHN0eWxlPVwid2lkdGg6MzBweDtkaXNwbGF5OmlubGluZS1ibG9ja1wiPjxzcGFuIGlkPVwic25vd0J1dHRvbkVkaXRcIj4xNTA8L3NwYW4+PC9wPjxkaXYgaWQ9XCJzbm93TWludXNcIiBjbGFzcz1cInNub3dDb250cm9sXCIgc3R5bGU9XCJkaXNwbGF5OmlubGluZS1ibG9jaztwYWRkaW5nOjNweFwiPjxwIHN0eWxlPVwicGFkZGluZzowO2ZvbnQtc2l6ZToyMHB4XCI+LTwvcD48L2Rpdj48ZGl2IGlkPVwic25vd1BsdXNcIiBzdHlsZT1cImRpc3BsYXk6aW5saW5lLWJsb2NrO3BhZGRpbmc6M3B4XCI+PHAgc3R5bGU9XCJwYWRkaW5nOjA7Zm9udC1zaXplOjE3cHhcIj4rPC9wPjwvZGl2PjwvZGl2PicpO1xuICAgIH1cbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IDQ7IGkrKykge1xuICAgICAgICBidWlsZFBsYXllck9iamVjdChpKTtcbiAgICAgICAgZXhwb3J0cy5wbGF5ZXJbaV0ucGh5cy5mYWNlID0gMTtcbiAgICAgICAgZXhwb3J0cy5wbGF5ZXJbaV0uYWN0aW9uU3RhdGUgPSBcIldBSVRcIjtcbiAgICB9XG4gICAgY2FjaGVEb20oKTtcbiAgICAoMCwga2V5Ym9hcmRtZW51XzEuZ2V0S2V5Ym9hcmRDb29raWUpKCk7XG4gICAgZ2l2ZU1lZGFscygpO1xuICAgICgwLCBhdWRpb21lbnVfMS5nZXRBdWRpb0Nvb2tpZXMpKCk7XG4gICAgKDAsIGdhbWVwbGF5bWVudV8xLmdldEdhbWVwbGF5Q29va2llcykoKTtcbiAgICAoMCwganF1ZXJ5XzEuZGVmYXVsdCkoXCIja2V5Ym9hcmRCdXR0b25cIikuY2xpY2soZnVuY3Rpb24gKCkge1xuICAgICAgICAoMCwganF1ZXJ5XzEuZGVmYXVsdCkoXCIja2V5Ym9hcmRDb250cm9sc0ltZ1wiKS50b2dnbGUoKTtcbiAgICAgICAgKDAsIGpxdWVyeV8xLmRlZmF1bHQpKFwiI2tleWJvYXJkUHJvbXB0XCIpLmhpZGUoKTtcbiAgICB9KTtcbiAgICAoMCwganF1ZXJ5XzEuZGVmYXVsdCkoXCIjY29udHJvbGxlckJ1dHRvblwiKS5jbGljayhmdW5jdGlvbiAoKSB7XG4gICAgICAgICgwLCBqcXVlcnlfMS5kZWZhdWx0KShcIiNjb250cm9sbGVyU3VwcG9ydENvbnRhaW5lclwiKS50b2dnbGUoKTtcbiAgICB9KTtcbiAgICBleHBvcnRzLmxheWVycy5CRzEgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImJhY2tncm91bmQxQ2FudmFzXCIpO1xuICAgIGV4cG9ydHMuYmcxID0gZXhwb3J0cy5sYXllcnMuQkcxLmdldENvbnRleHQoXCIyZFwiKTtcbiAgICBleHBvcnRzLmxheWVycy5CRzIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImJhY2tncm91bmQyQ2FudmFzXCIpO1xuICAgIGV4cG9ydHMuYmcyID0gZXhwb3J0cy5sYXllcnMuQkcyLmdldENvbnRleHQoXCIyZFwiKTtcbiAgICBleHBvcnRzLmxheWVycy5GRzEgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImZvcmVncm91bmQxQ2FudmFzXCIpO1xuICAgIGV4cG9ydHMuZmcxID0gZXhwb3J0cy5sYXllcnMuRkcxLmdldENvbnRleHQoXCIyZFwiKTtcbiAgICBleHBvcnRzLmxheWVycy5GRzIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImZvcmVncm91bmQyQ2FudmFzXCIpO1xuICAgIGV4cG9ydHMuZmcyID0gZXhwb3J0cy5sYXllcnMuRkcyLmdldENvbnRleHQoXCIyZFwiKTtcbiAgICBleHBvcnRzLmxheWVycy5VSSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidWlDYW52YXNcIik7XG4gICAgZXhwb3J0cy51aSA9IGV4cG9ydHMubGF5ZXJzLlVJLmdldENvbnRleHQoXCIyZFwiKTtcbiAgICBleHBvcnRzLmJnMS5maWxsU3R5bGUgPSBcInJnYigwLCAwLCAwKVwiO1xuICAgIGV4cG9ydHMuYmcxLmZpbGxSZWN0KDAsIDAsIGV4cG9ydHMubGF5ZXJzLkJHMS53aWR0aCwgZXhwb3J0cy5sYXllcnMuQkcxLmhlaWdodCk7XG4gICAgbGV0IG51bGxJbnB1dEJ1ZmZlcnMgPSBbKDAsIGlucHV0XzEubnVsbElucHV0cykoKSwgKDAsIGlucHV0XzEubnVsbElucHV0cykoKSwgKDAsIGlucHV0XzEubnVsbElucHV0cykoKSwgKDAsIGlucHV0XzEubnVsbElucHV0cykoKV07XG4gICAgZ2FtZVRpY2sobnVsbElucHV0QnVmZmVycyk7XG4gICAgcmVuZGVyVGljaygpO1xuICAgICgwLCBqcXVlcnlfMS5kZWZhdWx0KShcIiNlZmZlY3RzQnV0dG9uXCIpLmNsaWNrKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCgwLCB2ZnhfMS5pc1Nob3dTRlgpKCkpIHtcbiAgICAgICAgICAgICgwLCBqcXVlcnlfMS5kZWZhdWx0KShcIiNlZmZlY3RzQnV0dG9uRWRpdFwiKS5lbXB0eSgpLmFwcGVuZChcIk9GRlwiKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICgwLCBqcXVlcnlfMS5kZWZhdWx0KShcIiNlZmZlY3RzQnV0dG9uRWRpdFwiKS5lbXB0eSgpLmFwcGVuZChcIk9OXCIpO1xuICAgICAgICB9XG4gICAgICAgICgwLCB2ZnhfMS50b2dnbGVTaG93U0ZYKSgpO1xuICAgIH0pO1xuICAgICgwLCBqcXVlcnlfMS5kZWZhdWx0KShcIiNmcHNCdXR0b25cIikuY2xpY2soZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoZnBzMzApIHtcbiAgICAgICAgICAgICgwLCBqcXVlcnlfMS5kZWZhdWx0KShcIiNmcHNCdXR0b25FZGl0XCIpLmVtcHR5KCkuYXBwZW5kKFwiNjBcIik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAoMCwganF1ZXJ5XzEuZGVmYXVsdCkoXCIjZnBzQnV0dG9uRWRpdFwiKS5lbXB0eSgpLmFwcGVuZChcIjMwXCIpO1xuICAgICAgICB9XG4gICAgICAgIGZwczMwIF49IHRydWU7XG4gICAgfSk7XG4gICAgKDAsIGpxdWVyeV8xLmRlZmF1bHQpKFwiI2FscGhhQnV0dG9uXCIpLmNsaWNrKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCgwLCB0cmFuc3BhcmVuY3lfMS5nZXRUcmFuc3BhcmVuY3kpKCkpIHtcbiAgICAgICAgICAgICgwLCBqcXVlcnlfMS5kZWZhdWx0KShcIiNhbHBoYUJ1dHRvbkVkaXRcIikuZW1wdHkoKS5hcHBlbmQoXCJPRkZcIik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAoMCwganF1ZXJ5XzEuZGVmYXVsdCkoXCIjYWxwaGFCdXR0b25FZGl0XCIpLmVtcHR5KCkuYXBwZW5kKFwiT05cIik7XG4gICAgICAgIH1cbiAgICAgICAgKDAsIHRyYW5zcGFyZW5jeV8xLnRvZ2dsZVRyYW5zcGFyZW5jeSkoKTtcbiAgICB9KTtcbiAgICAoMCwganF1ZXJ5XzEuZGVmYXVsdCkoXCIjbGF5ZXJCdXR0b25cIikuaG92ZXIoZnVuY3Rpb24gKCkge1xuICAgICAgICAoMCwganF1ZXJ5XzEuZGVmYXVsdCkoXCIjbGF5ZXJEcm9wZG93blwiKS50b2dnbGUoKTtcbiAgICB9KTtcbiAgICAoMCwganF1ZXJ5XzEuZGVmYXVsdCkoXCIubGF5ZXJcIikuY2xpY2soZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgaWQgPSAoMCwganF1ZXJ5XzEuZGVmYXVsdCkodGhpcykuYXR0cihcImlkXCIpO1xuICAgICAgICBzd2l0Y2ggKGlkKSB7XG4gICAgICAgICAgICBjYXNlIFwibGF5ZXIxXCI6XG4gICAgICAgICAgICAgICAgZXhwb3J0cy5sYXllclN3aXRjaGVzLkJHMSBePSB0cnVlO1xuICAgICAgICAgICAgICAgICgwLCBqcXVlcnlfMS5kZWZhdWx0KShcIiNiYWNrZ3JvdW5kMUNhbnZhc1wiKS50b2dnbGUoKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJsYXllcjJcIjpcbiAgICAgICAgICAgICAgICBleHBvcnRzLmxheWVyU3dpdGNoZXMuQkcyIF49IHRydWU7XG4gICAgICAgICAgICAgICAgKDAsIGpxdWVyeV8xLmRlZmF1bHQpKFwiI2JhY2tncm91bmQyQ2FudmFzXCIpLnRvZ2dsZSgpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcImxheWVyM1wiOlxuICAgICAgICAgICAgICAgIGV4cG9ydHMubGF5ZXJTd2l0Y2hlcy5GRzEgXj0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAoMCwganF1ZXJ5XzEuZGVmYXVsdCkoXCIjZm9yZWdyb3VuZDFDYW52YXNcIikudG9nZ2xlKCk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwibGF5ZXI0XCI6XG4gICAgICAgICAgICAgICAgZXhwb3J0cy5sYXllclN3aXRjaGVzLkZHMiBePSB0cnVlO1xuICAgICAgICAgICAgICAgICgwLCBqcXVlcnlfMS5kZWZhdWx0KShcIiNmb3JlZ3JvdW5kMkNhbnZhc1wiKS50b2dnbGUoKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJsYXllcjVcIjpcbiAgICAgICAgICAgICAgICBleHBvcnRzLmxheWVyU3dpdGNoZXMuVUkgXj0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAoMCwganF1ZXJ5XzEuZGVmYXVsdCkoXCIjdWlDYW52YXNcIikudG9nZ2xlKCk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgICgwLCBqcXVlcnlfMS5kZWZhdWx0KSh0aGlzKS50b2dnbGVDbGFzcyhcImxheWVyT25cIik7XG4gICAgfSk7XG4gICAgKDAsIGpxdWVyeV8xLmRlZmF1bHQpKFwiI2RlYnVnQnV0dG9uXCIpLmNsaWNrKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKGV4cG9ydHMuc2hvd0RlYnVnKSB7XG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDQ7IGkrKykge1xuICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZ2FtZXBhZFNWR1wiICsgaSkuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgKDAsIGpxdWVyeV8xLmRlZmF1bHQpKFwiI2RlYnVnQnV0dG9uRWRpdFwiKS5lbXB0eSgpLmFwcGVuZChcIk9GRlwiKTtcbiAgICAgICAgICAgICgwLCBqcXVlcnlfMS5kZWZhdWx0KShcIiNkZWJ1Z1wiKS5oaWRlKCk7XG4gICAgICAgICAgICAoMCwganF1ZXJ5XzEuZGVmYXVsdCkoXCIjcGxheWVyc1wiKS5oaWRlKCk7XG4gICAgICAgICAgICAoMCwganF1ZXJ5XzEuZGVmYXVsdCkoXCJib2R5XCIpLmNzcyhcIm92ZXJmbG93XCIsIFwiaGlkZGVuXCIpO1xuICAgICAgICAgICAgLy92YXIgbVkgPSBNYXRoLm1heCgoJCh3aW5kb3cpLmhlaWdodCgpLTc1MCkvMiwwKTtcbiAgICAgICAgICAgIC8vJChcIiNkaXNwbGF5XCIpLmNzcyhcIm1hcmdpblwiLG1ZK1wicHggMHB4IDBweCBcIittWCtcInB4XCIpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCA0OyBpKyspIHtcbiAgICAgICAgICAgICAgICBpZiAoZXhwb3J0cy5wbGF5ZXJUeXBlW2ldICE9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAoMCwgZHJhd0dhbWVwYWRfMS51cGRhdGVHYW1lcGFkU1ZHQ29sb3VyKShpLCBcImdhbWVwYWRTVkdcIiArIGkpO1xuICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImdhbWVwYWRTVkdcIiArIGkpLnN0eWxlLmRpc3BsYXkgPSBcIlwiO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICgwLCBqcXVlcnlfMS5kZWZhdWx0KShcIiNkZWJ1Z0J1dHRvbkVkaXRcIikuZW1wdHkoKS5hcHBlbmQoXCJPTlwiKTtcbiAgICAgICAgICAgICgwLCBqcXVlcnlfMS5kZWZhdWx0KShcIiNkZWJ1Z1wiKS5zaG93KCk7XG4gICAgICAgICAgICAoMCwganF1ZXJ5XzEuZGVmYXVsdCkoXCIjcGxheWVyc1wiKS5zaG93KCk7XG4gICAgICAgICAgICAoMCwganF1ZXJ5XzEuZGVmYXVsdCkoXCJib2R5XCIpLmNzcyhcIm92ZXJmbG93XCIsIFwic2Nyb2xsXCIpO1xuICAgICAgICAgICAgLy92YXIgbVkgPSBNYXRoLm1heCgoJCh3aW5kb3cpLmhlaWdodCgpLTkwMCkvMiwwKTtcbiAgICAgICAgICAgIC8vJChcIiNkaXNwbGF5XCIpLmNzcyhcIm1hcmdpblwiLG1ZK1wiIDBweCAwcHggcHggXCIrbVgrXCJweFwiKTtcbiAgICAgICAgfVxuICAgICAgICBleHBvcnRzLnNob3dEZWJ1ZyBePSB0cnVlO1xuICAgICAgICByZXNpemUoKTtcbiAgICB9KTtcbiAgICAoMCwganF1ZXJ5XzEuZGVmYXVsdCkoXCIjaGlkZUJ1dHRvblwiKS5jbGljayhmdW5jdGlvbiAoKSB7XG4gICAgICAgICgwLCBqcXVlcnlfMS5kZWZhdWx0KShcIiNoZWFkZXJcIikudG9nZ2xlKCk7XG4gICAgICAgIHNob3dIZWFkZXIgXj0gdHJ1ZTtcbiAgICAgICAgcmVzaXplKCk7XG4gICAgfSk7XG4gICAgKDAsIGpxdWVyeV8xLmRlZmF1bHQpKFwiI2Z1bGxzY3JlZW5CdXR0b25cIikuY2xpY2soZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoKGRvY3VtZW50LmZ1bGxTY3JlZW5FbGVtZW50ICYmIGRvY3VtZW50LmZ1bGxTY3JlZW5FbGVtZW50ICE9PSBudWxsKSB8fCAoIWRvY3VtZW50Lm1vekZ1bGxTY3JlZW4gJiYgIWRvY3VtZW50LndlYmtpdElzRnVsbFNjcmVlbikpIHtcbiAgICAgICAgICAgIGlmIChkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQucmVxdWVzdEZ1bGxTY3JlZW4pIHtcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQucmVxdWVzdEZ1bGxTY3JlZW4oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5tb3pSZXF1ZXN0RnVsbFNjcmVlbikge1xuICAgICAgICAgICAgICAgIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5tb3pSZXF1ZXN0RnVsbFNjcmVlbigpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LndlYmtpdFJlcXVlc3RGdWxsU2NyZWVuKSB7XG4gICAgICAgICAgICAgICAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LndlYmtpdFJlcXVlc3RGdWxsU2NyZWVuKEVsZW1lbnQuQUxMT1dfS0VZQk9BUkRfSU5QVVQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgaWYgKGRvY3VtZW50LmNhbmNlbEZ1bGxTY3JlZW4pIHtcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5jYW5jZWxGdWxsU2NyZWVuKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChkb2N1bWVudC5tb3pDYW5jZWxGdWxsU2NyZWVuKSB7XG4gICAgICAgICAgICAgICAgZG9jdW1lbnQubW96Q2FuY2VsRnVsbFNjcmVlbigpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoZG9jdW1lbnQud2Via2l0Q2FuY2VsRnVsbFNjcmVlbikge1xuICAgICAgICAgICAgICAgIGRvY3VtZW50LndlYmtpdENhbmNlbEZ1bGxTY3JlZW4oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvLyByZXNpemUoKTtcbiAgICB9KTtcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiZnVsbHNjcmVlbmNoYW5nZVwiLCBvbkZ1bGxTY3JlZW5DaGFuZ2UsIGZhbHNlKTtcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwid2Via2l0ZnVsbHNjcmVlbmNoYW5nZVwiLCBvbkZ1bGxTY3JlZW5DaGFuZ2UsIGZhbHNlKTtcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwibW96ZnVsbHNjcmVlbmNoYW5nZVwiLCBvbkZ1bGxTY3JlZW5DaGFuZ2UsIGZhbHNlKTtcbiAgICAoMCwganF1ZXJ5XzEuZGVmYXVsdCkoXCIudG9wQnV0dG9uXCIpLmhvdmVyKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgKDAsIGpxdWVyeV8xLmRlZmF1bHQpKHRoaXMpLmNoaWxkcmVuKFwiLmJ1dHRvbkRldGFpbHNcIikudG9nZ2xlKCk7XG4gICAgfSk7XG4gICAgaWYgKG1vYmlsZSA9PT0gZmFsc2UpIHtcbiAgICAgICAgKDAsIGpxdWVyeV8xLmRlZmF1bHQpKFwiLmJ1dHRvblwiKS5ob3ZlcihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAoMCwganF1ZXJ5XzEuZGVmYXVsdCkodGhpcykudG9nZ2xlQ2xhc3MoXCJidXR0b25oaWdobGlnaHRlZFwiKTtcbiAgICAgICAgfSk7XG4gICAgICAgICgwLCBqcXVlcnlfMS5kZWZhdWx0KShcIi5zb2NpYWxtZWRpYVwiKS5ob3ZlcihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAoMCwganF1ZXJ5XzEuZGVmYXVsdCkodGhpcykudG9nZ2xlQ2xhc3MoXCJzb2NpYWxtZWRpYWhpZ2hsaWdodFwiKTtcbiAgICAgICAgfSk7XG4gICAgICAgICgwLCBqcXVlcnlfMS5kZWZhdWx0KShcIi5zdWdidG5cIikuaG92ZXIoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgKDAsIGpxdWVyeV8xLmRlZmF1bHQpKHRoaXMpLnRvZ2dsZUNsYXNzKFwic3VnYnRuaGlnaGxpZ2h0XCIpO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgKDAsIGpxdWVyeV8xLmRlZmF1bHQpKFwiI2FwcHNCdXR0b25cIikuaG92ZXIoZnVuY3Rpb24gKCkge1xuICAgICAgICAoMCwganF1ZXJ5XzEuZGVmYXVsdCkoXCIjYXBwc0Ryb3Bkb3duXCIpLnNob3coKTtcbiAgICB9LCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICgwLCBqcXVlcnlfMS5kZWZhdWx0KShcIiNhcHBzRHJvcGRvd25cIikuaGlkZSgpO1xuICAgIH0pO1xuICAgIGlmIChleHBvcnRzLmhvbGlkYXkgPT09IDEpIHtcbiAgICAgICAgKDAsIGpxdWVyeV8xLmRlZmF1bHQpKFwiI3Nub3dNaW51c1wiKS5jbGljayhmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBleHBvcnRzLnNub3dDb3VudCAtPSAyMDtcbiAgICAgICAgICAgIGlmIChleHBvcnRzLnNub3dDb3VudCA8IDApIHtcbiAgICAgICAgICAgICAgICBleHBvcnRzLnNub3dDb3VudCA9IDA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAoMCwganF1ZXJ5XzEuZGVmYXVsdCkoXCIjc25vd0J1dHRvbkVkaXRcIikudGV4dChleHBvcnRzLnNub3dDb3VudCk7XG4gICAgICAgIH0pO1xuICAgICAgICAoMCwganF1ZXJ5XzEuZGVmYXVsdCkoXCIjc25vd1BsdXNcIikuY2xpY2soZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgZXhwb3J0cy5zbm93Q291bnQgKz0gMjA7XG4gICAgICAgICAgICBpZiAoZXhwb3J0cy5zbm93Q291bnQgPiAxMjAwKSB7XG4gICAgICAgICAgICAgICAgZXhwb3J0cy5zbm93Q291bnQgPSAxMjAwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgKDAsIGpxdWVyeV8xLmRlZmF1bHQpKFwiI3Nub3dCdXR0b25FZGl0XCIpLnRleHQoZXhwb3J0cy5zbm93Q291bnQpO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgKDAsIGpxdWVyeV8xLmRlZmF1bHQpKFwiI3JlcGxheVwiKS5jaGFuZ2UoZnVuY3Rpb24gKCkge1xuICAgICAgICAvLyBncmFiIHRoZSBmaXJzdCBpbWFnZSBpbiB0aGUgRmlsZUxpc3Qgb2JqZWN0IGFuZCBwYXNzIGl0IHRvIHRoZSBmdW5jdGlvblxuICAgICAgICAoMCwgcmVwbGF5XzEubG9hZFJlcGxheSkodGhpcy5maWxlc1swXSk7XG4gICAgfSk7XG4gICAgcmVzaXplKCk7XG59XG53aW5kb3cuc3RhcnQgPSBzdGFydDtcbmZ1bmN0aW9uIGN1c3RvbURlYWR6b25lKCkge1xuICAgIHRoaXMubHMgPSBuZXcgVmVjMkRfMS5WZWMyRCgwLCAwKTtcbiAgICB0aGlzLmNzID0gbmV3IFZlYzJEXzEuVmVjMkQoMCwgMCk7XG4gICAgdGhpcy5sID0gMDtcbiAgICB0aGlzLnIgPSAwO1xufVxuZnVuY3Rpb24gYWRkU2hpbmUodmFsKSB7XG4gICAgZXhwb3J0cy5zaGluZSArPSB2YWw7XG59XG5mdW5jdGlvbiBzZXRTaGluZSh2YWwpIHtcbiAgICBleHBvcnRzLnNoaW5lID0gdmFsO1xufVxuZnVuY3Rpb24gc2V0RmluZGluZ1BsYXllcnModmFsKSB7XG4gICAgZXhwb3J0cy5maW5kaW5nUGxheWVycyA9IHZhbDtcbn1cbmZ1bmN0aW9uIHNldFBsYXlpbmcodmFsKSB7XG4gICAgZXhwb3J0cy5wbGF5aW5nID0gdmFsO1xufVxuZnVuY3Rpb24gc2V0Q2FsaWJyYXRpb25QbGF5ZXIodmFsKSB7XG4gICAgZXhwb3J0cy5jYWxpYnJhdGlvblBsYXllciA9IHZhbDtcbn1cbmNvbnN0IGRvbSA9IHt9O1xuZnVuY3Rpb24gY2FjaGVEb20oKSB7XG4gICAgY29uc3QgZWxlbWVudElkcyA9IFtcbiAgICAgICAgXCJtYXRjaE1pbnV0ZXNcIixcbiAgICAgICAgXCJtYXRjaFNlY29uZHNcIixcbiAgICAgICAgXCJnYW1lbG9naWNBdmdcIixcbiAgICAgICAgXCJnYW1lbG9naWNIaWdoXCIsXG4gICAgICAgIFwiZ2FtZWxvZ2ljTG93XCIsXG4gICAgICAgIFwiZ2FtZWxvZ2ljUGVha1wiLFxuICAgICAgICBcInJlbmRlckF2Z1wiLFxuICAgICAgICBcInJlbmRlckhpZ2hcIixcbiAgICAgICAgXCJyZW5kZXJMb3dcIixcbiAgICAgICAgXCJyZW5kZXJQZWFrXCIsXG4gICAgXTtcbiAgICBlbGVtZW50SWRzLmZvckVhY2goKGlkKSA9PiB7XG4gICAgICAgIGRvbVtpZF0gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCk7XG4gICAgfSk7XG59XG47XG5mdW5jdGlvbiBzZXRDUyhpbmRleCwgdmFsKSB7XG4gICAgZXhwb3J0cy5jaGFyYWN0ZXJTZWxlY3Rpb25zW2luZGV4XSA9IHZhbDtcbn1cbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/main/main.ts\n");

/***/ })

},
/******/ function(__webpack_require__) { // webpackRuntimeModules
/******/ /* webpack/runtime/getFullHash */
/******/ (() => {
/******/ 	__webpack_require__.h = () => ("047b2251353afa07618f")
/******/ })();
/******/ 
/******/ }
);