"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdatemeleelight"]("main",{

/***/ "./src/physics/article.ts":
/*!********************************!*\
  !*** ./src/physics/article.ts ***!
  \********************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.articles = exports.articleHitQueue = exports.destroyArticleQueue = exports.aArticles = void 0;\nexports.resetAArticles = resetAArticles;\nexports.executeArticles = executeArticles;\nexports.destroyArticles = destroyArticles;\nexports.renderArticles = renderArticles;\nexports.articlesHitDetection = articlesHitDetection;\nexports.executeArticleHits = executeArticleHits;\nexports.wallDetection = wallDetection;\nexports.articleHitCollision = articleHitCollision;\nexports.articleShieldCollision = articleShieldCollision;\nexports.interpolatedArticleCircleCollision = interpolatedArticleCircleCollision;\nexports.interpolatedArticleHurtCollision = interpolatedArticleHurtCollision;\nexports.articleHurtCollision = articleHurtCollision;\nconst main_1 = __webpack_require__(/*! main/main */ \"./src/main/main.ts\");\nconst render_1 = __webpack_require__(/*! main/render */ \"./src/main/render.ts\");\nconst sfx_1 = __webpack_require__(/*! main/sfx */ \"./src/main/sfx.ts\");\nconst hitDetection_1 = __webpack_require__(/*! physics/hitDetection */ \"./src/physics/hitDetection.ts\");\nconst environmentalCollision_1 = __webpack_require__(/*! ./environmentalCollision */ \"./src/physics/environmentalCollision.ts\");\nconst ecbTransform_1 = __webpack_require__(/*! ../main/util/ecbTransform */ \"./src/main/util/ecbTransform.ts\");\nconst findSmallestWithin_1 = __webpack_require__(/*! ../main/util/findSmallestWithin */ \"./src/main/util/findSmallestWithin.ts\");\nconst linAlg_1 = __webpack_require__(/*! ../main/linAlg */ \"./src/main/linAlg.ts\");\nconst actionStateShortcuts_1 = __webpack_require__(/*! physics/actionStateShortcuts */ \"./src/physics/actionStateShortcuts.ts\");\nconst drawVfx_1 = __webpack_require__(/*! main/vfx/drawVfx */ \"./src/main/vfx/drawVfx.js\");\nconst activeStage_1 = __webpack_require__(/*! stages/activeStage */ \"./src/stages/activeStage.ts\");\nconst createHitBox_1 = __webpack_require__(/*! ../main/util/createHitBox */ \"./src/main/util/createHitBox.ts\");\nconst Vec2D_1 = __webpack_require__(/*! ../main/util/Vec2D */ \"./src/main/util/Vec2D.ts\");\nconst laser_1 = __webpack_require__(/*! ../main/vfx/dVfx/laser */ \"./src/main/vfx/dVfx/laser.js\");\nconst chromaticAberration_1 = __webpack_require__(/*! ../main/vfx/chromaticAberration */ \"./src/main/vfx/chromaticAberration.js\");\nconst makeColour_1 = __webpack_require__(/*! ../main/vfx/makeColour */ \"./src/main/vfx/makeColour.js\");\nconst interpolatedCollision_1 = __webpack_require__(/*! ./interpolatedCollision */ \"./src/physics/interpolatedCollision.ts\");\n/* eslint-disable */\nexports.aArticles = [];\nexports.destroyArticleQueue = [];\nexports.articleHitQueue = [];\nfunction resetAArticles() {\n    exports.aArticles = [];\n}\n// 0.00390583333333333333333333333333 = hitbox size multiplier\nexports.articles = {\n    \"LASER\": {\n        name: \"LASER\",\n        canTurboCancel: false,\n        strokeStyle: \"\",\n        fillStyle: \"\",\n        init: function (options) {\n            const p = options.p;\n            const x = options.x;\n            const y = options.y;\n            const rotate = options.rotate;\n            const isFox = (options.isFox !== undefined) ? options.isFox : true;\n            const partOfThrow = options.partOfThrow || false;\n            this.strokeStyle = isFox ? \"rgba(255, 59, 59,0.6)\" : \"rgba(73,130,234,0.6)\";\n            this.fillStyle = isFox ? \"rgb(255, 193, 193)\" : \"rgb(225, 255, 255)\";\n            var obj = {\n                hitList: [],\n                rotate: rotate,\n                destroyOnHit: true,\n                clank: false,\n                timer: 0,\n                vel: new Vec2D_1.Vec2D((isFox ? 7 : 5) * Math.cos(rotate) * main_1.player[p].phys.face, (isFox ? 7 : 5) * Math.sin(rotate)),\n                pos: new Vec2D_1.Vec2D(main_1.player[p].phys.pos.x + (x * main_1.player[p].phys.face), main_1.player[p].phys.pos.y + y),\n                posPrev1: new Vec2D_1.Vec2D(main_1.player[p].phys.pos.x, main_1.player[p].phys.pos.y + y),\n                posPrev2: new Vec2D_1.Vec2D(main_1.player[p].phys.pos.x, main_1.player[p].phys.pos.y + y),\n                posPrev3: new Vec2D_1.Vec2D(main_1.player[p].phys.pos.x, main_1.player[p].phys.pos.y + y),\n                posPrev: new Vec2D_1.Vec2D(main_1.player[p].phys.pos.x, main_1.player[p].phys.pos.y + y),\n                hb: new createHitBox_1.createHitbox(new Vec2D_1.Vec2D(0, 0), 1.172, 3, 361, isFox ? 0 : partOfThrow ? 0 : 100, 0, isFox ? 0 : partOfThrow ? 0 : 5, 0, 0, 1, 1),\n                ecb: [new Vec2D_1.Vec2D(main_1.player[p].phys.pos.x + (x * main_1.player[p].phys.face), main_1.player[p].phys.pos.y + y - 0.01),\n                    new Vec2D_1.Vec2D(main_1.player[p].phys.pos.x + (x * main_1.player[p].phys.face) + 10, main_1.player[p].phys.pos.y + y),\n                    new Vec2D_1.Vec2D(main_1.player[p].phys.pos.x + (x * main_1.player[p].phys.face), main_1.player[p].phys.pos.y + y + 0.01),\n                    new Vec2D_1.Vec2D(main_1.player[p].phys.pos.x + (x * main_1.player[p].phys.face) - 10, main_1.player[p].phys.pos.y + y)]\n            };\n            exports.aArticles.push({\n                name: \"LASER\",\n                player: p,\n                instance: obj\n            });\n            exports.articles.LASER.main(exports.aArticles.length - 1);\n        },\n        main: function (i) {\n            exports.aArticles[i].instance.timer++;\n            if (exports.aArticles[i].instance.timer > 4) {\n                exports.aArticles[i].instance.posPrev.x = exports.aArticles[i].instance.posPrev3.x;\n                exports.aArticles[i].instance.posPrev.y = exports.aArticles[i].instance.posPrev3.y;\n            }\n            if (exports.aArticles[i].instance.timer > 3) {\n                exports.aArticles[i].instance.posPrev3.x = exports.aArticles[i].instance.posPrev2.x;\n                exports.aArticles[i].instance.posPrev3.y = exports.aArticles[i].instance.posPrev2.y;\n            }\n            if (exports.aArticles[i].instance.timer > 2) {\n                exports.aArticles[i].instance.posPrev2.x = exports.aArticles[i].instance.posPrev1.x;\n                exports.aArticles[i].instance.posPrev2.y = exports.aArticles[i].instance.posPrev1.y;\n            }\n            if (exports.aArticles[i].instance.timer > 1) {\n                exports.aArticles[i].instance.posPrev1.x = exports.aArticles[i].instance.pos.x;\n                exports.aArticles[i].instance.posPrev1.y = exports.aArticles[i].instance.pos.y;\n            }\n            exports.aArticles[i].instance.pos.x += exports.aArticles[i].instance.vel.x;\n            exports.aArticles[i].instance.ecb[0].x += exports.aArticles[i].instance.vel.x;\n            exports.aArticles[i].instance.ecb[1].x += exports.aArticles[i].instance.vel.x;\n            exports.aArticles[i].instance.ecb[2].x += exports.aArticles[i].instance.vel.x;\n            exports.aArticles[i].instance.ecb[3].x += exports.aArticles[i].instance.vel.x;\n            exports.aArticles[i].instance.pos.y += exports.aArticles[i].instance.vel.y;\n            exports.aArticles[i].instance.ecb[0].y += exports.aArticles[i].instance.vel.y;\n            exports.aArticles[i].instance.ecb[1].y += exports.aArticles[i].instance.vel.y;\n            exports.aArticles[i].instance.ecb[2].y += exports.aArticles[i].instance.vel.y;\n            exports.aArticles[i].instance.ecb[3].y += exports.aArticles[i].instance.vel.y;\n            if (wallDetection(i) || exports.aArticles[i].instance.timer > 200) {\n                exports.destroyArticleQueue.push(i);\n            }\n        },\n        draw: function (i) {\n            main_1.fg2.save();\n            var h = new Vec2D_1.Vec2D((exports.aArticles[i].instance.pos.x * activeStage_1.activeStage.scale) + activeStage_1.activeStage.offset[0], (exports.aArticles[i].instance.pos.y * -activeStage_1.activeStage.scale) +\n                activeStage_1.activeStage.offset[1]);\n            var t = new Vec2D_1.Vec2D((exports.aArticles[i].instance.posPrev.x * activeStage_1.activeStage.scale) + activeStage_1.activeStage.offset[0], (exports.aArticles[i].instance.posPrev.y * -activeStage_1.activeStage.scale) + activeStage_1.activeStage.offset[1]);\n            var d = (h.x > t.x) ? 1 : -1;\n            var r = exports.aArticles[i].instance.rotate;\n            var v1 = (0, render_1.rotateVector)(-4, 2, -r);\n            var v2 = (0, render_1.rotateVector)(4, 2, -r);\n            var v3 = (0, render_1.rotateVector)(4, -2, -r);\n            var v4 = (0, render_1.rotateVector)(-4, -2, -r);\n            (0, chromaticAberration_1.chromaticAberration)(main_1.fg2, (c1, c2) => (0, laser_1.drawLaserLine)(h, t, v1, v2, v3, v4, d, c1, c2), (0, makeColour_1.unmakeColour)(this.strokeStyle), (0, makeColour_1.unmakeColour)(this.fillStyle), 0.8, new Vec2D_1.Vec2D(-0.3 * Math.sin(r) * activeStage_1.activeStage.scale, -0.3 * Math.cos(r) * activeStage_1.activeStage.scale));\n            main_1.fg2.restore();\n        }\n    },\n    \"ILLUSION\": {\n        name: \"ILLUSION\",\n        noDraw: true,\n        canTurboCancel: true,\n        init: function (options) {\n            const p = options.p;\n            const type = options.type;\n            const isFox = options.isFox || true;\n            var obj = {\n                hitList: [],\n                destroyOnHit: false,\n                clank: true,\n                timer: 0,\n                pos: new Vec2D_1.Vec2D(main_1.player[p].phys.posPrev.x, main_1.player[p].phys.posPrev.y + 5),\n                posPrev: new Vec2D_1.Vec2D(main_1.player[p].phys.posPrev.x, main_1.player[p].phys.posPrev.y + 5),\n                hb: new createHitBox_1.createHitbox(new Vec2D_1.Vec2D(0, 0), 4.160, 7, isFox ? 80 : 270, isFox ? 60 : 70, isFox ? 68 : 70, 0, 1, 1, 1, 1),\n                ecb: [new Vec2D_1.Vec2D(main_1.player[p].phys.posPrev.x, main_1.player[p].phys.posPrev.y - 10), new Vec2D_1.Vec2D(main_1.player[p].phys.posPrev\n                        .x + 10, main_1.player[p].phys.posPrev.y), new Vec2D_1.Vec2D(main_1.player[p].phys.posPrev.x, main_1.player[p].phys.posPrev.y +\n                        10), new Vec2D_1.Vec2D(main_1.player[p].phys.posPrev.x - 10, main_1.player[p].phys.posPrev.y)]\n            };\n            // if ground\n            if (type) {\n                if (isFox) {\n                    obj.hb.kg = 40;\n                }\n                else {\n                    obj.hb.angle = 65;\n                    obj.hb.kg = 60;\n                    obj.hb.bk = 74;\n                }\n            }\n            exports.aArticles.push({\n                name: \"ILLUSION\",\n                player: p,\n                instance: obj\n            });\n            exports.articles.ILLUSION.main(exports.aArticles.length - 1);\n        },\n        main: function (i) {\n            var p = exports.aArticles[i].player;\n            exports.aArticles[i].instance.timer++;\n            exports.aArticles[i].instance.posPrev = new Vec2D_1.Vec2D(exports.aArticles[i].instance.pos.x, exports.aArticles[i].instance.pos.y);\n            exports.aArticles[i].instance.pos = new Vec2D_1.Vec2D(main_1.player[p].phys.posPrev.x, main_1.player[p].phys.posPrev.y);\n            exports.aArticles[i].instance.ecb = [new Vec2D_1.Vec2D(main_1.player[p].phys.posPrev.x, main_1.player[p].phys.posPrev.y - 10), new Vec2D_1.Vec2D(main_1.player[p]\n                    .phys.posPrev.x + 10, main_1.player[p].phys.posPrev.y), new Vec2D_1.Vec2D(main_1.player[p].phys.posPrev.x, main_1.player[p].phys.posPrev\n                    .y + 10), new Vec2D_1.Vec2D(main_1.player[p].phys.posPrev.x - 10, main_1.player[p].phys.posPrev.y)];\n            if (exports.aArticles[i].instance.timer > 5) {\n                exports.destroyArticleQueue.push(i);\n            }\n        }\n    }\n};\nfunction executeArticles() {\n    exports.destroyArticleQueue = [];\n    for (var i = 0; i < exports.aArticles.length; i++) {\n        exports.articles[exports.aArticles[i].name].main(i);\n    }\n}\nfunction destroyArticles() {\n    for (var k = 0; k < exports.destroyArticleQueue.length; k++) {\n        exports.aArticles.splice(exports.destroyArticleQueue[k] - k, 1);\n    }\n}\nfunction renderArticles() {\n    for (var i = 0; i < exports.aArticles.length; i++) {\n        if (!exports.articles[exports.aArticles[i].name].noDraw) {\n            exports.articles[exports.aArticles[i].name].draw(i);\n        }\n    }\n}\nfunction articlesHitDetection() {\n    exports.articleHitQueue = [];\n    for (var a = 0; a < exports.aArticles.length; a++) {\n        var articleDestroyed = false;\n        if (exports.aArticles[a].instance.timer > 1) {\n            var interpolate = true;\n        }\n        else {\n            var interpolate = false;\n        }\n        for (var v = 0; v < 4; v++) {\n            var inHitList = false;\n            for (var n = 0; n < 4; n++) {\n                if (v == exports.aArticles[a].instance.hitList[n]) {\n                    inHitList = true;\n                    break;\n                }\n            }\n            // if v isnt the owner, not destroyed and no in article's hitlist\n            if (v != exports.aArticles[a].player && !articleDestroyed && !inHitList && main_1.playerType[v] != -1) {\n                // if article is clankable\n                var attackerClank = false;\n                if (exports.aArticles[a].instance.clank) {\n                    for (var k = 0; k < 4; k++) {\n                        if (main_1.player[v].hitboxes.active[k] && (main_1.player[v].hitboxes.id[k].clank == 1 || (main_1.player[v].hitboxes.id[k].clank ==\n                            2 && main_1.player[v].phys.grounded))) {\n                            // ILL DO CLANKS TOMOZ\n                            /*var clankHit = articleHitCollision(a,v,k);\n                             if (clankHit[0]){\n  \n                             var diff = player[p].hitboxes.id[j].dmg - player[i].hitboxes.id[k].dmg;\n                             if (diff >= 9){\n                             // victim clank\n                             // attacker cut through\n                             player[i].hit.hitlag = Math.floor(player[p].hitboxes.id[j].dmg * (1/3) + 3);\n                             turnOffHitboxes(i);\n                             actionStates[characterSelections[i]][78].init(i);\n                             }\n                             else if (diff <= -9){\n                             // attacker clank\n                             // victim cut through\n                             player[p].hit.hitlag = Math.floor(player[i].hitboxes.id[k].dmg * (1/3) + 3);\n                             attackerClank = true;\n                             articleDestroyed = true;\n                             turnOffHitboxes(p);\n                             actionStates[characterSelections[p]][78].init(p,input);\n                             }\n                             else {\n                             // both clank\n                             player[i].hit.hitlag = Math.floor(player[p].hitboxes.id[j].dmg * (1/3) + 3);\n                             player[p].hit.hitlag = Math.floor(player[i].hitboxes.id[k].dmg * (1/3) + 3);\n                             attackerClank = true;\n                             articleDestroyed = true;\n                             turnOffHitboxes(i);\n                             actionStates[characterSelections[i]][78].init(i);\n                             turnOffHitboxes(p);\n                             actionStates[characterSelections[p]][78].init(p,input);\n                             }\n                             sounds.clank.play();\n                             drawVfx(\"clank\",clankHit[1]);\n                             player[p].hitboxes.hitList.push(i);\n                             break;\n                             }*/\n                        }\n                    }\n                }\n                if (!attackerClank) {\n                    var reflected = false;\n                    for (var i = 0; i < 4; i++) {\n                        if (main_1.player[v].hitboxes.active[i]) {\n                            if (main_1.player[v].hitboxes.id[i].type == 7) {\n                                if (articleHitCollision(a, v, i) || (interpolate && (articleHitCollision(a, v, i) ||\n                                    interpolatedArticleCircleCollision(a, new Vec2D_1.Vec2D(main_1.player[v].phys.pos.x + main_1.player[v].hitboxes.id[i]\n                                        .offset[0].x, main_1.player[v].phys.pos.y + main_1.player[v].hitboxes.id[i].offset[0].y), main_1.player[v].hitboxes\n                                        .id[i].size)))) {\n                                    if (main_1.player[v].actionState.substr(0, 11) == \"DOWNSPECIAL\") {\n                                        // do shine reflect animation\n                                        sfx_1.sounds.foxshinereflect.play();\n                                    }\n                                    // change ownership\n                                    exports.aArticles[a].player = v;\n                                    // increase damage\n                                    exports.aArticles[a].instance.hb.dmg *= 1.5;\n                                    // reflect\n                                    if (exports.aArticles[a].instance.vel != undefined || exports.aArticles[a].instance.vel != null) {\n                                        exports.aArticles[a].instance.vel.x *= -1;\n                                        exports.aArticles[a].instance.vel.y *= -1;\n                                    }\n                                    reflected = true;\n                                    break;\n                                }\n                            }\n                        }\n                    }\n                    if (!reflected) {\n                        if (main_1.player[v].phys.shielding && (articleShieldCollision(a, v, false) || (interpolate && (articleShieldCollision(a, v, true) || interpolatedArticleCircleCollision(a, main_1.player[v].phys.shieldPositionReal, main_1.player[v].phys.shieldSize))))) {\n                            exports.articleHitQueue.push([a, v, true]);\n                            exports.aArticles[a].instance.hitList.push(v);\n                            if (exports.articles[exports.aArticles[a].name].canTurboCancel) {\n                                main_1.player[exports.aArticles[a].player].hasHit = true;\n                            }\n                        }\n                        else if (main_1.player[v].phys.hurtBoxState != 1) {\n                            if (articleHurtCollision(a, v, false) || (interpolate && (interpolatedArticleHurtCollision(a, v) ||\n                                articleHurtCollision(a, v, true)))) {\n                                exports.articleHitQueue.push([a, v, false]);\n                                exports.aArticles[a].instance.hitList.push(v);\n                                if (exports.articles[exports.aArticles[a].name].canTurboCancel) {\n                                    main_1.player[exports.aArticles[a].player].hasHit = true;\n                                }\n                                if (exports.aArticles[a].instance.destroyOnHit) {\n                                    exports.destroyArticleQueue.push(a);\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    }\n}\nfunction executeArticleHits(input) {\n    for (var i = 0; i < exports.articleHitQueue.length; i++) {\n        var a = exports.articleHitQueue[i][0];\n        var v = exports.articleHitQueue[i][1];\n        var shieldHit = exports.articleHitQueue[i][2];\n        var o = exports.aArticles[a].player;\n        var hb = exports.aArticles[a].instance.hb;\n        var damage = hb.dmg;\n        if (shieldHit) {\n            if (main_1.player[v].phys.powerShieldReflectActive) {\n                (0, drawVfx_1.drawVfx)({\n                    name: \"powershieldreflect\",\n                    pos: main_1.player[v].phys.shieldPositionReal,\n                    face: main_1.player[v].phys.face\n                });\n                sfx_1.sounds.powershieldreflect.play();\n                exports.aArticles[a].player = v; // change ownership to victim\n                // reflects velocity\n                if (exports.aArticles[a].instance.vel != undefined || exports.aArticles[a].instance.vel != null) {\n                    exports.aArticles[a].instance.vel.x *= -1;\n                    exports.aArticles[a].instance.vel.y *= -1;\n                }\n                // cuts damage in half\n                exports.aArticles[a].instance.hb.dmg *= 0.5;\n            }\n            else {\n                main_1.player[v].phys.shieldHP -= damage;\n                if (main_1.player[v].phys.shieldHP < 0) {\n                    main_1.player[v].phys.shielding = false;\n                    main_1.player[v].phys.cVel.y = 2.5;\n                    main_1.player[v].phys.grounded = false;\n                    main_1.player[v].phys.shieldHP = 0;\n                    (0, drawVfx_1.drawVfx)({\n                        name: \"breakShield\",\n                        pos: main_1.player[v].phys.pos,\n                        face: main_1.player[v].phys.face\n                    });\n                    actionStateShortcuts_1.actionStates[main_1.characterSelections[v]].SHIELDBREAKFALL.init(v, input);\n                    sfx_1.sounds.shieldbreak.play();\n                    break;\n                }\n                if (exports.aArticles[a].instance.destroyOnHit) {\n                    exports.destroyArticleQueue.push(a);\n                }\n                (0, drawVfx_1.drawVfx)({\n                    name: \"clank\",\n                    pos: exports.aArticles[a].instance.pos,\n                    face: 1\n                });\n                main_1.player[v].hit.hitlag = Math.floor(damage * (1 / 3) + 3);\n                main_1.player[v].hit.shieldstun = ((Math.floor(damage) * ((0.65 * (1 - ((main_1.player[v].phys.shieldAnalog - 0.3) / 0.7))) +\n                    0.3)) * 1.5) + 2;\n                var victimPush = ((Math.floor(damage) * ((0.195 * (1 - ((main_1.player[v].phys.shieldAnalog - 0.3) / 0.7))) + 0.09)) +\n                    0.4) * 0.6;\n                if (victimPush > 2) {\n                    victimPush = 2;\n                }\n                if (exports.aArticles[a].instance.pos.x < main_1.player[v].phys.pos.x) {\n                    main_1.player[v].phys.cVel.x = victimPush;\n                }\n                else {\n                    main_1.player[v].phys.cVel.x = -victimPush;\n                }\n            }\n            actionStateShortcuts_1.actionStates[main_1.characterSelections[v]].GUARD.init(v, input);\n        }\n        else {\n            if (main_1.player[v].phys.hurtBoxState == 0) {\n                var crouching = actionStateShortcuts_1.actionStates[main_1.characterSelections[v]][main_1.player[v].actionState].crouch;\n                var vCancel = false;\n                if (main_1.player[v].phys.vCancelTimer > 0) {\n                    if (actionStateShortcuts_1.actionStates[main_1.characterSelections[v]][main_1.player[v].actionState].vCancel) {\n                        vCancel = true;\n                        sfx_1.sounds.vcancel.play();\n                    }\n                }\n                main_1.player[v].hit.knockback = (0, hitDetection_1.getKnockback)(hb, damage, damage, main_1.player[v].percent, main_1.player[v].charAttributes.weight, crouching, vCancel);\n                main_1.player[v].hit.hitPoint = exports.aArticles[a].instance.pos;\n                main_1.player[v].percent += damage;\n                switch (hb.type) {\n                    case 0:\n                        (0, drawVfx_1.drawVfx)({\n                            name: \"normalhit\",\n                            pos: main_1.player[v].hit.hitPoint,\n                            face: main_1.player[v].phys.face\n                        });\n                        break;\n                    case 1:\n                        (0, drawVfx_1.drawVfx)({\n                            name: \"hitSparks\",\n                            pos: main_1.player[v].hit.hitPoint,\n                            face: main_1.player[v].phys.face\n                        });\n                        (0, drawVfx_1.drawVfx)({\n                            name: \"hitFlair\",\n                            pos: main_1.player[v].hit.hitPoint,\n                            face: main_1.player[v].phys.face\n                        });\n                        (0, drawVfx_1.drawVfx)({\n                            name: \"hitCurve\",\n                            pos: main_1.player[v].hit.hitPoint,\n                            face: main_1.player[v].phys.face,\n                            f: main_1.player[v].hit.angle\n                        });\n                        break;\n                    default:\n                        break;\n                }\n                (0, hitDetection_1.knockbackSounds)(hb.type, main_1.player[v].hit.knockback, v);\n                if (main_1.player[v].hit.knockback > 0) {\n                    main_1.player[v].hit.angle = hb.angle;\n                    if (main_1.player[v].hit.angle == 361) {\n                        if (main_1.player[v].hit.knockback < 32.1) {\n                            main_1.player[v].hit.angle = 0;\n                        }\n                        else if (main_1.player[v].hit.knockback >= 32.1) {\n                            main_1.player[v].hit.angle = 44;\n                        }\n                    }\n                    main_1.player[v].hit.hitlag = Math.floor(damage * (1 / 3) + 3);\n                    if (exports.aArticles[a].instance.pos.x < main_1.player[v].phys.pos.x) {\n                        main_1.player[v].hit.reverse = false;\n                        main_1.player[v].phys.face = -1;\n                    }\n                    else {\n                        main_1.player[v].hit.reverse = true;\n                        main_1.player[v].phys.face = 1;\n                    }\n                    var isThrow = false;\n                    if (main_1.player[v].phys.grabbedBy == -1 || (main_1.player[v].phys.grabbedBy > -1 && main_1.player[v].hit.knockback > 50)) {\n                        main_1.player[v].hit.hitstun = (0, hitDetection_1.getHitstun)(main_1.player[v].hit.knockback);\n                        if (main_1.player[v].hit.knockback >= 80 || isThrow) {\n                            actionStateShortcuts_1.actionStates[main_1.characterSelections[v]].DAMAGEFLYN.init(v, input, !isThrow);\n                        }\n                        else {\n                            actionStateShortcuts_1.actionStates[main_1.characterSelections[v]].DAMAGEN2.init(v, input);\n                        }\n                    }\n                    else {\n                        if (main_1.player[v].actionState != \"THROWNPUFFDOWN\") {\n                            actionStateShortcuts_1.actionStates[main_1.characterSelections[v]].CAPTUREDAMAGE.init(v, input);\n                        }\n                    }\n                    if (main_1.player[v].phys.grounded && main_1.player[v].hit.angle > 180) {\n                        if (main_1.player[v].hit.knockback >= 80) {\n                            sfx_1.sounds.bounce.play();\n                            (0, drawVfx_1.drawVfx)({\n                                name: \"groundBounce\",\n                                pos: main_1.player[v].phys.pos,\n                                face: main_1.player[v].phys.face\n                            });\n                            main_1.player[v].hit.angle = 360 - main_1.player[v].hit.angle;\n                            main_1.player[v].hit.knockback *= 0.8;\n                        }\n                    }\n                    (0, main_1.screenShake)(main_1.player[v].hit.knockback);\n                    (0, main_1.percentShake)(main_1.player[v].hit.knockback, v);\n                }\n            }\n            else {\n                sfx_1.sounds.blunthit.play();\n                (0, drawVfx_1.drawVfx)({\n                    name: \"clank\",\n                    pos: exports.aArticles[a].instance.pos\n                });\n            }\n        }\n    }\n}\nfunction wallDetection(i) {\n    const article = exports.aArticles[i].instance;\n    const ecbp = article.ecb;\n    let ecb1;\n    if (article.timer < 2) {\n        const focus = article.posPrev;\n        const offset = 0.0001;\n        ecb1 = [new Vec2D_1.Vec2D(focus.x, focus.y - offset),\n            new Vec2D_1.Vec2D(focus.x + offset, focus.y),\n            new Vec2D_1.Vec2D(focus.x, focus.y + offset),\n            new Vec2D_1.Vec2D(focus.x - offset, focus.y)\n        ];\n    }\n    else {\n        ecb1 = (0, ecbTransform_1.moveECB)(ecbp, (0, linAlg_1.subtract)(article.posPrev, article.pos));\n    }\n    let collisions = [];\n    let thisCollision = null;\n    for (var j = 0; j < activeStage_1.activeStage.wallL.length; j++) {\n        thisCollision = (0, environmentalCollision_1.findCollision)(ecb1, ecbp, [activeStage_1.activeStage.wallL[j], [\"l\", j]]);\n        if (thisCollision !== null) {\n            collisions.push(thisCollision);\n        }\n    }\n    for (var j = 0; j < activeStage_1.activeStage.wallR.length; j++) {\n        thisCollision = (0, environmentalCollision_1.findCollision)(ecb1, ecbp, [activeStage_1.activeStage.wallR[j], [\"r\", j]]);\n        if (thisCollision !== null) {\n            collisions.push(thisCollision);\n        }\n    }\n    for (var j = 0; j < activeStage_1.activeStage.ceiling.length; j++) {\n        thisCollision = (0, environmentalCollision_1.findCollision)(ecb1, ecbp, [activeStage_1.activeStage.ceiling[j], [\"c\", j]]);\n        if (thisCollision !== null) {\n            collisions.push(thisCollision);\n        }\n    }\n    for (var j = 0; j < activeStage_1.activeStage.ground.length; j++) {\n        thisCollision = (0, environmentalCollision_1.findCollision)(ecb1, ecbp, [activeStage_1.activeStage.ground[j], [\"g\", j]]);\n        if (thisCollision !== null) {\n            collisions.push(thisCollision);\n            ;\n        }\n    }\n    for (var j = 0; j < activeStage_1.activeStage.platform.length; j++) {\n        thisCollision = (0, environmentalCollision_1.findCollision)(ecb1, ecbp, [activeStage_1.activeStage.platform[j], [\"p\", j]]);\n        if (thisCollision !== null) {\n            collisions.push(thisCollision);\n        }\n    }\n    let firstCollision = (0, findSmallestWithin_1.pickSmallestSweep)(collisions);\n    if (firstCollision !== null) {\n        return firstCollision.sweep;\n    }\n    else {\n        return null;\n    }\n}\nfunction articleHitCollision(a, v, k) {\n    var hbpos = exports.aArticles[a].instance.pos;\n    var hbpos2 = new Vec2D_1.Vec2D(main_1.player[v].phys.pos.x + (main_1.player[v].hitboxes.id[k].offset[main_1.player[v].hitboxes.frame].x * main_1.player[v].phys.face), main_1.player[v].phys.pos.y + main_1.player[v].hitboxes.id[k].offset[main_1.player[v].hitboxes.frame].y);\n    var hitPoint = new Vec2D_1.Vec2D((hbpos.x + hbpos2.x) / 2, (hbpos.y + hbpos2.y) / 2);\n    return (Math.pow(hbpos2.x - hbpos.x, 2) + Math.pow(hbpos.y - hbpos2.y, 2) <= Math.pow(exports.aArticles[a].instance.hb.size +\n        main_1.player[v].hitboxes.id[k].size, 2));\n    //return [(Math.pow(hbpos2.x-hbpos.x,2) + Math.pow(hbpos.y-hbpos2.y,2) <= Math.pow(aArticles[a].instance.hb.size+player[v].hitboxes.id[k].size,2)),hitPoint];\n}\nfunction articleShieldCollision(a, v, previous) {\n    if (previous) {\n        var hbpos = exports.aArticles[a].instance.posPrev;\n    }\n    else {\n        var hbpos = exports.aArticles[a].instance.pos;\n    }\n    var shieldpos = main_1.player[v].phys.shieldPositionReal;\n    return (Math.pow(shieldpos.x - hbpos.x, 2) + Math.pow(hbpos.y - shieldpos.y, 2) <= Math.pow(exports.aArticles[a].instance.hb.size +\n        main_1.player[v].phys.shieldSize, 2));\n}\nfunction interpolatedArticleCircleCollision(a, circlePos, r) {\n    const h1 = exports.aArticles[a].instance.posPrev;\n    const h2 = exports.aArticles[a].instance.pos;\n    const s = exports.aArticles[a].instance.hb.size;\n    const collision = (0, interpolatedCollision_1.sweepCircleVsSweepCircle)(h1, s, h2, s, circlePos, r, circlePos, r);\n    if (collision === null) {\n        return false;\n    }\n    else {\n        return true;\n    }\n}\nfunction interpolatedArticleHurtCollision(a, v) {\n    const hurt = main_1.player[v].phys.hurtbox;\n    const h1 = exports.aArticles[a].instance.posPrev;\n    const h2 = exports.aArticles[a].instance.pos;\n    const r = exports.aArticles[a].instance.hb.size;\n    const collision = (0, interpolatedCollision_1.sweepCircleVsAABB)(h1, r, h2, r, hurt.min, hurt.max);\n    if (collision === null) {\n        return false;\n    }\n    else {\n        return true;\n    }\n}\nfunction articleHurtCollision(a, v, previous) {\n    if (previous) {\n        var hbpos = exports.aArticles[a].instance.posPrev;\n    }\n    else {\n        var hbpos = exports.aArticles[a].instance.pos;\n    }\n    var hurtCenter = new Vec2D_1.Vec2D((main_1.player[v].phys.hurtbox.min.x + main_1.player[v].phys.hurtbox.max.x) / 2, (main_1.player[v].phys.hurtbox\n        .min.y + main_1.player[v].phys.hurtbox.max.y) / 2);\n    var distance = new Vec2D_1.Vec2D(Math.abs(hbpos.x - hurtCenter.x), Math.abs(hbpos.y - hurtCenter.y));\n    var hurtWidth = 8;\n    var hurtHeight = 18;\n    if (distance.x > (hurtWidth / 2 + exports.aArticles[a].instance.hb.size)) {\n        return false;\n    }\n    if (distance.y > (hurtHeight / 2 + exports.aArticles[a].instance.hb.size)) {\n        return false;\n    }\n    if (distance.x <= (hurtWidth / 2)) {\n        return true;\n    }\n    if (distance.y <= (hurtHeight / 2)) {\n        return true;\n    }\n    var cornerDistance_sq = Math.pow(distance.x - hurtWidth / 2, 2) +\n        Math.pow(distance.y - hurtHeight / 2, 2);\n    return (cornerDistance_sq <= (Math.pow(exports.aArticles[a].instance.hb.size, 2)));\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUI7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUI7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkI7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IsNENBQTRDO0FBQ2hFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IsNENBQTRDO0FBQ2hFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IsOENBQThDO0FBQ2xFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IsNkNBQTZDO0FBQ2pFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQiwrQ0FBK0M7QUFDbkU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9tZWxlZWxpZ2h0Ly4vc3JjL3BoeXNpY3MvYXJ0aWNsZS50cz9hMzljIl0sInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuZXhwb3J0cy5hcnRpY2xlcyA9IGV4cG9ydHMuYXJ0aWNsZUhpdFF1ZXVlID0gZXhwb3J0cy5kZXN0cm95QXJ0aWNsZVF1ZXVlID0gZXhwb3J0cy5hQXJ0aWNsZXMgPSB2b2lkIDA7XG5leHBvcnRzLnJlc2V0QUFydGljbGVzID0gcmVzZXRBQXJ0aWNsZXM7XG5leHBvcnRzLmV4ZWN1dGVBcnRpY2xlcyA9IGV4ZWN1dGVBcnRpY2xlcztcbmV4cG9ydHMuZGVzdHJveUFydGljbGVzID0gZGVzdHJveUFydGljbGVzO1xuZXhwb3J0cy5yZW5kZXJBcnRpY2xlcyA9IHJlbmRlckFydGljbGVzO1xuZXhwb3J0cy5hcnRpY2xlc0hpdERldGVjdGlvbiA9IGFydGljbGVzSGl0RGV0ZWN0aW9uO1xuZXhwb3J0cy5leGVjdXRlQXJ0aWNsZUhpdHMgPSBleGVjdXRlQXJ0aWNsZUhpdHM7XG5leHBvcnRzLndhbGxEZXRlY3Rpb24gPSB3YWxsRGV0ZWN0aW9uO1xuZXhwb3J0cy5hcnRpY2xlSGl0Q29sbGlzaW9uID0gYXJ0aWNsZUhpdENvbGxpc2lvbjtcbmV4cG9ydHMuYXJ0aWNsZVNoaWVsZENvbGxpc2lvbiA9IGFydGljbGVTaGllbGRDb2xsaXNpb247XG5leHBvcnRzLmludGVycG9sYXRlZEFydGljbGVDaXJjbGVDb2xsaXNpb24gPSBpbnRlcnBvbGF0ZWRBcnRpY2xlQ2lyY2xlQ29sbGlzaW9uO1xuZXhwb3J0cy5pbnRlcnBvbGF0ZWRBcnRpY2xlSHVydENvbGxpc2lvbiA9IGludGVycG9sYXRlZEFydGljbGVIdXJ0Q29sbGlzaW9uO1xuZXhwb3J0cy5hcnRpY2xlSHVydENvbGxpc2lvbiA9IGFydGljbGVIdXJ0Q29sbGlzaW9uO1xuY29uc3QgbWFpbl8xID0gcmVxdWlyZShcIm1haW4vbWFpblwiKTtcbmNvbnN0IHJlbmRlcl8xID0gcmVxdWlyZShcIm1haW4vcmVuZGVyXCIpO1xuY29uc3Qgc2Z4XzEgPSByZXF1aXJlKFwibWFpbi9zZnhcIik7XG5jb25zdCBoaXREZXRlY3Rpb25fMSA9IHJlcXVpcmUoXCJwaHlzaWNzL2hpdERldGVjdGlvblwiKTtcbmNvbnN0IGVudmlyb25tZW50YWxDb2xsaXNpb25fMSA9IHJlcXVpcmUoXCIuL2Vudmlyb25tZW50YWxDb2xsaXNpb25cIik7XG5jb25zdCBlY2JUcmFuc2Zvcm1fMSA9IHJlcXVpcmUoXCIuLi9tYWluL3V0aWwvZWNiVHJhbnNmb3JtXCIpO1xuY29uc3QgZmluZFNtYWxsZXN0V2l0aGluXzEgPSByZXF1aXJlKFwiLi4vbWFpbi91dGlsL2ZpbmRTbWFsbGVzdFdpdGhpblwiKTtcbmNvbnN0IGxpbkFsZ18xID0gcmVxdWlyZShcIi4uL21haW4vbGluQWxnXCIpO1xuY29uc3QgYWN0aW9uU3RhdGVTaG9ydGN1dHNfMSA9IHJlcXVpcmUoXCJwaHlzaWNzL2FjdGlvblN0YXRlU2hvcnRjdXRzXCIpO1xuY29uc3QgZHJhd1ZmeF8xID0gcmVxdWlyZShcIm1haW4vdmZ4L2RyYXdWZnhcIik7XG5jb25zdCBhY3RpdmVTdGFnZV8xID0gcmVxdWlyZShcInN0YWdlcy9hY3RpdmVTdGFnZVwiKTtcbmNvbnN0IGNyZWF0ZUhpdEJveF8xID0gcmVxdWlyZShcIi4uL21haW4vdXRpbC9jcmVhdGVIaXRCb3hcIik7XG5jb25zdCBWZWMyRF8xID0gcmVxdWlyZShcIi4uL21haW4vdXRpbC9WZWMyRFwiKTtcbmNvbnN0IGxhc2VyXzEgPSByZXF1aXJlKFwiLi4vbWFpbi92ZngvZFZmeC9sYXNlclwiKTtcbmNvbnN0IGNocm9tYXRpY0FiZXJyYXRpb25fMSA9IHJlcXVpcmUoXCIuLi9tYWluL3ZmeC9jaHJvbWF0aWNBYmVycmF0aW9uXCIpO1xuY29uc3QgbWFrZUNvbG91cl8xID0gcmVxdWlyZShcIi4uL21haW4vdmZ4L21ha2VDb2xvdXJcIik7XG5jb25zdCBpbnRlcnBvbGF0ZWRDb2xsaXNpb25fMSA9IHJlcXVpcmUoXCIuL2ludGVycG9sYXRlZENvbGxpc2lvblwiKTtcbi8qIGVzbGludC1kaXNhYmxlICovXG5leHBvcnRzLmFBcnRpY2xlcyA9IFtdO1xuZXhwb3J0cy5kZXN0cm95QXJ0aWNsZVF1ZXVlID0gW107XG5leHBvcnRzLmFydGljbGVIaXRRdWV1ZSA9IFtdO1xuZnVuY3Rpb24gcmVzZXRBQXJ0aWNsZXMoKSB7XG4gICAgZXhwb3J0cy5hQXJ0aWNsZXMgPSBbXTtcbn1cbi8vIDAuMDAzOTA1ODMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMgPSBoaXRib3ggc2l6ZSBtdWx0aXBsaWVyXG5leHBvcnRzLmFydGljbGVzID0ge1xuICAgIFwiTEFTRVJcIjoge1xuICAgICAgICBuYW1lOiBcIkxBU0VSXCIsXG4gICAgICAgIGNhblR1cmJvQ2FuY2VsOiBmYWxzZSxcbiAgICAgICAgc3Ryb2tlU3R5bGU6IFwiXCIsXG4gICAgICAgIGZpbGxTdHlsZTogXCJcIixcbiAgICAgICAgaW5pdDogZnVuY3Rpb24gKG9wdGlvbnMpIHtcbiAgICAgICAgICAgIGNvbnN0IHAgPSBvcHRpb25zLnA7XG4gICAgICAgICAgICBjb25zdCB4ID0gb3B0aW9ucy54O1xuICAgICAgICAgICAgY29uc3QgeSA9IG9wdGlvbnMueTtcbiAgICAgICAgICAgIGNvbnN0IHJvdGF0ZSA9IG9wdGlvbnMucm90YXRlO1xuICAgICAgICAgICAgY29uc3QgaXNGb3ggPSAob3B0aW9ucy5pc0ZveCAhPT0gdW5kZWZpbmVkKSA/IG9wdGlvbnMuaXNGb3ggOiB0cnVlO1xuICAgICAgICAgICAgY29uc3QgcGFydE9mVGhyb3cgPSBvcHRpb25zLnBhcnRPZlRocm93IHx8IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5zdHJva2VTdHlsZSA9IGlzRm94ID8gXCJyZ2JhKDI1NSwgNTksIDU5LDAuNilcIiA6IFwicmdiYSg3MywxMzAsMjM0LDAuNilcIjtcbiAgICAgICAgICAgIHRoaXMuZmlsbFN0eWxlID0gaXNGb3ggPyBcInJnYigyNTUsIDE5MywgMTkzKVwiIDogXCJyZ2IoMjI1LCAyNTUsIDI1NSlcIjtcbiAgICAgICAgICAgIHZhciBvYmogPSB7XG4gICAgICAgICAgICAgICAgaGl0TGlzdDogW10sXG4gICAgICAgICAgICAgICAgcm90YXRlOiByb3RhdGUsXG4gICAgICAgICAgICAgICAgZGVzdHJveU9uSGl0OiB0cnVlLFxuICAgICAgICAgICAgICAgIGNsYW5rOiBmYWxzZSxcbiAgICAgICAgICAgICAgICB0aW1lcjogMCxcbiAgICAgICAgICAgICAgICB2ZWw6IG5ldyBWZWMyRF8xLlZlYzJEKChpc0ZveCA/IDcgOiA1KSAqIE1hdGguY29zKHJvdGF0ZSkgKiBtYWluXzEucGxheWVyW3BdLnBoeXMuZmFjZSwgKGlzRm94ID8gNyA6IDUpICogTWF0aC5zaW4ocm90YXRlKSksXG4gICAgICAgICAgICAgICAgcG9zOiBuZXcgVmVjMkRfMS5WZWMyRChtYWluXzEucGxheWVyW3BdLnBoeXMucG9zLnggKyAoeCAqIG1haW5fMS5wbGF5ZXJbcF0ucGh5cy5mYWNlKSwgbWFpbl8xLnBsYXllcltwXS5waHlzLnBvcy55ICsgeSksXG4gICAgICAgICAgICAgICAgcG9zUHJldjE6IG5ldyBWZWMyRF8xLlZlYzJEKG1haW5fMS5wbGF5ZXJbcF0ucGh5cy5wb3MueCwgbWFpbl8xLnBsYXllcltwXS5waHlzLnBvcy55ICsgeSksXG4gICAgICAgICAgICAgICAgcG9zUHJldjI6IG5ldyBWZWMyRF8xLlZlYzJEKG1haW5fMS5wbGF5ZXJbcF0ucGh5cy5wb3MueCwgbWFpbl8xLnBsYXllcltwXS5waHlzLnBvcy55ICsgeSksXG4gICAgICAgICAgICAgICAgcG9zUHJldjM6IG5ldyBWZWMyRF8xLlZlYzJEKG1haW5fMS5wbGF5ZXJbcF0ucGh5cy5wb3MueCwgbWFpbl8xLnBsYXllcltwXS5waHlzLnBvcy55ICsgeSksXG4gICAgICAgICAgICAgICAgcG9zUHJldjogbmV3IFZlYzJEXzEuVmVjMkQobWFpbl8xLnBsYXllcltwXS5waHlzLnBvcy54LCBtYWluXzEucGxheWVyW3BdLnBoeXMucG9zLnkgKyB5KSxcbiAgICAgICAgICAgICAgICBoYjogbmV3IGNyZWF0ZUhpdEJveF8xLmNyZWF0ZUhpdGJveChuZXcgVmVjMkRfMS5WZWMyRCgwLCAwKSwgMS4xNzIsIDMsIDM2MSwgaXNGb3ggPyAwIDogcGFydE9mVGhyb3cgPyAwIDogMTAwLCAwLCBpc0ZveCA/IDAgOiBwYXJ0T2ZUaHJvdyA/IDAgOiA1LCAwLCAwLCAxLCAxKSxcbiAgICAgICAgICAgICAgICBlY2I6IFtuZXcgVmVjMkRfMS5WZWMyRChtYWluXzEucGxheWVyW3BdLnBoeXMucG9zLnggKyAoeCAqIG1haW5fMS5wbGF5ZXJbcF0ucGh5cy5mYWNlKSwgbWFpbl8xLnBsYXllcltwXS5waHlzLnBvcy55ICsgeSAtIDAuMDEpLFxuICAgICAgICAgICAgICAgICAgICBuZXcgVmVjMkRfMS5WZWMyRChtYWluXzEucGxheWVyW3BdLnBoeXMucG9zLnggKyAoeCAqIG1haW5fMS5wbGF5ZXJbcF0ucGh5cy5mYWNlKSArIDEwLCBtYWluXzEucGxheWVyW3BdLnBoeXMucG9zLnkgKyB5KSxcbiAgICAgICAgICAgICAgICAgICAgbmV3IFZlYzJEXzEuVmVjMkQobWFpbl8xLnBsYXllcltwXS5waHlzLnBvcy54ICsgKHggKiBtYWluXzEucGxheWVyW3BdLnBoeXMuZmFjZSksIG1haW5fMS5wbGF5ZXJbcF0ucGh5cy5wb3MueSArIHkgKyAwLjAxKSxcbiAgICAgICAgICAgICAgICAgICAgbmV3IFZlYzJEXzEuVmVjMkQobWFpbl8xLnBsYXllcltwXS5waHlzLnBvcy54ICsgKHggKiBtYWluXzEucGxheWVyW3BdLnBoeXMuZmFjZSkgLSAxMCwgbWFpbl8xLnBsYXllcltwXS5waHlzLnBvcy55ICsgeSldXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgZXhwb3J0cy5hQXJ0aWNsZXMucHVzaCh7XG4gICAgICAgICAgICAgICAgbmFtZTogXCJMQVNFUlwiLFxuICAgICAgICAgICAgICAgIHBsYXllcjogcCxcbiAgICAgICAgICAgICAgICBpbnN0YW5jZTogb2JqXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGV4cG9ydHMuYXJ0aWNsZXMuTEFTRVIubWFpbihleHBvcnRzLmFBcnRpY2xlcy5sZW5ndGggLSAxKTtcbiAgICAgICAgfSxcbiAgICAgICAgbWFpbjogZnVuY3Rpb24gKGkpIHtcbiAgICAgICAgICAgIGV4cG9ydHMuYUFydGljbGVzW2ldLmluc3RhbmNlLnRpbWVyKys7XG4gICAgICAgICAgICBpZiAoZXhwb3J0cy5hQXJ0aWNsZXNbaV0uaW5zdGFuY2UudGltZXIgPiA0KSB7XG4gICAgICAgICAgICAgICAgZXhwb3J0cy5hQXJ0aWNsZXNbaV0uaW5zdGFuY2UucG9zUHJldi54ID0gZXhwb3J0cy5hQXJ0aWNsZXNbaV0uaW5zdGFuY2UucG9zUHJldjMueDtcbiAgICAgICAgICAgICAgICBleHBvcnRzLmFBcnRpY2xlc1tpXS5pbnN0YW5jZS5wb3NQcmV2LnkgPSBleHBvcnRzLmFBcnRpY2xlc1tpXS5pbnN0YW5jZS5wb3NQcmV2My55O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGV4cG9ydHMuYUFydGljbGVzW2ldLmluc3RhbmNlLnRpbWVyID4gMykge1xuICAgICAgICAgICAgICAgIGV4cG9ydHMuYUFydGljbGVzW2ldLmluc3RhbmNlLnBvc1ByZXYzLnggPSBleHBvcnRzLmFBcnRpY2xlc1tpXS5pbnN0YW5jZS5wb3NQcmV2Mi54O1xuICAgICAgICAgICAgICAgIGV4cG9ydHMuYUFydGljbGVzW2ldLmluc3RhbmNlLnBvc1ByZXYzLnkgPSBleHBvcnRzLmFBcnRpY2xlc1tpXS5pbnN0YW5jZS5wb3NQcmV2Mi55O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGV4cG9ydHMuYUFydGljbGVzW2ldLmluc3RhbmNlLnRpbWVyID4gMikge1xuICAgICAgICAgICAgICAgIGV4cG9ydHMuYUFydGljbGVzW2ldLmluc3RhbmNlLnBvc1ByZXYyLnggPSBleHBvcnRzLmFBcnRpY2xlc1tpXS5pbnN0YW5jZS5wb3NQcmV2MS54O1xuICAgICAgICAgICAgICAgIGV4cG9ydHMuYUFydGljbGVzW2ldLmluc3RhbmNlLnBvc1ByZXYyLnkgPSBleHBvcnRzLmFBcnRpY2xlc1tpXS5pbnN0YW5jZS5wb3NQcmV2MS55O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGV4cG9ydHMuYUFydGljbGVzW2ldLmluc3RhbmNlLnRpbWVyID4gMSkge1xuICAgICAgICAgICAgICAgIGV4cG9ydHMuYUFydGljbGVzW2ldLmluc3RhbmNlLnBvc1ByZXYxLnggPSBleHBvcnRzLmFBcnRpY2xlc1tpXS5pbnN0YW5jZS5wb3MueDtcbiAgICAgICAgICAgICAgICBleHBvcnRzLmFBcnRpY2xlc1tpXS5pbnN0YW5jZS5wb3NQcmV2MS55ID0gZXhwb3J0cy5hQXJ0aWNsZXNbaV0uaW5zdGFuY2UucG9zLnk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBleHBvcnRzLmFBcnRpY2xlc1tpXS5pbnN0YW5jZS5wb3MueCArPSBleHBvcnRzLmFBcnRpY2xlc1tpXS5pbnN0YW5jZS52ZWwueDtcbiAgICAgICAgICAgIGV4cG9ydHMuYUFydGljbGVzW2ldLmluc3RhbmNlLmVjYlswXS54ICs9IGV4cG9ydHMuYUFydGljbGVzW2ldLmluc3RhbmNlLnZlbC54O1xuICAgICAgICAgICAgZXhwb3J0cy5hQXJ0aWNsZXNbaV0uaW5zdGFuY2UuZWNiWzFdLnggKz0gZXhwb3J0cy5hQXJ0aWNsZXNbaV0uaW5zdGFuY2UudmVsLng7XG4gICAgICAgICAgICBleHBvcnRzLmFBcnRpY2xlc1tpXS5pbnN0YW5jZS5lY2JbMl0ueCArPSBleHBvcnRzLmFBcnRpY2xlc1tpXS5pbnN0YW5jZS52ZWwueDtcbiAgICAgICAgICAgIGV4cG9ydHMuYUFydGljbGVzW2ldLmluc3RhbmNlLmVjYlszXS54ICs9IGV4cG9ydHMuYUFydGljbGVzW2ldLmluc3RhbmNlLnZlbC54O1xuICAgICAgICAgICAgZXhwb3J0cy5hQXJ0aWNsZXNbaV0uaW5zdGFuY2UucG9zLnkgKz0gZXhwb3J0cy5hQXJ0aWNsZXNbaV0uaW5zdGFuY2UudmVsLnk7XG4gICAgICAgICAgICBleHBvcnRzLmFBcnRpY2xlc1tpXS5pbnN0YW5jZS5lY2JbMF0ueSArPSBleHBvcnRzLmFBcnRpY2xlc1tpXS5pbnN0YW5jZS52ZWwueTtcbiAgICAgICAgICAgIGV4cG9ydHMuYUFydGljbGVzW2ldLmluc3RhbmNlLmVjYlsxXS55ICs9IGV4cG9ydHMuYUFydGljbGVzW2ldLmluc3RhbmNlLnZlbC55O1xuICAgICAgICAgICAgZXhwb3J0cy5hQXJ0aWNsZXNbaV0uaW5zdGFuY2UuZWNiWzJdLnkgKz0gZXhwb3J0cy5hQXJ0aWNsZXNbaV0uaW5zdGFuY2UudmVsLnk7XG4gICAgICAgICAgICBleHBvcnRzLmFBcnRpY2xlc1tpXS5pbnN0YW5jZS5lY2JbM10ueSArPSBleHBvcnRzLmFBcnRpY2xlc1tpXS5pbnN0YW5jZS52ZWwueTtcbiAgICAgICAgICAgIGlmICh3YWxsRGV0ZWN0aW9uKGkpIHx8IGV4cG9ydHMuYUFydGljbGVzW2ldLmluc3RhbmNlLnRpbWVyID4gMjAwKSB7XG4gICAgICAgICAgICAgICAgZXhwb3J0cy5kZXN0cm95QXJ0aWNsZVF1ZXVlLnB1c2goaSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGRyYXc6IGZ1bmN0aW9uIChpKSB7XG4gICAgICAgICAgICBtYWluXzEuZmcyLnNhdmUoKTtcbiAgICAgICAgICAgIHZhciBoID0gbmV3IFZlYzJEXzEuVmVjMkQoKGV4cG9ydHMuYUFydGljbGVzW2ldLmluc3RhbmNlLnBvcy54ICogYWN0aXZlU3RhZ2VfMS5hY3RpdmVTdGFnZS5zY2FsZSkgKyBhY3RpdmVTdGFnZV8xLmFjdGl2ZVN0YWdlLm9mZnNldFswXSwgKGV4cG9ydHMuYUFydGljbGVzW2ldLmluc3RhbmNlLnBvcy55ICogLWFjdGl2ZVN0YWdlXzEuYWN0aXZlU3RhZ2Uuc2NhbGUpICtcbiAgICAgICAgICAgICAgICBhY3RpdmVTdGFnZV8xLmFjdGl2ZVN0YWdlLm9mZnNldFsxXSk7XG4gICAgICAgICAgICB2YXIgdCA9IG5ldyBWZWMyRF8xLlZlYzJEKChleHBvcnRzLmFBcnRpY2xlc1tpXS5pbnN0YW5jZS5wb3NQcmV2LnggKiBhY3RpdmVTdGFnZV8xLmFjdGl2ZVN0YWdlLnNjYWxlKSArIGFjdGl2ZVN0YWdlXzEuYWN0aXZlU3RhZ2Uub2Zmc2V0WzBdLCAoZXhwb3J0cy5hQXJ0aWNsZXNbaV0uaW5zdGFuY2UucG9zUHJldi55ICogLWFjdGl2ZVN0YWdlXzEuYWN0aXZlU3RhZ2Uuc2NhbGUpICsgYWN0aXZlU3RhZ2VfMS5hY3RpdmVTdGFnZS5vZmZzZXRbMV0pO1xuICAgICAgICAgICAgdmFyIGQgPSAoaC54ID4gdC54KSA/IDEgOiAtMTtcbiAgICAgICAgICAgIHZhciByID0gZXhwb3J0cy5hQXJ0aWNsZXNbaV0uaW5zdGFuY2Uucm90YXRlO1xuICAgICAgICAgICAgdmFyIHYxID0gKDAsIHJlbmRlcl8xLnJvdGF0ZVZlY3RvcikoLTQsIDIsIC1yKTtcbiAgICAgICAgICAgIHZhciB2MiA9ICgwLCByZW5kZXJfMS5yb3RhdGVWZWN0b3IpKDQsIDIsIC1yKTtcbiAgICAgICAgICAgIHZhciB2MyA9ICgwLCByZW5kZXJfMS5yb3RhdGVWZWN0b3IpKDQsIC0yLCAtcik7XG4gICAgICAgICAgICB2YXIgdjQgPSAoMCwgcmVuZGVyXzEucm90YXRlVmVjdG9yKSgtNCwgLTIsIC1yKTtcbiAgICAgICAgICAgICgwLCBjaHJvbWF0aWNBYmVycmF0aW9uXzEuY2hyb21hdGljQWJlcnJhdGlvbikobWFpbl8xLmZnMiwgKGMxLCBjMikgPT4gKDAsIGxhc2VyXzEuZHJhd0xhc2VyTGluZSkoaCwgdCwgdjEsIHYyLCB2MywgdjQsIGQsIGMxLCBjMiksICgwLCBtYWtlQ29sb3VyXzEudW5tYWtlQ29sb3VyKSh0aGlzLnN0cm9rZVN0eWxlKSwgKDAsIG1ha2VDb2xvdXJfMS51bm1ha2VDb2xvdXIpKHRoaXMuZmlsbFN0eWxlKSwgMC44LCBuZXcgVmVjMkRfMS5WZWMyRCgtMC4zICogTWF0aC5zaW4ocikgKiBhY3RpdmVTdGFnZV8xLmFjdGl2ZVN0YWdlLnNjYWxlLCAtMC4zICogTWF0aC5jb3MocikgKiBhY3RpdmVTdGFnZV8xLmFjdGl2ZVN0YWdlLnNjYWxlKSk7XG4gICAgICAgICAgICBtYWluXzEuZmcyLnJlc3RvcmUoKTtcbiAgICAgICAgfVxuICAgIH0sXG4gICAgXCJJTExVU0lPTlwiOiB7XG4gICAgICAgIG5hbWU6IFwiSUxMVVNJT05cIixcbiAgICAgICAgbm9EcmF3OiB0cnVlLFxuICAgICAgICBjYW5UdXJib0NhbmNlbDogdHJ1ZSxcbiAgICAgICAgaW5pdDogZnVuY3Rpb24gKG9wdGlvbnMpIHtcbiAgICAgICAgICAgIGNvbnN0IHAgPSBvcHRpb25zLnA7XG4gICAgICAgICAgICBjb25zdCB0eXBlID0gb3B0aW9ucy50eXBlO1xuICAgICAgICAgICAgY29uc3QgaXNGb3ggPSBvcHRpb25zLmlzRm94IHx8IHRydWU7XG4gICAgICAgICAgICB2YXIgb2JqID0ge1xuICAgICAgICAgICAgICAgIGhpdExpc3Q6IFtdLFxuICAgICAgICAgICAgICAgIGRlc3Ryb3lPbkhpdDogZmFsc2UsXG4gICAgICAgICAgICAgICAgY2xhbms6IHRydWUsXG4gICAgICAgICAgICAgICAgdGltZXI6IDAsXG4gICAgICAgICAgICAgICAgcG9zOiBuZXcgVmVjMkRfMS5WZWMyRChtYWluXzEucGxheWVyW3BdLnBoeXMucG9zUHJldi54LCBtYWluXzEucGxheWVyW3BdLnBoeXMucG9zUHJldi55ICsgNSksXG4gICAgICAgICAgICAgICAgcG9zUHJldjogbmV3IFZlYzJEXzEuVmVjMkQobWFpbl8xLnBsYXllcltwXS5waHlzLnBvc1ByZXYueCwgbWFpbl8xLnBsYXllcltwXS5waHlzLnBvc1ByZXYueSArIDUpLFxuICAgICAgICAgICAgICAgIGhiOiBuZXcgY3JlYXRlSGl0Qm94XzEuY3JlYXRlSGl0Ym94KG5ldyBWZWMyRF8xLlZlYzJEKDAsIDApLCA0LjE2MCwgNywgaXNGb3ggPyA4MCA6IDI3MCwgaXNGb3ggPyA2MCA6IDcwLCBpc0ZveCA/IDY4IDogNzAsIDAsIDEsIDEsIDEsIDEpLFxuICAgICAgICAgICAgICAgIGVjYjogW25ldyBWZWMyRF8xLlZlYzJEKG1haW5fMS5wbGF5ZXJbcF0ucGh5cy5wb3NQcmV2LngsIG1haW5fMS5wbGF5ZXJbcF0ucGh5cy5wb3NQcmV2LnkgLSAxMCksIG5ldyBWZWMyRF8xLlZlYzJEKG1haW5fMS5wbGF5ZXJbcF0ucGh5cy5wb3NQcmV2XG4gICAgICAgICAgICAgICAgICAgICAgICAueCArIDEwLCBtYWluXzEucGxheWVyW3BdLnBoeXMucG9zUHJldi55KSwgbmV3IFZlYzJEXzEuVmVjMkQobWFpbl8xLnBsYXllcltwXS5waHlzLnBvc1ByZXYueCwgbWFpbl8xLnBsYXllcltwXS5waHlzLnBvc1ByZXYueSArXG4gICAgICAgICAgICAgICAgICAgICAgICAxMCksIG5ldyBWZWMyRF8xLlZlYzJEKG1haW5fMS5wbGF5ZXJbcF0ucGh5cy5wb3NQcmV2LnggLSAxMCwgbWFpbl8xLnBsYXllcltwXS5waHlzLnBvc1ByZXYueSldXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgLy8gaWYgZ3JvdW5kXG4gICAgICAgICAgICBpZiAodHlwZSkge1xuICAgICAgICAgICAgICAgIGlmIChpc0ZveCkge1xuICAgICAgICAgICAgICAgICAgICBvYmouaGIua2cgPSA0MDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIG9iai5oYi5hbmdsZSA9IDY1O1xuICAgICAgICAgICAgICAgICAgICBvYmouaGIua2cgPSA2MDtcbiAgICAgICAgICAgICAgICAgICAgb2JqLmhiLmJrID0gNzQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZXhwb3J0cy5hQXJ0aWNsZXMucHVzaCh7XG4gICAgICAgICAgICAgICAgbmFtZTogXCJJTExVU0lPTlwiLFxuICAgICAgICAgICAgICAgIHBsYXllcjogcCxcbiAgICAgICAgICAgICAgICBpbnN0YW5jZTogb2JqXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGV4cG9ydHMuYXJ0aWNsZXMuSUxMVVNJT04ubWFpbihleHBvcnRzLmFBcnRpY2xlcy5sZW5ndGggLSAxKTtcbiAgICAgICAgfSxcbiAgICAgICAgbWFpbjogZnVuY3Rpb24gKGkpIHtcbiAgICAgICAgICAgIHZhciBwID0gZXhwb3J0cy5hQXJ0aWNsZXNbaV0ucGxheWVyO1xuICAgICAgICAgICAgZXhwb3J0cy5hQXJ0aWNsZXNbaV0uaW5zdGFuY2UudGltZXIrKztcbiAgICAgICAgICAgIGV4cG9ydHMuYUFydGljbGVzW2ldLmluc3RhbmNlLnBvc1ByZXYgPSBuZXcgVmVjMkRfMS5WZWMyRChleHBvcnRzLmFBcnRpY2xlc1tpXS5pbnN0YW5jZS5wb3MueCwgZXhwb3J0cy5hQXJ0aWNsZXNbaV0uaW5zdGFuY2UucG9zLnkpO1xuICAgICAgICAgICAgZXhwb3J0cy5hQXJ0aWNsZXNbaV0uaW5zdGFuY2UucG9zID0gbmV3IFZlYzJEXzEuVmVjMkQobWFpbl8xLnBsYXllcltwXS5waHlzLnBvc1ByZXYueCwgbWFpbl8xLnBsYXllcltwXS5waHlzLnBvc1ByZXYueSk7XG4gICAgICAgICAgICBleHBvcnRzLmFBcnRpY2xlc1tpXS5pbnN0YW5jZS5lY2IgPSBbbmV3IFZlYzJEXzEuVmVjMkQobWFpbl8xLnBsYXllcltwXS5waHlzLnBvc1ByZXYueCwgbWFpbl8xLnBsYXllcltwXS5waHlzLnBvc1ByZXYueSAtIDEwKSwgbmV3IFZlYzJEXzEuVmVjMkQobWFpbl8xLnBsYXllcltwXVxuICAgICAgICAgICAgICAgICAgICAucGh5cy5wb3NQcmV2LnggKyAxMCwgbWFpbl8xLnBsYXllcltwXS5waHlzLnBvc1ByZXYueSksIG5ldyBWZWMyRF8xLlZlYzJEKG1haW5fMS5wbGF5ZXJbcF0ucGh5cy5wb3NQcmV2LngsIG1haW5fMS5wbGF5ZXJbcF0ucGh5cy5wb3NQcmV2XG4gICAgICAgICAgICAgICAgICAgIC55ICsgMTApLCBuZXcgVmVjMkRfMS5WZWMyRChtYWluXzEucGxheWVyW3BdLnBoeXMucG9zUHJldi54IC0gMTAsIG1haW5fMS5wbGF5ZXJbcF0ucGh5cy5wb3NQcmV2LnkpXTtcbiAgICAgICAgICAgIGlmIChleHBvcnRzLmFBcnRpY2xlc1tpXS5pbnN0YW5jZS50aW1lciA+IDUpIHtcbiAgICAgICAgICAgICAgICBleHBvcnRzLmRlc3Ryb3lBcnRpY2xlUXVldWUucHVzaChpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn07XG5mdW5jdGlvbiBleGVjdXRlQXJ0aWNsZXMoKSB7XG4gICAgZXhwb3J0cy5kZXN0cm95QXJ0aWNsZVF1ZXVlID0gW107XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBleHBvcnRzLmFBcnRpY2xlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICBleHBvcnRzLmFydGljbGVzW2V4cG9ydHMuYUFydGljbGVzW2ldLm5hbWVdLm1haW4oaSk7XG4gICAgfVxufVxuZnVuY3Rpb24gZGVzdHJveUFydGljbGVzKCkge1xuICAgIGZvciAodmFyIGsgPSAwOyBrIDwgZXhwb3J0cy5kZXN0cm95QXJ0aWNsZVF1ZXVlLmxlbmd0aDsgaysrKSB7XG4gICAgICAgIGV4cG9ydHMuYUFydGljbGVzLnNwbGljZShleHBvcnRzLmRlc3Ryb3lBcnRpY2xlUXVldWVba10gLSBrLCAxKTtcbiAgICB9XG59XG5mdW5jdGlvbiByZW5kZXJBcnRpY2xlcygpIHtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGV4cG9ydHMuYUFydGljbGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGlmICghZXhwb3J0cy5hcnRpY2xlc1tleHBvcnRzLmFBcnRpY2xlc1tpXS5uYW1lXS5ub0RyYXcpIHtcbiAgICAgICAgICAgIGV4cG9ydHMuYXJ0aWNsZXNbZXhwb3J0cy5hQXJ0aWNsZXNbaV0ubmFtZV0uZHJhdyhpKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbmZ1bmN0aW9uIGFydGljbGVzSGl0RGV0ZWN0aW9uKCkge1xuICAgIGV4cG9ydHMuYXJ0aWNsZUhpdFF1ZXVlID0gW107XG4gICAgZm9yICh2YXIgYSA9IDA7IGEgPCBleHBvcnRzLmFBcnRpY2xlcy5sZW5ndGg7IGErKykge1xuICAgICAgICB2YXIgYXJ0aWNsZURlc3Ryb3llZCA9IGZhbHNlO1xuICAgICAgICBpZiAoZXhwb3J0cy5hQXJ0aWNsZXNbYV0uaW5zdGFuY2UudGltZXIgPiAxKSB7XG4gICAgICAgICAgICB2YXIgaW50ZXJwb2xhdGUgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdmFyIGludGVycG9sYXRlID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgdiA9IDA7IHYgPCA0OyB2KyspIHtcbiAgICAgICAgICAgIHZhciBpbkhpdExpc3QgPSBmYWxzZTtcbiAgICAgICAgICAgIGZvciAodmFyIG4gPSAwOyBuIDwgNDsgbisrKSB7XG4gICAgICAgICAgICAgICAgaWYgKHYgPT0gZXhwb3J0cy5hQXJ0aWNsZXNbYV0uaW5zdGFuY2UuaGl0TGlzdFtuXSkge1xuICAgICAgICAgICAgICAgICAgICBpbkhpdExpc3QgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBpZiB2IGlzbnQgdGhlIG93bmVyLCBub3QgZGVzdHJveWVkIGFuZCBubyBpbiBhcnRpY2xlJ3MgaGl0bGlzdFxuICAgICAgICAgICAgaWYgKHYgIT0gZXhwb3J0cy5hQXJ0aWNsZXNbYV0ucGxheWVyICYmICFhcnRpY2xlRGVzdHJveWVkICYmICFpbkhpdExpc3QgJiYgbWFpbl8xLnBsYXllclR5cGVbdl0gIT0gLTEpIHtcbiAgICAgICAgICAgICAgICAvLyBpZiBhcnRpY2xlIGlzIGNsYW5rYWJsZVxuICAgICAgICAgICAgICAgIHZhciBhdHRhY2tlckNsYW5rID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgaWYgKGV4cG9ydHMuYUFydGljbGVzW2FdLmluc3RhbmNlLmNsYW5rKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGsgPSAwOyBrIDwgNDsgaysrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobWFpbl8xLnBsYXllclt2XS5oaXRib3hlcy5hY3RpdmVba10gJiYgKG1haW5fMS5wbGF5ZXJbdl0uaGl0Ym94ZXMuaWRba10uY2xhbmsgPT0gMSB8fCAobWFpbl8xLnBsYXllclt2XS5oaXRib3hlcy5pZFtrXS5jbGFuayA9PVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDIgJiYgbWFpbl8xLnBsYXllclt2XS5waHlzLmdyb3VuZGVkKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBJTEwgRE8gQ0xBTktTIFRPTU9aXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLyp2YXIgY2xhbmtIaXQgPSBhcnRpY2xlSGl0Q29sbGlzaW9uKGEsdixrKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNsYW5rSGl0WzBdKXtcbiAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkaWZmID0gcGxheWVyW3BdLmhpdGJveGVzLmlkW2pdLmRtZyAtIHBsYXllcltpXS5oaXRib3hlcy5pZFtrXS5kbWc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkaWZmID49IDkpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB2aWN0aW0gY2xhbmtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gYXR0YWNrZXIgY3V0IHRocm91Z2hcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGxheWVyW2ldLmhpdC5oaXRsYWcgPSBNYXRoLmZsb29yKHBsYXllcltwXS5oaXRib3hlcy5pZFtqXS5kbWcgKiAoMS8zKSArIDMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0dXJuT2ZmSGl0Ym94ZXMoaSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvblN0YXRlc1tjaGFyYWN0ZXJTZWxlY3Rpb25zW2ldXVs3OF0uaW5pdChpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChkaWZmIDw9IC05KXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gYXR0YWNrZXIgY2xhbmtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdmljdGltIGN1dCB0aHJvdWdoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsYXllcltwXS5oaXQuaGl0bGFnID0gTWF0aC5mbG9vcihwbGF5ZXJbaV0uaGl0Ym94ZXMuaWRba10uZG1nICogKDEvMykgKyAzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXR0YWNrZXJDbGFuayA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFydGljbGVEZXN0cm95ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0dXJuT2ZmSGl0Ym94ZXMocCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvblN0YXRlc1tjaGFyYWN0ZXJTZWxlY3Rpb25zW3BdXVs3OF0uaW5pdChwLGlucHV0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gYm90aCBjbGFua1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGF5ZXJbaV0uaGl0LmhpdGxhZyA9IE1hdGguZmxvb3IocGxheWVyW3BdLmhpdGJveGVzLmlkW2pdLmRtZyAqICgxLzMpICsgMyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsYXllcltwXS5oaXQuaGl0bGFnID0gTWF0aC5mbG9vcihwbGF5ZXJbaV0uaGl0Ym94ZXMuaWRba10uZG1nICogKDEvMykgKyAzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXR0YWNrZXJDbGFuayA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFydGljbGVEZXN0cm95ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0dXJuT2ZmSGl0Ym94ZXMoaSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvblN0YXRlc1tjaGFyYWN0ZXJTZWxlY3Rpb25zW2ldXVs3OF0uaW5pdChpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHVybk9mZkhpdGJveGVzKHApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb25TdGF0ZXNbY2hhcmFjdGVyU2VsZWN0aW9uc1twXV1bNzhdLmluaXQocCxpbnB1dCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc291bmRzLmNsYW5rLnBsYXkoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZHJhd1ZmeChcImNsYW5rXCIsY2xhbmtIaXRbMV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGF5ZXJbcF0uaGl0Ym94ZXMuaGl0TGlzdC5wdXNoKGkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSovXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKCFhdHRhY2tlckNsYW5rKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciByZWZsZWN0ZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCA0OyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtYWluXzEucGxheWVyW3ZdLmhpdGJveGVzLmFjdGl2ZVtpXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtYWluXzEucGxheWVyW3ZdLmhpdGJveGVzLmlkW2ldLnR5cGUgPT0gNykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYXJ0aWNsZUhpdENvbGxpc2lvbihhLCB2LCBpKSB8fCAoaW50ZXJwb2xhdGUgJiYgKGFydGljbGVIaXRDb2xsaXNpb24oYSwgdiwgaSkgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGludGVycG9sYXRlZEFydGljbGVDaXJjbGVDb2xsaXNpb24oYSwgbmV3IFZlYzJEXzEuVmVjMkQobWFpbl8xLnBsYXllclt2XS5waHlzLnBvcy54ICsgbWFpbl8xLnBsYXllclt2XS5oaXRib3hlcy5pZFtpXVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5vZmZzZXRbMF0ueCwgbWFpbl8xLnBsYXllclt2XS5waHlzLnBvcy55ICsgbWFpbl8xLnBsYXllclt2XS5oaXRib3hlcy5pZFtpXS5vZmZzZXRbMF0ueSksIG1haW5fMS5wbGF5ZXJbdl0uaGl0Ym94ZXNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuaWRbaV0uc2l6ZSkpKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG1haW5fMS5wbGF5ZXJbdl0uYWN0aW9uU3RhdGUuc3Vic3RyKDAsIDExKSA9PSBcIkRPV05TUEVDSUFMXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBkbyBzaGluZSByZWZsZWN0IGFuaW1hdGlvblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNmeF8xLnNvdW5kcy5mb3hzaGluZXJlZmxlY3QucGxheSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gY2hhbmdlIG93bmVyc2hpcFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhwb3J0cy5hQXJ0aWNsZXNbYV0ucGxheWVyID0gdjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGluY3JlYXNlIGRhbWFnZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhwb3J0cy5hQXJ0aWNsZXNbYV0uaW5zdGFuY2UuaGIuZG1nICo9IDEuNTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHJlZmxlY3RcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChleHBvcnRzLmFBcnRpY2xlc1thXS5pbnN0YW5jZS52ZWwgIT0gdW5kZWZpbmVkIHx8IGV4cG9ydHMuYUFydGljbGVzW2FdLmluc3RhbmNlLnZlbCAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhwb3J0cy5hQXJ0aWNsZXNbYV0uaW5zdGFuY2UudmVsLnggKj0gLTE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhwb3J0cy5hQXJ0aWNsZXNbYV0uaW5zdGFuY2UudmVsLnkgKj0gLTE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWZsZWN0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKCFyZWZsZWN0ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtYWluXzEucGxheWVyW3ZdLnBoeXMuc2hpZWxkaW5nICYmIChhcnRpY2xlU2hpZWxkQ29sbGlzaW9uKGEsIHYsIGZhbHNlKSB8fCAoaW50ZXJwb2xhdGUgJiYgKGFydGljbGVTaGllbGRDb2xsaXNpb24oYSwgdiwgdHJ1ZSkgfHwgaW50ZXJwb2xhdGVkQXJ0aWNsZUNpcmNsZUNvbGxpc2lvbihhLCBtYWluXzEucGxheWVyW3ZdLnBoeXMuc2hpZWxkUG9zaXRpb25SZWFsLCBtYWluXzEucGxheWVyW3ZdLnBoeXMuc2hpZWxkU2l6ZSkpKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBleHBvcnRzLmFydGljbGVIaXRRdWV1ZS5wdXNoKFthLCB2LCB0cnVlXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhwb3J0cy5hQXJ0aWNsZXNbYV0uaW5zdGFuY2UuaGl0TGlzdC5wdXNoKHYpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChleHBvcnRzLmFydGljbGVzW2V4cG9ydHMuYUFydGljbGVzW2FdLm5hbWVdLmNhblR1cmJvQ2FuY2VsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1haW5fMS5wbGF5ZXJbZXhwb3J0cy5hQXJ0aWNsZXNbYV0ucGxheWVyXS5oYXNIaXQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKG1haW5fMS5wbGF5ZXJbdl0ucGh5cy5odXJ0Qm94U3RhdGUgIT0gMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhcnRpY2xlSHVydENvbGxpc2lvbihhLCB2LCBmYWxzZSkgfHwgKGludGVycG9sYXRlICYmIChpbnRlcnBvbGF0ZWRBcnRpY2xlSHVydENvbGxpc2lvbihhLCB2KSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcnRpY2xlSHVydENvbGxpc2lvbihhLCB2LCB0cnVlKSkpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4cG9ydHMuYXJ0aWNsZUhpdFF1ZXVlLnB1c2goW2EsIHYsIGZhbHNlXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4cG9ydHMuYUFydGljbGVzW2FdLmluc3RhbmNlLmhpdExpc3QucHVzaCh2KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGV4cG9ydHMuYXJ0aWNsZXNbZXhwb3J0cy5hQXJ0aWNsZXNbYV0ubmFtZV0uY2FuVHVyYm9DYW5jZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1haW5fMS5wbGF5ZXJbZXhwb3J0cy5hQXJ0aWNsZXNbYV0ucGxheWVyXS5oYXNIaXQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChleHBvcnRzLmFBcnRpY2xlc1thXS5pbnN0YW5jZS5kZXN0cm95T25IaXQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4cG9ydHMuZGVzdHJveUFydGljbGVRdWV1ZS5wdXNoKGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufVxuZnVuY3Rpb24gZXhlY3V0ZUFydGljbGVIaXRzKGlucHV0KSB7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBleHBvcnRzLmFydGljbGVIaXRRdWV1ZS5sZW5ndGg7IGkrKykge1xuICAgICAgICB2YXIgYSA9IGV4cG9ydHMuYXJ0aWNsZUhpdFF1ZXVlW2ldWzBdO1xuICAgICAgICB2YXIgdiA9IGV4cG9ydHMuYXJ0aWNsZUhpdFF1ZXVlW2ldWzFdO1xuICAgICAgICB2YXIgc2hpZWxkSGl0ID0gZXhwb3J0cy5hcnRpY2xlSGl0UXVldWVbaV1bMl07XG4gICAgICAgIHZhciBvID0gZXhwb3J0cy5hQXJ0aWNsZXNbYV0ucGxheWVyO1xuICAgICAgICB2YXIgaGIgPSBleHBvcnRzLmFBcnRpY2xlc1thXS5pbnN0YW5jZS5oYjtcbiAgICAgICAgdmFyIGRhbWFnZSA9IGhiLmRtZztcbiAgICAgICAgaWYgKHNoaWVsZEhpdCkge1xuICAgICAgICAgICAgaWYgKG1haW5fMS5wbGF5ZXJbdl0ucGh5cy5wb3dlclNoaWVsZFJlZmxlY3RBY3RpdmUpIHtcbiAgICAgICAgICAgICAgICAoMCwgZHJhd1ZmeF8xLmRyYXdWZngpKHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJwb3dlcnNoaWVsZHJlZmxlY3RcIixcbiAgICAgICAgICAgICAgICAgICAgcG9zOiBtYWluXzEucGxheWVyW3ZdLnBoeXMuc2hpZWxkUG9zaXRpb25SZWFsLFxuICAgICAgICAgICAgICAgICAgICBmYWNlOiBtYWluXzEucGxheWVyW3ZdLnBoeXMuZmFjZVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHNmeF8xLnNvdW5kcy5wb3dlcnNoaWVsZHJlZmxlY3QucGxheSgpO1xuICAgICAgICAgICAgICAgIGV4cG9ydHMuYUFydGljbGVzW2FdLnBsYXllciA9IHY7IC8vIGNoYW5nZSBvd25lcnNoaXAgdG8gdmljdGltXG4gICAgICAgICAgICAgICAgLy8gcmVmbGVjdHMgdmVsb2NpdHlcbiAgICAgICAgICAgICAgICBpZiAoZXhwb3J0cy5hQXJ0aWNsZXNbYV0uaW5zdGFuY2UudmVsICE9IHVuZGVmaW5lZCB8fCBleHBvcnRzLmFBcnRpY2xlc1thXS5pbnN0YW5jZS52ZWwgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICBleHBvcnRzLmFBcnRpY2xlc1thXS5pbnN0YW5jZS52ZWwueCAqPSAtMTtcbiAgICAgICAgICAgICAgICAgICAgZXhwb3J0cy5hQXJ0aWNsZXNbYV0uaW5zdGFuY2UudmVsLnkgKj0gLTE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vIGN1dHMgZGFtYWdlIGluIGhhbGZcbiAgICAgICAgICAgICAgICBleHBvcnRzLmFBcnRpY2xlc1thXS5pbnN0YW5jZS5oYi5kbWcgKj0gMC41O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgbWFpbl8xLnBsYXllclt2XS5waHlzLnNoaWVsZEhQIC09IGRhbWFnZTtcbiAgICAgICAgICAgICAgICBpZiAobWFpbl8xLnBsYXllclt2XS5waHlzLnNoaWVsZEhQIDwgMCkge1xuICAgICAgICAgICAgICAgICAgICBtYWluXzEucGxheWVyW3ZdLnBoeXMuc2hpZWxkaW5nID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIG1haW5fMS5wbGF5ZXJbdl0ucGh5cy5jVmVsLnkgPSAyLjU7XG4gICAgICAgICAgICAgICAgICAgIG1haW5fMS5wbGF5ZXJbdl0ucGh5cy5ncm91bmRlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBtYWluXzEucGxheWVyW3ZdLnBoeXMuc2hpZWxkSFAgPSAwO1xuICAgICAgICAgICAgICAgICAgICAoMCwgZHJhd1ZmeF8xLmRyYXdWZngpKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IFwiYnJlYWtTaGllbGRcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvczogbWFpbl8xLnBsYXllclt2XS5waHlzLnBvcyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGZhY2U6IG1haW5fMS5wbGF5ZXJbdl0ucGh5cy5mYWNlXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBhY3Rpb25TdGF0ZVNob3J0Y3V0c18xLmFjdGlvblN0YXRlc1ttYWluXzEuY2hhcmFjdGVyU2VsZWN0aW9uc1t2XV0uU0hJRUxEQlJFQUtGQUxMLmluaXQodiwgaW5wdXQpO1xuICAgICAgICAgICAgICAgICAgICBzZnhfMS5zb3VuZHMuc2hpZWxkYnJlYWsucGxheSgpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGV4cG9ydHMuYUFydGljbGVzW2FdLmluc3RhbmNlLmRlc3Ryb3lPbkhpdCkge1xuICAgICAgICAgICAgICAgICAgICBleHBvcnRzLmRlc3Ryb3lBcnRpY2xlUXVldWUucHVzaChhKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgKDAsIGRyYXdWZnhfMS5kcmF3VmZ4KSh7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IFwiY2xhbmtcIixcbiAgICAgICAgICAgICAgICAgICAgcG9zOiBleHBvcnRzLmFBcnRpY2xlc1thXS5pbnN0YW5jZS5wb3MsXG4gICAgICAgICAgICAgICAgICAgIGZhY2U6IDFcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBtYWluXzEucGxheWVyW3ZdLmhpdC5oaXRsYWcgPSBNYXRoLmZsb29yKGRhbWFnZSAqICgxIC8gMykgKyAzKTtcbiAgICAgICAgICAgICAgICBtYWluXzEucGxheWVyW3ZdLmhpdC5zaGllbGRzdHVuID0gKChNYXRoLmZsb29yKGRhbWFnZSkgKiAoKDAuNjUgKiAoMSAtICgobWFpbl8xLnBsYXllclt2XS5waHlzLnNoaWVsZEFuYWxvZyAtIDAuMykgLyAwLjcpKSkgK1xuICAgICAgICAgICAgICAgICAgICAwLjMpKSAqIDEuNSkgKyAyO1xuICAgICAgICAgICAgICAgIHZhciB2aWN0aW1QdXNoID0gKChNYXRoLmZsb29yKGRhbWFnZSkgKiAoKDAuMTk1ICogKDEgLSAoKG1haW5fMS5wbGF5ZXJbdl0ucGh5cy5zaGllbGRBbmFsb2cgLSAwLjMpIC8gMC43KSkpICsgMC4wOSkpICtcbiAgICAgICAgICAgICAgICAgICAgMC40KSAqIDAuNjtcbiAgICAgICAgICAgICAgICBpZiAodmljdGltUHVzaCA+IDIpIHtcbiAgICAgICAgICAgICAgICAgICAgdmljdGltUHVzaCA9IDI7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChleHBvcnRzLmFBcnRpY2xlc1thXS5pbnN0YW5jZS5wb3MueCA8IG1haW5fMS5wbGF5ZXJbdl0ucGh5cy5wb3MueCkge1xuICAgICAgICAgICAgICAgICAgICBtYWluXzEucGxheWVyW3ZdLnBoeXMuY1ZlbC54ID0gdmljdGltUHVzaDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIG1haW5fMS5wbGF5ZXJbdl0ucGh5cy5jVmVsLnggPSAtdmljdGltUHVzaDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBhY3Rpb25TdGF0ZVNob3J0Y3V0c18xLmFjdGlvblN0YXRlc1ttYWluXzEuY2hhcmFjdGVyU2VsZWN0aW9uc1t2XV0uR1VBUkQuaW5pdCh2LCBpbnB1dCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBpZiAobWFpbl8xLnBsYXllclt2XS5waHlzLmh1cnRCb3hTdGF0ZSA9PSAwKSB7XG4gICAgICAgICAgICAgICAgdmFyIGNyb3VjaGluZyA9IGFjdGlvblN0YXRlU2hvcnRjdXRzXzEuYWN0aW9uU3RhdGVzW21haW5fMS5jaGFyYWN0ZXJTZWxlY3Rpb25zW3ZdXVttYWluXzEucGxheWVyW3ZdLmFjdGlvblN0YXRlXS5jcm91Y2g7XG4gICAgICAgICAgICAgICAgdmFyIHZDYW5jZWwgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBpZiAobWFpbl8xLnBsYXllclt2XS5waHlzLnZDYW5jZWxUaW1lciA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGFjdGlvblN0YXRlU2hvcnRjdXRzXzEuYWN0aW9uU3RhdGVzW21haW5fMS5jaGFyYWN0ZXJTZWxlY3Rpb25zW3ZdXVttYWluXzEucGxheWVyW3ZdLmFjdGlvblN0YXRlXS52Q2FuY2VsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2Q2FuY2VsID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNmeF8xLnNvdW5kcy52Y2FuY2VsLnBsYXkoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBtYWluXzEucGxheWVyW3ZdLmhpdC5rbm9ja2JhY2sgPSAoMCwgaGl0RGV0ZWN0aW9uXzEuZ2V0S25vY2tiYWNrKShoYiwgZGFtYWdlLCBkYW1hZ2UsIG1haW5fMS5wbGF5ZXJbdl0ucGVyY2VudCwgbWFpbl8xLnBsYXllclt2XS5jaGFyQXR0cmlidXRlcy53ZWlnaHQsIGNyb3VjaGluZywgdkNhbmNlbCk7XG4gICAgICAgICAgICAgICAgbWFpbl8xLnBsYXllclt2XS5oaXQuaGl0UG9pbnQgPSBleHBvcnRzLmFBcnRpY2xlc1thXS5pbnN0YW5jZS5wb3M7XG4gICAgICAgICAgICAgICAgbWFpbl8xLnBsYXllclt2XS5wZXJjZW50ICs9IGRhbWFnZTtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKGhiLnR5cGUpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICAgICAgKDAsIGRyYXdWZnhfMS5kcmF3VmZ4KSh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJub3JtYWxoaXRcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3M6IG1haW5fMS5wbGF5ZXJbdl0uaGl0LmhpdFBvaW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZhY2U6IG1haW5fMS5wbGF5ZXJbdl0ucGh5cy5mYWNlXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICAgICAoMCwgZHJhd1ZmeF8xLmRyYXdWZngpKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBcImhpdFNwYXJrc1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvczogbWFpbl8xLnBsYXllclt2XS5oaXQuaGl0UG9pbnQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZmFjZTogbWFpbl8xLnBsYXllclt2XS5waHlzLmZhY2VcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgKDAsIGRyYXdWZnhfMS5kcmF3VmZ4KSh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJoaXRGbGFpclwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvczogbWFpbl8xLnBsYXllclt2XS5oaXQuaGl0UG9pbnQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZmFjZTogbWFpbl8xLnBsYXllclt2XS5waHlzLmZhY2VcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgKDAsIGRyYXdWZnhfMS5kcmF3VmZ4KSh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJoaXRDdXJ2ZVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvczogbWFpbl8xLnBsYXllclt2XS5oaXQuaGl0UG9pbnQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZmFjZTogbWFpbl8xLnBsYXllclt2XS5waHlzLmZhY2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZjogbWFpbl8xLnBsYXllclt2XS5oaXQuYW5nbGVcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgKDAsIGhpdERldGVjdGlvbl8xLmtub2NrYmFja1NvdW5kcykoaGIudHlwZSwgbWFpbl8xLnBsYXllclt2XS5oaXQua25vY2tiYWNrLCB2KTtcbiAgICAgICAgICAgICAgICBpZiAobWFpbl8xLnBsYXllclt2XS5oaXQua25vY2tiYWNrID4gMCkge1xuICAgICAgICAgICAgICAgICAgICBtYWluXzEucGxheWVyW3ZdLmhpdC5hbmdsZSA9IGhiLmFuZ2xlO1xuICAgICAgICAgICAgICAgICAgICBpZiAobWFpbl8xLnBsYXllclt2XS5oaXQuYW5nbGUgPT0gMzYxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobWFpbl8xLnBsYXllclt2XS5oaXQua25vY2tiYWNrIDwgMzIuMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1haW5fMS5wbGF5ZXJbdl0uaGl0LmFuZ2xlID0gMDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKG1haW5fMS5wbGF5ZXJbdl0uaGl0Lmtub2NrYmFjayA+PSAzMi4xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFpbl8xLnBsYXllclt2XS5oaXQuYW5nbGUgPSA0NDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBtYWluXzEucGxheWVyW3ZdLmhpdC5oaXRsYWcgPSBNYXRoLmZsb29yKGRhbWFnZSAqICgxIC8gMykgKyAzKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGV4cG9ydHMuYUFydGljbGVzW2FdLmluc3RhbmNlLnBvcy54IDwgbWFpbl8xLnBsYXllclt2XS5waHlzLnBvcy54KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBtYWluXzEucGxheWVyW3ZdLmhpdC5yZXZlcnNlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICBtYWluXzEucGxheWVyW3ZdLnBoeXMuZmFjZSA9IC0xO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgbWFpbl8xLnBsYXllclt2XS5oaXQucmV2ZXJzZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBtYWluXzEucGxheWVyW3ZdLnBoeXMuZmFjZSA9IDE7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdmFyIGlzVGhyb3cgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG1haW5fMS5wbGF5ZXJbdl0ucGh5cy5ncmFiYmVkQnkgPT0gLTEgfHwgKG1haW5fMS5wbGF5ZXJbdl0ucGh5cy5ncmFiYmVkQnkgPiAtMSAmJiBtYWluXzEucGxheWVyW3ZdLmhpdC5rbm9ja2JhY2sgPiA1MCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1haW5fMS5wbGF5ZXJbdl0uaGl0LmhpdHN0dW4gPSAoMCwgaGl0RGV0ZWN0aW9uXzEuZ2V0SGl0c3R1bikobWFpbl8xLnBsYXllclt2XS5oaXQua25vY2tiYWNrKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtYWluXzEucGxheWVyW3ZdLmhpdC5rbm9ja2JhY2sgPj0gODAgfHwgaXNUaHJvdykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvblN0YXRlU2hvcnRjdXRzXzEuYWN0aW9uU3RhdGVzW21haW5fMS5jaGFyYWN0ZXJTZWxlY3Rpb25zW3ZdXS5EQU1BR0VGTFlOLmluaXQodiwgaW5wdXQsICFpc1Rocm93KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvblN0YXRlU2hvcnRjdXRzXzEuYWN0aW9uU3RhdGVzW21haW5fMS5jaGFyYWN0ZXJTZWxlY3Rpb25zW3ZdXS5EQU1BR0VOMi5pbml0KHYsIGlucHV0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtYWluXzEucGxheWVyW3ZdLmFjdGlvblN0YXRlICE9IFwiVEhST1dOUFVGRkRPV05cIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvblN0YXRlU2hvcnRjdXRzXzEuYWN0aW9uU3RhdGVzW21haW5fMS5jaGFyYWN0ZXJTZWxlY3Rpb25zW3ZdXS5DQVBUVVJFREFNQUdFLmluaXQodiwgaW5wdXQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChtYWluXzEucGxheWVyW3ZdLnBoeXMuZ3JvdW5kZWQgJiYgbWFpbl8xLnBsYXllclt2XS5oaXQuYW5nbGUgPiAxODApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtYWluXzEucGxheWVyW3ZdLmhpdC5rbm9ja2JhY2sgPj0gODApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZnhfMS5zb3VuZHMuYm91bmNlLnBsYXkoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAoMCwgZHJhd1ZmeF8xLmRyYXdWZngpKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJncm91bmRCb3VuY2VcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zOiBtYWluXzEucGxheWVyW3ZdLnBoeXMucG9zLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmYWNlOiBtYWluXzEucGxheWVyW3ZdLnBoeXMuZmFjZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1haW5fMS5wbGF5ZXJbdl0uaGl0LmFuZ2xlID0gMzYwIC0gbWFpbl8xLnBsYXllclt2XS5oaXQuYW5nbGU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFpbl8xLnBsYXllclt2XS5oaXQua25vY2tiYWNrICo9IDAuODtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAoMCwgbWFpbl8xLnNjcmVlblNoYWtlKShtYWluXzEucGxheWVyW3ZdLmhpdC5rbm9ja2JhY2spO1xuICAgICAgICAgICAgICAgICAgICAoMCwgbWFpbl8xLnBlcmNlbnRTaGFrZSkobWFpbl8xLnBsYXllclt2XS5oaXQua25vY2tiYWNrLCB2KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBzZnhfMS5zb3VuZHMuYmx1bnRoaXQucGxheSgpO1xuICAgICAgICAgICAgICAgICgwLCBkcmF3VmZ4XzEuZHJhd1ZmeCkoe1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiBcImNsYW5rXCIsXG4gICAgICAgICAgICAgICAgICAgIHBvczogZXhwb3J0cy5hQXJ0aWNsZXNbYV0uaW5zdGFuY2UucG9zXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59XG5mdW5jdGlvbiB3YWxsRGV0ZWN0aW9uKGkpIHtcbiAgICBjb25zdCBhcnRpY2xlID0gZXhwb3J0cy5hQXJ0aWNsZXNbaV0uaW5zdGFuY2U7XG4gICAgY29uc3QgZWNicCA9IGFydGljbGUuZWNiO1xuICAgIGxldCBlY2IxO1xuICAgIGlmIChhcnRpY2xlLnRpbWVyIDwgMikge1xuICAgICAgICBjb25zdCBmb2N1cyA9IGFydGljbGUucG9zUHJldjtcbiAgICAgICAgY29uc3Qgb2Zmc2V0ID0gMC4wMDAxO1xuICAgICAgICBlY2IxID0gW25ldyBWZWMyRF8xLlZlYzJEKGZvY3VzLngsIGZvY3VzLnkgLSBvZmZzZXQpLFxuICAgICAgICAgICAgbmV3IFZlYzJEXzEuVmVjMkQoZm9jdXMueCArIG9mZnNldCwgZm9jdXMueSksXG4gICAgICAgICAgICBuZXcgVmVjMkRfMS5WZWMyRChmb2N1cy54LCBmb2N1cy55ICsgb2Zmc2V0KSxcbiAgICAgICAgICAgIG5ldyBWZWMyRF8xLlZlYzJEKGZvY3VzLnggLSBvZmZzZXQsIGZvY3VzLnkpXG4gICAgICAgIF07XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBlY2IxID0gKDAsIGVjYlRyYW5zZm9ybV8xLm1vdmVFQ0IpKGVjYnAsICgwLCBsaW5BbGdfMS5zdWJ0cmFjdCkoYXJ0aWNsZS5wb3NQcmV2LCBhcnRpY2xlLnBvcykpO1xuICAgIH1cbiAgICBsZXQgY29sbGlzaW9ucyA9IFtdO1xuICAgIGxldCB0aGlzQ29sbGlzaW9uID0gbnVsbDtcbiAgICBmb3IgKHZhciBqID0gMDsgaiA8IGFjdGl2ZVN0YWdlXzEuYWN0aXZlU3RhZ2Uud2FsbEwubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgdGhpc0NvbGxpc2lvbiA9ICgwLCBlbnZpcm9ubWVudGFsQ29sbGlzaW9uXzEuZmluZENvbGxpc2lvbikoZWNiMSwgZWNicCwgW2FjdGl2ZVN0YWdlXzEuYWN0aXZlU3RhZ2Uud2FsbExbal0sIFtcImxcIiwgal1dKTtcbiAgICAgICAgaWYgKHRoaXNDb2xsaXNpb24gIT09IG51bGwpIHtcbiAgICAgICAgICAgIGNvbGxpc2lvbnMucHVzaCh0aGlzQ29sbGlzaW9uKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBmb3IgKHZhciBqID0gMDsgaiA8IGFjdGl2ZVN0YWdlXzEuYWN0aXZlU3RhZ2Uud2FsbFIubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgdGhpc0NvbGxpc2lvbiA9ICgwLCBlbnZpcm9ubWVudGFsQ29sbGlzaW9uXzEuZmluZENvbGxpc2lvbikoZWNiMSwgZWNicCwgW2FjdGl2ZVN0YWdlXzEuYWN0aXZlU3RhZ2Uud2FsbFJbal0sIFtcInJcIiwgal1dKTtcbiAgICAgICAgaWYgKHRoaXNDb2xsaXNpb24gIT09IG51bGwpIHtcbiAgICAgICAgICAgIGNvbGxpc2lvbnMucHVzaCh0aGlzQ29sbGlzaW9uKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBmb3IgKHZhciBqID0gMDsgaiA8IGFjdGl2ZVN0YWdlXzEuYWN0aXZlU3RhZ2UuY2VpbGluZy5sZW5ndGg7IGorKykge1xuICAgICAgICB0aGlzQ29sbGlzaW9uID0gKDAsIGVudmlyb25tZW50YWxDb2xsaXNpb25fMS5maW5kQ29sbGlzaW9uKShlY2IxLCBlY2JwLCBbYWN0aXZlU3RhZ2VfMS5hY3RpdmVTdGFnZS5jZWlsaW5nW2pdLCBbXCJjXCIsIGpdXSk7XG4gICAgICAgIGlmICh0aGlzQ29sbGlzaW9uICE9PSBudWxsKSB7XG4gICAgICAgICAgICBjb2xsaXNpb25zLnB1c2godGhpc0NvbGxpc2lvbik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZm9yICh2YXIgaiA9IDA7IGogPCBhY3RpdmVTdGFnZV8xLmFjdGl2ZVN0YWdlLmdyb3VuZC5sZW5ndGg7IGorKykge1xuICAgICAgICB0aGlzQ29sbGlzaW9uID0gKDAsIGVudmlyb25tZW50YWxDb2xsaXNpb25fMS5maW5kQ29sbGlzaW9uKShlY2IxLCBlY2JwLCBbYWN0aXZlU3RhZ2VfMS5hY3RpdmVTdGFnZS5ncm91bmRbal0sIFtcImdcIiwgal1dKTtcbiAgICAgICAgaWYgKHRoaXNDb2xsaXNpb24gIT09IG51bGwpIHtcbiAgICAgICAgICAgIGNvbGxpc2lvbnMucHVzaCh0aGlzQ29sbGlzaW9uKTtcbiAgICAgICAgICAgIDtcbiAgICAgICAgfVxuICAgIH1cbiAgICBmb3IgKHZhciBqID0gMDsgaiA8IGFjdGl2ZVN0YWdlXzEuYWN0aXZlU3RhZ2UucGxhdGZvcm0ubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgdGhpc0NvbGxpc2lvbiA9ICgwLCBlbnZpcm9ubWVudGFsQ29sbGlzaW9uXzEuZmluZENvbGxpc2lvbikoZWNiMSwgZWNicCwgW2FjdGl2ZVN0YWdlXzEuYWN0aXZlU3RhZ2UucGxhdGZvcm1bal0sIFtcInBcIiwgal1dKTtcbiAgICAgICAgaWYgKHRoaXNDb2xsaXNpb24gIT09IG51bGwpIHtcbiAgICAgICAgICAgIGNvbGxpc2lvbnMucHVzaCh0aGlzQ29sbGlzaW9uKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBsZXQgZmlyc3RDb2xsaXNpb24gPSAoMCwgZmluZFNtYWxsZXN0V2l0aGluXzEucGlja1NtYWxsZXN0U3dlZXApKGNvbGxpc2lvbnMpO1xuICAgIGlmIChmaXJzdENvbGxpc2lvbiAhPT0gbnVsbCkge1xuICAgICAgICByZXR1cm4gZmlyc3RDb2xsaXNpb24uc3dlZXA7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG59XG5mdW5jdGlvbiBhcnRpY2xlSGl0Q29sbGlzaW9uKGEsIHYsIGspIHtcbiAgICB2YXIgaGJwb3MgPSBleHBvcnRzLmFBcnRpY2xlc1thXS5pbnN0YW5jZS5wb3M7XG4gICAgdmFyIGhicG9zMiA9IG5ldyBWZWMyRF8xLlZlYzJEKG1haW5fMS5wbGF5ZXJbdl0ucGh5cy5wb3MueCArIChtYWluXzEucGxheWVyW3ZdLmhpdGJveGVzLmlkW2tdLm9mZnNldFttYWluXzEucGxheWVyW3ZdLmhpdGJveGVzLmZyYW1lXS54ICogbWFpbl8xLnBsYXllclt2XS5waHlzLmZhY2UpLCBtYWluXzEucGxheWVyW3ZdLnBoeXMucG9zLnkgKyBtYWluXzEucGxheWVyW3ZdLmhpdGJveGVzLmlkW2tdLm9mZnNldFttYWluXzEucGxheWVyW3ZdLmhpdGJveGVzLmZyYW1lXS55KTtcbiAgICB2YXIgaGl0UG9pbnQgPSBuZXcgVmVjMkRfMS5WZWMyRCgoaGJwb3MueCArIGhicG9zMi54KSAvIDIsIChoYnBvcy55ICsgaGJwb3MyLnkpIC8gMik7XG4gICAgcmV0dXJuIChNYXRoLnBvdyhoYnBvczIueCAtIGhicG9zLngsIDIpICsgTWF0aC5wb3coaGJwb3MueSAtIGhicG9zMi55LCAyKSA8PSBNYXRoLnBvdyhleHBvcnRzLmFBcnRpY2xlc1thXS5pbnN0YW5jZS5oYi5zaXplICtcbiAgICAgICAgbWFpbl8xLnBsYXllclt2XS5oaXRib3hlcy5pZFtrXS5zaXplLCAyKSk7XG4gICAgLy9yZXR1cm4gWyhNYXRoLnBvdyhoYnBvczIueC1oYnBvcy54LDIpICsgTWF0aC5wb3coaGJwb3MueS1oYnBvczIueSwyKSA8PSBNYXRoLnBvdyhhQXJ0aWNsZXNbYV0uaW5zdGFuY2UuaGIuc2l6ZStwbGF5ZXJbdl0uaGl0Ym94ZXMuaWRba10uc2l6ZSwyKSksaGl0UG9pbnRdO1xufVxuZnVuY3Rpb24gYXJ0aWNsZVNoaWVsZENvbGxpc2lvbihhLCB2LCBwcmV2aW91cykge1xuICAgIGlmIChwcmV2aW91cykge1xuICAgICAgICB2YXIgaGJwb3MgPSBleHBvcnRzLmFBcnRpY2xlc1thXS5pbnN0YW5jZS5wb3NQcmV2O1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgdmFyIGhicG9zID0gZXhwb3J0cy5hQXJ0aWNsZXNbYV0uaW5zdGFuY2UucG9zO1xuICAgIH1cbiAgICB2YXIgc2hpZWxkcG9zID0gbWFpbl8xLnBsYXllclt2XS5waHlzLnNoaWVsZFBvc2l0aW9uUmVhbDtcbiAgICByZXR1cm4gKE1hdGgucG93KHNoaWVsZHBvcy54IC0gaGJwb3MueCwgMikgKyBNYXRoLnBvdyhoYnBvcy55IC0gc2hpZWxkcG9zLnksIDIpIDw9IE1hdGgucG93KGV4cG9ydHMuYUFydGljbGVzW2FdLmluc3RhbmNlLmhiLnNpemUgK1xuICAgICAgICBtYWluXzEucGxheWVyW3ZdLnBoeXMuc2hpZWxkU2l6ZSwgMikpO1xufVxuZnVuY3Rpb24gaW50ZXJwb2xhdGVkQXJ0aWNsZUNpcmNsZUNvbGxpc2lvbihhLCBjaXJjbGVQb3MsIHIpIHtcbiAgICBjb25zdCBoMSA9IGV4cG9ydHMuYUFydGljbGVzW2FdLmluc3RhbmNlLnBvc1ByZXY7XG4gICAgY29uc3QgaDIgPSBleHBvcnRzLmFBcnRpY2xlc1thXS5pbnN0YW5jZS5wb3M7XG4gICAgY29uc3QgcyA9IGV4cG9ydHMuYUFydGljbGVzW2FdLmluc3RhbmNlLmhiLnNpemU7XG4gICAgY29uc3QgY29sbGlzaW9uID0gKDAsIGludGVycG9sYXRlZENvbGxpc2lvbl8xLnN3ZWVwQ2lyY2xlVnNTd2VlcENpcmNsZSkoaDEsIHMsIGgyLCBzLCBjaXJjbGVQb3MsIHIsIGNpcmNsZVBvcywgcik7XG4gICAgaWYgKGNvbGxpc2lvbiA9PT0gbnVsbCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG59XG5mdW5jdGlvbiBpbnRlcnBvbGF0ZWRBcnRpY2xlSHVydENvbGxpc2lvbihhLCB2KSB7XG4gICAgY29uc3QgaHVydCA9IG1haW5fMS5wbGF5ZXJbdl0ucGh5cy5odXJ0Ym94O1xuICAgIGNvbnN0IGgxID0gZXhwb3J0cy5hQXJ0aWNsZXNbYV0uaW5zdGFuY2UucG9zUHJldjtcbiAgICBjb25zdCBoMiA9IGV4cG9ydHMuYUFydGljbGVzW2FdLmluc3RhbmNlLnBvcztcbiAgICBjb25zdCByID0gZXhwb3J0cy5hQXJ0aWNsZXNbYV0uaW5zdGFuY2UuaGIuc2l6ZTtcbiAgICBjb25zdCBjb2xsaXNpb24gPSAoMCwgaW50ZXJwb2xhdGVkQ29sbGlzaW9uXzEuc3dlZXBDaXJjbGVWc0FBQkIpKGgxLCByLCBoMiwgciwgaHVydC5taW4sIGh1cnQubWF4KTtcbiAgICBpZiAoY29sbGlzaW9uID09PSBudWxsKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGFydGljbGVIdXJ0Q29sbGlzaW9uKGEsIHYsIHByZXZpb3VzKSB7XG4gICAgaWYgKHByZXZpb3VzKSB7XG4gICAgICAgIHZhciBoYnBvcyA9IGV4cG9ydHMuYUFydGljbGVzW2FdLmluc3RhbmNlLnBvc1ByZXY7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICB2YXIgaGJwb3MgPSBleHBvcnRzLmFBcnRpY2xlc1thXS5pbnN0YW5jZS5wb3M7XG4gICAgfVxuICAgIHZhciBodXJ0Q2VudGVyID0gbmV3IFZlYzJEXzEuVmVjMkQoKG1haW5fMS5wbGF5ZXJbdl0ucGh5cy5odXJ0Ym94Lm1pbi54ICsgbWFpbl8xLnBsYXllclt2XS5waHlzLmh1cnRib3gubWF4LngpIC8gMiwgKG1haW5fMS5wbGF5ZXJbdl0ucGh5cy5odXJ0Ym94XG4gICAgICAgIC5taW4ueSArIG1haW5fMS5wbGF5ZXJbdl0ucGh5cy5odXJ0Ym94Lm1heC55KSAvIDIpO1xuICAgIHZhciBkaXN0YW5jZSA9IG5ldyBWZWMyRF8xLlZlYzJEKE1hdGguYWJzKGhicG9zLnggLSBodXJ0Q2VudGVyLngpLCBNYXRoLmFicyhoYnBvcy55IC0gaHVydENlbnRlci55KSk7XG4gICAgdmFyIGh1cnRXaWR0aCA9IDg7XG4gICAgdmFyIGh1cnRIZWlnaHQgPSAxODtcbiAgICBpZiAoZGlzdGFuY2UueCA+IChodXJ0V2lkdGggLyAyICsgZXhwb3J0cy5hQXJ0aWNsZXNbYV0uaW5zdGFuY2UuaGIuc2l6ZSkpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBpZiAoZGlzdGFuY2UueSA+IChodXJ0SGVpZ2h0IC8gMiArIGV4cG9ydHMuYUFydGljbGVzW2FdLmluc3RhbmNlLmhiLnNpemUpKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgaWYgKGRpc3RhbmNlLnggPD0gKGh1cnRXaWR0aCAvIDIpKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICBpZiAoZGlzdGFuY2UueSA8PSAoaHVydEhlaWdodCAvIDIpKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICB2YXIgY29ybmVyRGlzdGFuY2Vfc3EgPSBNYXRoLnBvdyhkaXN0YW5jZS54IC0gaHVydFdpZHRoIC8gMiwgMikgK1xuICAgICAgICBNYXRoLnBvdyhkaXN0YW5jZS55IC0gaHVydEhlaWdodCAvIDIsIDIpO1xuICAgIHJldHVybiAoY29ybmVyRGlzdGFuY2Vfc3EgPD0gKE1hdGgucG93KGV4cG9ydHMuYUFydGljbGVzW2FdLmluc3RhbmNlLmhiLnNpemUsIDIpKSk7XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/physics/article.ts\n");

/***/ })

},
/******/ function(__webpack_require__) { // webpackRuntimeModules
/******/ /* webpack/runtime/getFullHash */
/******/ (() => {
/******/ 	__webpack_require__.h = () => ("853d16988caf7b71bd2d")
/******/ })();
/******/ 
/******/ }
);